<!DOCTYPE html>
<html>

<!-- Mirrored from smartfun.club/serve?portal_id=5763614147346432&game_id=5420867413606400&branding_id=5734046899372032&ad_id=4865470182195200&portal_localization_id=5092721263902720 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Sep 2023 14:22:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <title>Tic Tac Toe With Friends</title>
    <link rel="icon" type="image/x-icon" href="http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/misc/favicon.ico" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <!-- Use this metatag when Apple fixes their IOS 9
    <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1, maximum-scale=1, user-scalable=0, minimal-ui"/>
    -->
    <!--Temporary fix for IOS 9-->
    <meta name="viewport" content="initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no, minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <script type="text/javascript" src="../whitelabel-cdn.marketjs.com/jquery.min.js"></script>
    <script type="text/javascript">
        //SERVER_IP = "188.166.215.35:3000";
        SERVER_IP = "common.marketjs-multiplayer.com";
    </script>
<style>html,body{background-color:#000;margin:0;padding:0;position:relative;font-family:"Arial";width:100%;height:100%;overflow:hidden}@font-face{font-family:'leaguespartan';src:url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/leaguespartan.eot') format('embedded-opentype');src:url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/leaguespartan.eot?#iefix') format('embedded-opentype'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/leaguespartan.woff') format('woff'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/leaguespartan.svg') format('svg'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/leaguespartan.otf') format('opentype')}@font-face{font-family:'lobster13';src:url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/lobster13.eot') format('embedded-opentype');src:url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/lobster13.eot?#iefix') format('embedded-opentype'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/lobster13.woff') format('woff'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/lobster13.svg') format('svg'),url('http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/font/lobster13.otf') format('opentype')}#pause{position:absolute;float:left;width:100%;height:100%;top:0;left:0;z-index:99999;display:none;font-size:2em;text-align:center;background:rgba(0,0,0,0.2);color:#fff}#game{position:absolute;left:0;top:0;z-index:0}#ajaxbar{background:url('../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/loading/ajax-loader.gif') center no-repeat;width:100%;height:100%;z-index:5}#canvas{position:absolute;left:0;top:0;width:100%;height:100%;-ms-interpolation-mode:nearest-neighbor;-webkit-transform:scale3d(1,1,1);z-index:1}#orientate{position:absolute;float:left;width:100%;height:100%;top:0;left:0;z-index:10002;display:none}#orientate img{position:absolute;float:left;width:100%;height:100%}.play{position:absolute;float:left;width:100%;height:100%;z-index:1000;background-color:#fff;left:0;top:0;display:none}.play img{position:absolute;float:left;width:100%;height:100%;z-index:1000;left:0;top:0}#nohtml5{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:1002;visibility:hidden}#nohtml5 img{position:absolute;width:100%;height:100%}#nohtml5-bubble{position:absolute;bottom:20px;left:50px;width:380px;height:100px;z-index:1002;color:#000;background:rgba(255,255,255,0.75);-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}#nohtml5-text{padding:10px}.horizontal-seperator{height:10px;width:100%}.ig_debug{position:fixed;left:0;bottom:0;width:100%;background-color:#000;border-top:2px solid #f57401;font-size:12px;color:#fff;z-index:1000;-webkit-user-select:none;display:none}.ig_debug_panel_menu{height:28px;background:#222;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#000),color-stop(1,#333));background:-moz-linear-gradient(center bottom,#000 0,#333 100%);background:-o-linear-gradient(#333,#000)}.ig_debug_panel_menu div{float:left;height:22px;padding:6px 8px 0 8px;border-right:1px solid #333}.ig_debug_panel_menu .ig_debug_head{font-weight:bold;color:#888}.ig_debug_menu_item:hover{cursor:pointer;background-color:#fff;color:#000}.ig_debug_menu_item.active,.ig_debug_menu_item.active:hover{background-color:#000;color:#fff}.ig_debug_stats{position:absolute;right:0;top:0;float:right;color:#888;border-left:1px solid #333;text-align:right}.ig_debug_stats span{width:3em;display:inline-block;color:#fff !important;margin-right:.2em;margin-left:.3em;font-family:bitstream vera sans mono,courier new;white-space:nowrap}.ig_debug_panel{height:152px;overflow:auto;position:relative}.ig_debug_panel canvas{border-bottom:1px solid #444}.ig_debug_panel .ig_debug_panel{padding:8px;height:auto;float:left;background-color:#000;border-right:2px solid #222}.ig_debug_option{padding:2px 0 2px 8px;cursor:pointer}.ig_debug_option:first-child{margin-top:8px}.ig_debug_option:hover{background-color:#111}.ig_debug_graph_mark{position:absolute;color:#888;left:4px;font-size:10px;margin-top:-12px}.ig_debug_legend{color:#ccc}.ig_debug_label_mark{display:inline-block;width:10px;height:10px;margin-right:4px;-webkit-transition:.1s linear;-moz-transition:.1s linear}.ig_debug_legend_color{display:inline-block;width:6px;height:10px;margin-right:4px;margin-left:16px}.ig_debug_legend_number{width:3em;display:inline-block;text-align:right;font-family:bitstream vera sans mono,courier new;color:#fff;margin-right:.2em}.ig_debug_map_container{position:relative;overflow:hidden;border:1px solid #888}.ig_debug_map_container canvas{position:absolute}.ig_debug_map_screen{position:absolute;border:1px solid #f0f}</style>
<!-- APICode -->
<!-- In Game Preroll Structure Template here --><div id='AdInGamePreroll'><div id='AdInGamePreroll-Box'><div id='AdInGamePreroll-Box-Header'></div><a id='AdInGamePreroll-Box-Close' onclick='AdInGamePreroll.Close();'></a><div id='AdInGamePreroll-Box-Body'><center></center></div><div id='AdInGamePreroll-Box-Footer'></div></div></div><!-- In Game Endgame Structure Template here --><div id='AdInGameEndgame'><div id='AdInGameEndgame-Box'><div id='AdInGameEndgame-Box-Header'></div><a id='AdInGameEndgame-Box-Close' onclick='AdInGameEndgame.Close();'></a><div id='AdInGameEndgame-Box-Body'><center></center></div><div id='AdInGameEndgame-Box-Footer'></div></div></div><!-- In Game Endgame Structure Template here --><div id='AdInGameEndgame'><div id='AdInGameEndgame-Box'><div id='AdInGameEndgame-Box-Header'></div><a id='AdInGameEndgame-Box-Close' onclick='AdInGameEndgame.Close();'></a><div id='AdInGameEndgame-Box-Body'><center></center></div><div id='AdInGameEndgame-Box-Footer'></div></div></div>
<script type='text/javascript'>// Setup
function getQueryVariable(variable) {
    var query = window.location.search.substring(1); // search in parent
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
        }
    }
}

var mjs_game_id = getQueryVariable('game_id')
var mjs_portal_id = getQueryVariable('portal_id')
var mjs_branding_id = getQueryVariable('branding_id')
var mjs_ad_id = getQueryVariable('ad_id')

console.log('mjs_game_id:',mjs_game_id)
console.log('mjs_portal_id:',mjs_portal_id)
console.log('mjs_branding_id:',mjs_branding_id)
console.log('mjs_ad_id:',mjs_ad_id)

//Base structure in script form
var css = "";
css+= "html,body,#sticky-container{margin:0;height:100%;color:#000;background:#e3f2fc;font-size:1.2em;font-family:Helvetica,Arial,sans-serif}#sticky-container{height:auto;min-height:100%}#sticky-footer{clear:both;position:relative;z-index:10}h1{padding:0;margin:0}h2{font-size:1.2em;padding:0;margin:0}h3{font-size:.8em;padding:0;margin:0}a{color:#128ccb}a.hover{color:#128ccb}.button{font-size:1em;font-weight:normal;-moz-border-radius:.5em;-webkit-border-radius:.5em;border-radius:.5em;padding:.5em 1em;text-decoration:none;color:#fff;background-color:#fbd305;display:inline-block}.button:hover{background-color:#fbd305;color:#fff;text-decoration:none !important}.button:active{position:relative;top:.05em}.button-large{font-size:2em}input[type=submit]{border:0}.valid{font-size:.8em;color:#1bdc24}.error{font-size:.8em;color:#ea1313;margin-top:.2em;margin-bottom:.5em;display:block}.tip{color:#ccc;font-size:.8em}.borderless{border:none !important}.pull-right{text-align:right}.padding-side{padding:0 1em 0 1em}.padding-side-small{padding:0 .5em 0 .5em}.padding-side-medium{padding:0 1.5em 0 1.5em}.container{clear:both;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;border-left:0 solid #ccc;border-right:0 solid #ccc;min-height:100%}.container-shadow{-webkit-box-shadow:5px 0 5px -2px #ccc,-5px 0 5px -2px #ccc;box-shadow:5px 0 5px -2px #ccc,-5px 0 5px -2px #ccc}.overlay-container-basic{background:rgba(0,0,0,0.4);width:100%;height:100%;min-height:100%;position:fixed;top:0;left:0;z-index:10004;display:none}.overlay-container{background:rgba(0,0,0,0.4);width:100%;height:100%;min-height:100%;position:fixed;top:0;left:0;z-index:10005;display:none}.overlay-container img{position:fixed;top:50%;left:50%}.horizontal-seperator{height:1em;width:100%}.horizontal-seperator-small{height:.5em;width:100%}.horizontal-seperator-line{width:100%;border-bottom:1px solid #ccc;margin-top:.2em;margin-bottom:.2em}.section{clear:both;margin:0}.inner_section{clear:both;margin:0}.col{display:block;float:left;margin:0}.col:first-child{margin-left:0}.group:before,.group:after{content:'';display:table}.group:after{clear:both}.group{zoom:1}.span_4_of_4{width:100%}.span_3_of_4{width:74.6%}.span_2_of_4{width:49.2%}.span_1_of_4{width:23.8%}.span_3_of_3{width:100%}.span_2_of_3{width:76.1%}.span_1_of_3{width:20.2%}.span_10_of_10{width:100%}.span_9_of_10{width:89.84%}.span_8_of_10{width:79.68%}.span_7_of_10{width:69.52%}.span_6_of_10{width:59.36%}.span_5_of_10{width:49.2%}.span_4_of_10{width:39.04%}.span_3_of_10{width:28.88%}.span_2_of_10{width:18.72%}.span_1_of_10{width:8.56%}.span_8_of_8{width:100%}.span_7_of_8{width:87.3%}.span_6_of_8{width:74.6%}.span_5_of_8{width:61.9%}.span_4_of_8{width:49.2%}.span_3_of_8{width:36.5%}.span_2_of_8{width:23.8%}.span_1_of_8{width:11.1%}.span_6_of_6{width:100%}.span_5_of_6{width:83.06%}.span_4_of_6{width:66.13%}.span_3_of_6{width:49.2%}.span_2_of_6{width:33.00%}.span_1_of_6{width:16.00%}.right_bar_module_span_2_of_6{width:100%}.overlay_span_middle{width:32.26%}.overlay_span_side{width:32.26%}@media only screen and (max-width:480px){.col{margin:1% 0 1% 0}.span_2_of_3{width:80%}.span_1_of_3{width:20%}.span_4_of_4{width:100%}.span_3_of_4{width:100%}.span_2_of_4{width:100%}.span_1_of_4{width:100%}.span_2_of_6{width:100%}.span_1_of_6{width:33%}.span_10_of_10{width:100%}.span_9_of_10{width:100%}.span_8_of_10{width:100%}.span_7_of_10{width:100%}.span_6_of_10{width:100%}.span_5_of_10{width:100%}.span_4_of_10{width:100%}.span_3_of_10{width:100%}.span_2_of_10{width:100%}.span_1_of_10{width:100%}.overlay_span_middle{width:100%}.overlay_span_side{width:100%}.container{margin:0}.navigation{line-height:1.8em;font-size:.8em}.css_btn_class{font-size:2em}.right_bar_module_span_2_of_6{width:100%}.box-action{margin:.2em}.featured-short-description{display:none}.box-more-games{height:140px !important}}@media only screen and (min-width:480px) and (max-width:768px){.span_2_of_3{width:80%}.span_1_of_3{width:20%}.span_6_of_10{width:50.0%}.span_4_of_10{width:50.0%}.span_7_of_10{width:100%}.span_2_of_10{width:100%}.span_3_of_10{width:100%}.span_2_of_6{width:50%}.navigation{line-height:2em}.right_bar_module_span_2_of_6{width:50%}.span_1_of_4{width:100%}.span_3_of_4{width:100%}.overlay_span_middle{width:50%}.overlay_span_side{width:25%}}@media only screen and (min-width :768px) and (max-width:1152px){.tablet-left{width:60%}.tablet-right{width:40%}.span_3_of_4{width:65%}.span_1_of_4{width:33%}.span_2_of_6{width:50.00%}.span_1_of_6{width:19.7%}.right_bar_module_span_2_of_6{width:100%}.overlay_span_middle{width:45%}.overlay_span_side{width:27.5%}.container{margin:0}.navigation{line-height:1.8em}.box-embed{width:92%}}@media only screen and (max-width:1165px){.AdPortalLeaderboard{display:none}}@media only screen and (max-width:1280px){.container{margin:0}.AdPortalSkyscraperLeft{display:none}.AdPortalSkyscraperRight{display:none}}@media only screen and (min-device-width :320px) and (max-device-width :568px) and (orientation :landscape){.span_6_of_10{width:60.0%}.span_4_of_10{width:40.0%}}";
css+= "/*BRANDING_IN_GAME_MENUBAR_THEME*/"; //can't fit in one line. Do we minify and remove all spaces?
css+= "/*BRANDING_IN_GAME_MENUBAR_USER_PANEL_LOGGED_THEME*/";
css+= "/*BRANDING_IN_GAME_MENUBAR_USER_PANEL_UNLOGGED_THEME*/";
css+= "/*BRANDING_IN_GAME_MENUBAR_LOGIN_THEME*/";
css+= "/*BRANDING_IN_GAME_MENUBAR_REGISTER_THEME*/";
css+= "/*BRANDING_IN_GAME_MENUBAR_LOGOUT_THEME*/";
css+= "/*BRANDING_IN_GAME_MENUBAR_LEADERBOARD_THEME*/";
css+= "/*BRANDING_CHANGE_USERNAME_THEME*/";
css+= "#AdInGamePreroll{position:absolute;float:left;min-width:320px;z-index:10000;left:0;top:0;display:none;background:rgba(0,0,0,0.7);-webkit-transition:all .6s ease;-moz-transition:all .6s ease;-o-transition:all .6s ease}#AdInGamePreroll-Box{z-index:10000;position:absolute;width:302px;height:250px}#AdInGamePreroll-Box-Body{z-index:10000;position:relative;background:transparent}#AdInGamePreroll-Box-Footer{z-index:10000;position:relative;font-size:11px;height:20px;color:#fff;background:transparent}#AdInGamePreroll-Box-Header{z-index:10000;position:relative;margin-top:-2px;font-size:11px;height:20px;text-align:right;color:#fff;background:transparent}#AdInGamePreroll-Box-Close{position:absolute;z-index:10005;background-image:url('static/test/images/ad/close-button.png');background-repeat:no-repeat;width:22px;height:22px;top:-4px;margin-right:-1px;display:none}";
css+= "#AdInGameEndgame{position:absolute;float:left;min-width:320px;z-index:10000;left:0;top:0;display:none;background:rgba(0,0,0,0.7);-webkit-transition:all .6s ease;-moz-transition:all .6s ease;-o-transition:all .6s ease}#AdInGameEndgame-Box{z-index:10000;position:absolute;width:302px;height:250px}#AdInGameEndgame-Box-Body{z-index:10000;position:relative;background:transparent}#AdInGameEndgame-Box-Footer{z-index:10000;position:relative;font-size:11px;height:20px;color:#fff;background:transparent}#AdInGameEndgame-Box-Header{z-index:10000;position:relative;margin-top:-2px;font-size:11px;height:20px;text-align:right;color:#fff;background:transparent}#AdInGameEndgame-Box-Close{position:absolute;z-index:10005;background-image:url('static/test/images/ad/close-button.png');background-repeat:no-repeat;width:22px;height:22px;top:-4px;margin-right:-1px;display:none}";

var html = "";
html+= "<!--BRANDING_IN_GAME_MENUBAR_STRUCTURE-->";
html+= "<!--BRANDING_IN_GAME_MENUBAR_LOGIN_STRUCTURE-->";
html+= "<!--BRANDING_IN_GAME_MENUBAR_REGISTER_STRUCTURE-->";
html+= "<!--BRANDING_IN_GAME_MENUBAR_LOGOUT_STRUCTURE-->";
html+= "<!--BRANDING_IN_GAME_MENUBAR_LEADERBOARD_STRUCTURE-->";
html+= "<!--BRANDING_CHANGE_USERNAME_STRUCTURE-->";
html+= "<!--AD_IN_GAME_PREROLL_STRUCTURE-->";
html+= "<!--AD_IN_GAME_ENDGAME_STRUCTURE-->";

$('head').append("<style>"+css+"</style>");
$('html').append(html);

//Base script contains all that important juice (language.jsvalidate,forms,validate extra,etc)

var _CONFIG={LOGGING:!0};var Language=new function(){this.en={Validation:{urlshort:"Please enter a valid url: Eg: mysite.com",alphanumeric:"Letters, numbers, and dashes only please",lettersonly:"Letters only please",letterswithbasicpunc:"Letters or punctuation only please",letterswithwhitespace:"Letters with white spaces only please",alphanumericnodash:"Letters and numbers only please",alphanumericwhitespace:"Letters and numbers only please",nowhitespace:"No white space please",ziprange:"Your ZIP-code must be in the range 902xx-xxxx to 905-xx-xxxx",
integer:"A positive or negative non-decimal number please",vinUS:"The specified vehicle identification number (VIN) is invalid",dateITA:"Please enter a correct date","user-password-retype":"Please type in the same password",maxWords:"Please enter {0} words or less",minWords:"Please enter at least {0} words",rangeWords:"Please enter between {0} and {1} words",valueNotEquals:"Value must not equal arg",required:"This field is required",remote:"Please fix this field",email:"Valid email address required",
url:"Please enter a valid URL",date:"Please enter a valid date",dateISO:"Please enter a valid date (ISO)",number:"Please enter a valid number",digits:"Please enter only digits",creditcard:"Please enter a valid credit card number",equalTo:"Please enter the same value again",accept:"Please enter a value with a valid extension",maxlength:"Please enter no more than {0} characters",minlength:"Please enter at least {0} characters",rangelength:"Please enter a value between {0} and {1} characters long",range:"Please enter a value between {0} and {1}",
max:"Please enter a value less than or equal to {0}",min:"Please enter a value greater than or equal to {0}"}};this.zh={}},Localization=Language.en;(function(b){b.extend(b.fn,{validate:function(a){if(this.length){var c=b.data(this[0],"validator");if(c)return c;this.attr("novalidate","novalidate");c=new b.validator(a,this[0]);b.data(this[0],"validator",c);c.settings.onsubmit&&(a=this.find("input, button"),a.filter(".cancel").click(function(){c.cancelSubmit=!0}),c.settings.submitHandler&&a.filter(":submit").click(function(){c.submitButton=this}),this.submit(function(a){function f(){if(c.settings.submitHandler){if(c.submitButton)var a=b("<input type='hidden'/>").attr("name",
c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm);c.settings.submitHandler.call(c,c.currentForm);c.submitButton&&a.remove();return!1}return!0}c.settings.debug&&a.preventDefault();if(c.cancelSubmit)return c.cancelSubmit=!1,f();if(c.form())return c.pendingRequest?(c.formSubmitted=!0,!1):f();c.focusInvalid();return!1}));return c}a&&a.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(b(this[0]).is("form"))return this.validate().form();
var a=!0,c=b(this[0].form).validate();this.each(function(){a&=c.element(this)});return a},removeAttrs:function(a){var c={},d=this;b.each(a.split(/\s/),function(a,b){c[b]=d.attr(b);d.removeAttr(b)});return c},rules:function(a,c){var d=this[0];if(a){var f=b.data(d.form,"validator").settings,g=f.rules,r=b.validator.staticRules(d);switch(a){case "add":b.extend(r,b.validator.normalizeRule(c));g[d.name]=r;c.messages&&(f.messages[d.name]=b.extend(f.messages[d.name],c.messages));break;case "remove":if(!c)return delete g[d.name],
r;var u={};b.each(c.split(/\s/),function(a,b){u[b]=r[b];delete r[b]});return u}}d=b.validator.normalizeRules(b.extend({},b.validator.metadataRules(d),b.validator.classRules(d),b.validator.attributeRules(d),b.validator.staticRules(d)),d);d.required&&(f=d.required,delete d.required,d=b.extend({required:f},d));return d}});b.extend(b.expr[":"],{blank:function(a){return!b.trim(""+a.value)},filled:function(a){return!!b.trim(""+a.value)},unchecked:function(a){return!a.checked}});b.validator=function(a,c){this.settings=
b.extend(!0,{},b.validator.defaults,a);this.currentForm=c;this.init()};b.validator.format=function(a,c){if(1==arguments.length)return function(){var c=b.makeArray(arguments);c.unshift(a);return b.validator.format.apply(this,c)};2<arguments.length&&c.constructor!=Array&&(c=b.makeArray(arguments).slice(1));c.constructor!=Array&&(c=[c]);b.each(c,function(b,c){a=a.replace(RegExp("\\{"+b+"\\}","g"),c)});return a};b.extend(b.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",
errorElement:"label",focusInvalid:!0,errorContainer:b([]),errorLabelContainer:b([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a;this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a){!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))&&this.element(a)},onkeyup:function(a){(a.name in
this.submitted||a==this.lastElement)&&this.element(a)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(a,c,d){"radio"===a.type?this.findByName(a.name).addClass(c).removeClass(d):b(a).addClass(c).removeClass(d)},unhighlight:function(a,c,d){"radio"===a.type?this.findByName(a.name).removeClass(c).addClass(d):b(a).removeClass(c).addClass(d)}},setDefaults:function(a){b.extend(b.validator.defaults,a)},messages:{required:Localization.Validation.required,
remote:Localization.Validation.remote,email:Localization.Validation.email,url:Localization.Validation.url,date:Localization.Validation.date,dateISO:Localization.Validation.dateISO,number:Localization.Validation.number,digits:Localization.Validation.digits,creditcard:Localization.Validation.creditcard,equalTo:Localization.Validation.equalTo,accept:Localization.Validation.accept,maxlength:b.validator.format(Localization.Validation.maxlength),minlength:b.validator.format(Localization.Validation.minlength),
rangelength:b.validator.format(Localization.Validation.rangelength),range:b.validator.format(Localization.Validation.range),max:b.validator.format(Localization.Validation.max),min:b.validator.format(Localization.Validation.min)},autoCreateRanges:!1,prototype:{init:function(){function a(a){var c=b.data(this[0].form,"validator"),d="on"+a.type.replace(/^validate/,"");c.settings[d]&&c.settings[d].call(c,this[0],a)}this.labelContainer=b(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&
this.labelContainer||b(this.currentForm);this.containers=b(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var c=this.groups={};b.each(this.settings.groups,function(a,d){b.each(d.split(/\s/),function(b,d){c[d]=a})});var d=this.settings.rules;b.each(d,function(a,c){d[a]=b.validator.normalizeRule(c)});b(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ",
"focusin focusout keyup",a).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",a);this.settings.invalidHandler&&b(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){this.checkForm();b.extend(this.submitted,this.errorMap);this.invalid=b.extend({},this.errorMap);this.valid()||b(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=
this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(a){this.lastElement=a=this.validationTargetFor(this.clean(a));this.prepareElement(a);this.currentElements=b(a);var c=this.check(a);c?delete this.invalid[a.name]:this.invalid[a.name]=!0;this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers));this.showErrors();return c},showErrors:function(a){if(a){b.extend(this.errorMap,a);this.errorList=[];for(var c in a)this.errorList.push({message:a[c],element:this.findByName(c)[0]});
this.successList=b.grep(this.successList,function(b){return!(b.name in a)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){b.fn.resetForm&&b(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0,d;for(d in a)b++;
return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0==this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{b(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(a){}},findLastActive:function(){var a=this.lastActive;return a&&1==b.grep(this.errorList,function(b){return b.element.name==a.name}).length&&a},elements:function(){var a=
this,c={};return b(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&a.settings.debug&&window.console&&console.error("%o has no name assigned",this);return this.name in c||!a.objectLength(b(this).rules())?!1:c[this.name]=!0})},clean:function(a){return b(a)[0]},errors:function(){return b(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=
[];this.errorMap={};this.toShow=b([]);this.toHide=b([]);this.currentElements=b([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset();this.toHide=this.errorsFor(a)},check:function(a){a=this.validationTargetFor(this.clean(a));var c=b(a).rules(),d=!1,f;for(f in c){var g={method:f,parameters:c[f]};try{var r=b.validator.methods[f].call(this,a.value.replace(/\r/g,""),a,g.parameters);if("dependency-mismatch"==r)d=!0;else{d=!1;if("pending"==
r){this.toHide=this.toHide.not(this.errorsFor(a));return}if(!r)return this.formatAndAdd(a,g),!1}}catch(u){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+a.id+", check the '"+g.method+"' method",u),u;}}if(!d)return this.objectLength(c)&&this.successList.push(a),!0},customMetaMessage:function(a,c){if(b.metadata){var d=this.settings.meta?b(a).metadata()[this.settings.meta]:b(a).metadata();return d&&d.messages&&d.messages[c]}},customMessage:function(a,
b){var d=this.settings.messages[a];return d&&(d.constructor==String?d:d[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]},defaultMessage:function(a,c){return this.findDefined(this.customMessage(a.name,c),this.customMetaMessage(a,c),!this.settings.ignoreTitle&&a.title||void 0,b.validator.messages[c],"<strong>Warning: No message defined for "+a.name+"</strong>")},formatAndAdd:function(a,b){var d=this.defaultMessage(a,b.method),f=/\$?\{(\d+)\}/g;
"function"==typeof d?d=d.call(this,b.parameters,a):f.test(d)&&(d=jQuery.format(d.replace(f,"{$1}"),b.parameters));this.errorList.push({message:d,element:a});this.errorMap[a.name]=d;this.submitted[a.name]=d},addWrapper:function(a){this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper)));return a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);
this.showLabel(b.element,b.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight){a=0;for(b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass)}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},
invalidElements:function(){return b(this.errorList).map(function(){return this.element})},showLabel:function(a,c){var d=this.errorsFor(a);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),d.attr("generated")&&d.html(c)):(d=b("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(a),generated:!0}).addClass(this.settings.errorClass).html(c||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||
(this.settings.errorPlacement?this.settings.errorPlacement(d,b(a)):d.insertAfter(a)));!c&&this.settings.success&&(d.text(""),"string"==typeof this.settings.success?d.addClass(this.settings.success):this.settings.success(d));this.toShow=this.toShow.add(d)},errorsFor:function(a){var c=this.idOrName(a);return this.errors().filter(function(){return b(this).attr("for")==c})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){this.checkable(a)&&
(a=this.findByName(a.name).not(this.settings.ignore)[0]);return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(a){var c=this.currentForm;return b(document.getElementsByName(a)).map(function(b,f){return f.form==c&&f.name==a&&f||null})},getLength:function(a,c){switch(c.nodeName.toLowerCase()){case "select":return b("option:selected",c).length;case "input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return a.length},depend:function(a,
b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a){return a},string:function(a,c){return!!b(a,c.form).length},"function":function(a,b){return a(b)}},optional:function(a){return!b.validator.methods.required.call(this,b.trim(a.value),a)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(a,c){this.pendingRequest--;0>this.pendingRequest&&(this.pendingRequest=
0);delete this.pending[a.name];c&&0==this.pendingRequest&&this.formSubmitted&&this.form()?(b(this.currentForm).submit(),this.formSubmitted=!1):!c&&(0==this.pendingRequest&&this.formSubmitted)&&(b(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(a){return b.data(a,"previousValue")||b.data(a,"previousValue",{old:null,valid:!0,message:this.defaultMessage(a,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},
dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(a,c){a.constructor==String?this.classRuleSettings[a]=c:b.extend(this.classRuleSettings,a)},classRules:function(a){var c={};(a=b(a).attr("class"))&&b.each(a.split(" "),function(){this in b.validator.classRuleSettings&&b.extend(c,b.validator.classRuleSettings[this])});return c},attributeRules:function(a){var c={};a=b(a);for(var d in b.validator.methods){var f;
(f="required"===d&&"function"===typeof b.fn.prop?a.prop(d):a.attr(d))?c[d]=f:a[0].getAttribute("type")===d&&(c[d]=!0)}c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength;return c},metadataRules:function(a){if(!b.metadata)return{};var c=b.data(a.form,"validator").settings.meta;return c?b(a).metadata()[c]:b(a).metadata()},staticRules:function(a){var c={},d=b.data(a.form,"validator");d.settings.rules&&(c=b.validator.normalizeRule(d.settings.rules[a.name])||{});return c},normalizeRules:function(a,
c){b.each(a,function(d,f){if(!1===f)delete a[d];else if(f.param||f.depends){var g=!0;switch(typeof f.depends){case "string":g=!!b(f.depends,c.form).length;break;case "function":g=f.depends.call(c,c)}g?a[d]=void 0!==f.param?f.param:!0:delete a[d]}});b.each(a,function(d,f){a[d]=b.isFunction(f)?f(c):f});b.each(["minlength","maxlength","min","max"],function(){a[this]&&(a[this]=Number(a[this]))});b.each(["rangelength","range"],function(){a[this]&&(a[this]=[Number(a[this][0]),Number(a[this][1])])});b.validator.autoCreateRanges&&
(a.min&&a.max&&(a.range=[a.min,a.max],delete a.min,delete a.max),a.minlength&&a.maxlength&&(a.rangelength=[a.minlength,a.maxlength],delete a.minlength,delete a.maxlength));a.messages&&delete a.messages;return a},normalizeRule:function(a){if("string"==typeof a){var c={};b.each(a.split(/\s/),function(){c[this]=!0});a=c}return a},addMethod:function(a,c,d){b.validator.methods[a]=c;b.validator.messages[a]=void 0!=d?d:b.validator.messages[a];3>c.length&&b.validator.addClassRules(a,b.validator.normalizeRule(a))},
methods:{required:function(a,c,d){if(!this.depend(d,c))return"dependency-mismatch";switch(c.nodeName.toLowerCase()){case "select":return(a=b(c).val())&&0<a.length;case "input":if(this.checkable(c))return 0<this.getLength(a,c);default:return 0<b.trim(a).length}},remote:function(a,c,d){if(this.optional(c))return"dependency-mismatch";var f=this.previousValue(c);this.settings.messages[c.name]||(this.settings.messages[c.name]={});f.originalMessage=this.settings.messages[c.name].remote;this.settings.messages[c.name].remote=
f.message;d="string"==typeof d&&{url:d}||d;if(this.pending[c.name])return"pending";if(f.old===a)return f.valid;f.old=a;var g=this;this.startRequest(c);var r={};r[c.name]=a;b.ajax(b.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:r,success:function(d){g.settings.messages[c.name].remote=f.originalMessage;var n=!0===d;if(n){var s=g.formSubmitted;g.prepareElement(c);g.formSubmitted=s;g.successList.push(c);g.showErrors()}else s={},d=d||g.defaultMessage(c,"remote"),s[c.name]=f.message=
b.isFunction(d)?d(a):d,g.showErrors(s);f.valid=n;g.stopRequest(c,n)}},d));return"pending"},minlength:function(a,c,d){return this.optional(c)||this.getLength(b.trim(a),c)>=d},maxlength:function(a,c,d){return this.optional(c)||this.getLength(b.trim(a),c)<=d},rangelength:function(a,c,d){a=this.getLength(b.trim(a),c);return this.optional(c)||a>=d[0]&&a<=d[1]},min:function(a,b,d){return this.optional(b)||a>=d},max:function(a,b,d){return this.optional(b)||a<=d},range:function(a,b,d){return this.optional(b)||
a>=d[0]&&a<=d[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},
url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},
date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return!1;var d=0,f=0,g=!1;a=a.replace(/\D/g,"");for(var r=a.length-1;0<=r;r--){f=
a.charAt(r);f=parseInt(f,10);if(g&&9<(f*=2))f-=9;d+=f;g=!g}return 0==d%10},accept:function(a,b,d){d="string"==typeof d?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||a.match(RegExp(".("+d+")$","i"))},equalTo:function(a,c,d){d=b(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){b(c).valid()});return a==d.val()}}});b.format=b.validator.format})(jQuery);
(function(b){var a={};if(b.ajaxPrefilter)b.ajaxPrefilter(function(b,c,g){c=b.port;"abort"==b.mode&&(a[c]&&a[c].abort(),a[c]=g)});else{var c=b.ajax;b.ajax=function(d){var f=("port"in d?d:b.ajaxSettings).port;return"abort"==("mode"in d?d:b.ajaxSettings).mode?(a[f]&&a[f].abort(),a[f]=c.apply(this,arguments)):c.apply(this,arguments)}}})(jQuery);
(function(b){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&b.each({focus:"focusin",blur:"focusout"},function(a,c){function d(a){a=b.event.fix(a);a.type=c;return b.event.handle.call(this,a)}b.event.special[c]={setup:function(){this.addEventListener(a,d,!0)},teardown:function(){this.removeEventListener(a,d,!0)},handler:function(a){arguments[0]=b.event.fix(a);arguments[0].type=c;return b.event.handle.apply(this,arguments)}}});b.extend(b.fn,{validateDelegate:function(a,
c,d){return this.bind(c,function(c){var g=b(c.target);if(g.is(a))return d.apply(g,arguments)})}})})(jQuery);(function(){function b(a){return a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[0-9.(),;:!?%#$'"_+=\/-]*/g,"")}jQuery.validator.addMethod("maxWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length<d},jQuery.validator.format(Localization.Validation.maxWords));jQuery.validator.addMethod("minWords",function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length>=d},jQuery.validator.format(Localization.Validation.minWords));jQuery.validator.addMethod("rangeWords",
function(a,c,d){return this.optional(c)||b(a).match(/\b\w+\b/g).length>=d[0]&&a.match(/bw+b/g).length<d[1]},jQuery.validator.format(Localization.Validation.rangeWords))})();jQuery.validator.addMethod("valueNotEquals",function(b,a,c){return c!=b},Localization.Validation.valueNotEquals);jQuery.validator.addMethod("filesize",function(b,a,c){return this.optional(a)||a.files[0].size<=c});
jQuery.validator.addMethod("urlshort",function(b,a){"http://"!=b.substr(0,7)&&(b="http://"+b);"/"!=b.substr(b.length-1,1)&&(b+="/");return this.optional(a)||/^(http|https|ftp):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i.test(b)},"Not valid url.");jQuery.validator.addMethod("letterswithbasicpunc",function(b,a){return this.optional(a)||/^[a-z-.,?!()'\"\s]+$/i.test(b)},Localization.Validation.letterswithbasicpunc);
jQuery.validator.addMethod("alphanumericnodash",function(b,a){return this.optional(a)||/^[\sa-zA-Z0-9]+$/i.test(b)},Localization.Validation.alphanumericnodash);jQuery.validator.addMethod("alphanumericwhitespace",function(b,a){return this.optional(a)||/^[a-zA-Z0-9-\s]+$/i.test(b)},Localization.Validation.alphanumericwhitespace);jQuery.validator.addMethod("alphanumeric",function(b,a){return this.optional(a)||/^[a-zA-Z0-9-]+$/i.test(b)},Localization.Validation.alphanumeric);
jQuery.validator.addMethod("lettersonly",function(b,a){return this.optional(a)||/^[a-z]+$/i.test(b)},Localization.Validation.lettersonly);jQuery.validator.addMethod("nowhitespace",function(b,a){return this.optional(a)||/^\S+$/i.test(b)},Localization.Validation.nowhitespace);jQuery.validator.addMethod("ziprange",function(b,a){return this.optional(a)||/^90[2-5]\d\{2}-\d{4}$/.test(b)},Localization.Validation.ziprange);
jQuery.validator.addMethod("integer",function(b,a){return this.optional(a)||/^-?\d+$/.test(b)},Localization.Validation.integer);
jQuery.validator.addMethod("vinUS",function(b){if(17!=b.length)return!1;var a,c,d,f,g,r="ABCDEFGHJKLMNPRSTUVWXYZ".split(""),u=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],n=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],s=0;for(a=0;17>a;a++){f=n[a];d=b.slice(a,a+1);8==a&&(g=d);if(isNaN(d))for(c=0;c<r.length;c++){if(d.toUpperCase()===r[c]){d=u[c];d*=f;isNaN(g)&&8==c&&(g=r[c]);break}}else d*=f;s+=d}b=s%11;10==b&&(b="X");return b==g?!0:!1},Localization.Validation.vinUS);
jQuery.validator.addMethod("dateITA",function(b,a){var c=!1;if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(b))var d=b.split("index.html"),c=parseInt(d[0],10),f=parseInt(d[1],10),d=parseInt(d[2],10),g=new Date(d,f-1,c),c=g.getFullYear()==d&&g.getMonth()==f-1&&g.getDate()==c?!0:!1;else c=!1;return this.optional(a)||c},Localization.Validation.dateITA);!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):b("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(b){function a(a){var c=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(a.target).ajaxSubmit(c))}function c(a){var c=a.target,d=b(c);if(!d.is("[type=submit],[type=image]")){c=d.closest("[type=submit]");if(0===c.length)return;c=c[0]}var e=this;if(e.clk=c,"image"==c.type)void 0!==a.offsetX?(e.clk_x=a.offsetX,e.clk_y=a.offsetY):"function"==typeof b.fn.offset?(d=d.offset(),
e.clk_x=a.pageX-d.left,e.clk_y=a.pageY-d.top):(e.clk_x=a.pageX-c.offsetLeft,e.clk_y=a.pageY-c.offsetTop);setTimeout(function(){e.clk=e.clk_x=e.clk_y=null},100)}function d(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var f,g;f=void 0!==b("<input type='file'/>").get(0).files;g=void 0!==window.FormData;var r=!!b.fn.prop;b.fn.attr2=function(){if(!r)return this.attr.apply(this,
arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)};b.fn.ajaxSubmit=function(a){function c(e){function f(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){d("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(e){d("cannot get iframe.contentDocument: "+e),b=a.document}return b}function g(){function a(){try{var b=f(z).readyState;d("state = "+
b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){d("Server abort: ",c," (",c.name,")"),k(C),F&&clearTimeout(F),F=void 0}}var c=p.attr2("target"),e=p.attr2("action"),u=p.attr("enctype")||p.attr("encoding")||"multipart/form-data";w.setAttribute("target",l);(!s||/post/i.test(s))&&w.setAttribute("method","POST");e!=h.url&&w.setAttribute("action",h.url);h.skipEncodingOverride||s&&!/post/i.test(s)||p.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});h.timeout&&(F=setTimeout(function(){y=
!0;k(G)},h.timeout));var j=[];try{if(h.extraData)for(var n in h.extraData)h.extraData.hasOwnProperty(n)&&j.push(b.isPlainObject(h.extraData[n])&&h.extraData[n].hasOwnProperty("name")&&h.extraData[n].hasOwnProperty("value")?b('<input type="hidden" name="'+h.extraData[n].name+'">').val(h.extraData[n].value).appendTo(w)[0]:b('<input type="hidden" name="'+n+'">').val(h.extraData[n]).appendTo(w)[0]);h.iframeTarget||m.appendTo("body");z.attachEvent?z.attachEvent("onload",k):z.addEventListener("load",k,
!1);setTimeout(a,15);try{w.submit()}catch(t){document.createElement("form").submit.apply(w)}}finally{w.setAttribute("action",e),w.setAttribute("enctype",u),c?w.setAttribute("target",c):p.removeAttr("target"),b(j).remove()}}function k(a){if(!j.aborted&&!E){if(v=f(z),v||(d("cannot access response document"),a=C),a===G&&j)return j.abort("timeout"),void A.reject(j,"timeout");if(a==C&&j)return j.abort("server abort"),void A.reject(j,"error","server abort");if(v&&v.location.href!=h.iframeSrc||y){z.detachEvent?
z.detachEvent("onload",k):z.removeEventListener("load",k,!1);var c;a="success";try{if(y)throw"timeout";var e="xml"==h.dataType||v.XMLDocument||b.isXMLDoc(v);if(d("isXml="+e),!e&&window.opera&&(null===v.body||!v.body.innerHTML)&&--H)return d("requeing onLoad callback, DOM not available"),void setTimeout(k,250);var u=v.body?v.body:v.documentElement;j.responseText=u?u.innerHTML:null;j.responseXML=v.XMLDocument?v.XMLDocument:v;e&&(h.dataType="xml");j.getResponseHeader=function(a){return{"content-type":h.dataType}[a.toLowerCase()]};
u&&(j.status=Number(u.getAttribute("status"))||j.status,j.statusText=u.getAttribute("statusText")||j.statusText);var n=(h.dataType||"").toLowerCase(),s=/(json|script|text)/.test(n);if(s||h.textarea){var p=v.getElementsByTagName("textarea")[0];if(p)j.responseText=p.value,j.status=Number(p.getAttribute("status"))||j.status,j.statusText=p.getAttribute("statusText")||j.statusText;else if(s){var g=v.getElementsByTagName("pre")[0],l=v.getElementsByTagName("body")[0];g?j.responseText=g.textContent?g.textContent:
g.innerText:l&&(j.responseText=l.textContent?l.textContent:l.innerText)}}else"xml"==n&&!j.responseXML&&j.responseText&&(j.responseXML=I(j.responseText));try{var e=j,u=h,q=e.getResponseHeader("content-type")||"",r="xml"===n||!n&&0<=q.indexOf("xml"),B=r?e.responseXML:e.responseText;D=(r&&"parsererror"===B.documentElement.nodeName&&b.error&&b.error("parsererror"),u&&u.dataFilter&&(B=u.dataFilter(B,n)),"string"==typeof B&&("json"===n||!n&&0<=q.indexOf("json")?B=J(B):("script"===n||!n&&0<=q.indexOf("javascript"))&&
b.globalEval(B)),B)}catch(w){a="parsererror",j.error=c=w||a}}catch(x){d("error caught: ",x),a="error",j.error=c=x||a}j.aborted&&(d("upload aborted"),a=null);j.status&&(a=200<=j.status&&300>j.status||304===j.status?"success":"error");"success"===a?(h.success&&h.success.call(h.context,D,"success",j),A.resolve(j.responseText,"success",j),t&&b.event.trigger("ajaxSuccess",[j,h])):a&&(void 0===c&&(c=j.statusText),h.error&&h.error.call(h.context,j,a,c),A.reject(j,"error",c),t&&b.event.trigger("ajaxError",
[j,h,c]));t&&b.event.trigger("ajaxComplete",[j,h]);t&&!--b.active&&b.event.trigger("ajaxStop");h.complete&&h.complete.call(h.context,j,a);E=!0;h.timeout&&clearTimeout(F);setTimeout(function(){h.iframeTarget?m.attr("src",h.iframeSrc):m.remove();j.responseXML=null},100)}}}var n,h,t,l,m,z,j,x,y,F,w=p[0],A=b.Deferred();if(A.abort=function(a){j.abort(a)},e)for(n=0;n<q.length;n++)e=b(q[n]),r?e.prop("disabled",!1):e.removeAttr("disabled");if(h=b.extend(!0,{},b.ajaxSettings,a),h.context=h.context||h,l="jqFormIO"+
(new Date).getTime(),h.iframeTarget?(m=b(h.iframeTarget),x=m.attr2("name"),x?l=x:m.attr2("name",l)):(m=b('<iframe name="'+l+'" src="'+h.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),z=m[0],j={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var c="timeout"===a?"timeout":"aborted";d("aborting upload... "+c);this.aborted=1;try{z.contentWindow.document.execCommand&&
z.contentWindow.document.execCommand("Stop")}catch(e){}m.attr("src",h.iframeSrc);j.error=c;h.error&&h.error.call(h.context,j,c,a);t&&b.event.trigger("ajaxError",[j,h,c]);h.complete&&h.complete.call(h.context,j,c)}},t=h.global,t&&0===b.active++&&b.event.trigger("ajaxStart"),t&&b.event.trigger("ajaxSend",[j,h]),h.beforeSend&&!1===h.beforeSend.call(h.context,j,h))return h.global&&b.active--,A.reject(),A;if(j.aborted)return A.reject(),A;(e=w.clk)&&(x=e.name,x&&!e.disabled&&(h.extraData=h.extraData||{},
h.extraData[x]=e.value,"image"==e.type&&(h.extraData[x+".x"]=w.clk_x,h.extraData[x+".y"]=w.clk_y)));var G=1,C=2;x=b("meta[name=csrf-token]").attr("content");(e=b("meta[name=csrf-param]").attr("content"))&&x&&(h.extraData=h.extraData||{},h.extraData[e]=x);h.forceSync?g():setTimeout(g,10);var D,v,E,H=50,I=b.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&"parsererror"!=
b.documentElement.nodeName?b:null},J=b.parseJSON||function(a){return window.eval("("+a+")")};return A}if(!this.length)return d("ajaxSubmit: skipping submit process - no element selected"),this;var s,e,p=this;"function"==typeof a?a={success:a}:void 0===a&&(a={});s=a.type||this.attr2("method");e=a.url||this.attr2("action");(e=(e="string"==typeof e?b.trim(e):"")||window.location.href||"")&&(e=(e.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:e,success:b.ajaxSettings.success,type:s||b.ajaxSettings.type,
iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);e={};if(this.trigger("form-pre-serialize",[this,a,e]),e.veto)return d("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return d("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var t=a.traditional;void 0===t&&(t=b.ajaxSettings.traditional);var k,q=[],l=this.formToArray(a.semantic,q);if(a.data&&(a.extraData=a.data,k=b.param(a.data,
t)),a.beforeSubmit&&!1===a.beforeSubmit(l,this,a))return d("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[l,this,a,e]),e.veto)return d("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;e=b.param(l,t);k&&(e=e?e+"&"+k:k);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+e,a.data=null):a.data=e;var m=[];if(a.resetForm&&m.push(function(){p.resetForm()}),a.clearForm&&m.push(function(){p.clearForm(a.includeHidden)}),
!a.dataType&&a.target){var G=a.success||function(){};m.push(function(c){var d=a.replaceTarget?"replaceWith":"html";b(a.target)[d](c).each(G,arguments)})}else a.success&&m.push(a.success);if(a.success=function(b,c,d){for(var e=a.context||this,f=0,h=m.length;h>f;f++)m[f].apply(e,[b,c,d||p,p])},a.error){var y=a.error;a.error=function(b,c,d){y.apply(a.context||this,[b,c,d,p])}}if(a.complete){var I=a.complete;a.complete=function(b,c){I.apply(a.context||this,[b,c,p])}}k=0<b("input[type=file]:enabled",this).filter(function(){return""!==
b(this).val()}).length;e="multipart/form-data"==p.attr("enctype")||"multipart/form-data"==p.attr("encoding");t=f&&g;d("fileAPI :"+t);var C;if(!1!==a.iframe&&(a.iframe||(k||e)&&!t))a.closeKeepAlive?b.get(a.closeKeepAlive,function(){C=c(l)}):C=c(l);else{if((k||e)&&t){var E=new FormData;for(e=0;e<l.length;e++)E.append(l[e].name,l[e].value);if(a.extraData){var D=b.param(a.extraData,a.traditional).split("&"),J=D.length;k=[];for(e=0;J>e;e++)D[e]=D[e].replace(/\+/g," "),t=D[e].split("="),k.push([decodeURIComponent(t[0]),
decodeURIComponent(t[1])]);for(e=0;e<k.length;e++)k[e]&&E.append(k[e][0],k[e][1])}a.data=null;k=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:s||"POST"});a.uploadProgress&&(k.xhr=function(){var c=b.ajaxSettings.xhr();return c.upload&&c.upload.addEventListener("progress",function(b){var c=0,d=b.loaded||b.position,e=b.total;b.lengthComputable&&(c=Math.ceil(100*(d/e)));a.uploadProgress(b,d,e,c)},!1),c});k.data=null;var H=k.beforeSend;k=(k.beforeSend=function(b,c){c.data=
a.formData?a.formData:E;H&&H.call(this,b,c)},b.ajax(k))}else k=b.ajax(a);C=k}p.removeData("jqxhr").data("jqxhr",C);for(k=0;k<q.length;k++)q[k]=null;return this.trigger("form-submit-notify",[this,a]),this};b.fn.ajaxForm=function(f){if(f=f||{},f.delegation=f.delegation&&b.isFunction(b.fn.on),!f.delegation&&0===this.length){var n=this.selector,s=this.context;return!b.isReady&&n?(d("DOM not ready, queuing ajaxForm"),b(function(){b(n,s).ajaxForm(f)}),this):(d("terminating; zero elements found by selector"+
(b.isReady?"":" (DOM not ready)")),this)}return f.delegation?(b(document).off("submit.form-plugin",this.selector,a).off("click.form-plugin",this.selector,c).on("submit.form-plugin",this.selector,f,a).on("click.form-plugin",this.selector,f,c),this):this.ajaxFormUnbind().bind("submit.form-plugin",f,a).bind("click.form-plugin",f,c)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a,c){var d=[];if(0===this.length)return d;var e,p=this[0],
g=this.attr("id"),k=a?p.getElementsByTagName("*"):p.elements;if(k&&!/MSIE [678]/.test(navigator.userAgent)&&(k=b(k).get()),g&&(e=b(':input[form="'+g+'"]').get(),e.length&&(k=(k||[]).concat(e))),!k||!k.length)return d;var q,l,m,r,y;e=0;for(r=k.length;r>e;e++)if(m=k[e],q=m.name,q&&!m.disabled)if(a&&p.clk&&"image"==m.type)p.clk==m&&(d.push({name:q,value:b(m).val(),type:m.type}),d.push({name:q+".x",value:p.clk_x},{name:q+".y",value:p.clk_y}));else if(l=b.fieldValue(m,!0),l&&l.constructor==Array){c&&c.push(m);
g=0;for(y=l.length;y>g;g++)d.push({name:q,value:l[g]})}else if(f&&"file"==m.type)if(c&&c.push(m),y=m.files,y.length)for(g=0;g<y.length;g++)d.push({name:q,value:y[g],type:m.type});else d.push({name:q,value:"",type:m.type});else null!==l&&"undefined"!=typeof l&&(c&&c.push(m),d.push({name:q,value:l,type:m.type,required:m.required}));!a&&p.clk&&(k=b(p.clk),l=k[0],(q=l.name)&&!l.disabled&&"image"==l.type&&(d.push({name:q,value:k.val()}),d.push({name:q+".x",value:p.clk_x},{name:q+".y",value:p.clk_y})));
return d};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];return this.each(function(){var d=this.name;if(d){var e=b.fieldValue(this,a);if(e&&e.constructor==Array)for(var f=0,g=e.length;g>f;f++)c.push({name:d,value:e[f]});else null!==e&&"undefined"!=typeof e&&c.push({name:this.name,value:e})}}),b.param(c)};b.fn.fieldValue=function(a){for(var c=[],d=0,e=this.length;e>d;d++){var f=b.fieldValue(this[d],a);null===f||"undefined"==typeof f||f.constructor==
Array&&!f.length||(f.constructor==Array?b.merge(c,f):c.push(f))}return c};b.fieldValue=function(a,c){var d=a.name,e=a.type,f=a.tagName.toLowerCase();if(void 0===c&&(c=!0),c&&(!d||a.disabled||"reset"==e||"button"==e||("checkbox"==e||"radio"==e)&&!a.checked||("submit"==e||"image"==e)&&a.form&&a.form.clk!=a||"select"==f&&-1==a.selectedIndex))return null;if("select"==f){var g=a.selectedIndex;if(0>g)return null;for(var d=[],f=a.options,k=(e="select-one"==e)?g+1:f.length,g=e?g:0;k>g;g++){var q=f[g];if(q.selected){var l=
q.value;if(l||(l=q.attributes&&q.attributes.value&&!q.attributes.value.specified?q.text:q.value),e)return l;d.push(l)}}return d}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value=
"":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?b(this).replaceWith(b(this).clone(!0)):b(this).val(""):a&&(!0===a&&/hidden/.test(d)||"string"==typeof a&&b(this).is(a))&&(this.value="")})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=
!a})};b.fn.selected=function(a){return void 0===a&&(a=!0),this.each(function(){var c=this.type;"checkbox"==c||"radio"==c?this.checked=a:"option"==this.tagName.toLowerCase()&&(c=b(this).parent("select"),a&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1});


var InGameMenubarAuth = {
	checkIfLoggedIn:function(token_id){
		$.ajax({
	        type: 'GET',
	        dataType: 'json',
			url: 'http://smartfun.club' + '/api/login/check/' + token_id + '',
            beforeSend:function (){
				console.log('InGameMenubarAuth.checkIfLoggedIn: beforeSend')
			},			
		}).done(function(response){
			console.log(response)								
			$('#in-game-menubar-user-panel').html(response.data.template);	
			
			if(response.status.code==200){				
				if(mjs_user_token_id){
					// Update portal domain
					var old_href = 'index.html';
					console.log('old_href:',old_href);
					
					$('#in-game-menubar-main-portal-url').attr('href',old_href+'?mjs_user_token_id='+mjs_user_token_id.toString());				

					// Update header
					$('#in-game-menubar-header-url').attr('href',old_href+'?mjs_user_token_id='+mjs_user_token_id.toString())					
				}

			}
		});			
	},	
}

// GLOBAL
var mjs_user_token_id;

// getQueryVariable
function getQueryVariable(variable) {
    var query = window.location.search.substring(1); // search in parent
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
        }
    }
}

// In Game Menubar Script Template here
var InGameMenubar = {
	enabled:eval('false'),
	
	activateLeaderboard:function(){
		$('#in-game-menubar-main').hide()
		$('#in-game-menubar-leaderboard').show();		
	},
	
	showActivator:function(){
		$('#in-game-menubar-activator').show();
	},
	activate: function(){
		// Resolve in pixels
		var height = $('#in-game-menubar-main').css('height')
		if(height=='0px'){
			console.log('weird bug with 0px ... forcing something')
			$('#in-game-menubar-main').css('height',window.innerHeight*0.6)
		}
		
		$('#in-game-menubar-activator').hide(200);
		//$('#in-game-menubar-main').css('top',$('#in-game-menubar-activator').css('top'))
		$('#in-game-menubar-main').show(200);
	},		
	deactivate: function(){
		$('#in-game-menubar-activator').show(200);
		$('#in-game-menubar-main').hide(200);
	},
}

var Cookie = {
	IsEnabled: function(){
		return navigator.cookieEnabled ||
	        ('cookie' in document && (document.cookie.length > 0 ||
	        (document.cookie = 'mjstestcookie').indexOf.call(document.cookie, 'mjstestcookie') > -1));	
	},	
	DoesExist: function(cname) {
	    var name = cname + '=';
	    var ca = document.cookie.split(';');
		var value;
	    for(var i=0; i<ca.length; i++) {
	        var c = ca[i];
	        while (c.charAt(0)==' ') c = c.substring(1);
	        if (c.indexOf(name) == 0){
				return true;
			} 
	    }
	    return false;
	},
	// TEST
	SetFiveSecondCookie: function(cname) {
	    var d = new Date();
	    d.setTime(d.getTime() + (5*1000));
	    var expires = 'expires='+d.toUTCString();
	    document.cookie = cname + '=' + 'yes' + '; ' + expires;
	},
	SetHourlyCookie: function(cname) {
	    var d = new Date();
	    d.setTime(d.getTime() + (1*60*60*1000));
	    var expires = 'expires='+d.toUTCString();
	    document.cookie = cname + '=' + 'yes' + '; ' + expires;
	},
	SetDailyCookie: function(cname) {
	    var d = new Date();
	    d.setTime(d.getTime() + (1*24*60*60*1000));
	    var expires = 'expires='+d.toUTCString();
	    document.cookie = cname + '=' + 'yes' + '; ' + expires;
	},
 	SetMonthlyCookie: function(cname) { // averages to 30 days
	    var d = new Date();
	    d.setTime(d.getTime() + (1*30*24*60*60*1000));
	    var expires = 'expires='+d.toUTCString();
	    document.cookie = cname + '=' + 'yes' + '; ' + expires;
	},		
	SetYearlyCookie: function(cname) {
	    var d = new Date();
	    d.setTime(d.getTime() + (1*365*24*60*60*1000)); // averages to 365 days
	    var expires = 'expires='+d.toUTCString();
	    document.cookie = cname + '=' + 'yes' + '; ' + expires;
	},			
}

var MarketJS = {
	Log:{
		Game:function(metric_name){ // Eg: MarketJS.Log.Game('Initialize'), MarketJS.Log.Game('EndGame'), MarketJS.Log.Game('LaunchGame)
			console.log('MarketJS API Log Game Event: ',metric_name)
			$.ajax({
		        type: 'GET',
				dataType:'json',
				url: 'http://smartfun.club/api/log/game/' + metric_name + '/' + mjs_game_id + '?mjs_user_token_id=' + mjs_user_token_id,		
			}).done(function(response){
				console.log(response.status.code);							
			});				
		},
		Portal:function(metric_name){ // Eg: MarketJS.Log.Portal('UserLogin'), MarketJS.Log.Portal('UserRegister')
			console.log('MarketJS API Log Portal Event: ',metric_name)
			$.ajax({
		        type: 'POST',
				dataType:'json',
				url: 'http://smartfun.club/api/log/portal/' + metric_name + '/' + mjs_portal_id,		
			}).done(function(response){
				console.log(response.status.code);							
			});				
		},
		TimeSpent:function(metric_value){
			console.log('MarketJS API Log Time Spent: ',metric_value)
			var metric_name = 'TimeSpent';
			$.ajax({
		        type: 'POST',
				data:{'metric_value':metric_value},
				dataType:'json',
				url: 'http://smartfun.club/api/log/portal/' + metric_name + '/' + mjs_portal_id,		
			}).done(function(response){
				console.log(response.status.code);							
			});				
		},	
		// Specially developed
		UniqueVisitor:function(){
			console.log('MarketJS API Log Unique Visitor Event')

			// if unique_visitor_params[xxxx] = 'True', means it will be logged in the server			
			var unique_visitor_params = {
				'singular':'True', // to invoke singular counter increments. Special case
				'hourly':'False',
				'daily':'False',
				'monthly':'False',
				'yearly':'False',
			}
			
			var submit_hourly_cookie = false;
			var submit_daily_cookie = false;
			var submit_monthly_cookie = false;
			var submit_yearly_cookie = false;
			
			if(Cookie.IsEnabled()){
				/*
				if(!Cookie.DoesExist('mjstest')){ // If cookie does not exist
					unique_visitor_params['hourly'] = 'True';
					Cookie.SetFiveSecondCookie('mjstest');
					submit_hourly_cookie = true;
				}*/
				
				if(!Cookie.DoesExist('mjshourly')){ // If cookie does not exist
					unique_visitor_params['hourly'] = 'True';
					Cookie.SetHourlyCookie('mjshourly');
					submit_hourly_cookie = true;
				}

				if(!Cookie.DoesExist('mjsdaily')){
					unique_visitor_params['daily'] = 'True';
					Cookie.SetDailyCookie('mjsdaily');
					submit_daily_cookie = true;
				}

				if(!Cookie.DoesExist('mjsmonthly')){
					unique_visitor_params['monthly'] = 'True';
					Cookie.SetMonthlyCookie('mjsmonthly');					
					submit_monthly_cookie = true;
				}

				if(!Cookie.DoesExist('mjsyearly')){
					unique_visitor_params['yearly'] = 'True';
					Cookie.SetYearlyCookie('mjsyearly');
					submit_yearly_cookie = true;
				}																
			}	

			/* SAMPLE:
			unique_visitor_params:{
				hourly:hourly, // 'True'
				daily:daily,	// 'False'
				monthly:monthly, // 'False'
				yearly:yearly, // 'False'
			},
			*/						
			if(submit_hourly_cookie || submit_daily_cookie || submit_monthly_cookie || submit_yearly_cookie){
				console.log('Submitting ...')
				$.ajax({
			        type: 'POST',
					dataType:'json',
					data:unique_visitor_params,
					url: 'http://smartfun.club/api/log/portal/' + 'UniqueVisitor' + '/' + mjs_portal_id,
				}).done(function(response){
					console.log(response.status.code);							
				});					
			}else{
				console.log('Not submitting ... all data is current')
			}					
		},
	},
	
	Leaderboard:{
		SubmitScore:function(points){ // (token_id,game_id,points)
			// what's the drawback? users can post as often as they want, but we have a filter for frequency and value
			if(!mjs_user_token_id){
				console.log('No user session detected. No score submitted')
				return
			}
			$.ajax({
		        type: 'POST',
				data:{
					'token_id':mjs_user_token_id,//token_id,
					'game_id':mjs_game_id,//game_id,
					'points':points,
				},
		        dataType: 'json',
				url: 'http://smartfun.club/leaderboard/write',		
			}).done(function(response){
				console.log(response);
				if(response.status.code==200){
					console.log('SUCCESSFUL')
				}else{
					console.log('FAILED')
				}							
			});			
		},			
	}
}

// Steps

// Good thing we only have mobile and non-mobile
function isMobile(){
	var userAgent = navigator.userAgent;
	var list = ['iPhone','iPad','android','Android','Windows Phone','Silk','BB10','PlayBook'];
	for(i=0;i<list.length;i++){
		if(userAgent.indexOf(list[i])!=-1){
			return true
		}
	}
	return false;
}

// ENABLER
// temporaryly use localStorage, instead of jStorage
$(document).ready(function(){
	if(isMobile() && InGameMenubar.enabled){
		InGameMenubar.showActivator();
	}
	
	mjs_user_token_id = getQueryVariable('mjs_user_token_id');
	if(mjs_user_token_id){
		console.log('mjs_user_token_id found in url param')

		if(isMobile() && InGameMenubar.enabled){
			InGameMenubarAuth.checkIfLoggedIn(mjs_user_token_id);
		}		
	}else{
		if(localStorage){
			mjs_user_token_id = localStorage.getItem('mjs_user_token_id')
			
			if(isMobile() && InGameMenubar.enabled){
				if(mjs_user_token_id){
					console.log('mjs_user_token_id found in localStorage');
					InGameMenubarAuth.checkIfLoggedIn(mjs_user_token_id)
				}else{
					console.log('No user token id found in localStorage ... perform a dummy check')
					InGameMenubarAuth.checkIfLoggedIn('12345678') // SOMEHOW THIS NEEDS TO BE HERE
				}				
			}			
			
		}else{
			console.log('no localstorage found')
		}
	}	
});

/* OBSOLETE
// Record TimeSpent
var TimeSpent = 0;
window.setInterval(function () {TimeSpent+=1}, 1000);
var isSmartphone = eval('false');
var isTablet = eval('false');
var isDesktop;
if(isSmartphone || isTablet){
	isDesktop = false;
}else{
	isDesktop = true;
}
if(!isDesktop){
	window.setInterval(function () {
		MarketJS.Log.TimeSpent(TimeSpent); // NEEDS TO BE OPTIMIZED, TO REDUCE LOAD
		TimeSpent = 0;					
	}, 31000);	
}
*/


var BrandingSplashScreen={enabled:eval('true'),}
function InitializeSplashScreen(){if(BrandingSplashScreen.enabled){this.START_BRANDING_SPLASH;ig.module('plugins.branding.splash').requires('impact.impact','impact.entity').defines(function(){ig.BrandingSplash=ig.Class.extend({init:function(){ig.game.spawnEntity(EntityBranding,0,0);}});EntityBranding=ig.Entity.extend({gravityFactor:0,size:{x:32,y:32},splash:new ig.Image('http://lh3.googleusercontent.com/YADmEGMQG8Rabw_t5RDwpddpX7r0VqS8lIQj6R65PozZt1KyTX_NvlOK5UBYqZOE6pwsXlxdOI7UWcHy6sz51525x82aH1fXLq_1Og=s480'),init:function(x,y,settings){this.parent(x,y,settings); if(ig.system.width<=320){this.size.x=320;this.size.y=200;}else{this.size.x=480;this.size.y=240;} 
this.pos.x=(ig.system.width-this.size.x)/2;this.pos.y=-this.size.y-200; this.endPosY=(ig.system.height-this.size.y)/2;var tween1=this.tween({pos:{y:this.endPosY}},0.5,{easing:ig.Tween.Easing.Bounce.EaseIn});var tween2=this.tween({},eval('3')-0.5,{onComplete:function(){ ig.game.director.loadLevel(ig.game.director.currentLevel);}});tween1.chain(tween2);tween1.start();this.currentAnim=this.anims.idle;},createClickableLayer:function(){ console.log('Build clickable layer')
this.checkClickableLayer('branding-splash','SPLASH_SCREEN_CLICKABLE_LOGO_URL',true);},doesClickableLayerExist:function(id){for(k in dynamicClickableEntityDivs){if(k==id)return true;}
return false;},checkClickableLayer:function(divID,outboundLink,open_new_window){if(typeof(wm)=='undefined'){ if(this.doesClickableLayerExist(divID)){ ig.game.showOverlay([divID]); $('#'+divID).find('[href]').attr('href',outboundLink);}else{this.createClickableOutboundLayer(divID,outboundLink,'static/test/images/branding/splash_screen/invisible.png',open_new_window);}}}, createClickableOutboundLayer:function(id,outbound_link,image_path,open_new_window){ var div=ig.$new('div');div.id=id;document.body.appendChild(div); $('#'+div.id).css('float','left');$('#'+div.id).css('position','absolute');if(ig.ua.mobile){var heightRatio=window.innerHeight/mobileHeight;var widthRatio=window.innerWidth/mobileWidth;$('#'+div.id).css('left',this.pos.x*widthRatio);$('#'+div.id).css('top',this.pos.y*heightRatio);$('#'+div.id).css('width',this.size.x*widthRatio);$('#'+div.id).css('height',this.size.y*heightRatio);}else{ var reference={x:(w/2)-(destW/2),y:(h/2)-(destH/2),}
console.log(reference.x,reference.y);$('#'+div.id).css('left',reference.x+this.pos.x*multiplier);$('#'+div.id).css('top',reference.y+this.pos.y*multiplier);$('#'+div.id).css('width',this.size.x*multiplier);$('#'+div.id).css('height',this.size.y*multiplier);} 
if(open_new_window){$('#'+div.id).html('<a target=\'_blank\' href=\''+outbound_link+'\'><img style=\'width:100%;height:100%\' src=\''+image_path+'\'></a>');}else{$('#'+div.id).html('<a href=\''+outbound_link+'\'><img style=\'width:100%;height:100%\' src=\''+image_path+'\'></a>');} 
dynamicClickableEntityDivs[id]={};dynamicClickableEntityDivs[id]['width']=this.size.x*multiplier;dynamicClickableEntityDivs[id]['height']=this.size.y*multiplier;dynamicClickableEntityDivs[id]['entity_pos_x']=this.pos.x;dynamicClickableEntityDivs[id]['entity_pos_y']=this.pos.y;},draw:function(){ig.system.context.fillStyle='#ffffff';ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);this.parent();if(this.splash)
{ig.system.context.drawImage(this.splash.data,0,0,this.splash.data.width,this.splash.data.height,this.pos.x,this.pos.y,this.size.x,this.size.y);}}});});this.END_BRANDING_SPLASH;}}

//BRANDING_IN_GAME_MENUBAR_LOGIN_SCRIPT

//BRANDING_IN_GAME_MENUBAR_REGISTER_SCRIPT

//BRANDING_IN_GAME_MENUBAR_LOGOUT_SCRIPT

//BRANDING_IN_GAME_MENUBAR_LEADERBOARD_SCRIPT

//BRANDING_CHANGE_USERNAME_SCRIPT


var AdInGamePreroll={enabled:eval('false'),ad_duration:eval('5'),ad_width:eval('300'),ad_height:eval('250'),ready_in:'Ready in',loading:'Loading ...',close:'Close'+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;',Initialize:function(){if(!this.enabled){console.log('AdInGamePreroll disabled in CMS ...')
return;} 
if(advancedDivsToResize){advancedDivsToResize['AdInGamePreroll']={'box-width':AdInGamePreroll.ad_width+2,'box-height':AdInGamePreroll.ad_height+20,}}
this.selectedOverlayName='AdInGamePreroll'
console.log('selected:',this.selectedOverlayName); this.overlay=$('#'+this.selectedOverlayName);this.box=$('#'+this.selectedOverlayName+'-Box');this.game=$('#game');this.boxContents={footer:$('#'+this.selectedOverlayName+'-Box-Footer'),header:$('#'+this.selectedOverlayName+'-Box-Header'),close:$('#'+this.selectedOverlayName+'-Box-Close'),body:$('#'+this.selectedOverlayName+'-Box-Body'),}; this.box.width(this.ad_width);this.box.height(this.ad_height);this.box.css('left',(this.overlay.width()-this.box.width())/2);this.box.css('top',(this.overlay.height()-this.box.height()-this.boxContents.header.height()-this.boxContents.footer.height())/2); this.overlay.show(this.Timer(this.ad_duration)); sizeHandler();},Timer:function(duration){var i=duration;var inter=setInterval(function(){AdInGamePreroll.boxContents.header.text(AdInGamePreroll.ready_in+' '+i+'...');AdInGamePreroll.boxContents.footer.text(AdInGamePreroll.loading);i--;if(i<0){clearInterval(inter);AdInGamePreroll.boxContents.close.css('left',AdInGamePreroll.boxContents.body.width()-23);AdInGamePreroll.boxContents.close.show();AdInGamePreroll.boxContents.header.html(AdInGamePreroll.close);AdInGamePreroll.boxContents.footer.text('');}},1000);},Close:function(){this.boxContents.close.hide();this.overlay.hide();}};



var AdInGameEndgame={enabled:eval('false'),ad_duration:eval('5'),ad_width:eval('300'),ad_height:eval('250'),ready_in:'Ready in',loading:'Loading ...',close:'Close'+'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;',Initialize:function(){if(!this.enabled){console.log('AdInGameEndgame disabled in CMS ...')
return;} 
if(advancedDivsToResize){advancedDivsToResize['AdInGameEndgame']={'box-width':AdInGameEndgame.ad_width+2,'box-height':AdInGameEndgame.ad_height+20,}}
this.selectedOverlayName='AdInGameEndgame'
console.log('selected:',this.selectedOverlayName); this.overlay=$('#'+this.selectedOverlayName);this.box=$('#'+this.selectedOverlayName+'-Box');this.game=$('#game');this.boxContents={footer:$('#'+this.selectedOverlayName+'-Box-Footer'),header:$('#'+this.selectedOverlayName+'-Box-Header'),close:$('#'+this.selectedOverlayName+'-Box-Close'),body:$('#'+this.selectedOverlayName+'-Box-Body'),}; this.box.width(this.ad_width);this.box.height(this.ad_height);this.box.css('left',(this.overlay.width()-this.box.width())/2);this.box.css('top',(this.overlay.height()-this.box.height()-this.boxContents.header.height()-this.boxContents.footer.height())/2); this.overlay.show(this.Timer(this.ad_duration)); sizeHandler();},Timer:function(duration){var i=duration;var inter=setInterval(function(){AdInGameEndgame.boxContents.header.text(AdInGameEndgame.ready_in+' '+i+'...');AdInGameEndgame.boxContents.footer.text(AdInGameEndgame.loading);i--;if(i<0){clearInterval(inter);AdInGameEndgame.boxContents.close.css('left',AdInGameEndgame.boxContents.body.width()-23);AdInGameEndgame.boxContents.close.show();AdInGameEndgame.boxContents.header.html(AdInGameEndgame.close);AdInGameEndgame.boxContents.footer.text('');}},1000);},Close:function(){this.boxContents.close.hide();this.overlay.hide();}};

//BRANDING_FACEBOOK_SCRIPT


var BrandingInGameMoreGames={enabled:eval('true'),url:'http://smartfun.club',}

//PORTAL_ANALYTICS_CODE</script>
<script type='text/javascript'>var _STRINGS={"Ad":{"Mobile":{"Preroll":{"ReadyIn":"The game is ready in ","Loading":"Your game is loading...","Close":"Close",},"Header":{"ReadyIn":"The game is ready in ","Loading":"Your game is loading...","Close":"Close",},"End":{"ReadyIn":"Advertisement ends in ","Loading":"Please wait ...","Close":"Close",},},},"Splash":{"Loading":"Loading ...","LogoLine1":"Some text here","LogoLine2":"powered by MarketJS","LogoLine3":"none",},"Loading":{"Loading":"Loading...",},"UI":{"MULTIPLAYER TIC TAC TOE":"TIC TAC TOE WITH FRIENDS","Casual Play":"Casual Play","Options":"Options","Rules":"Rules","Sound":"Sound","Music":"Music","Main Menu":"Main Menu","On":"On","Off":"Off","Back":"Back","Connecting...":"Connecting...","Disconnected":"Disconnected","Attempting to reconnect...":"Attempting to reconnect...","Player Online":"Player Online","Players Online":"Players Online","Enter Your Name":"Enter Your Name","Game Request Rejected":"Game Request Rejected","Please Refresh the Client and Try Again":"Please Refresh the Client and Try Again","Connecting to the Server":"Connecting to the Server","Please Wait":"Please Wait","Waiting for Other Players":"Waiting for Other Players"," Player Found":" Player Found"," Players Found":" Players Found","No Players Found":"No Players Found","You May Continue to Wait":"You May Continue to Wait","or Try Casual Play":"or Try Casual Play","Confirm":"Confirm","Cancel":"Cancel","Leave Game":"Leave Game","Total":"Total","Name":"Name","Send":"Send","< Enter Your Message Here >":"< Enter Your Message Here >","Rules":"Rules","Options":"Options","WAITING FOR ANOTHER PLAYER...":"Waiting for Another Player...","PLAYER JOINED!":"Here Comes a New Challenger!","PLAYER LEFT!":"Player Left!","STARTING MATCH...":"Starting Match...","WAITING FOR PLAYER DECISION...":"Waiting for Player Decision...","SHOWING PLAYER DECISION...":"Showing Player Decision...","MATCH ENDED":"Match Ended"," WON!":" Won!","IT'S A TIE!":"It's a Tie!","WINNER!":"Winner!","'S TURN":"'s Turn","YOUR TURN":"Your Turn","NEW MATCH BEGINS IN ":"New Match Begins in "," SECONDS...":" Seconds...",},"Rules":["The goal is to get 3 in a row.","","The player who succeeds in ","placing three of their marks in a ","horizontal, vertical, or diagonal ","row wins the game.",],};
var _SETTINGS={DeveloperBranding:{Splash:{Enabled:!1},Logo:{Enabled:!0,Link:"http://google.com",LinkEnabled:!0,Width:166,Height:61}},Branding:{Splash:{Enabled:BrandingSplashScreen.enabled},Logo:{Enabled:!1,Link:"http://google.com",LinkEnabled:!1,Width:166,Height:61}},MoreGames:{Enabled:BrandingInGameMoreGames.enabled,Link:BrandingInGameMoreGames.url,NewWindow:!0}};(function(b,c){function d(b,d,e){if(e===c&&1===b.nodeType)if(e="data-"+d.replace(uc,"-$1").toLowerCase(),e=b.getAttribute(e),"string"==typeof e){try{e="true"===e?!0:"false"===e?!1:"null"===e?null:+e+""===e?+e:vc.test(e)?p.parseJSON(e):e}catch(f){}p.data(b,d,e)}else e=c;return e}function e(b){for(var c in b)if(!("data"===c&&p.isEmptyObject(b[c]))&&"toJSON"!==c)return!1;return!0}function f(){return!1}function g(){return!0}function n(b){return!b||!b.parentNode||11===b.parentNode.nodeType}function l(b,
c){do b=b[c];while(b&&1!==b.nodeType);return b}function m(b,c,d){c=c||0;if(p.isFunction(c))return p.grep(b,function(b,G){return!!c.call(b,G,b)===d});if(c.nodeType)return p.grep(b,function(b){return b===c===d});if("string"==typeof c){var e=p.grep(b,function(b){return 1===b.nodeType});if(xc.test(c))return p.filter(c,e,!d);c=p.filter(c,e)}return p.grep(b,function(b){return 0<=p.inArray(b,c)===d})}function r(b){var c=Fb.split("|");b=b.createDocumentFragment();if(b.createElement)for(;c.length;)b.createElement(c.pop());
return b}function q(b,c){if(1===c.nodeType&&p.hasData(b)){var d,e,f;e=p._data(b);var g=p._data(c,e),m=e.events;if(m)for(d in delete g.handle,g.events={},m){e=0;for(f=m[d].length;e<f;e++)p.event.add(c,d,m[d][e])}g.data&&(g.data=p.extend({},g.data))}}function s(b,c){var d;1===c.nodeType&&(c.clearAttributes&&c.clearAttributes(),c.mergeAttributes&&c.mergeAttributes(b),d=c.nodeName.toLowerCase(),"object"===d?(c.parentNode&&(c.outerHTML=b.outerHTML),p.support.html5Clone&&b.innerHTML&&!p.trim(c.innerHTML)&&
(c.innerHTML=b.innerHTML)):"input"===d&&Gb.test(b.type)?(c.defaultChecked=c.checked=b.checked,c.value!==b.value&&(c.value=b.value)):"option"===d?c.selected=b.defaultSelected:"input"===d||"textarea"===d?c.defaultValue=b.defaultValue:"script"===d&&c.text!==b.text&&(c.text=b.text),c.removeAttribute(p.expando))}function u(b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName("*"):"undefined"!=typeof b.querySelectorAll?b.querySelectorAll("*"):[]}function t(b){Gb.test(b.type)&&(b.defaultChecked=
b.checked)}function v(b,c){if(c in b)return c;for(var d=c.charAt(0).toUpperCase()+c.slice(1),e=c,f=Hb.length;f--;)if(c=Hb[f]+d,c in b)return c;return e}function x(b,c){return b=c||b,"none"===p.css(b,"display")||!p.contains(b.ownerDocument,b)}function E(b,c){for(var d,e,f=[],g=0,m=b.length;g<m;g++)d=b[g],d.style&&(f[g]=p._data(d,"olddisplay"),c?(!f[g]&&"none"===d.style.display&&(d.style.display=""),""===d.style.display&&x(d)&&(f[g]=p._data(d,"olddisplay",J(d.nodeName)))):(e=W(d,"display"),!f[g]&&"none"!==
e&&p._data(d,"olddisplay",e)));for(g=0;g<m;g++)if(d=b[g],d.style&&(!c||"none"===d.style.display||""===d.style.display))d.style.display=c?f[g]||"":"none";return b}function B(b,c,d){return(b=yc.exec(c))?Math.max(0,b[1]-(d||0))+(b[2]||"px"):c}function F(b,c,d,e){c=d===(e?"border":"content")?4:"width"===c?1:0;for(var f=0;4>c;c+=2)"margin"===d&&(f+=p.css(b,d+na[c],!0)),e?("content"===d&&(f-=parseFloat(W(b,"padding"+na[c]))||0),"margin"!==d&&(f-=parseFloat(W(b,"border"+na[c]+"Width"))||0)):(f+=parseFloat(W(b,
"padding"+na[c]))||0,"padding"!==d&&(f+=parseFloat(W(b,"border"+na[c]+"Width"))||0));return f}function A(b,c,d){var e="width"===c?b.offsetWidth:b.offsetHeight,f=!0,g=p.support.boxSizing&&"border-box"===p.css(b,"boxSizing");if(0>=e||null==e){e=W(b,c);if(0>e||null==e)e=b.style[c];if(Ja.test(e))return e;f=g&&(p.support.boxSizingReliable||e===b.style[c]);e=parseFloat(e)||0}return e+F(b,c,d||(g?"border":"content"),f)+"px"}function J(b){if(fb[b])return fb[b];var c=p("<"+b+">").appendTo(y.body),d=c.css("display");
c.remove();if("none"===d||""===d){ua=y.body.appendChild(ua||p.extend(y.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!va||!ua.createElement)va=(ua.contentWindow||ua.contentDocument).document,va.write("<!doctype html><html><body>"),va.close();c=va.body.appendChild(va.createElement(b));d=W(c,"display");y.body.removeChild(ua)}return fb[b]=d,d}function D(b,c,d,e){var f;if(p.isArray(c))p.each(c,function(c,f){d||zc.test(b)?e(b,f):D(b+"["+("object"==typeof f?c:"")+"]",f,d,e)});else if(!d&&
"object"===p.type(c))for(f in c)D(b+"["+f+"]",c[f],d,e);else e(b,c)}function N(b){return function(c,d){"string"!=typeof c&&(d=c,c="*");var e,f,g=c.toLowerCase().split(U),m=0,n=g.length;if(p.isFunction(d))for(;m<n;m++)e=g[m],(f=/^\+/.test(e))&&(e=e.substr(1)||"*"),e=b[e]=b[e]||[],e[f?"unshift":"push"](d)}}function C(b,d,e,f,g,m){g=g||d.dataTypes[0];m=m||{};m[g]=!0;var p;g=b[g];for(var n=0,l=g?g.length:0,q=b===gb;n<l&&(q||!p);n++)p=g[n](d,e,f),"string"==typeof p&&(!q||m[p]?p=c:(d.dataTypes.unshift(p),
p=C(b,d,e,f,p,m)));return(q||!p)&&!m["*"]&&(p=C(b,d,e,f,"*",m)),p}function ia(b,d){var e,f,g=p.ajaxSettings.flatOptions||{};for(e in d)d[e]!==c&&((g[e]?b:f||(f={}))[e]=d[e]);f&&p.extend(!0,b,f)}function H(){try{return new b.XMLHttpRequest}catch(c){}}function aa(){return setTimeout(function(){Ka=c},0),Ka=p.now()}function hb(b,c,d){var e,f=0,g=La.length,m=p.Deferred().always(function(){delete n.elem}),n=function(){for(var c=Ka||aa(),c=Math.max(0,l.startTime+l.duration-c),d=1-(c/l.duration||0),e=0,f=
l.tweens.length;e<f;e++)l.tweens[e].run(d);return m.notifyWith(b,[l,d,c]),1>d&&f?c:(m.resolveWith(b,[l]),!1)},l=m.promise({elem:b,props:p.extend({},c),opts:p.extend(!0,{specialEasing:{}},d),originalProperties:c,originalOptions:d,startTime:Ka||aa(),duration:d.duration,tweens:[],createTween:function(c,d){var e=p.Tween(b,l.opts,c,d,l.opts.specialEasing[c]||l.opts.easing);return l.tweens.push(e),e},stop:function(c){for(var d=0,e=c?l.tweens.length:0;d<e;d++)l.tweens[d].run(1);return c?m.resolveWith(b,
[l,c]):m.rejectWith(b,[l,c]),this}});c=l.props;d=l.opts.specialEasing;var q,r,t,s;for(e in c)if(q=p.camelCase(e),r=d[q],t=c[e],p.isArray(t)&&(r=t[1],t=c[e]=t[0]),e!==q&&(c[q]=t,delete c[e]),(s=p.cssHooks[q])&&"expand"in s)for(e in t=s.expand(t),delete c[q],t)e in c||(c[e]=t[e],d[e]=r);else d[q]=r;for(;f<g;f++)if(e=La[f].call(l,b,c,l.opts))return e;var v=l;p.each(c,function(b,c){for(var d=(Ca[b]||[]).concat(Ca["*"]),e=0,G=d.length;e<G&&!d[e].call(v,b,c);e++);});return p.isFunction(l.opts.start)&&l.opts.start.call(b,
l),p.fx.timer(p.extend(n,{anim:l,queue:l.opts.queue,elem:b})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function O(b,c,d,e,f){return new O.prototype.init(b,c,d,e,f)}function X(b,c){var d,e={height:b},f=0;for(c=c?1:0;4>f;f+=2-c)d=na[f],e["margin"+d]=e["padding"+d]=b;return c&&(e.opacity=e.width=b),e}function Ma(b){return p.isWindow(b)?b:9===b.nodeType?b.defaultView||b.parentWindow:!1}var ja,wa,y=b.document,Na=b.location,Da=b.navigator,ib=
b.jQuery,jb=b.$,z=Array.prototype.push,Y=Array.prototype.slice,M=Array.prototype.indexOf,ga=Object.prototype.toString,oa=Object.prototype.hasOwnProperty,xa=String.prototype.trim,p=function(b,c){return new p.fn.init(b,c,ja)},V=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,Q=/\S/,U=/\s+/,Bc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Cc=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ib=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,P=/^[\],:{}\s]*$/,Dc=/(?:^|:|,)(?:\s*\[)+/g,Ec=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Fc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,
Gc=/^-ms-/,Hc=/-([\da-z])/gi,Ic=function(b,c){return(c+"").toUpperCase()},Oa=function(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",Oa,!1),p.ready()):"complete"===y.readyState&&(y.detachEvent("onreadystatechange",Oa),p.ready())},Jb={};p.fn=p.prototype={constructor:p,init:function(b,d,e){var f,g;if(!b)return this;if(b.nodeType)return this.context=this[0]=b,this.length=1,this;if("string"==typeof b){"<"===b.charAt(0)&&">"===b.charAt(b.length-1)&&3<=b.length?f=[null,b,null]:f=Cc.exec(b);
if(f&&(f[1]||!d)){if(f[1])return d=d instanceof p?d[0]:d,g=d&&d.nodeType?d.ownerDocument||d:y,b=p.parseHTML(f[1],g,!0),Ib.test(f[1])&&p.isPlainObject(d)&&this.attr.call(b,d,!0),p.merge(this,b);if((d=y.getElementById(f[2]))&&d.parentNode){if(d.id!==f[2])return e.find(b);this.length=1;this[0]=d}return this.context=y,this.selector=b,this}return!d||d.jquery?(d||e).find(b):this.constructor(d).find(b)}return p.isFunction(b)?e.ready(b):(b.selector!==c&&(this.selector=b.selector,this.context=b.context),p.makeArray(b,
this))},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return Y.call(this)},get:function(b){return null==b?this.toArray():0>b?this[this.length+b]:this[b]},pushStack:function(b,c,d){b=p.merge(this.constructor(),b);return b.prevObject=this,b.context=this.context,"find"===c?b.selector=this.selector+(this.selector?" ":"")+d:c&&(b.selector=this.selector+"."+c+"("+d+")"),b},each:function(b,c){return p.each(this,b,c)},ready:function(b){return p.ready.promise().done(b),
this},eq:function(b){return b=+b,-1===b?this.slice(b):this.slice(b,b+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Y.apply(this,arguments),"slice",Y.call(arguments).join(","))},map:function(b){return this.pushStack(p.map(this,function(c,d){return b.call(c,d,c)}))},end:function(){return this.prevObject||this.constructor(null)},push:z,sort:[].sort,splice:[].splice};p.fn.init.prototype=p.fn;p.extend=p.fn.extend=function(){var b,d,e,
f,g,m,l=arguments[0]||{},n=1,q=arguments.length,r=!1;"boolean"==typeof l&&(r=l,l=arguments[1]||{},n=2);"object"!=typeof l&&!p.isFunction(l)&&(l={});for(q===n&&(l=this,--n);n<q;n++)if(null!=(b=arguments[n]))for(d in b)e=l[d],f=b[d],l!==f&&(r&&f&&(p.isPlainObject(f)||(g=p.isArray(f)))?(g?(g=!1,m=e&&p.isArray(e)?e:[]):m=e&&p.isPlainObject(e)?e:{},l[d]=p.extend(r,m,f)):f!==c&&(l[d]=f));return l};p.extend({noConflict:function(c){return b.$===p&&(b.$=jb),c&&b.jQuery===p&&(b.jQuery=ib),p},isReady:!1,readyWait:1,
holdReady:function(b){b?p.readyWait++:p.ready(!0)},ready:function(b){if(!(!0===b?--p.readyWait:p.isReady)){if(!y.body)return setTimeout(p.ready,1);p.isReady=!0;!0!==b&&0<--p.readyWait||(wa.resolveWith(y,[p]),p.fn.trigger&&p(y).trigger("ready").off("ready"))}},isFunction:function(b){return"function"===p.type(b)},isArray:Array.isArray||function(b){return"array"===p.type(b)},isWindow:function(b){return null!=b&&b==b.window},isNumeric:function(b){return!isNaN(parseFloat(b))&&isFinite(b)},type:function(b){return null==
b?String(b):Jb[ga.call(b)]||"object"},isPlainObject:function(b){if(!b||"object"!==p.type(b)||b.nodeType||p.isWindow(b))return!1;try{if(b.constructor&&!oa.call(b,"constructor")&&!oa.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(d){return!1}for(var e in b);return e===c||oa.call(b,e)},isEmptyObject:function(b){for(var c in b)return!1;return!0},error:function(b){throw Error(b);},parseHTML:function(b,c,d){var e;return!b||"string"!=typeof b?null:("boolean"==typeof c&&(d=c,c=0),c=c||y,(e=
Ib.exec(b))?[c.createElement(e[1])]:(e=p.buildFragment([b],c,d?null:[]),p.merge([],(e.cacheable?p.clone(e.fragment):e.fragment).childNodes)))},parseJSON:function(c){if(!c||"string"!=typeof c)return null;c=p.trim(c);if(b.JSON&&b.JSON.parse)return b.JSON.parse(c);if(P.test(c.replace(Ec,"@").replace(Fc,"]").replace(Dc,"")))return(new Function("return "+c))();p.error("Invalid JSON: "+c)},parseXML:function(d){var e,f;if(!d||"string"!=typeof d)return null;try{b.DOMParser?(f=new DOMParser,e=f.parseFromString(d,
"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(d))}catch(g){e=c}return(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+d),e},noop:function(){},globalEval:function(c){c&&Q.test(c)&&(b.execScript||function(c){b.eval.call(b,c)})(c)},camelCase:function(b){return b.replace(Gc,"ms-").replace(Hc,Ic)},nodeName:function(b,c){return b.nodeName&&b.nodeName.toLowerCase()===c.toLowerCase()},each:function(b,d,e){var f,g=0,m=b.length,
l=m===c||p.isFunction(b);if(e)if(l)for(f in b){if(!1===d.apply(b[f],e))break}else for(;g<m&&!1!==d.apply(b[g++],e););else if(l)for(f in b){if(!1===d.call(b[f],f,b[f]))break}else for(;g<m&&!1!==d.call(b[g],g,b[g++]););return b},trim:xa&&!xa.call("\ufeff\u00a0")?function(b){return null==b?"":xa.call(b)}:function(b){return null==b?"":(b+"").replace(Bc,"")},makeArray:function(b,c){var d,e=c||[];return null!=b&&(d=p.type(b),null==b.length||"string"===d||"function"===d||"regexp"===d||p.isWindow(b)?z.call(e,
b):p.merge(e,b)),e},inArray:function(b,c,d){var e;if(c){if(M)return M.call(c,b,d);e=c.length;for(d=d?0>d?Math.max(0,e+d):d:0;d<e;d++)if(d in c&&c[d]===b)return d}return-1},merge:function(b,d){var e=d.length,f=b.length,g=0;if("number"==typeof e)for(;g<e;g++)b[f++]=d[g];else for(;d[g]!==c;)b[f++]=d[g++];return b.length=f,b},grep:function(b,c,d){var e,f=[],g=0,m=b.length;for(d=!!d;g<m;g++)e=!!c(b[g],g),d!==e&&f.push(b[g]);return f},map:function(b,d,e){var f,g,m=[],l=0,n=b.length;if(b instanceof p||n!==
c&&"number"==typeof n&&(0<n&&b[0]&&b[n-1]||0===n||p.isArray(b)))for(;l<n;l++)f=d(b[l],l,e),null!=f&&(m[m.length]=f);else for(g in b)f=d(b[g],g,e),null!=f&&(m[m.length]=f);return m.concat.apply([],m)},guid:1,proxy:function(b,d){var e,f,g;return"string"==typeof d&&(e=b[d],d=b,b=e),p.isFunction(b)?(f=Y.call(arguments,2),g=function(){return b.apply(d,f.concat(Y.call(arguments)))},g.guid=b.guid=b.guid||p.guid++,g):c},access:function(b,d,e,f,g,m,l){var n,q=null==e,r=0,t=b.length;if(e&&"object"==typeof e){for(r in e)p.access(b,
d,r,e[r],1,m,f);g=1}else if(f!==c){n=l===c&&p.isFunction(f);q&&(n?(n=d,d=function(b,c,d){return n.call(p(b),d)}):(d.call(b,f),d=null));if(d)for(;r<t;r++)d(b[r],e,n?f.call(b[r],r,d(b[r],e)):f,l);g=1}return g?b:q?d.call(b):t?d(b[0],e):m},now:function(){return(new Date).getTime()}});p.ready.promise=function(c){if(!wa)if(wa=p.Deferred(),"complete"===y.readyState)setTimeout(p.ready,1);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",Oa,!1),b.addEventListener("load",p.ready,!1);else{y.attachEvent("onreadystatechange",
Oa);b.attachEvent("onload",p.ready);var d=!1;try{d=null==b.frameElement&&y.documentElement}catch(e){}d&&d.doScroll&&function wc(){if(!p.isReady){try{d.doScroll("left")}catch(b){return setTimeout(wc,50)}p.ready()}}()}return wa.promise(c)};p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b,c){Jb["[object "+c+"]"]=c.toLowerCase()});ja=p(y);var Kb={};p.Callbacks=function(b){var d;if("string"==typeof b){if(!(d=Kb[b])){d=b;var e=Kb[d]={};d=(p.each(d.split(U),function(b,
c){e[c]=!0}),e)}}else d=p.extend({},b);b=d;var f,g,m,l,n,q,r=[],t=!b.once&&[],s=function(c){f=b.memory&&c;g=!0;q=l||0;l=0;n=r.length;for(m=!0;r&&q<n;q++)if(!1===r[q].apply(c[0],c[1])&&b.stopOnFalse){f=!1;break}m=!1;r&&(t?t.length&&s(t.shift()):f?r=[]:v.disable())},v={add:function(){if(r){var c=r.length;(function Ac(c){p.each(c,function(c,d){var e=p.type(d);"function"===e&&(!b.unique||!v.has(d))?r.push(d):d&&d.length&&"string"!==e&&Ac(d)})})(arguments);m?n=r.length:f&&(l=c,s(f))}return this},remove:function(){return r&&
p.each(arguments,function(b,c){for(var d;-1<(d=p.inArray(c,r,d));)r.splice(d,1),m&&(d<=n&&n--,d<=q&&q--)}),this},has:function(b){return-1<p.inArray(b,r)},empty:function(){return r=[],this},disable:function(){return r=t=f=c,this},disabled:function(){return!r},lock:function(){return t=c,f||v.disable(),this},locked:function(){return!t},fireWith:function(b,c){return c=c||[],c=[b,c.slice?c.slice():c],r&&(!g||t)&&(m?t.push(c):s(c)),this},fire:function(){return v.fireWith(this,arguments),this},fired:function(){return!!g}};
return v};p.extend({Deferred:function(b){var c=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},then:function(){var b=arguments;return p.Deferred(function(d){p.each(c,function(c,e){var G=e[0],g=b[c];f[e[1]](p.isFunction(g)?function(){var b=g.apply(this,arguments);b&&p.isFunction(b.promise)?
b.promise().done(d.resolve).fail(d.reject).progress(d.notify):d[G+"With"](this===f?d:this,[b])}:d[G])});b=null}).promise()},promise:function(b){return null!=b?p.extend(b,e):e}},f={};return e.pipe=e.then,p.each(c,function(b,G){var g=G[2],m=G[3];e[G[1]]=g.add;m&&g.add(function(){d=m},c[b^1][2].disable,c[2][2].lock);f[G[0]]=g.fire;f[G[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(b){var c=0,d=Y.call(arguments),e=d.length,f=1!==e||b&&p.isFunction(b.promise)?e:0,g=1===f?b:p.Deferred(),
m=function(b,c,d){return function(e){c[b]=this;d[b]=1<arguments.length?Y.call(arguments):e;d===l?g.notifyWith(c,d):--f||g.resolveWith(c,d)}},l,n,q;if(1<e){l=Array(e);n=Array(e);for(q=Array(e);c<e;c++)d[c]&&p.isFunction(d[c].promise)?d[c].promise().done(m(c,q,d)).fail(g.reject).progress(m(c,n,l)):--f}return f||g.resolveWith(q,d),g.promise()}});var Jc=p,kb;var T,Pa,pa,Qa,Ra,Z,qa,Sa,lb,Ea,Lb,K=y.createElement("div");K.setAttribute("className","t");K.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
Pa=K.getElementsByTagName("*");pa=K.getElementsByTagName("a")[0];pa.style.cssText="top:1px;float:left;opacity:.5";if(!Pa||!Pa.length)kb={};else{Qa=y.createElement("select");Ra=Qa.appendChild(y.createElement("option"));Z=K.getElementsByTagName("input")[0];T={leadingWhitespace:3===K.firstChild.nodeType,tbody:!K.getElementsByTagName("tbody").length,htmlSerialize:!!K.getElementsByTagName("link").length,style:/top/.test(pa.getAttribute("style")),hrefNormalized:"/a"===pa.getAttribute("href"),opacity:/^0.5/.test(pa.style.opacity),
cssFloat:!!pa.style.cssFloat,checkOn:"on"===Z.value,optSelected:Ra.selected,getSetAttribute:"t"!==K.className,enctype:!!y.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===y.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};Z.checked=!0;T.noCloneChecked=Z.cloneNode(!0).checked;
Qa.disabled=!0;T.optDisabled=!Ra.disabled;try{delete K.test}catch(Md){T.deleteExpando=!1}!K.addEventListener&&K.attachEvent&&K.fireEvent&&(K.attachEvent("onclick",Lb=function(){T.noCloneEvent=!1}),K.cloneNode(!0).fireEvent("onclick"),K.detachEvent("onclick",Lb));Z=y.createElement("input");Z.value="t";Z.setAttribute("type","radio");T.radioValue="t"===Z.value;Z.setAttribute("checked","checked");Z.setAttribute("name","t");K.appendChild(Z);qa=y.createDocumentFragment();qa.appendChild(K.lastChild);T.checkClone=
qa.cloneNode(!0).cloneNode(!0).lastChild.checked;T.appendChecked=Z.checked;qa.removeChild(Z);qa.appendChild(K);if(K.attachEvent)for(lb in{submit:!0,change:!0,focusin:!0})Sa="on"+lb,(Ea=Sa in K)||(K.setAttribute(Sa,"return;"),Ea="function"==typeof K[Sa]),T[lb+"Bubbles"]=Ea;kb=(p(function(){var c,d,e,f,g=y.getElementsByTagName("body")[0];g&&(c=y.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",g.insertBefore(c,g.firstChild),d=y.createElement("div"),
c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=d.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",Ea=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",T.reliableHiddenOffsets=Ea&&0===e[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",T.boxSizing=
4===d.offsetWidth,T.doesNotIncludeMarginInBodyOffset=1!==g.offsetTop,b.getComputedStyle&&(T.pixelPosition="1%"!==(b.getComputedStyle(d,null)||{}).top,T.boxSizingReliable="4px"===(b.getComputedStyle(d,null)||{width:"4px"}).width,f=y.createElement("div"),f.style.cssText=d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;",f.style.marginRight=f.style.width="0",d.style.width="1px",d.appendChild(f),T.reliableMarginRight=!parseFloat((b.getComputedStyle(f,null)||{}).marginRight)),
"undefined"!=typeof d.style.zoom&&(d.innerHTML="",d.style.cssText="padding:0;margin:0;border:0;display:block;overflow:hidden;width:1px;padding:1px;display:inline;zoom:1",T.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",T.shrinkWrapBlocks=3!==d.offsetWidth,c.style.zoom=1),g.removeChild(c))}),qa.removeChild(K),Pa=pa=Qa=Ra=Z=qa=K=null,T)}Jc.support=kb;var vc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,uc=/([A-Z])/g;
p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(b){return b=b.nodeType?p.cache[b[p.expando]]:b[p.expando],!!b&&!e(b)},data:function(b,d,e,f){if(p.acceptData(b)){var g,m,l=p.expando,n="string"==typeof d,q=b.nodeType,r=q?p.cache:b,t=q?b[l]:b[l]&&l;if(t&&r[t]&&(f||r[t].data)||!(n&&e===c)){t||(q?b[l]=t=p.deletedIds.pop()||p.guid++:t=l);r[t]||(r[t]={},
q||(r[t].toJSON=p.noop));if("object"==typeof d||"function"==typeof d)f?r[t]=p.extend(r[t],d):r[t].data=p.extend(r[t].data,d);return g=r[t],f||(g.data||(g.data={}),g=g.data),e!==c&&(g[p.camelCase(d)]=e),n?(m=g[d],null==m&&(m=g[p.camelCase(d)])):m=g,m}}},removeData:function(b,c,d){if(p.acceptData(b)){var f,g,m,l=b.nodeType,n=l?p.cache:b,q=l?b[p.expando]:p.expando;if(n[q]){if(c&&(f=d?n[q]:n[q].data)){p.isArray(c)||(c in f?c=[c]:(c=p.camelCase(c),c in f?c=[c]:c=c.split(" ")));g=0;for(m=c.length;g<m;g++)delete f[c[g]];
if(!(d?e:p.isEmptyObject)(f))return}if(!d&&(delete n[q].data,!e(n[q])))return;l?p.cleanData([b],!0):p.support.deleteExpando||n!=n.window?delete n[q]:n[q]=null}}},_data:function(b,c,d){return p.data(b,c,d,!0)},acceptData:function(b){var c=b.nodeName&&p.noData[b.nodeName.toLowerCase()];return!c||!0!==c&&b.getAttribute("classid")===c}});p.fn.extend({data:function(b,e){var f,g,m,l,n,q=this[0],r=0,t=null;if(b===c){if(this.length&&(t=p.data(q),1===q.nodeType&&!p._data(q,"parsedAttrs"))){m=q.attributes;
for(n=m.length;r<n;r++)l=m[r].name,l.indexOf("data-")||(l=p.camelCase(l.substring(5)),d(q,l,t[l]));p._data(q,"parsedAttrs",!0)}return t}return"object"==typeof b?this.each(function(){p.data(this,b)}):(f=b.split(".",2),f[1]=f[1]?"."+f[1]:"",g=f[1]+"!",p.access(this,function(e){if(e===c)return t=this.triggerHandler("getData"+g,[f[0]]),t===c&&q&&(t=p.data(q,b),t=d(q,b,t)),t===c&&f[1]?this.data(f[0]):t;f[1]=e;this.each(function(){var c=p(this);c.triggerHandler("setData"+g,f);p.data(this,b,e);c.triggerHandler("changeData"+
g,f)})},null,e,1<arguments.length,null,!1))},removeData:function(b){return this.each(function(){p.removeData(this,b)})}});p.extend({queue:function(b,c,d){var e;if(b)return c=(c||"fx")+"queue",e=p._data(b,c),d&&(!e||p.isArray(d)?e=p._data(b,c,p.makeArray(d)):e.push(d)),e||[]},dequeue:function(b,c){c=c||"fx";var d=p.queue(b,c),e=d.length,f=d.shift(),g=p._queueHooks(b,c),m=function(){p.dequeue(b,c)};"inprogress"===f&&(f=d.shift(),e--);f&&("fx"===c&&d.unshift("inprogress"),delete g.stop,f.call(b,m,g));
!e&&g&&g.empty.fire()},_queueHooks:function(b,c){var d=c+"queueHooks";return p._data(b,d)||p._data(b,d,{empty:p.Callbacks("once memory").add(function(){p.removeData(b,c+"queue",!0);p.removeData(b,d,!0)})})}});p.fn.extend({queue:function(b,d){var e=2;return"string"!=typeof b&&(d=b,b="fx",e--),arguments.length<e?p.queue(this[0],b):d===c?this:this.each(function(){var c=p.queue(this,b,d);p._queueHooks(this,b);"fx"===b&&"inprogress"!==c[0]&&p.dequeue(this,b)})},dequeue:function(b){return this.each(function(){p.dequeue(this,
b)})},delay:function(b,c){return b=p.fx?p.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=setTimeout(c,b);d.stop=function(){clearTimeout(e)}})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,d){var e,f=1,g=p.Deferred(),m=this,l=this.length,n=function(){--f||g.resolveWith(m,[m])};"string"!=typeof b&&(d=b,b=c);for(b=b||"fx";l--;)(e=p._data(m[l],b+"queueHooks"))&&e.empty&&(f++,e.empty.add(n));return n(),g.promise(d)}});var ka,Mb,Nb,Ob=/[\t\r\n]/g,Kc=/\r/g,Lc=/^(?:button|input)$/i,
Mc=/^(?:button|input|object|select|textarea)$/i,Nc=/^a(?:rea|)$/i,Pb=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Qb=p.support.getSetAttribute;p.fn.extend({attr:function(b,c){return p.access(this,p.attr,b,c,1<arguments.length)},removeAttr:function(b){return this.each(function(){p.removeAttr(this,b)})},prop:function(b,c){return p.access(this,p.prop,b,c,1<arguments.length)},removeProp:function(b){return b=p.propFix[b]||
b,this.each(function(){try{this[b]=c,delete this[b]}catch(d){}})},addClass:function(b){var c,d,e,f,g,m,l;if(p.isFunction(b))return this.each(function(c){p(this).addClass(b.call(this,c,this.className))});if(b&&"string"==typeof b){c=b.split(U);d=0;for(e=this.length;d<e;d++)if(f=this[d],1===f.nodeType)if(!f.className&&1===c.length)f.className=b;else{g=" "+f.className+" ";m=0;for(l=c.length;m<l;m++)0>g.indexOf(" "+c[m]+" ")&&(g+=c[m]+" ");f.className=p.trim(g)}}return this},removeClass:function(b){var d,
e,f,g,m,l,n;if(p.isFunction(b))return this.each(function(c){p(this).removeClass(b.call(this,c,this.className))});if(b&&"string"==typeof b||b===c){d=(b||"").split(U);l=0;for(n=this.length;l<n;l++)if(f=this[l],1===f.nodeType&&f.className){e=(" "+f.className+" ").replace(Ob," ");g=0;for(m=d.length;g<m;g++)for(;0<=e.indexOf(" "+d[g]+" ");)e=e.replace(" "+d[g]+" "," ");f.className=b?p.trim(e):""}}return this},toggleClass:function(b,c){var d=typeof b,e="boolean"==typeof c;return p.isFunction(b)?this.each(function(d){p(this).toggleClass(b.call(this,
d,this.className,c),c)}):this.each(function(){if("string"===d)for(var f,g=0,m=p(this),l=c,n=b.split(U);f=n[g++];)l=e?l:!m.hasClass(f),m[l?"addClass":"removeClass"](f);else if("undefined"===d||"boolean"===d)this.className&&p._data(this,"__className__",this.className),this.className=this.className||!1===b?"":p._data(this,"__className__")||""})},hasClass:function(b){b=" "+b+" ";for(var c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&0<=(" "+this[c].className+" ").replace(Ob," ").indexOf(b))return!0;
return!1},val:function(b){var d,e,f,g=this[0];if(arguments.length)return f=p.isFunction(b),this.each(function(e){var g,m=p(this);if(1===this.nodeType&&(f?g=b.call(this,e,m.val()):g=b,null==g?g="":"number"==typeof g?g+="":p.isArray(g)&&(g=p.map(g,function(b){return null==b?"":b+""})),d=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()],!d||!("set"in d)||d.set(this,g,"value")===c))this.value=g});if(g)return d=p.valHooks[g.type]||p.valHooks[g.nodeName.toLowerCase()],d&&"get"in d&&(e=d.get(g,
"value"))!==c?e:(e=g.value,"string"==typeof e?e.replace(Kc,""):null==e?"":e)}});p.extend({valHooks:{option:{get:function(b){var c=b.attributes.value;return!c||c.specified?b.value:b.text}},select:{get:function(b){var c,d,e=b.selectedIndex,f=[],g=b.options,m="select-one"===b.type;if(0>e)return null;b=m?e:0;for(d=m?e+1:g.length;b<d;b++)if(c=g[b],c.selected&&(p.support.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!p.nodeName(c.parentNode,"optgroup"))){c=p(c).val();
if(m)return c;f.push(c)}return m&&!f.length&&g.length?p(g[e]).val():f},set:function(b,c){var d=p.makeArray(c);return p(b).find("option").each(function(){this.selected=0<=p.inArray(p(this).val(),d)}),d.length||(b.selectedIndex=-1),d}}},attrFn:{},attr:function(b,d,e,f){var g,m,l=b.nodeType;if(b&&!(3===l||8===l||2===l)){if(f&&p.isFunction(p.fn[d]))return p(b)[d](e);if("undefined"==typeof b.getAttribute)return p.prop(b,d,e);(f=1!==l||!p.isXMLDoc(b))&&(d=d.toLowerCase(),m=p.attrHooks[d]||(Pb.test(d)?Mb:
ka));if(e!==c){if(null===e){p.removeAttr(b,d);return}return m&&"set"in m&&f&&(g=m.set(b,e,d))!==c?g:(b.setAttribute(d,e+""),e)}return m&&"get"in m&&f&&null!==(g=m.get(b,d))?g:(g=b.getAttribute(d),null===g?c:g)}},removeAttr:function(b,c){var d,e,f,g,m=0;if(c&&1===b.nodeType)for(e=c.split(U);m<e.length;m++)(f=e[m])&&(d=p.propFix[f]||f,g=Pb.test(f),g||p.attr(b,f,""),b.removeAttribute(Qb?f:d),g&&d in b&&(b[d]=!1))},attrHooks:{type:{set:function(b,c){if(Lc.test(b.nodeName)&&b.parentNode)p.error("type property can't be changed");
else if(!p.support.radioValue&&"radio"===c&&p.nodeName(b,"input")){var d=b.value;return b.setAttribute("type",c),d&&(b.value=d),c}}},value:{get:function(b,c){return ka&&p.nodeName(b,"button")?ka.get(b,c):c in b?b.value:null},set:function(b,c,d){if(ka&&p.nodeName(b,"button"))return ka.set(b,c,d);b.value=c}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",
usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(b,d,e){var f,g,m,l=b.nodeType;if(b&&!(3===l||8===l||2===l))return m=1!==l||!p.isXMLDoc(b),m&&(d=p.propFix[d]||d,g=p.propHooks[d]),e!==c?g&&"set"in g&&(f=g.set(b,e,d))!==c?f:b[d]=e:g&&"get"in g&&null!==(f=g.get(b,d))?f:b[d]},propHooks:{tabIndex:{get:function(b){var d=b.getAttributeNode("tabindex");return d&&d.specified?parseInt(d.value,10):Mc.test(b.nodeName)||Nc.test(b.nodeName)&&b.href?0:c}}}});Mb={get:function(b,
d){var e,f=p.prop(b,d);return!0===f||"boolean"!=typeof f&&(e=b.getAttributeNode(d))&&!1!==e.nodeValue?d.toLowerCase():c},set:function(b,c,d){var e;return!1===c?p.removeAttr(b,d):(e=p.propFix[d]||d,e in b&&(b[e]=!0),b.setAttribute(d,d.toLowerCase())),d}};Qb||(Nb={name:!0,id:!0,coords:!0},ka=p.valHooks.button={get:function(b,d){var e;return e=b.getAttributeNode(d),e&&(Nb[d]?""!==e.value:e.specified)?e.value:c},set:function(b,c,d){var e=b.getAttributeNode(d);return e||(e=y.createAttribute(d),b.setAttributeNode(e)),
e.value=c+""}},p.each(["width","height"],function(b,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{set:function(b,d){if(""===d)return b.setAttribute(c,"auto"),d}})}),p.attrHooks.contenteditable={get:ka.get,set:function(b,c,d){""===c&&(c="false");ka.set(b,c,d)}});p.support.hrefNormalized||p.each(["href","src","width","height"],function(b,d){p.attrHooks[d]=p.extend(p.attrHooks[d],{get:function(b){b=b.getAttribute(d,2);return null===b?c:b}})});p.support.style||(p.attrHooks.style={get:function(b){return b.style.cssText.toLowerCase()||
c},set:function(b,c){return b.style.cssText=c+""}});p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(b){b=b.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}));p.support.enctype||(p.propFix.enctype="encoding");p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(b){return null===b.getAttribute("value")?"on":b.value}}});p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],
{set:function(b,c){if(p.isArray(c))return b.checked=0<=p.inArray(p(b).val(),c)}})});var mb=/^(?:textarea|input|select)$/i,Rb=/^([^\.]*|)(?:\.(.+)|)$/,Oc=/(?:^|\s)hover(\.\S+|)\b/,Pc=/^key/,Qc=/^(?:mouse|contextmenu)|click/,Sb=/^(?:focusinfocus|focusoutblur)$/,Tb=function(b){return p.event.special.hover?b:b.replace(Oc,"mouseenter$1 mouseleave$1")};p.event={add:function(b,d,e,f,g){var m,l,n,q,r,t,s,v,u;if(!(3===b.nodeType||8===b.nodeType||!d||!e||!(m=p._data(b)))){e.handler&&(s=e,e=s.handler,g=s.selector);
e.guid||(e.guid=p.guid++);(n=m.events)||(m.events=n={});(l=m.handle)||(m.handle=l=function(b){return"undefined"!=typeof p&&(!b||p.event.triggered!==b.type)?p.event.dispatch.apply(l.elem,arguments):c},l.elem=b);d=p.trim(Tb(d)).split(" ");for(m=0;m<d.length;m++){q=Rb.exec(d[m])||[];r=q[1];t=(q[2]||"").split(".").sort();u=p.event.special[r]||{};r=(g?u.delegateType:u.bindType)||r;u=p.event.special[r]||{};q=p.extend({type:r,origType:q[1],data:f,handler:e,guid:e.guid,selector:g,needsContext:g&&p.expr.match.needsContext.test(g),
namespace:t.join(".")},s);v=n[r];if(!v&&(v=n[r]=[],v.delegateCount=0,!u.setup||!1===u.setup.call(b,f,t,l)))b.addEventListener?b.addEventListener(r,l,!1):b.attachEvent&&b.attachEvent("on"+r,l);u.add&&(u.add.call(b,q),q.handler.guid||(q.handler.guid=e.guid));g?v.splice(v.delegateCount++,0,q):v.push(q);p.event.global[r]=!0}b=null}},global:{},remove:function(b,c,d,e,f){var g,m,l,n,q,r,t,v,s,u,x=p.hasData(b)&&p._data(b);if(x&&(t=x.events)){c=p.trim(Tb(c||"")).split(" ");for(g=0;g<c.length;g++)if(m=Rb.exec(c[g])||
[],l=n=m[1],m=m[2],l){v=p.event.special[l]||{};l=(e?v.delegateType:v.bindType)||l;s=t[l]||[];q=s.length;m=m?RegExp("(^|\\.)"+m.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(r=0;r<s.length;r++)u=s[r],(f||n===u.origType)&&(!d||d.guid===u.guid)&&(!m||m.test(u.namespace))&&(!e||e===u.selector||"**"===e&&u.selector)&&(s.splice(r--,1),u.selector&&s.delegateCount--,v.remove&&v.remove.call(b,u));0===s.length&&q!==s.length&&((!v.teardown||!1===v.teardown.call(b,m,x.handle))&&p.removeEvent(b,
l,x.handle),delete t[l])}else for(l in t)p.event.remove(b,l+c[g],d,e,!0);p.isEmptyObject(t)&&(delete x.handle,p.removeData(b,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(d,e,f,g){if(!f||3!==f.nodeType&&8!==f.nodeType){var m,l,n,q,r,t,s,v=d.type||d;q=[];if(!Sb.test(v+p.event.triggered)&&(0<=v.indexOf("!")&&(v=v.slice(0,-1),m=!0),0<=v.indexOf(".")&&(q=v.split("."),v=q.shift(),q.sort()),f&&!p.event.customEvent[v]||p.event.global[v]))if(d="object"==typeof d?d[p.expando]?
d:new p.Event(v,d):new p.Event(v),d.type=v,d.isTrigger=!0,d.exclusive=m,d.namespace=q.join("."),d.namespace_re=d.namespace?RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,q=0>v.indexOf(":")?"on"+v:"",f){if(d.result=c,d.target||(d.target=f),e=null!=e?p.makeArray(e):[],e.unshift(d),r=p.event.special[v]||{},!(r.trigger&&!1===r.trigger.apply(f,e))){s=[[f,r.bindType||v]];if(!g&&!r.noBubble&&!p.isWindow(f)){l=r.delegateType||v;m=Sb.test(l+v)?f:f.parentNode;for(n=f;m;m=m.parentNode)s.push([m,l]),
n=m;n===(f.ownerDocument||y)&&s.push([n.defaultView||n.parentWindow||b,l])}for(l=0;l<s.length&&!d.isPropagationStopped();l++)m=s[l][0],d.type=s[l][1],(t=(p._data(m,"events")||{})[d.type]&&p._data(m,"handle"))&&t.apply(m,e),(t=q&&m[q])&&p.acceptData(m)&&t.apply&&!1===t.apply(m,e)&&d.preventDefault();return d.type=v,!g&&!d.isDefaultPrevented()&&(!r._default||!1===r._default.apply(f.ownerDocument,e))&&("click"!==v||!p.nodeName(f,"a"))&&p.acceptData(f)&&q&&f[v]&&("focus"!==v&&"blur"!==v||0!==d.target.offsetWidth)&&
!p.isWindow(f)&&(n=f[q],n&&(f[q]=null),p.event.triggered=v,f[v](),p.event.triggered=c,n&&(f[q]=n)),d.result}}else for(l in f=p.cache,f)f[l].events&&f[l].events[v]&&p.event.trigger(d,e,f[l].handle.elem,!0)}},dispatch:function(d){d=p.event.fix(d||b.event);var e,f,g,m,l,n,q=(p._data(this,"events")||{})[d.type]||[],r=q.delegateCount,t=Y.call(arguments),v=!d.exclusive&&!d.namespace,s=p.event.special[d.type]||{},u=[];t[0]=d;d.delegateTarget=this;if(!(s.preDispatch&&!1===s.preDispatch.call(this,d))){if(r&&
(!d.button||"click"!==d.type))for(f=d.target;f!=this;f=f.parentNode||this)if(!0!==f.disabled||"click"!==d.type){m={};l=[];for(e=0;e<r;e++)g=q[e],n=g.selector,m[n]===c&&(m[n]=g.needsContext?0<=p(n,this).index(f):p.find(n,this,null,[f]).length),m[n]&&l.push(g);l.length&&u.push({elem:f,matches:l})}q.length>r&&u.push({elem:this,matches:q.slice(r)});for(e=0;e<u.length&&!d.isPropagationStopped();e++){m=u[e];d.currentTarget=m.elem;for(f=0;f<m.matches.length&&!d.isImmediatePropagationStopped();f++)if(g=m.matches[f],
v||!d.namespace&&!g.namespace||d.namespace_re&&d.namespace_re.test(g.namespace))d.data=g.data,d.handleObj=g,g=((p.event.special[g.origType]||{}).handle||g.handler).apply(m.elem,t),g!==c&&(d.result=g,!1===g&&(d.preventDefault(),d.stopPropagation()))}return s.postDispatch&&s.postDispatch.call(this,d),d.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},
keyHooks:{props:["char","charCode","key","keyCode"],filter:function(b,c){return null==b.which&&(b.which=null!=c.charCode?c.charCode:c.keyCode),b}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b,d){var e,f,g,m=d.button,l=d.fromElement;return null==b.pageX&&null!=d.clientX&&(e=b.target.ownerDocument||y,f=e.documentElement,g=e.body,b.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||
g&&g.clientLeft||0),b.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!b.relatedTarget&&l&&(b.relatedTarget=l===b.target?d.toElement:l),!b.which&&m!==c&&(b.which=m&1?1:m&2?3:m&4?2:0),b}},fix:function(b){if(b[p.expando])return b;var c,d,e=b,f=p.event.fixHooks[b.type]||{},g=f.props?this.props.concat(f.props):this.props;b=p.Event(e);for(c=g.length;c;)d=g[--c],b[d]=e[d];return b.target||(b.target=e.srcElement||y),3===b.target.nodeType&&(b.target=b.target.parentNode),
b.metaKey=!!b.metaKey,f.filter?f.filter(b,e):b},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b,c,d){p.isWindow(this)&&(this.onbeforeunload=d)},teardown:function(b,c){this.onbeforeunload===c&&(this.onbeforeunload=null)}}},simulate:function(b,c,d,e){b=p.extend(new p.Event,d,{type:b,isSimulated:!0,originalEvent:{}});e?p.event.trigger(b,null,c):p.event.dispatch.call(c,b);b.isDefaultPrevented()&&d.preventDefault()}};p.event.handle=
p.event.dispatch;p.removeEvent=y.removeEventListener?function(b,c,d){b.removeEventListener&&b.removeEventListener(c,d,!1)}:function(b,c,d){c="on"+c;b.detachEvent&&("undefined"==typeof b[c]&&(b[c]=null),b.detachEvent(c,d))};p.Event=function(b,c){if(this instanceof p.Event)b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||!1===b.returnValue||b.getPreventDefault&&b.getPreventDefault()?g:f):this.type=b,c&&p.extend(this,c),this.timeStamp=b&&b.timeStamp||p.now(),
this[p.expando]=!0;else return new p.Event(b,c)};p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=g;var b=this.originalEvent;b&&(b.preventDefault?b.preventDefault():b.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=g;var b=this.originalEvent;b&&(b.stopPropagation&&b.stopPropagation(),b.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g;this.stopPropagation()},isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f};
p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b,c){p.event.special[b]={delegateType:c,bindType:c,handle:function(b){var d,e=b.relatedTarget,f=b.handleObj;if(!e||e!==this&&!p.contains(this,e))b.type=f.origType,d=f.handler.apply(this,arguments),b.type=c;return d}}});p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form"))return!1;p.event.add(this,"click._submit keypress._submit",function(b){b=b.target;(b=p.nodeName(b,"input")||p.nodeName(b,"button")?
b.form:c)&&!p._data(b,"_submit_attached")&&(p.event.add(b,"submit._submit",function(b){b._submit_bubble=!0}),p._data(b,"_submit_attached",!0))})},postDispatch:function(b){b._submit_bubble&&(delete b._submit_bubble,this.parentNode&&!b.isTrigger&&p.event.simulate("submit",this.parentNode,b,!0))},teardown:function(){if(p.nodeName(this,"form"))return!1;p.event.remove(this,"._submit")}});p.support.changeBubbles||(p.event.special.change={setup:function(){if(mb.test(this.nodeName)){if("checkbox"===this.type||
"radio"===this.type)p.event.add(this,"propertychange._change",function(b){"checked"===b.originalEvent.propertyName&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(b){this._just_changed&&!b.isTrigger&&(this._just_changed=!1);p.event.simulate("change",this,b,!0)});return!1}p.event.add(this,"beforeactivate._change",function(b){b=b.target;mb.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(b){this.parentNode&&!b.isSimulated&&!b.isTrigger&&
p.event.simulate("change",this.parentNode,b,!0)}),p._data(b,"_change_attached",!0))})},handle:function(b){var c=b.target;if(this!==c||b.isSimulated||b.isTrigger||"radio"!==c.type&&"checkbox"!==c.type)return b.handleObj.handler.apply(this,arguments)},teardown:function(){return p.event.remove(this,"._change"),!mb.test(this.nodeName)}});p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(b,c){var d=0,e=function(b){p.event.simulate(c,b.target,p.event.fix(b),!0)};p.event.special[c]=
{setup:function(){0===d++&&y.addEventListener(b,e,!0)},teardown:function(){0===--d&&y.removeEventListener(b,e,!0)}}});p.fn.extend({on:function(b,d,e,g,m){var l,n;if("object"==typeof b){"string"!=typeof d&&(e=e||d,d=c);for(n in b)this.on(n,d,e,b[n],m);return this}null==e&&null==g?(g=d,e=d=c):null==g&&("string"==typeof d?(g=e,e=c):(g=e,e=d,d=c));if(!1===g)g=f;else if(!g)return this;return 1===m&&(l=g,g=function(b){return p().off(b),l.apply(this,arguments)},g.guid=l.guid||(l.guid=p.guid++)),this.each(function(){p.event.add(this,
b,g,e,d)})},one:function(b,c,d,e){return this.on(b,c,d,e,1)},off:function(b,d,e){var g,m;if(b&&b.preventDefault&&b.handleObj)return g=b.handleObj,p(b.delegateTarget).off(g.namespace?g.origType+"."+g.namespace:g.origType,g.selector,g.handler),this;if("object"==typeof b){for(m in b)this.off(m,d,b[m]);return this}if(!1===d||"function"==typeof d)e=d,d=c;return!1===e&&(e=f),this.each(function(){p.event.remove(this,b,e,d)})},bind:function(b,c,d){return this.on(b,null,c,d)},unbind:function(b,c){return this.off(b,
null,c)},live:function(b,c,d){return p(this.context).on(b,this.selector,c,d),this},die:function(b,c){return p(this.context).off(b,this.selector||"**",c),this},delegate:function(b,c,d,e){return this.on(c,b,d,e)},undelegate:function(b,c,d){return 1===arguments.length?this.off(b,"**"):this.off(c,b||"**",d)},trigger:function(b,c){return this.each(function(){p.event.trigger(b,c,this)})},triggerHandler:function(b,c){if(this[0])return p.event.trigger(b,c,this[0],!0)},toggle:function(b){var c=arguments,d=
b.guid||p.guid++,e=0,f=function(d){var f=(p._data(this,"lastToggle"+b.guid)||0)%e;return p._data(this,"lastToggle"+b.guid,f+1),d.preventDefault(),c[f].apply(this,arguments)||!1};for(f.guid=d;e<c.length;)c[e++].guid=d;return this.click(f)},hover:function(b,c){return this.mouseenter(b).mouseleave(c||b)}});p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(b,c){p.fn[c]=function(b,d){return null==d&&(d=b,b=null),0<arguments.length?this.on(c,null,b,d):this.trigger(c)};Pc.test(c)&&(p.event.fixHooks[c]=p.event.keyHooks);Qc.test(c)&&(p.event.fixHooks[c]=p.event.mouseHooks)});var Rc=b,I=function(b,c,d,e){d=d||[];c=c||da;var f,g,m,l,p=c.nodeType;if(!b||"string"!=typeof b)return d;if(1!==p&&9!==p)return[];m=Ta(c);if(!m&&!e&&(f=Sc.exec(b)))if(l=f[1])if(9===p){g=c.getElementById(l);if(!g||!g.parentNode)return d;if(g.id===l)return d.push(g),d}else{if(c.ownerDocument&&
(g=c.ownerDocument.getElementById(l))&&Ub(c,g)&&g.id===l)return d.push(g),d}else{if(f[2])return ya.apply(d,za.call(c.getElementsByTagName(b),0)),d;if((l=f[3])&&Vb&&c.getElementsByClassName)return ya.apply(d,za.call(c.getElementsByClassName(l),0)),d}return nb(b.replace(Ua,"$1"),c,d,e,m)},Fa=function(b){return function(c){return"input"===c.nodeName.toLowerCase()&&c.type===b}},Wb=function(b){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===b}},ra=function(b){return ea(function(c){return c=
+c,ea(function(d,e){for(var f,g=b([],d.length,c),m=g.length;m--;)d[f=g[m]]&&(d[f]=!(e[f]=d[f]))})})},Va=function(b,c,d){if(b===c)return d;for(b=b.nextSibling;b;){if(b===c)return-1;b=b.nextSibling}return 1},Xa=function(b,c){var d,e,f,g,m,l,p;if(m=Xb[R][b])return c?0:m.slice(0);m=b;l=[];for(p=L.preFilter;m;){if(!d||(e=Tc.exec(m)))e&&(m=m.slice(e[0].length)),l.push(f=[]);d=!1;if(e=Uc.exec(m))f.push(d=new Yb(e.shift())),m=m.slice(d.length),d.type=e[0].replace(Ua," ");for(g in L.filter)(e=Wa[g].exec(m))&&
(!p[g]||(e=p[g](e,da,!0)))&&(f.push(d=new Yb(e.shift())),m=m.slice(d.length),d.type=g,d.matches=e);if(!d)break}return c?m.length:m?I.error(b):Xb(b,l).slice(0)},pb=function(b,c,d){var e=c.dir,f=d&&"parentNode"===c.dir,g=Vc++;return c.first?function(c,d,g){for(;c=c[e];)if(f||1===c.nodeType)return b(c,d,g)}:function(c,d,m){if(m)for(;c=c[e];){if((f||1===c.nodeType)&&b(c,d,m))return c}else for(var l,p=Ga+" "+g+" ",n=p+ob;c=c[e];)if(f||1===c.nodeType){if((l=c[R])===n)return c.sizset;if("string"==typeof l&&
0===l.indexOf(p)){if(c.sizset)return c}else{c[R]=n;if(b(c,d,m))return c.sizset=!0,c;c.sizset=!1}}}},qb=function(b){return 1<b.length?function(c,d,e){for(var f=b.length;f--;)if(!b[f](c,d,e))return!1;return!0}:b[0]},Ya=function(b,c,d,e,f){for(var g,m=[],l=0,p=b.length,n=null!=c;l<p;l++)if(g=b[l])if(!d||d(g,e,f))m.push(g),n&&c.push(l);return m},rb=function(b,c,d,e,f,g){return e&&!e[R]&&(e=rb(e)),f&&!f[R]&&(f=rb(f,g)),ea(function(g,m,l,p){if(!g||!f){var n,q,r=[],t=[],v=m.length;if(!(q=g)){q=c||"*";var s=
l.nodeType?[l]:l,u=[];n=0;for(var x=s.length;n<x;n++)I(q,s[n],u,g);q=u}s=b&&(g||!c)?Ya(q,r,b,l,p):q;u=d?f||(g?b:v||e)?[]:m:s;d&&d(s,u,l,p);if(e){q=Ya(u,t);e(q,[],l,p);for(l=q.length;l--;)if(n=q[l])u[t[l]]=!(s[t[l]]=n)}if(g)for(l=b&&u.length;l--;){if(n=u[l])g[r[l]]=!(m[r[l]]=n)}else u=Ya(u===m?u.splice(v,u.length):u),f?f(null,m,u,p):ya.apply(m,u)}})},sb=function(b){var c,d,e,f=b.length,g=L.relative[b[0].type];d=g||L.relative[" "];for(var m=g?1:0,l=pb(function(b){return b===c},d,!0),p=pb(function(b){return-1<
Zb.call(c,b)},d,!0),n=[function(b,d,e){return!g&&(e||d!==Za)||((c=d).nodeType?l(b,d,e):p(b,d,e))}];m<f;m++)if(d=L.relative[b[m].type])n=[pb(qb(n),d)];else{d=L.filter[b[m].type].apply(null,b[m].matches);if(d[R]){for(e=++m;e<f&&!L.relative[b[e].type];e++);return rb(1<m&&qb(n),1<m&&b.slice(0,m-1).join("").replace(Ua,"$1"),d,m<e&&sb(b.slice(m,e)),e<f&&sb(b=b.slice(e)),e<f&&b.join(""))}n.push(d)}return qb(n)},nb=function(b,c,d,e,f){var g,m,l,p,n=Xa(b);if(!e&&1===n.length){m=n[0]=n[0].slice(0);if(2<m.length&&
"ID"===(l=m[0]).type&&9===c.nodeType&&!f&&L.relative[m[1].type]){c=L.find.ID(l.matches[0].replace(sa,""),c,f)[0];if(!c)return d;b=b.slice(m.shift().length)}for(g=Wa.POS.test(b)?-1:m.length-1;0<=g;g--){l=m[g];if(L.relative[p=l.type])break;if(p=L.find[p])if(e=p(l.matches[0].replace(sa,""),tb.test(m[0].type)&&c.parentNode||c,f)){m.splice(g,1);b=e.length&&m.join("");if(!b)return ya.apply(d,za.call(e,0)),d;break}}}return ub(b,n)(e,c,f,d,tb.test(b)),d},$b=function(){},ob,vb,L,$a,Ta,Ub,ub,wb,Ha,Za,ac=!0,
R=("sizcache"+Math.random()).replace(".",""),Yb=String,da=Rc.document,ca=da.documentElement,Ga=0,Vc=0,Wc=[].pop,ya=[].push,za=[].slice,Zb=[].indexOf||function(b){for(var c=0,d=this.length;c<d;c++)if(this[c]===b)return c;return-1},ea=function(b,c){return b[R]=null==c||c,b},xb=function(){var b={},c=[];return ea(function(d,e){return c.push(d)>L.cacheLength&&delete b[c.shift()],b[d]=e},b)},bc=xb(),Xb=xb(),cc=xb(),dc="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+
"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w#")+")|)|)[\\x20\\t\\r\\n\\f]*\\]",yb=":((?:\\\\.|[-\\w]|[^\\x00-\\xa0])+)(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+dc+")|[^:]|\\\\.)*|.*))\\)|)",Ua=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Tc=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Uc=/^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,Xc=RegExp(yb),Sc=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,tb=/[\x20\t\r\n\f]*[+~]/,Yc=/h\d/i,Zc=/input|select|textarea|button/i,sa=/\\(?!\\)/g,
Wa={ID:/^#((?:\\.|[-\w]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[-\w]|[^\x00-\xa0])+)/,NAME:/^\[name=['"]?((?:\\.|[-\w]|[^\x00-\xa0])+)['"]?\]/,TAG:RegExp("^("+"(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+dc),PSEUDO:RegExp("^"+yb),POS:/:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,CHILD:RegExp("^:(only|nth|first|last)-child(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},la=function(b){var c=da.createElement("div");try{return b(c)}catch(d){return!1}finally{}},$c=la(function(b){return b.appendChild(da.createComment("")),!b.getElementsByTagName("*").length}),ad=la(function(b){return b.innerHTML="<a href='#'></a>",b.firstChild&&"undefined"!==typeof b.firstChild.getAttribute&&"#"===b.firstChild.getAttribute("href")}),
bd=la(function(b){b.innerHTML="<select></select>";b=typeof b.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),Vb=la(function(b){return b.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!b.getElementsByClassName||!b.getElementsByClassName("e").length?!1:(b.lastChild.className="e",2===b.getElementsByClassName("e").length)}),cd=la(function(b){b.id=R+0;b.innerHTML="<a name='"+R+"'></a><div name='"+R+"'></div>";ca.insertBefore(b,ca.firstChild);var c=da.getElementsByName&&
da.getElementsByName(R).length===2+da.getElementsByName(R+0).length;return vb=!da.getElementById(R),ca.removeChild(b),c});try{za.call(ca.childNodes,0)[0].nodeType}catch(Nd){za=function(b){for(var c,d=[];c=this[b];b++)d.push(c);return d}}I.matches=function(b,c){return I(b,null,null,c)};I.matchesSelector=function(b,c){return 0<I(c,null,null,[b]).length};$a=I.getText=function(b){var c,d="",e=0;if(c=b.nodeType)if(1===c||9===c||11===c){if("string"==typeof b.textContent)return b.textContent;for(b=b.firstChild;b;b=
b.nextSibling)d+=$a(b)}else{if(3===c||4===c)return b.nodeValue}else for(;c=b[e];e++)d+=$a(c);return d};Ta=I.isXML=function(b){return(b=b&&(b.ownerDocument||b).documentElement)?"HTML"!==b.nodeName:!1};Ub=I.contains=ca.contains?function(b,c){var d=9===b.nodeType?b.documentElement:b,e=c&&c.parentNode;return b===e||!(!e||!(1===e.nodeType&&d.contains&&d.contains(e)))}:ca.compareDocumentPosition?function(b,c){return c&&!!(b.compareDocumentPosition(c)&16)}:function(b,c){for(;c=c.parentNode;)if(c===b)return!0;
return!1};I.attr=function(b,c){var d,e=Ta(b);return e||(c=c.toLowerCase()),(d=L.attrHandle[c])?d(b):e||bd?b.getAttribute(c):(d=b.getAttributeNode(c),d?"boolean"==typeof b[c]?b[c]?c:null:d.specified?d.value:null:null)};L=I.selectors={cacheLength:50,createPseudo:ea,match:Wa,attrHandle:ad?{}:{href:function(b){return b.getAttribute("href",2)},type:function(b){return b.getAttribute("type")}},find:{ID:vb?function(b,c,d){if("undefined"!==typeof c.getElementById&&!d)return(b=c.getElementById(b))&&b.parentNode?
[b]:[]}:function(b,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=c.getElementById(b))?c.id===b||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").value===b?[c]:void 0:[]},TAG:$c?function(b,c){if("undefined"!==typeof c.getElementsByTagName)return c.getElementsByTagName(b)}:function(b,c){var d=c.getElementsByTagName(b);if("*"===b){for(var e,f=[],g=0;e=d[g];g++)1===e.nodeType&&f.push(e);return f}return d},NAME:cd&&function(b,c){if("undefined"!==typeof c.getElementsByName)return c.getElementsByName(name)},
CLASS:Vb&&function(b,c,d){if("undefined"!==typeof c.getElementsByClassName&&!d)return c.getElementsByClassName(b)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(sa,""),b[3]=(b[4]||b[5]||"").replace(sa,""),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1]?(b[2]||I.error(b[0]),b[3]=+(b[3]?b[4]+(b[5]||1):
2*("even"===b[2]||"odd"===b[2])),b[4]=+(b[6]+b[7]||"odd"===b[2])):b[2]&&I.error(b[0]),b},PSEUDO:function(b){var c,d;if(Wa.CHILD.test(b[0]))return null;if(b[3])b[2]=b[3];else if(c=b[4])Xc.test(c)&&(d=Xa(c,!0))&&(d=c.indexOf(")",c.length-d)-c.length)&&(c=c.slice(0,d),b[0]=b[0].slice(0,d)),b[2]=c;return b.slice(0,3)}},filter:{ID:vb?function(b){return b=b.replace(sa,""),function(c){return c.getAttribute("id")===b}}:function(b){return b=b.replace(sa,""),function(c){return(c="undefined"!==typeof c.getAttributeNode&&
c.getAttributeNode("id"))&&c.value===b}},TAG:function(b){return"*"===b?function(){return!0}:(b=b.replace(sa,"").toLowerCase(),function(c){return c.nodeName&&c.nodeName.toLowerCase()===b})},CLASS:function(b){var c=bc[R][b];return c||(c=bc(b,RegExp("(^|[\\x20\\t\\r\\n\\f])"+b+"([\\x20\\t\\r\\n\\f]|$)"))),function(b){return c.test(b.className||"undefined"!==typeof b.getAttribute&&b.getAttribute("class")||"")}},ATTR:function(b,c,d){return function(e){e=I.attr(e,b);return null==e?"!="===c:c?(e+="","="===
c?e===d:"!="===c?e!==d:"^="===c?d&&0===e.indexOf(d):"*="===c?d&&-1<e.indexOf(d):"$="===c?d&&e.substr(e.length-d.length)===d:"~="===c?-1<(" "+e+" ").indexOf(d):"|="===c?e===d||e.substr(0,d.length+1)===d+"-":!1):!0}},CHILD:function(b,c,d,e){return"nth"===b?function(b){var c,f;c=b.parentNode;if(1===d&&0===e)return!0;if(c){f=0;for(c=c.firstChild;c&&!(1===c.nodeType&&(f++,b===c));c=c.nextSibling);}return f-=e,f===d||0===f%d&&0<=f/d}:function(c){var d=c;switch(b){case "only":case "first":for(;d=d.previousSibling;)if(1===
d.nodeType)return!1;if("first"===b)return!0;d=c;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0}}},PSEUDO:function(b,c){var d,e=L.pseudos[b]||L.setFilters[b.toLowerCase()]||I.error("unsupported pseudo: "+b);return e[R]?e(c):1<e.length?(d=[b,b,"",c],L.setFilters.hasOwnProperty(b.toLowerCase())?ea(function(b,d){for(var f,g=e(b,c),m=g.length;m--;)f=Zb.call(b,g[m]),b[f]=!(d[f]=g[m])}):function(b){return e(b,0,d)}):e}},pseudos:{not:ea(function(b){var c=[],d=[],e=ub(b.replace(Ua,"$1"));
return e[R]?ea(function(b,c,d,f){f=e(b,null,f,[]);for(var g=b.length;g--;)if(d=f[g])b[g]=!(c[g]=d)}):function(b,f,g){return c[0]=b,e(c,null,g,d),!d.pop()}}),has:ea(function(b){return function(c){return 0<I(b,c).length}}),contains:ea(function(b){return function(c){return-1<(c.textContent||c.innerText||$a(c)).indexOf(b)}}),enabled:function(b){return!1===b.disabled},disabled:function(b){return!0===b.disabled},checked:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&!!b.checked||"option"===
c&&!!b.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,!0===b.selected},parent:function(b){return!L.pseudos.empty(b)},empty:function(b){var c;for(b=b.firstChild;b;){if("@"<b.nodeName||3===(c=b.nodeType)||4===c)return!1;b=b.nextSibling}return!0},header:function(b){return Yc.test(b.nodeName)},text:function(b){var c,d;return"input"===b.nodeName.toLowerCase()&&"text"===(c=b.type)&&(null==(d=b.getAttribute("type"))||d.toLowerCase()===c)},radio:Fa("radio"),checkbox:Fa("checkbox"),
file:Fa("file"),password:Fa("password"),image:Fa("image"),submit:Wb("submit"),reset:Wb("reset"),button:function(b){var c=b.nodeName.toLowerCase();return"input"===c&&"button"===b.type||"button"===c},input:function(b){return Zc.test(b.nodeName)},focus:function(b){var c=b.ownerDocument;return b===c.activeElement&&(!c.hasFocus||c.hasFocus())&&(!!b.type||!!b.href)},active:function(b){return b===b.ownerDocument.activeElement},first:ra(function(){return[0]}),last:ra(function(b,c){return[c-1]}),eq:ra(function(b,
c,d){return[0>d?d+c:d]}),even:ra(function(b,c){for(var d=0;d<c;d+=2)b.push(d);return b}),odd:ra(function(b,c){for(var d=1;d<c;d+=2)b.push(d);return b}),lt:ra(function(b,c,d){for(c=0>d?d+c:d;0<=--c;)b.push(c);return b}),gt:ra(function(b,c,d){for(d=0>d?d+c:d;++d<c;)b.push(d);return b})}};wb=ca.compareDocumentPosition?function(b,c){return b===c?(Ha=!0,0):(!b.compareDocumentPosition||!c.compareDocumentPosition?b.compareDocumentPosition:b.compareDocumentPosition(c)&4)?-1:1}:function(b,c){if(b===c)return Ha=
!0,0;if(b.sourceIndex&&c.sourceIndex)return b.sourceIndex-c.sourceIndex;var d,e,f=[],g=[];d=b.parentNode;e=c.parentNode;var m=d;if(d===e)return Va(b,c);if(!d)return-1;if(!e)return 1;for(;m;)f.unshift(m),m=m.parentNode;for(m=e;m;)g.unshift(m),m=m.parentNode;d=f.length;e=g.length;for(m=0;m<d&&m<e;m++)if(f[m]!==g[m])return Va(f[m],g[m]);return m===d?Va(b,g[m],-1):Va(f[m],c,1)};[0,0].sort(wb);ac=!Ha;I.uniqueSort=function(b){var c,d=1;Ha=ac;b.sort(wb);if(Ha)for(;c=b[d];d++)c===b[d-1]&&b.splice(d--,1);
return b};I.error=function(b){throw Error("Syntax error, unrecognized expression: "+b);};ub=I.compile=function(b,c){var d,e=[],f=[],g=cc[R][b];if(!g){c||(c=Xa(b));for(d=c.length;d--;)g=sb(c[d]),g[R]?e.push(g):f.push(g);var m=0<e.length,l=0<f.length,p=function(b,c,d,g,n){var q,r,t=[],G=0,v="0",s=b&&[],u=null!=n,S=Za,fa=b||l&&L.find.TAG("*",n&&c.parentNode||c),x=Ga+=null==S?1:Math.E;for(u&&(Za=c!==da&&c,ob=p.el);null!=(n=fa[v]);v++){if(l&&n){for(q=0;r=f[q];q++)if(r(n,c,d)){g.push(n);break}u&&(Ga=x,
ob=++p.el)}m&&((n=!r&&n)&&G--,b&&s.push(n))}G+=v;if(m&&v!==G){for(q=0;r=e[q];q++)r(s,t,c,d);if(b){if(0<G)for(;v--;)!s[v]&&!t[v]&&(t[v]=Wc.call(g));t=Ya(t)}ya.apply(g,t);u&&!b&&0<t.length&&1<G+e.length&&I.uniqueSort(g)}return u&&(Ga=x,Za=S),s};d=(p.el=0,m?ea(p):p);g=cc(b,d)}return g};if(da.querySelectorAll){var ec,dd=nb,ed=/'|\\/g,fd=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,ha=[":focus"],ab=[":active",":focus"],bb=ca.matchesSelector||ca.mozMatchesSelector||ca.webkitMatchesSelector||ca.oMatchesSelector||
ca.msMatchesSelector;la(function(b){b.innerHTML="<select><option selected=''></option></select>";b.querySelectorAll("[selected]").length||ha.push("\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)");b.querySelectorAll(":checked").length||ha.push(":checked")});la(function(b){b.innerHTML="<p test=''></p>";b.querySelectorAll("[test^='']").length&&ha.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");b.innerHTML="<input type='hidden'/>";b.querySelectorAll(":enabled").length||
ha.push(":enabled",":disabled")});ha=RegExp(ha.join("|"));nb=function(b,c,d,e,f){if(!e&&!f&&(!ha||!ha.test(b))){var g,m,l=!0,p=R;m=c;g=9===c.nodeType&&b;if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){g=Xa(b);(l=c.getAttribute("id"))?p=l.replace(ed,"\\$&"):c.setAttribute("id",p);p="[id='"+p+"'] ";for(m=g.length;m--;)g[m]=p+g[m].join("");m=tb.test(b)&&c.parentNode||c;g=g.join(",")}if(g)try{return ya.apply(d,za.call(m.querySelectorAll(g),0)),d}catch(n){}finally{l||c.removeAttribute("id")}}return dd(b,
c,d,e,f)};bb&&(la(function(b){ec=bb.call(b,"div");try{bb.call(b,"[test!='']:sizzle"),ab.push("!=",yb)}catch(c){}}),ab=RegExp(ab.join("|")),I.matchesSelector=function(b,c){c=c.replace(fd,"='$1']");if(!Ta(b)&&!ab.test(c)&&(!ha||!ha.test(c)))try{var d=bb.call(b,c);if(d||ec||b.document&&11!==b.document.nodeType)return d}catch(e){}return 0<I(c,null,null,[b]).length})}L.pseudos.nth=L.pseudos.eq;L.filters=$b.prototype=L.pseudos;L.setFilters=new $b;I.attr=p.attr;p.find=I;p.expr=I.selectors;p.expr[":"]=p.expr.pseudos;
p.unique=I.uniqueSort;p.text=I.getText;p.isXMLDoc=I.isXML;p.contains=I.contains;var gd=/Until$/,hd=/^(?:parents|prev(?:Until|All))/,xc=/^.[^:#\[\.,]*$/,fc=p.expr.match.needsContext,jd={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(b){var c,d,e,f,g,m,l=this;if("string"!=typeof b)return p(b).filter(function(){c=0;for(d=l.length;c<d;c++)if(p.contains(l[c],this))return!0});m=this.pushStack("","find",b);c=0;for(d=this.length;c<d;c++)if(e=m.length,p.find(b,this[c],m),0<c)for(f=e;f<
m.length;f++)for(g=0;g<e;g++)if(m[g]===m[f]){m.splice(f--,1);break}return m},has:function(b){var c,d=p(b,this),e=d.length;return this.filter(function(){for(c=0;c<e;c++)if(p.contains(this,d[c]))return!0})},not:function(b){return this.pushStack(m(this,b,!1),"not",b)},filter:function(b){return this.pushStack(m(this,b,!0),"filter",b)},is:function(b){return!!b&&("string"==typeof b?fc.test(b)?0<=p(b,this.context).index(this[0]):0<p.filter(b,this).length:0<this.filter(b).length)},closest:function(b,c){for(var d,
e=0,f=this.length,g=[],m=fc.test(b)||"string"!=typeof b?p(b,c||this.context):0;e<f;e++)for(d=this[e];d&&d.ownerDocument&&d!==c&&11!==d.nodeType;){if(m?-1<m.index(d):p.find.matchesSelector(d,b)){g.push(d);break}d=d.parentNode}return g=1<g.length?p.unique(g):g,this.pushStack(g,"closest",b)},index:function(b){return b?"string"==typeof b?p.inArray(this[0],p(b)):p.inArray(b.jquery?b[0]:b,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(b,c){var d="string"==typeof b?p(b,c):p.makeArray(b&&
b.nodeType?[b]:b),e=p.merge(this.get(),d);return this.pushStack(n(d[0])||n(e[0])?e:p.unique(e))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}});p.fn.andSelf=p.fn.addBack;p.each({parent:function(b){return(b=b.parentNode)&&11!==b.nodeType?b:null},parents:function(b){return p.dir(b,"parentNode")},parentsUntil:function(b,c,d){return p.dir(b,"parentNode",d)},next:function(b){return l(b,"nextSibling")},prev:function(b){return l(b,"previousSibling")},nextAll:function(b){return p.dir(b,
"nextSibling")},prevAll:function(b){return p.dir(b,"previousSibling")},nextUntil:function(b,c,d){return p.dir(b,"nextSibling",d)},prevUntil:function(b,c,d){return p.dir(b,"previousSibling",d)},siblings:function(b){return p.sibling((b.parentNode||{}).firstChild,b)},children:function(b){return p.sibling(b.firstChild)},contents:function(b){return p.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:p.merge([],b.childNodes)}},function(b,c){p.fn[b]=function(d,e){var f=p.map(this,c,d);return gd.test(b)||
(e=d),e&&"string"==typeof e&&(f=p.filter(e,f)),f=1<this.length&&!jd[b]?p.unique(f):f,1<this.length&&hd.test(b)&&(f=f.reverse()),this.pushStack(f,b,Y.call(arguments).join(","))}});p.extend({filter:function(b,c,d){return d&&(b=":not("+b+")"),1===c.length?p.find.matchesSelector(c[0],b)?[c[0]]:[]:p.find.matches(b,c)},dir:function(b,d,e){var f=[];for(b=b[d];b&&9!==b.nodeType&&(e===c||1!==b.nodeType||!p(b).is(e));)1===b.nodeType&&f.push(b),b=b[d];return f},sibling:function(b,c){for(var d=[];b;b=b.nextSibling)1===
b.nodeType&&b!==c&&d.push(b);return d}});var Fb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",kd=/ jQuery\d+="(?:null|\d+)"/g,zb=/^\s+/,gc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,hc=/<([\w:]+)/,ld=/<tbody/i,md=/<|&#?\w+;/,nd=/<(?:script|style|link)/i,od=/<(?:script|object|embed|option|style)/i,Ab=RegExp("<(?:"+Fb+")[\\s/>]","i"),Gb=/^(?:checkbox|radio)$/,
ic=/checked\s*(?:[^=]|=\s*.checked.)/i,pd=/\/(java|ecma)script/i,qd=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,ba={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},jc=r(y),Bb=jc.appendChild(y.createElement("div"));ba.optgroup=
ba.option;ba.tbody=ba.tfoot=ba.colgroup=ba.caption=ba.thead;ba.th=ba.td;p.support.htmlSerialize||(ba._default=[1,"X<div>","</div>"]);p.fn.extend({text:function(b){return p.access(this,function(b){return b===c?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(b))},null,b,arguments.length)},wrapAll:function(b){if(p.isFunction(b))return this.each(function(c){p(this).wrapAll(b.call(this,c))});if(this[0]){var c=p(b,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&
c.insertBefore(this[0]);c.map(function(){for(var b=this;b.firstChild&&1===b.firstChild.nodeType;)b=b.firstChild;return b}).append(this)}return this},wrapInner:function(b){return p.isFunction(b)?this.each(function(c){p(this).wrapInner(b.call(this,c))}):this.each(function(){var c=p(this),d=c.contents();d.length?d.wrapAll(b):c.append(b)})},wrap:function(b){var c=p.isFunction(b);return this.each(function(d){p(this).wrapAll(c?b.call(this,d):b)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,
"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(b){(1===this.nodeType||11===this.nodeType)&&this.appendChild(b)})},prepend:function(){return this.domManip(arguments,!0,function(b){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(b,this.firstChild)})},before:function(){if(!n(this[0]))return this.domManip(arguments,!1,function(b){this.parentNode.insertBefore(b,this)});if(arguments.length){var b=p.clean(arguments);return this.pushStack(p.merge(b,
this),"before",this.selector)}},after:function(){if(!n(this[0]))return this.domManip(arguments,!1,function(b){this.parentNode.insertBefore(b,this.nextSibling)});if(arguments.length){var b=p.clean(arguments);return this.pushStack(p.merge(this,b),"after",this.selector)}},remove:function(b,c){for(var d,e=0;null!=(d=this[e]);e++)if(!b||p.filter(b,[d]).length)!c&&1===d.nodeType&&(p.cleanData(d.getElementsByTagName("*")),p.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var b,
c=0;null!=(b=this[c]);c++)for(1===b.nodeType&&p.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(b,c){return b=null==b?!1:b,c=null==c?b:c,this.map(function(){return p.clone(this,b,c)})},html:function(b){return p.access(this,function(b){var d=this[0]||{},e=0,f=this.length;if(b===c)return 1===d.nodeType?d.innerHTML.replace(kd,""):c;if("string"==typeof b&&!nd.test(b)&&(p.support.htmlSerialize||!Ab.test(b))&&(p.support.leadingWhitespace||!zb.test(b))&&
!ba[(hc.exec(b)||["",""])[1].toLowerCase()]){b=b.replace(gc,"<$1></$2>");try{for(;e<f;e++)d=this[e]||{},1===d.nodeType&&(p.cleanData(d.getElementsByTagName("*")),d.innerHTML=b);d=0}catch(g){}}d&&this.empty().append(b)},null,b,arguments.length)},replaceWith:function(b){return n(this[0])?this.length?this.pushStack(p(p.isFunction(b)?b():b),"replaceWith",b):this:p.isFunction(b)?this.each(function(c){var d=p(this),e=d.html();d.replaceWith(b.call(this,c,e))}):("string"!=typeof b&&(b=p(b).detach()),this.each(function(){var c=
this.nextSibling,d=this.parentNode;p(this).remove();c?p(c).before(b):p(d).append(b)}))},detach:function(b){return this.remove(b,!0)},domManip:function(b,d,e){b=[].concat.apply([],b);var f,g,m,l=0,n=b[0],q=[],r=this.length;if(!p.support.checkClone&&1<r&&"string"==typeof n&&ic.test(n))return this.each(function(){p(this).domManip(b,d,e)});if(p.isFunction(n))return this.each(function(f){var g=p(this);b[0]=n.call(this,f,d?g.html():c);g.domManip(b,d,e)});if(this[0]){f=p.buildFragment(b,this,q);m=f.fragment;
g=m.firstChild;1===m.childNodes.length&&(m=g);if(g){d=d&&p.nodeName(g,"tr");for(f=f.cacheable||r-1;l<r;l++)e.call(d&&p.nodeName(this[l],"table")?this[l].getElementsByTagName("tbody")[0]||this[l].appendChild(this[l].ownerDocument.createElement("tbody")):this[l],l===f?m:p.clone(m,!0,!0))}m=g=null;q.length&&p.each(q,function(b,c){c.src?p.ajax?p.ajax({url:c.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((c.text||c.textContent||c.innerHTML||"").replace(qd,
""));c.parentNode&&c.parentNode.removeChild(c)})}return this}});p.buildFragment=function(b,d,e){var f,g,m,l=b[0];return d=d||y,d=!d.nodeType&&d[0]||d,d=d.ownerDocument||d,1===b.length&&"string"==typeof l&&512>l.length&&d===y&&"<"===l.charAt(0)&&!od.test(l)&&(p.support.checkClone||!ic.test(l))&&(p.support.html5Clone||!Ab.test(l))&&(g=!0,f=p.fragments[l],m=f!==c),f||(f=d.createDocumentFragment(),p.clean(b,d,f,e),g&&(p.fragments[l]=m&&f)),{fragment:f,cacheable:g}};p.fragments={};p.each({appendTo:"append",
prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){p.fn[b]=function(d){var e,f=0,g=[];d=p(d);var m=d.length;e=1===this.length&&this[0].parentNode;if((null==e||e&&11===e.nodeType&&1===e.childNodes.length)&&1===m)return d[c](this[0]),this;for(;f<m;f++)e=(0<f?this.clone(!0):this).get(),p(d[f])[c](e),g=g.concat(e);return this.pushStack(g,b,d.selector)}});p.extend({clone:function(b,c,d){var e,f,g,m;p.support.html5Clone||p.isXMLDoc(b)||!Ab.test("<"+b.nodeName+
">")?m=b.cloneNode(!0):(Bb.innerHTML=b.outerHTML,Bb.removeChild(m=Bb.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(1===b.nodeType||11===b.nodeType)&&!p.isXMLDoc(b)){s(b,m);e=u(b);f=u(m);for(g=0;e[g];++g)f[g]&&s(e[g],f[g])}if(c&&(q(b,m),d)){e=u(b);f=u(m);for(g=0;e[g];++g)q(e[g],f[g])}return m},clean:function(b,c,d,e){var f,g,m,l,n,q,v,s=c===y&&jc,u=[];if(!c||"undefined"==typeof c.createDocumentFragment)c=y;for(f=0;null!=(m=b[f]);f++)if("number"==typeof m&&(m+=""),m){if("string"==
typeof m)if(md.test(m)){s=s||r(c);q=c.createElement("div");s.appendChild(q);m=m.replace(gc,"<$1></$2>");g=(hc.exec(m)||["",""])[1].toLowerCase();l=ba[g]||ba._default;n=l[0];for(q.innerHTML=l[1]+m+l[2];n--;)q=q.lastChild;if(!p.support.tbody){n=ld.test(m);l="table"===g&&!n?q.firstChild&&q.firstChild.childNodes:"<table>"===l[1]&&!n?q.childNodes:[];for(g=l.length-1;0<=g;--g)p.nodeName(l[g],"tbody")&&!l[g].childNodes.length&&l[g].parentNode.removeChild(l[g])}!p.support.leadingWhitespace&&zb.test(m)&&q.insertBefore(c.createTextNode(zb.exec(m)[0]),
q.firstChild);m=q.childNodes;q.parentNode.removeChild(q)}else m=c.createTextNode(m);m.nodeType?u.push(m):p.merge(u,m)}q&&(m=q=s=null);if(!p.support.appendChecked)for(f=0;null!=(m=u[f]);f++)p.nodeName(m,"input")?t(m):"undefined"!=typeof m.getElementsByTagName&&p.grep(m.getElementsByTagName("input"),t);if(d){b=function(b){if(!b.type||pd.test(b.type))return e?e.push(b.parentNode?b.parentNode.removeChild(b):b):d.appendChild(b)};for(f=0;null!=(m=u[f]);f++)if(!p.nodeName(m,"script")||!b(m))d.appendChild(m),
"undefined"!=typeof m.getElementsByTagName&&(v=p.grep(p.merge([],m.getElementsByTagName("script")),b),u.splice.apply(u,[f+1,0].concat(v)),f+=v.length)}return u},cleanData:function(b,c){for(var d,e,f,g,m=0,l=p.expando,n=p.cache,q=p.support.deleteExpando,r=p.event.special;null!=(f=b[m]);m++)if(c||p.acceptData(f))if(d=(e=f[l])&&n[e]){if(d.events)for(g in d.events)r[g]?p.event.remove(f,g):p.removeEvent(f,g,d.handle);n[e]&&(delete n[e],q?delete f[l]:f.removeAttribute?f.removeAttribute(l):f[l]=null,p.deletedIds.push(e))}}});
var cb,ma;p.uaMatch=function(b){b=b.toLowerCase();b=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||0>b.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return{browser:b[1]||"",version:b[2]||"0"}};cb=p.uaMatch(Da.userAgent);ma={};cb.browser&&(ma[cb.browser]=!0,ma.version=cb.version);ma.chrome?ma.webkit=!0:ma.webkit&&(ma.safari=!0);p.browser=ma;p.sub=function(){function b(c,d){return new b.fn.init(c,
d)}p.extend(!0,b,this);b.superclass=this;b.fn=b.prototype=this();b.fn.constructor=b;b.sub=this.sub;b.fn.init=function(d,e){return e&&e instanceof p&&!(e instanceof b)&&(e=b(e)),p.fn.init.call(this,d,e,c)};b.fn.init.prototype=b.fn;var c=b(y);return b};var W,ua,va,Cb=/alpha\([^)]*\)/i,rd=/opacity=([^)]*)/,sd=/^(top|right|bottom|left)$/,td=/^(none|table(?!-c[ea]).+)/,kc=/^margin/,yc=RegExp("^("+V+")(.*)$","i"),Ja=RegExp("^("+V+")(?!px)[a-z%]+$","i"),ud=RegExp("^([-+])=("+V+")","i"),fb={},vd={position:"absolute",
visibility:"hidden",display:"block"},lc={letterSpacing:0,fontWeight:400},na=["Top","Right","Bottom","Left"],Hb=["Webkit","O","Moz","ms"],wd=p.fn.toggle;p.fn.extend({css:function(b,d){return p.access(this,function(b,d,e){return e!==c?p.style(b,d,e):p.css(b,d)},b,d,1<arguments.length)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(b,c){var d="boolean"==typeof b;return p.isFunction(b)&&p.isFunction(c)?wd.apply(this,arguments):this.each(function(){(d?b:x(this))?p(this).show():
p(this).hide()})}});p.extend({cssHooks:{opacity:{get:function(b,c){if(c){var d=W(b,"opacity");return""===d?"1":d}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(b,d,e,f){if(b&&!(3===b.nodeType||8===b.nodeType||!b.style)){var g,m,l,n=p.camelCase(d),q=b.style;d=p.cssProps[n]||(p.cssProps[n]=v(q,n));l=p.cssHooks[d]||p.cssHooks[n];if(e===c)return l&&"get"in l&&(g=l.get(b,
!1,f))!==c?g:q[d];m=typeof e;"string"===m&&(g=ud.exec(e))&&(e=(g[1]+1)*g[2]+parseFloat(p.css(b,d)),m="number");if(!(null==e||"number"===m&&isNaN(e)))if("number"===m&&!p.cssNumber[n]&&(e+="px"),!l||!("set"in l)||(e=l.set(b,e,f))!==c)try{q[d]=e}catch(r){}}},css:function(b,d,e,f){var g,m,l,n=p.camelCase(d);return d=p.cssProps[n]||(p.cssProps[n]=v(b.style,n)),l=p.cssHooks[d]||p.cssHooks[n],l&&"get"in l&&(g=l.get(b,!0,f)),g===c&&(g=W(b,d)),"normal"===g&&d in lc&&(g=lc[d]),e||f!==c?(m=parseFloat(g),e||
p.isNumeric(m)?m||0:g):g},swap:function(b,c,d){var e,f={};for(e in c)f[e]=b.style[e],b.style[e]=c[e];d=d.call(b);for(e in c)b.style[e]=f[e];return d}});b.getComputedStyle?W=function(c,d){var e,f,g,m,l=b.getComputedStyle(c,null),n=c.style;return l&&(e=l[d],""===e&&!p.contains(c.ownerDocument,c)&&(e=p.style(c,d)),Ja.test(e)&&kc.test(d)&&(f=n.width,g=n.minWidth,m=n.maxWidth,n.minWidth=n.maxWidth=n.width=e,e=l.width,n.width=f,n.minWidth=g,n.maxWidth=m)),e}:y.documentElement.currentStyle&&(W=function(b,
c){var d,e,f=b.currentStyle&&b.currentStyle[c],g=b.style;return null==f&&g&&g[c]&&(f=g[c]),Ja.test(f)&&!sd.test(c)&&(d=g.left,e=b.runtimeStyle&&b.runtimeStyle.left,e&&(b.runtimeStyle.left=b.currentStyle.left),g.left="fontSize"===c?"1em":f,f=g.pixelLeft+"px",g.left=d,e&&(b.runtimeStyle.left=e)),""===f?"auto":f});p.each(["height","width"],function(b,c){p.cssHooks[c]={get:function(b,d,e){if(d)return 0===b.offsetWidth&&td.test(W(b,"display"))?p.swap(b,vd,function(){return A(b,c,e)}):A(b,c,e)},set:function(b,
d,e){return B(b,d,e?F(b,c,e,p.support.boxSizing&&"border-box"===p.css(b,"boxSizing")):0)}}});p.support.opacity||(p.cssHooks.opacity={get:function(b,c){return rd.test((c&&b.currentStyle?b.currentStyle.filter:b.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":c?"1":""},set:function(b,c){var d=b.style,e=b.currentStyle,f=p.isNumeric(c)?"alpha(opacity="+100*c+")":"",g=e&&e.filter||d.filter||"";d.zoom=1;if(1<=c&&(""===p.trim(g.replace(Cb,""))&&d.removeAttribute)&&(d.removeAttribute("filter"),e&&!e.filter))return;
d.filter=Cb.test(g)?g.replace(Cb,f):g+" "+f}});p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(b,c){return p.swap(b,{display:"inline-block"},function(){if(c)return W(b,"marginRight")})}});!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(b,c){p.cssHooks[c]={get:function(b,d){if(d){var e=W(b,c);return Ja.test(e)?p(b).position()[c]+"px":e}}}})});p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(b){return 0===b.offsetWidth&&0===b.offsetHeight||
!p.support.reliableHiddenOffsets&&"none"===(b.style&&b.style.display||W(b,"display"))},p.expr.filters.visible=function(b){return!p.expr.filters.hidden(b)});p.each({margin:"",padding:"",border:"Width"},function(b,c){p.cssHooks[b+c]={expand:function(d){var e="string"==typeof d?d.split(" "):[d],f={};for(d=0;4>d;d++)f[b+na[d]+c]=e[d]||e[d-2]||e[0];return f}};kc.test(b)||(p.cssHooks[b+c].set=B)});var xd=/%20/g,zc=/\[\]$/,mc=/\r?\n/g,yd=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
zd=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||zd.test(this.nodeName)||yd.test(this.type))}).map(function(b,c){var d=p(this).val();return null==d?null:p.isArray(d)?p.map(d,function(b){return{name:c.name,value:b.replace(mc,"\r\n")}}):{name:c.name,value:d.replace(mc,"\r\n")}}).get()}});
p.param=function(b,d){var e,f=[],g=function(b,c){c=p.isFunction(c)?c():null==c?"":c;f[f.length]=encodeURIComponent(b)+"="+encodeURIComponent(c)};d===c&&(d=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(b)||b.jquery&&!p.isPlainObject(b))p.each(b,function(){g(this.name,this.value)});else for(e in b)D(e,b[e],d,g);return f.join("&").replace(xd,"+")};var Aa,ta,Ad=/#.*$/,Bd=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Cd=/^(?:GET|HEAD)$/,Dd=/^\/\//,nc=/\?/,Ed=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
Fd=/([?&])_=[^&]*/,oc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,pc=p.fn.load,gb={},qc={},rc=["*/"]+["*"];try{ta=Na.href}catch(Od){ta=y.createElement("a"),ta.href="",ta=ta.href}Aa=oc.exec(ta.toLowerCase())||[];p.fn.load=function(b,d,e){if("string"!=typeof b&&pc)return pc.apply(this,arguments);if(!this.length)return this;var f,g,m,l=this,n=b.indexOf(" ");return 0<=n&&(f=b.slice(n,b.length),b=b.slice(0,n)),p.isFunction(d)?(e=d,d=c):d&&"object"==typeof d&&(g="POST"),p.ajax({url:b,type:g,dataType:"html",
data:d,complete:function(b,c){e&&l.each(e,m||[b.responseText,c,b])}}).done(function(b){m=arguments;l.html(f?p("<div>").append(b.replace(Ed,"")).find(f):b)}),this};p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b,c){p.fn[c]=function(b){return this.on(c,b)}});p.each(["get","post"],function(b,d){p[d]=function(b,e,f,g){return p.isFunction(e)&&(g=g||f,f=e,e=c),p.ajax({type:d,url:b,data:e,success:f,dataType:g})}});p.extend({getScript:function(b,d){return p.get(b,
c,d,"script")},getJSON:function(b,c,d){return p.get(b,c,d,"json")},ajaxSetup:function(b,c){return c?ia(b,p.ajaxSettings):(c=b,b=p.ajaxSettings),ia(b,c),b},ajaxSettings:{url:ta,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Aa[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":rc},contents:{xml:/xml/,
html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":b.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:N(gb),ajaxTransport:N(qc),ajax:function(b,d){function e(b,d,m,q){var t,G,S,B,D,Q=d;if(2!==V){V=2;n&&clearTimeout(n);l=c;g=q||"";A.readyState=0<b?4:0;if(m){B=v;q=A;var J,P,fa,C,N=B.contents,U=B.dataTypes,y=B.responseFields;for(P in y)P in m&&(q[y[P]]=m[P]);for(;"*"===U[0];)U.shift(),
J===c&&(J=B.mimeType||q.getResponseHeader("content-type"));if(J)for(P in N)if(N[P]&&N[P].test(J)){U.unshift(P);break}if(U[0]in m)fa=U[0];else{for(P in m){if(!U[0]||B.converters[P+" "+U[0]]){fa=P;break}C||(C=P)}fa=fa||C}m=fa?(fa!==U[0]&&U.unshift(fa),m[fa]):void 0;B=m}if(200<=b&&300>b||304===b)if(v.ifModified&&(D=A.getResponseHeader("Last-Modified"),D&&(p.lastModified[f]=D),D=A.getResponseHeader("Etag"),D&&(p.etag[f]=D)),304===b)Q="notmodified",t=!0;else{var H;a:{t=v;G=B;var Ia,Q=t.dataTypes.slice();
m=Q[0];J={};P=0;t.dataFilter&&(G=t.dataFilter(G,t.dataType));if(Q[1])for(H in t.converters)J[H.toLowerCase()]=t.converters[H];for(;S=Q[++P];)if("*"!==S){if("*"!==m&&m!==S){H=J[m+" "+S]||J["* "+S];if(!H)for(Ia in J)if(D=Ia.split(" "),D[1]===S&&(H=J[m+" "+D[0]]||J["* "+D[0]])){!0===H?H=J[Ia]:!0!==J[Ia]&&(S=D[0],Q.splice(P--,0,S));break}if(!0!==H)if(H&&t["throws"])G=H(G);else try{G=H(G)}catch(z){H={state:"parsererror",error:H?z:"No conversion from "+m+" to "+S};break a}}m=S}H={state:"success",data:G}}t=
H;Q=t.state;G=t.data;S=t.error;t=!S}else if(S=Q,!Q||b)Q="error",0>b&&(b=0);A.status=b;A.statusText=(d||Q)+"";t?x.resolveWith(s,[G,Q,A]):x.rejectWith(s,[A,Q,S]);A.statusCode(F);F=c;r&&u.trigger("ajax"+(t?"Success":"Error"),[A,v,t?G:S]);E.fireWith(s,[A,Q]);r&&(u.trigger("ajaxComplete",[A,v]),--p.active||p.event.trigger("ajaxStop"))}}"object"==typeof b&&(d=b,b=c);d=d||{};var f,g,m,l,n,q,r,t,v=p.ajaxSetup({},d),s=v.context||v,u=s!==v&&(s.nodeType||s instanceof p)?p(s):p.event,x=p.Deferred(),E=p.Callbacks("once memory"),
F=v.statusCode||{},B={},D={},V=0,Q="canceled",A={readyState:0,setRequestHeader:function(b,c){if(!V){var d=b.toLowerCase();b=D[d]=D[d]||b;B[b]=c}return this},getAllResponseHeaders:function(){return 2===V?g:null},getResponseHeader:function(b){var d;if(2===V){if(!m)for(m={};d=Bd.exec(g);)m[d[1].toLowerCase()]=d[2];d=m[b.toLowerCase()]}return d===c?null:d},overrideMimeType:function(b){return V||(v.mimeType=b),this},abort:function(b){return b=b||Q,l&&l.abort(b),e(0,b),this}};x.promise(A);A.success=A.done;
A.error=A.fail;A.complete=E.add;A.statusCode=function(b){if(b){var c;if(2>V)for(c in b)F[c]=[F[c],b[c]];else c=b[A.status],A.always(c)}return this};v.url=((b||v.url)+"").replace(Ad,"").replace(Dd,Aa[1]+"//");v.dataTypes=p.trim(v.dataType||"*").toLowerCase().split(U);null==v.crossDomain&&(q=oc.exec(v.url.toLowerCase())||!1,v.crossDomain=q&&q.join(":")+(q[3]?"":"http:"===q[1]?80:443)!==Aa.join(":")+(Aa[3]?"":"http:"===Aa[1]?80:443));v.data&&v.processData&&"string"!=typeof v.data&&(v.data=p.param(v.data,
v.traditional));C(gb,v,d,A);if(2===V)return A;r=v.global;v.type=v.type.toUpperCase();v.hasContent=!Cd.test(v.type);r&&0===p.active++&&p.event.trigger("ajaxStart");if(!v.hasContent&&(v.data&&(v.url+=(nc.test(v.url)?"&":"?")+v.data,delete v.data),f=v.url,!1===v.cache)){q=p.now();var J=v.url.replace(Fd,"$1_="+q);v.url=J+(J===v.url?(nc.test(v.url)?"&":"?")+"_="+q:"")}(v.data&&v.hasContent&&!1!==v.contentType||d.contentType)&&A.setRequestHeader("Content-Type",v.contentType);v.ifModified&&(f=f||v.url,p.lastModified[f]&&
A.setRequestHeader("If-Modified-Since",p.lastModified[f]),p.etag[f]&&A.setRequestHeader("If-None-Match",p.etag[f]));A.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+rc+"; q=0.01":""):v.accepts["*"]);for(t in v.headers)A.setRequestHeader(t,v.headers[t]);if(!v.beforeSend||!1!==v.beforeSend.call(s,A,v)&&2!==V){Q="abort";for(t in{success:1,error:1,complete:1})A[t](v[t]);if(l=C(qc,v,d,A)){A.readyState=1;r&&u.trigger("ajaxSend",[A,
v]);v.async&&0<v.timeout&&(n=setTimeout(function(){A.abort("timeout")},v.timeout));try{V=1,l.send(B,e)}catch(P){if(2>V)e(-1,P);else throw P;}}else e(-1,"No Transport");return A}return A.abort()},active:0,lastModified:{},etag:{}});var sc=[],Gd=/\?/,db=/(=)\?(?=&|$)|\?\?/,Hd=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=sc.pop()||p.expando+"_"+Hd++;return this[b]=!0,b}});p.ajaxPrefilter("json jsonp",function(d,e,f){var g,m,l,n=d.data,q=d.url,r=!1!==d.jsonp,t=r&&db.test(q),v=r&&
!t&&"string"==typeof n&&!(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&db.test(n);if("jsonp"===d.dataTypes[0]||t||v)return g=d.jsonpCallback=p.isFunction(d.jsonpCallback)?d.jsonpCallback():d.jsonpCallback,m=b[g],t?d.url=q.replace(db,"$1"+g):v?d.data=n.replace(db,"$1"+g):r&&(d.url+=(Gd.test(q)?"&":"?")+d.jsonp+"="+g),d.converters["script json"]=function(){return l||p.error(g+" was not called"),l[0]},d.dataTypes[0]="json",b[g]=function(){l=arguments},f.always(function(){b[g]=m;d[g]&&
(d.jsonpCallback=e.jsonpCallback,sc.push(g));l&&p.isFunction(m)&&m(l[0]);l=m=c}),"script"});p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(b){return p.globalEval(b),b}}});p.ajaxPrefilter("script",function(b){b.cache===c&&(b.cache=!1);b.crossDomain&&(b.type="GET",b.global=!1)});p.ajaxTransport("script",function(b){if(b.crossDomain){var d,e=y.head||
y.getElementsByTagName("head")[0]||y.documentElement;return{send:function(f,g){d=y.createElement("script");d.async="async";b.scriptCharset&&(d.charset=b.scriptCharset);d.src=b.url;d.onload=d.onreadystatechange=function(b,f){if(f||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=c,f||g(200,"success")};e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var Ba,Db=b.ActiveXObject?function(){for(var b in Ba)Ba[b](0,
1)}:!1,Id=0;p.ajaxSettings.xhr=b.ActiveXObject?function(){var c;if(!(c=!this.isLocal&&H()))a:{try{c=new b.ActiveXObject("Microsoft.XMLHTTP");break a}catch(d){}c=void 0}return c}:H;var Eb=p.ajaxSettings.xhr();p.extend(p.support,{ajax:!!Eb,cors:!!Eb&&"withCredentials"in Eb});p.support.ajax&&p.ajaxTransport(function(d){if(!d.crossDomain||p.support.cors){var e;return{send:function(f,g){var m,l,n=d.xhr();d.username?n.open(d.type,d.url,d.async,d.username,d.password):n.open(d.type,d.url,d.async);if(d.xhrFields)for(l in d.xhrFields)n[l]=
d.xhrFields[l];d.mimeType&&n.overrideMimeType&&n.overrideMimeType(d.mimeType);!d.crossDomain&&!f["X-Requested-With"]&&(f["X-Requested-With"]="XMLHttpRequest");try{for(l in f)n.setRequestHeader(l,f[l])}catch(q){}n.send(d.hasContent&&d.data||null);e=function(b,f){var l,q,r,t,v;try{if(e&&(f||4===n.readyState))if(e=c,m&&(n.onreadystatechange=p.noop,Db&&delete Ba[m]),f)4!==n.readyState&&n.abort();else{l=n.status;r=n.getAllResponseHeaders();t={};(v=n.responseXML)&&v.documentElement&&(t.xml=v);try{t.text=
n.responseText}catch(s){}try{q=n.statusText}catch(u){q=""}!l&&d.isLocal&&!d.crossDomain?l=t.text?200:404:1223===l&&(l=204)}}catch(x){f||g(-1,x)}t&&g(l,q,t,r)};d.async?4===n.readyState?setTimeout(e,0):(m=++Id,Db&&(Ba||(Ba={},p(b).unload(Db)),Ba[m]=e),n.onreadystatechange=e):e()},abort:function(){e&&e(0,1)}}}});var Ka,eb,Jd=/^(?:toggle|show|hide)$/,Kd=RegExp("^(?:([-+])=|)("+V+")([a-z%]*)$","i"),Ld=/queueHooks$/,La=[function(b,c,d){var e,f,g,m,l,n,q=this,r=b.style,t={},v=[],s=b.nodeType&&x(b);d.queue||
(l=p._queueHooks(b,"fx"),null==l.unqueued&&(l.unqueued=0,n=l.empty.fire,l.empty.fire=function(){l.unqueued||n()}),l.unqueued++,q.always(function(){q.always(function(){l.unqueued--;p.queue(b,"fx").length||l.empty.fire()})}));1===b.nodeType&&("height"in c||"width"in c)&&(d.overflow=[r.overflow,r.overflowX,r.overflowY],"inline"===p.css(b,"display")&&"none"===p.css(b,"float")&&(!p.support.inlineBlockNeedsLayout||"inline"===J(b.nodeName)?r.display="inline-block":r.zoom=1));d.overflow&&(r.overflow="hidden",
p.support.shrinkWrapBlocks||q.done(function(){r.overflow=d.overflow[0];r.overflowX=d.overflow[1];r.overflowY=d.overflow[2]}));for(e in c)f=c[e],Jd.exec(f)&&(delete c[e],f!==(s?"hide":"show")&&v.push(e));if(f=v.length){g=p._data(b,"fxshow")||p._data(b,"fxshow",{});s?p(b).show():q.done(function(){p(b).hide()});q.done(function(){var c;p.removeData(b,"fxshow",!0);for(c in t)p.style(b,c,t[c])});for(e=0;e<f;e++)c=v[e],m=q.createTween(c,s?g[c]:0),t[c]=g[c]||p.style(b,c),c in g||(g[c]=m.start,s&&(m.end=m.start,
m.start="width"===c||"height"===c?1:0))}}],Ca={"*":[function(b,c){var d,e,f=this.createTween(b,c),g=Kd.exec(c),m=f.cur(),l=+m||0,n=1,q=20;if(g){d=+g[2];e=g[3]||(p.cssNumber[b]?"":"px");if("px"!==e&&l){l=p.css(f.elem,b,!0)||d||1;do n=n||".5",l/=n,p.style(f.elem,b,l+e);while(n!==(n=f.cur()/m)&&1!==n&&--q)}f.unit=e;f.start=l;f.end=g[1]?l+(g[1]+1)*d:d}return f}]};p.Animation=p.extend(hb,{tweener:function(b,c){p.isFunction(b)?(c=b,b=["*"]):b=b.split(" ");for(var d,e=0,f=b.length;e<f;e++)d=b[e],Ca[d]=Ca[d]||
[],Ca[d].unshift(c)},prefilter:function(b,c){c?La.unshift(b):La.push(b)}});p.Tween=O;O.prototype={constructor:O,init:function(b,c,d,e,f,g){this.elem=b;this.prop=d;this.easing=f||"swing";this.options=c;this.start=this.now=this.cur();this.end=e;this.unit=g||(p.cssNumber[d]?"":"px")},cur:function(){var b=O.propHooks[this.prop];return b&&b.get?b.get(this):O.propHooks._default.get(this)},run:function(b){var c,d=O.propHooks[this.prop];return this.options.duration?this.pos=c=p.easing[this.easing](b,this.options.duration*
b,0,1,this.options.duration):this.pos=c=b,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):O.propHooks._default.set(this),this}};O.prototype.init.prototype=O.prototype;O.propHooks={_default:{get:function(b){var c;return null==b.elem[b.prop]||b.elem.style&&null!=b.elem.style[b.prop]?(c=p.css(b.elem,b.prop,!1,""),!c||"auto"===c?0:c):b.elem[b.prop]},set:function(b){p.fx.step[b.prop]?p.fx.step[b.prop](b):b.elem.style&&
(null!=b.elem.style[p.cssProps[b.prop]]||p.cssHooks[b.prop])?p.style(b.elem,b.prop,b.now+b.unit):b.elem[b.prop]=b.now}}};O.propHooks.scrollTop=O.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}};p.each(["toggle","show","hide"],function(b,c){var d=p.fn[c];p.fn[c]=function(e,f,g){return null==e||"boolean"==typeof e||!b&&p.isFunction(e)&&p.isFunction(f)?d.apply(this,arguments):this.animate(X(c,!0),e,f,g)}});p.fn.extend({fadeTo:function(b,c,d,e){return this.filter(x).css("opacity",
0).show().end().animate({opacity:c},b,d,e)},animate:function(b,c,d,e){var f=p.isEmptyObject(b),g=p.speed(c,d,e);c=function(){var c=hb(this,p.extend({},b),g);f&&c.stop(!0)};return f||!1===g.queue?this.each(c):this.queue(g.queue,c)},stop:function(b,d,e){var f=function(b){var c=b.stop;delete b.stop;c(e)};return"string"!=typeof b&&(e=d,d=b,b=c),d&&!1!==b&&this.queue(b||"fx",[]),this.each(function(){var c=!0,d=null!=b&&b+"queueHooks",g=p.timers,m=p._data(this);if(d)m[d]&&m[d].stop&&f(m[d]);else for(d in m)m[d]&&
m[d].stop&&Ld.test(d)&&f(m[d]);for(d=g.length;d--;)g[d].elem===this&&(null==b||g[d].queue===b)&&(g[d].anim.stop(e),c=!1,g.splice(d,1));(c||!e)&&p.dequeue(this,b)})}});p.each({slideDown:X("show"),slideUp:X("hide"),slideToggle:X("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,c){p.fn[b]=function(b,d,e){return this.animate(c,b,d,e)}});p.speed=function(b,c,d){var e=b&&"object"==typeof b?p.extend({},b):{complete:d||!d&&c||p.isFunction(b)&&b,duration:b,
easing:d&&c||c&&!p.isFunction(c)&&c};e.duration=p.fx.off?0:"number"==typeof e.duration?e.duration:e.duration in p.fx.speeds?p.fx.speeds[e.duration]:p.fx.speeds._default;if(null==e.queue||!0===e.queue)e.queue="fx";return e.old=e.complete,e.complete=function(){p.isFunction(e.old)&&e.old.call(this);e.queue&&p.dequeue(this,e.queue)},e};p.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2}};p.timers=[];p.fx=O.prototype.init;p.fx.tick=function(){for(var b,c=p.timers,
d=0;d<c.length;d++)b=c[d],!b()&&c[d]===b&&c.splice(d--,1);c.length||p.fx.stop()};p.fx.timer=function(b){b()&&p.timers.push(b)&&!eb&&(eb=setInterval(p.fx.tick,p.fx.interval))};p.fx.interval=13;p.fx.stop=function(){clearInterval(eb);eb=null};p.fx.speeds={slow:600,fast:200,_default:400};p.fx.step={};p.expr&&p.expr.filters&&(p.expr.filters.animated=function(b){return p.grep(p.timers,function(c){return b===c.elem}).length});var tc=/^(?:body|html)$/i;p.fn.offset=function(b){if(arguments.length)return b===
c?this:this.each(function(c){p.offset.setOffset(this,b,c)});var d,e,f,g,m,l,n,q={top:0,left:0},r=this[0],t=r&&r.ownerDocument;if(t)return(e=t.body)===r?p.offset.bodyOffset(r):(d=t.documentElement,p.contains(d,r)?("undefined"!=typeof r.getBoundingClientRect&&(q=r.getBoundingClientRect()),f=Ma(t),g=d.clientTop||e.clientTop||0,m=d.clientLeft||e.clientLeft||0,l=f.pageYOffset||d.scrollTop,n=f.pageXOffset||d.scrollLeft,{top:q.top+l-g,left:q.left+n-m}):q)};p.offset={bodyOffset:function(b){var c=b.offsetTop,
d=b.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(c+=parseFloat(p.css(b,"marginTop"))||0,d+=parseFloat(p.css(b,"marginLeft"))||0),{top:c,left:d}},setOffset:function(b,c,d){var e=p.css(b,"position");"static"===e&&(b.style.position="relative");var f=p(b),g=f.offset(),m=p.css(b,"top"),l=p.css(b,"left"),n={},q={},r,t;("absolute"===e||"fixed"===e)&&-1<p.inArray("auto",[m,l])?(q=f.position(),r=q.top,t=q.left):(r=parseFloat(m)||0,t=parseFloat(l)||0);p.isFunction(c)&&(c=c.call(b,d,g));null!=
c.top&&(n.top=c.top-g.top+r);null!=c.left&&(n.left=c.left-g.left+t);"using"in c?c.using.call(b,n):f.css(n)}};p.fn.extend({position:function(){if(this[0]){var b=this[0],c=this.offsetParent(),d=this.offset(),e=tc.test(c[0].nodeName)?{top:0,left:0}:c.offset();return d.top-=parseFloat(p.css(b,"marginTop"))||0,d.left-=parseFloat(p.css(b,"marginLeft"))||0,e.top+=parseFloat(p.css(c[0],"borderTopWidth"))||0,e.left+=parseFloat(p.css(c[0],"borderLeftWidth"))||0,{top:d.top-e.top,left:d.left-e.left}}},offsetParent:function(){return this.map(function(){for(var b=
this.offsetParent||y.body;b&&!tc.test(b.nodeName)&&"static"===p.css(b,"position");)b=b.offsetParent;return b||y.body})}});p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,d){var e=/Y/.test(d);p.fn[b]=function(f){return p.access(this,function(b,f,g){var m=Ma(b);if(g===c)return m?d in m?m[d]:m.document.documentElement[f]:b[f];m?m.scrollTo(e?p(m).scrollLeft():g,e?g:p(m).scrollTop()):b[f]=g},b,f,arguments.length,null)}});p.each({Height:"height",Width:"width"},function(b,d){p.each({padding:"inner"+
b,content:d,"":"outer"+b},function(e,f){p.fn[f]=function(f,g){var m=arguments.length&&(e||"boolean"!=typeof f),l=e||(!0===f||!0===g?"margin":"border");return p.access(this,function(d,e,f){var g;return p.isWindow(d)?d.document.documentElement["client"+b]:9===d.nodeType?(g=d.documentElement,Math.max(d.body["scroll"+b],g["scroll"+b],d.body["offset"+b],g["offset"+b],g["client"+b])):f===c?p.css(d,e,f,l):p.style(d,e,f,l)},d,m?f:c,m,null)}})});b.jQuery=b.$=p;"function"==typeof define&&define.amd&&define.amd.jQuery&&
define("jquery",[],function(){return p})})(window);function getInternetExplorerVersion(){var b=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b}var ie=getInternetExplorerVersion();function getQueryVariable(b){for(var c=window.location.search.substring(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(decodeURIComponent(e[0])==b)return decodeURIComponent(e[1])}};this.jukebox={};
jukebox.Player=function(b,c){this.id=++jukebox.__jukeboxId;this.origin=c||null;this.settings={};for(var d in this.defaults)this.settings[d]=this.defaults[d];if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)this.settings[e]=b[e];"[object Function]"===Object.prototype.toString.call(jukebox.Manager)&&(jukebox.Manager=new jukebox.Manager);this.resource=this.isPlaying=null;this.resource="[object Object]"===Object.prototype.toString.call(jukebox.Manager)?jukebox.Manager.getPlayableResource(this.settings.resources):this.settings.resources[0]||
null;if(null===this.resource)throw"Your browser can't playback the given resources - or you have missed to include jukebox.Manager";this.__init();return this};jukebox.__jukeboxId=0;
jukebox.Player.prototype={defaults:{resources:[],autoplay:!1,spritemap:{},flashMediaElement:"./swf/FlashMediaElement.swf",timeout:1E3},__addToManager:function(){!0!==this.__wasAddedToManager&&(jukebox.Manager.add(this),this.__wasAddedToManager=!0)},__init:function(){var b=this,c=this.settings,d={},e;jukebox.Manager&&void 0!==jukebox.Manager.features&&(d=jukebox.Manager.features);if(!0===d.html5audio){this.context=new Audio;this.context.src=this.resource;if(null===this.origin){var f=function(c){b.__addToManager(c)};
this.context.addEventListener("canplaythrough",f,!0);window.setTimeout(function(){b.context.removeEventListener("canplaythrough",f,!0);f("timeout")},c.timeout)}this.context.autobuffer=!0;this.context.preload=!0;for(e in this.HTML5API)this[e]=this.HTML5API[e];1<d.channels?!0===c.autoplay?this.context.autoplay=!0:void 0!==c.spritemap[c.autoplay]&&this.play(c.autoplay):1===d.channels&&void 0!==c.spritemap[c.autoplay]&&(this.backgroundMusic=c.spritemap[c.autoplay],this.backgroundMusic.started=Date.now?
Date.now():+new Date,this.play(c.autoplay));1==d.channels&&!0!==c.canPlayBackground&&(window.addEventListener("pagehide",function(){null!==b.isPlaying&&(b.pause(),b.__wasAutoPaused=!0)}),window.addEventListener("pageshow",function(){b.__wasAutoPaused&&(b.resume(),delete b._wasAutoPaused)}))}else if(!0===d.flashaudio){for(e in this.FLASHAPI)this[e]=this.FLASHAPI[e];d=["id=jukebox-flashstream-"+this.id,"autoplay="+c.autoplay,"file="+window.encodeURIComponent(this.resource)];this.__initFlashContext(d);
!0===c.autoplay?this.play(0):c.spritemap[c.autoplay]&&this.play(c.autoplay)}else throw"Your Browser does not support Flash Audio or HTML5 Audio.";},__initFlashContext:function(b){var c,d=this.settings.flashMediaElement,e,f={flashvars:b.join("&"),quality:"high",bgcolor:"#000000",wmode:"transparent",allowscriptaccess:"always",allowfullscreen:"true"};if(navigator.userAgent.match(/MSIE/)){c=document.createElement("div");document.getElementsByTagName("body")[0].appendChild(c);var g=document.createElement("object");
g.id="jukebox-flashstream-"+this.id;g.setAttribute("type","application/x-shockwave-flash");g.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000");g.setAttribute("width","0");g.setAttribute("height","0");f.movie=d+"?x="+(Date.now?Date.now():+new Date);f.flashvars=b.join("&amp;");for(e in f)b=document.createElement("param"),b.setAttribute("name",e),b.setAttribute("value",f[e]),g.appendChild(b);c.outerHTML=g.outerHTML;this.context=document.getElementById("jukebox-flashstream-"+this.id)}else{c=
document.createElement("embed");c.id="jukebox-flashstream-"+this.id;c.setAttribute("type","application/x-shockwave-flash");c.setAttribute("width","100");c.setAttribute("height","100");f.play=!1;f.loop=!1;f.src=d+"?x="+(Date.now?Date.now():+new Date);for(e in f)c.setAttribute(e,f[e]);document.getElementsByTagName("body")[0].appendChild(c);this.context=c}},backgroundHackForiOS:function(){if(void 0!==this.backgroundMusic){var b=Date.now?Date.now():+new Date;void 0===this.backgroundMusic.started?(this.backgroundMusic.started=
b,this.setCurrentTime(this.backgroundMusic.start)):(this.backgroundMusic.lastPointer=(b-this.backgroundMusic.started)/1E3%(this.backgroundMusic.end-this.backgroundMusic.start)+this.backgroundMusic.start,this.play(this.backgroundMusic.lastPointer))}},play:function(b,c){if(null!==this.isPlaying&&!0!==c)void 0!==jukebox.Manager&&jukebox.Manager.addToQueue(b,this.id);else{var d=this.settings.spritemap,e;if(void 0!==d[b])e=d[b].start;else if("number"===typeof b){e=b;for(var f in d)if(e>=d[f].start&&e<=
d[f].end){b=f;break}}void 0!==e&&"[object Object]"===Object.prototype.toString.call(d[b])&&(this.isPlaying=this.settings.spritemap[b],this.context.play&&this.context.play(),this.wasReady=this.setCurrentTime(e))}},stop:function(){this.__lastPosition=0;this.isPlaying=null;this.backgroundMusic?this.backgroundHackForiOS():this.context.pause();return!0},pause:function(){this.isPlaying=null;this.__lastPosition=this.getCurrentTime();this.context.pause();return this.__lastPosition},resume:function(b){b="number"===
typeof b?b:this.__lastPosition;if(null!==b)return this.play(b),this.__lastPosition=null,!0;this.context.play();return!1},HTML5API:{getVolume:function(){return this.context.volume||1},setVolume:function(b){this.context.volume=b;return 1E-4>Math.abs(this.context.volume-b)?!0:!1},getCurrentTime:function(){return this.context.currentTime||0},setCurrentTime:function(b){try{return this.context.currentTime=b,!0}catch(c){return!1}}},FLASHAPI:{getVolume:function(){return this.context&&"function"===typeof this.context.getVolume?
this.context.getVolume():1},setVolume:function(b){return this.context&&"function"===typeof this.context.setVolume?(this.context.setVolume(b),!0):!1},getCurrentTime:function(){return this.context&&"function"===typeof this.context.getCurrentTime?this.context.getCurrentTime():0},setCurrentTime:function(b){return this.context&&"function"===typeof this.context.setCurrentTime?this.context.setCurrentTime(b):!1}}};
if(void 0===this.jukebox)throw"jukebox.Manager requires jukebox.Player (Player.js) to run properly.";
jukebox.Manager=function(b){this.features={};this.codecs={};this.__players={};this.__playersLength=0;this.__clones={};this.__queue=[];this.settings={};for(var c in this.defaults)this.settings[c]=this.defaults[c];if("[object Object]"===Object.prototype.toString.call(b))for(var d in b)this.settings[d]=b[d];this.__detectFeatures();jukebox.Manager.__initialized=!1===this.settings.useGameLoop?window.setInterval(function(){jukebox.Manager.loop()},20):!0};
jukebox.Manager.prototype={defaults:{useFlash:!1,useGameLoop:!1},__detectFeatures:function(){var b=window.Audio&&new Audio;if(b&&b.canPlayType&&!1===this.settings.useFlash){for(var c=[{e:"3gp",m:["audio/3gpp","audio/amr"]},{e:"aac",m:["audio/aac","audio/aacp"]},{e:"amr",m:["audio/amr","audio/3gpp"]},{e:"caf",m:["audio/IMA-ADPCM","audio/x-adpcm",'audio/x-aiff; codecs="IMA-ADPCM, ADPCM"']},{e:"m4a",m:'audio/mp4{audio/mp4; codecs="mp4a.40.2,avc1.42E01E"{audio/mpeg4{audio/mpeg4-generic{audio/mp4a-latm{audio/MP4A-LATM{audio/x-m4a'.split("{")},
{e:"mp3",m:["audio/mp3","audio/mpeg",'audio/mpeg; codecs="mp3"',"audio/MPA","audio/mpa-robust"]},{e:"mpga",m:["audio/MPA","audio/mpa-robust","audio/mpeg","video/mpeg"]},{e:"mp4",m:["audio/mp4","video/mp4"]},{e:"ogg",m:["application/ogg","audio/ogg",'audio/ogg; codecs="theora, vorbis"',"video/ogg",'video/ogg; codecs="theora, vorbis"']},{e:"wav",m:["audio/wave","audio/wav",'audio/wav; codecs="1"',"audio/x-wav","audio/x-pn-wav"]},{e:"webm",m:["audio/webm",'audio/webm; codecs="vorbis"',"video/webm"]}],
d,e,f=0,g=c.length;f<g;f++)if(e=c[f].e,c[f].m.length&&"object"===typeof c[f].m)for(var n=0,l=c[f].m.length;n<l;n++)if(d=c[f].m[n],""!==b.canPlayType(d)){this.codecs[e]=d;break}else this.codecs[e]||(this.codecs[e]=!1);this.features.html5audio=!(!this.codecs.mp3&&!this.codecs.ogg&&!this.codecs.webm&&!this.codecs.wav);this.features.channels=8;b.volume=0.1337;this.features.volume=!!(1E-4>Math.abs(b.volume-0.1337));navigator.userAgent.match(/iPhone|iPod|iPad/i)&&(this.features.channels=1)}this.features.flashaudio=
!!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.plugins["Shockwave Flash"]||!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),this.features.flashaudio=!0}catch(m){}!0===this.settings.useFlash&&(this.features.flashaudio=!0);!0===this.features.flashaudio&&!this.features.html5audio&&(this.codecs.mp3="audio/mp3",this.codecs.mpga="audio/mpeg",this.codecs.mp4="audio/mp4",this.codecs.m4a="audio/mp4",this.codecs["3gp"]="audio/3gpp",this.codecs.amr="audio/amr",
this.features.volume=!0,this.features.channels=1)},__getPlayerById:function(b){return this.__players&&void 0!==this.__players[b]?this.__players[b]:null},__getClone:function(b,c){for(var d in this.__clones){var e=this.__clones[d];if(null===e.isPlaying&&e.origin===b)return e}if("[object Object]"===Object.prototype.toString.call(c)){d={};for(var f in c)d[f]=c[f];d.autoplay=!1;f=new jukebox.Player(d,b);f.isClone=!0;f.wasReady=!1;return this.__clones[f.id]=f}return null},loop:function(){if(0!==this.__playersLength)if(this.__queue.length&&
this.__playersLength<this.features.channels){var b=this.__queue[0],c=this.__getPlayerById(b.origin);if(null!==c){var d=this.__getClone(b.origin,c.settings);null!==d&&(!0===this.features.volume&&(c=this.__players[b.origin])&&d.setVolume(c.getVolume()),this.add(d),d.play(b.pointer,!0))}this.__queue.splice(0,1)}else for(d in this.__queue.length&&1===this.features.channels&&(b=this.__queue[0],c=this.__getPlayerById(b.origin),null!==c&&c.play(b.pointer,!0),this.__queue.splice(0,1)),this.__players)b=this.__players[d],
c=b.getCurrentTime()||0,b.isPlaying&&!1===b.wasReady?b.wasReady=b.setCurrentTime(b.isPlaying.start):b.isPlaying&&!0===b.wasReady?c>b.isPlaying.end&&(!0===b.isPlaying.loop?b.play(b.isPlaying.start,!0):b.stop()):b.isClone&&null===b.isPlaying?this.remove(b):void 0!==b.backgroundMusic&&null===b.isPlaying&&c>b.backgroundMusic.end&&b.backgroundHackForiOS()},getPlayableResource:function(b){"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]);for(var c=0,d=b.length;c<d;c++){var e=b[c],f=e.match(/\.([^\.]*)$/)[1];
if(f&&this.codecs[f])return e}return null},add:function(b){return b instanceof jukebox.Player&&void 0===this.__players[b.id]?(this.__playersLength++,this.__players[b.id]=b,!0):!1},remove:function(b){return b instanceof jukebox.Player&&void 0!==this.__players[b.id]?(this.__playersLength--,delete this.__players[b.id],!0):!1},addToQueue:function(b,c){return("string"===typeof b||"number"===typeof b)&&void 0!==this.__players[c]?(this.__queue.push({pointer:b,origin:c}),!0):!1}};(function(){var b=function(){this.init()};b.prototype={init:function(){var b=this||c;b._codecs={};b._howls=[];b._muted=!1;b._volume=1;b._canPlayEvent="canplaythrough";b._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null;b.masterGain=null;b.noAudio=!1;b.usingWebAudio=!0;b.autoSuspend=!0;b.ctx=null;b.mobileAutoEnable=!0;b._setup();return b},volume:function(b){var d=this||c;b=parseFloat(b);d.ctx||l();if("undefined"!==typeof b&&0<=b&&1>=b){d._volume=b;if(d._muted)return d;
d.usingWebAudio&&(d.masterGain.gain.value=b);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=d._howls[e]._getSoundIds(),g=0;g<f.length;g++){var n=d._howls[e]._soundById(f[g]);n&&n._node&&(n._node.volume=n._volume*b)}return d}return d._volume},mute:function(b){var d=this||c;d.ctx||l();d._muted=b;d.usingWebAudio&&(d.masterGain.gain.value=b?0:d._volume);for(var e=0;e<d._howls.length;e++)if(!d._howls[e]._webAudio)for(var f=d._howls[e]._getSoundIds(),g=0;g<f.length;g++){var n=d._howls[e]._soundById(f[g]);
n&&n._node&&(n._node.muted=b?!0:n._muted)}return d},unload:function(){for(var b=this||c,d=b._howls.length-1;0<=d;d--)b._howls[d].unload();b.usingWebAudio&&(b.ctx&&"undefined"!==typeof b.ctx.close)&&(b.ctx.close(),b.ctx=null,l());return b},codecs:function(b){return(this||c)._codecs[b.replace(/^x-/,"")]},_setup:function(){var b=this||c;b.state=b.ctx?b.ctx.state||"running":"running";b._autoSuspend();if(!b.usingWebAudio)if("undefined"!==typeof Audio)try{var d=new Audio;"undefined"===typeof d.oncanplaythrough&&
(b._canPlayEvent="canplay")}catch(e){b.noAudio=!0}else b.noAudio=!0;try{d=new Audio,d.muted&&(b.noAudio=!0)}catch(f){}b.noAudio||b._setupCodecs();return b},_setupCodecs:function(){var b=this||c,d=null;try{d="undefined"!==typeof Audio?new Audio:null}catch(e){return b}if(!d||"function"!==typeof d.canPlayType)return b;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),g=b._navigator&&b._navigator.userAgent.match(/OPR\/([0-6].)/g),g=g&&33>parseInt(g[0].split("index.html")[1],10);b._codecs={mp3:!(g||!f&&!d.canPlayType("audio/mp3;").replace(/^no$/,
"")),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!d.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,
""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")};return b},_enableMobileAudio:function(){var b=this||c,d=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(b._navigator&&
b._navigator.userAgent),e=!!("ontouchend"in window||b._navigator&&0<b._navigator.maxTouchPoints||b._navigator&&0<b._navigator.msMaxTouchPoints);if(!b._mobileEnabled&&b.ctx&&(d||e)){b._mobileEnabled=!1;!b._mobileUnloaded&&44100!==b.ctx.sampleRate&&(b._mobileUnloaded=!0,b.unload());b._scratchBuffer=b.ctx.createBuffer(1,1,22050);var f=function(){var c=b.ctx.createBufferSource();c.buffer=b._scratchBuffer;c.connect(b.ctx.destination);"undefined"===typeof c.start?c.noteOn(0):c.start(0);c.onended=function(){c.disconnect(0);
b._mobileEnabled=!0;b.mobileAutoEnable=!1;document.removeEventListener("touchend",f,!0)}};document.addEventListener("touchend",f,!0);return b}},_autoSuspend:function(){var b=this;if(b.autoSuspend&&b.ctx&&"undefined"!==typeof b.ctx.suspend&&c.usingWebAudio){for(var d=0;d<b._howls.length;d++)if(b._howls[d]._webAudio)for(var e=0;e<b._howls[d]._sounds.length;e++)if(!b._howls[d]._sounds[e]._paused)return b;b._suspendTimer&&clearTimeout(b._suspendTimer);b._suspendTimer=setTimeout(function(){b.autoSuspend&&
(b._suspendTimer=null,b.state="suspending",b.ctx.suspend().then(function(){b.state="suspended";b._resumeAfterSuspend&&(delete b._resumeAfterSuspend,b._autoResume())}))},3E4);return b}},_autoResume:function(){var b=this;if(b.ctx&&"undefined"!==typeof b.ctx.resume&&c.usingWebAudio)return"running"===b.state&&b._suspendTimer?(clearTimeout(b._suspendTimer),b._suspendTimer=null):"suspended"===b.state?(b.state="resuming",b.ctx.resume().then(function(){b.state="running";for(var c=0;c<b._howls.length;c++)b._howls[c]._emit("resume")}),
b._suspendTimer&&(clearTimeout(b._suspendTimer),b._suspendTimer=null)):"suspending"===b.state&&(b._resumeAfterSuspend=!0),b}};var c=new b,d=function(b){!b.src||0===b.src.length?console.error("An array of source files must be passed with any new Howl."):this.init(b)};d.prototype={init:function(b){var d=this;c.ctx||l();d._autoplay=b.autoplay||!1;d._format="string"!==typeof b.format?b.format:[b.format];d._html5=b.html5||!1;d._muted=b.mute||!1;d._loop=b.loop||!1;d._pool=b.pool||5;d._preload="boolean"===
typeof b.preload?b.preload:!0;d._rate=b.rate||1;d._sprite=b.sprite||{};d._src="string"!==typeof b.src?b.src:[b.src];d._volume=void 0!==b.volume?b.volume:1;d._duration=0;d._state="unloaded";d._sounds=[];d._endTimers={};d._queue=[];d._onend=b.onend?[{fn:b.onend}]:[];d._onfade=b.onfade?[{fn:b.onfade}]:[];d._onload=b.onload?[{fn:b.onload}]:[];d._onloaderror=b.onloaderror?[{fn:b.onloaderror}]:[];d._onpause=b.onpause?[{fn:b.onpause}]:[];d._onplay=b.onplay?[{fn:b.onplay}]:[];d._onstop=b.onstop?[{fn:b.onstop}]:
[];d._onmute=b.onmute?[{fn:b.onmute}]:[];d._onvolume=b.onvolume?[{fn:b.onvolume}]:[];d._onrate=b.onrate?[{fn:b.onrate}]:[];d._onseek=b.onseek?[{fn:b.onseek}]:[];d._onresume=[];d._webAudio=c.usingWebAudio&&!d._html5;"undefined"!==typeof c.ctx&&(c.ctx&&c.mobileAutoEnable)&&c._enableMobileAudio();c._howls.push(d);d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}});d._preload&&d.load();return d},load:function(){var b=null;if(c.noAudio)this._emit("loaderror",null,"No audio support.");
else{"string"===typeof this._src&&(this._src=[this._src]);for(var d=0;d<this._src.length;d++){var l,s;if(this._format&&this._format[d])l=this._format[d];else{s=this._src[d];if("string"!==typeof s){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(l=/^data:audio\/([^;,]+);/i.exec(s))||(l=/\.([^.]+)$/.exec(s.split("?",1)[0]));l&&(l=l[1].toLowerCase())}if(c.codecs(l)){b=this._src[d];break}}if(b){this._src=b;this._state="loading";"https:"===window.location.protocol&&
"http:"===b.slice(0,5)&&(this._html5=!0,this._webAudio=!1);new e(this);if(this._webAudio){var u=this,t=u._src;if(f[t])u._duration=f[t].duration,n(u);else if(/^data:[^;]+;base64,/.test(t)){b=atob(t.split(",")[1]);d=new Uint8Array(b.length);for(l=0;l<b.length;++l)d[l]=b.charCodeAt(l);g(d.buffer,u)}else{var v=new XMLHttpRequest;v.open("GET.html",t,!0);v.responseType="arraybuffer";v.onload=function(){var b=(v.status+"")[0];"0"!==b&&"2"!==b&&"3"!==b?u._emit("loaderror",null,"Failed loading audio file with status: "+
v.status+"."):g(v.response,u)};v.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete f[t],u.load())};try{v.send()}catch(x){v.onerror()}}}return this}this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(b,d){var e=this,f=null;if("number"===typeof b)f=b,b=null;else{if("string"===typeof b&&"loaded"===e._state&&!e._sprite[b])return null;if("undefined"===typeof b){b="__default";for(var g=0,l=0;l<e._sounds.length;l++)e._sounds[l]._paused&&
!e._sounds[l]._ended&&(g++,f=e._sounds[l]._id);1===g?b=null:f=null}}var n=f?e._soundById(f):e._inactiveSound();if(!n)return null;f&&!b&&(b=n._sprite||"__default");if("loaded"!==e._state&&!e._sprite[b])return e._queue.push({event:"play",action:function(){e.play(e._soundById(n._id)?n._id:void 0)}}),n._id;if(f&&!n._paused)return d||setTimeout(function(){e._emit("play",n._id)},0),n._id;e._webAudio&&c._autoResume();var x=Math.max(0,0<n._seek?n._seek:e._sprite[b][0]/1E3),E=Math.max(0,(e._sprite[b][0]+e._sprite[b][1])/
1E3-x),B=1E3*E/Math.abs(n._rate);n._paused=!1;n._ended=!1;n._sprite=b;n._seek=x;n._start=e._sprite[b][0]/1E3;n._stop=(e._sprite[b][0]+e._sprite[b][1])/1E3;n._loop=!(!n._loop&&!e._sprite[b][2]);var F=n._node;if(e._webAudio)f=function(){e._refreshBuffer(n);F.gain.setValueAtTime(n._muted||e._muted?0:n._volume,c.ctx.currentTime);n._playStart=c.ctx.currentTime;"undefined"===typeof F.bufferSource.start?n._loop?F.bufferSource.noteGrainOn(0,x,86400):F.bufferSource.noteGrainOn(0,x,E):n._loop?F.bufferSource.start(0,
x,86400):F.bufferSource.start(0,x,E);Infinity!==B&&(e._endTimers[n._id]=setTimeout(e._ended.bind(e,n),B));d||setTimeout(function(){e._emit("play",n._id)},0)},g="running"===c.state,"loaded"===e._state&&g?f():(e.once(g?"load":"resume",f,g?n._id:null),e._clearTimer(n._id));else{var A=function(){F.currentTime=x;F.muted=n._muted||e._muted||c._muted||F.muted;F.volume=n._volume*c.volume();F.playbackRate=n._rate;setTimeout(function(){F.play();Infinity!==B&&(e._endTimers[n._id]=setTimeout(e._ended.bind(e,
n),B));d||e._emit("play",n._id)},0)},f="loaded"===e._state&&(window&&window.ejecta||!F.readyState&&c._navigator.isCocoonJS);if(4===F.readyState||f)A();else{var J=function(){A();F.removeEventListener(c._canPlayEvent,J,!1)};F.addEventListener(c._canPlayEvent,J,!1);e._clearTimer(n._id)}}return n._id},pause:function(b,c){var d=this;if("loaded"!==d._state)return d._queue.push({event:"pause",action:function(){d.pause(b)}}),d;for(var e=d._getSoundIds(b),f=0;f<e.length;f++){d._clearTimer(e[f]);var g=d._soundById(e[f]);
if(g&&!g._paused&&(g._seek=d.seek(e[f]),g._rateSeek=0,g._paused=!0,d._stopFade(e[f]),g._node))if(d._webAudio){if(!g._node.bufferSource)break;"undefined"===typeof g._node.bufferSource.stop?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0);d._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||Infinity===g._node.duration)&&g._node.pause();c||d._emit("pause",g?g._id:null)}return d},stop:function(b,c){var d=this;if("loaded"!==d._state)return d._queue.push({event:"stop",action:function(){d.stop(b)}}),
d;for(var e=d._getSoundIds(b),f=0;f<e.length;f++){d._clearTimer(e[f]);var g=d._soundById(e[f]);if(g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,d._stopFade(e[f]),g._node))if(d._webAudio){if(!g._node.bufferSource){c||d._emit("stop",g._id);break}"undefined"===typeof g._node.bufferSource.stop?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0);d._cleanBuffer(g._node)}else if(!isNaN(g._node.duration)||Infinity===g._node.duration)g._node.currentTime=g._start||0,g._node.pause();
g&&!c&&d._emit("stop",g._id)}return d},mute:function(b,d){var e=this;if("loaded"!==e._state)return e._queue.push({event:"mute",action:function(){e.mute(b,d)}}),e;if("undefined"===typeof d)if("boolean"===typeof b)e._muted=b;else return e._muted;for(var f=e._getSoundIds(d),g=0;g<f.length;g++){var l=e._soundById(f[g]);l&&(l._muted=b,e._webAudio&&l._node?l._node.gain.setValueAtTime(b?0:l._volume,c.ctx.currentTime):l._node&&(l._node.muted=c._muted?!0:b),e._emit("mute",l._id))}return e},volume:function(){var b=
this,d=arguments,e,f;if(0===d.length)return b._volume;1===d.length||2===d.length&&"undefined"===typeof d[1]?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2<=d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var g;if("undefined"!==typeof e&&0<=e&&1>=e){if("loaded"!==b._state)return b._queue.push({event:"volume",action:function(){b.volume.apply(b,d)}}),b;"undefined"===typeof f&&(b._volume=e);f=b._getSoundIds(f);for(var l=0;l<f.length;l++)if(g=b._soundById(f[l]))g._volume=
e,d[2]||b._stopFade(f[l]),b._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(e,c.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=e*c.volume()),b._emit("volume",g._id)}else return(g=f?b._soundById(f):b._sounds[0])?g._volume:0;return b},fade:function(b,d,e,f){var g=this,l=Math.abs(b-d),n=b>d?"out":"in",x=l/0.01,l=0<x?e/x:e;4>l&&(x=Math.ceil(x/(4/l)),l=4);if("loaded"!==g._state)return g._queue.push({event:"fade",action:function(){g.fade(b,d,e,f)}}),g;g.volume(b,f);for(var E=g._getSoundIds(f),
B=0;B<E.length;B++){var F=g._soundById(E[B]);if(F){f||g._stopFade(E[B]);if(g._webAudio&&!F._muted){var A=c.ctx.currentTime,J=A+e/1E3;F._volume=b;F._node.gain.setValueAtTime(b,A);F._node.gain.linearRampToValueAtTime(d,J)}var D=b;F._interval=setInterval(function(b,c){0<x&&(D+="in"===n?0.01:-0.01);D=Math.max(0,D);D=Math.min(1,D);D=Math.round(100*D)/100;g._webAudio?("undefined"===typeof f&&(g._volume=D),c._volume=D):g.volume(D,b,!0);D===d&&(clearInterval(c._interval),c._interval=null,g.volume(D,b),g._emit("fade",
b))}.bind(g,E[B],F),l)}}return g},_stopFade:function(b){var d=this._soundById(b);d&&d._interval&&(this._webAudio&&d._node.gain.cancelScheduledValues(c.ctx.currentTime),clearInterval(d._interval),d._interval=null,this._emit("fade",b));return this},loop:function(){var b=arguments,c,d;if(0===b.length)return this._loop;if(1===b.length)if("boolean"===typeof b[0])this._loop=c=b[0];else return(b=this._soundById(parseInt(b[0],10)))?b._loop:!1;else 2===b.length&&(c=b[0],d=parseInt(b[1],10));d=this._getSoundIds(d);
for(var e=0;e<d.length;e++)if(b=this._soundById(d[e]))if(b._loop=c,this._webAudio&&(b._node&&b._node.bufferSource)&&(b._node.bufferSource.loop=c))b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop;return this},rate:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):e=parseFloat(d[0]):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));var g;if("number"===typeof e){if("loaded"!==b._state)return b._queue.push({event:"rate",
action:function(){b.rate.apply(b,d)}}),b;"undefined"===typeof f&&(b._rate=e);f=b._getSoundIds(f);for(var l=0;l<f.length;l++)if(g=b._soundById(f[l])){g._rateSeek=b.seek(f[l]);g._playStart=b._webAudio?c.ctx.currentTime:g._playStart;g._rate=e;b._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.value=e:g._node&&(g._node.playbackRate=e);var n=b.seek(f[l]),n=1E3*((b._sprite[g._sprite][0]+b._sprite[g._sprite][1])/1E3-n)/Math.abs(g._rate);if(b._endTimers[f[l]]||!g._paused)b._clearTimer(f[l]),
b._endTimers[f[l]]=setTimeout(b._ended.bind(b,g),n);b._emit("rate",g._id)}}else return(g=b._soundById(f))?g._rate:b._rate;return b},seek:function(){var b=this,d=arguments,e,f;0===d.length?f=b._sounds[0]._id:1===d.length?0<=b._getSoundIds().indexOf(d[0])?f=parseInt(d[0],10):(f=b._sounds[0]._id,e=parseFloat(d[0])):2===d.length&&(e=parseFloat(d[0]),f=parseInt(d[1],10));if("undefined"===typeof f)return b;if("loaded"!==b._state)return b._queue.push({event:"seek",action:function(){b.seek.apply(b,d)}}),
b;var g=b._soundById(f);if(g)if("number"===typeof e&&0<=e){var l=b.playing(f);l&&b.pause(f,!0);g._seek=e;g._ended=!1;b._clearTimer(f);l&&b.play(f,!0);!b._webAudio&&g._node&&(g._node.currentTime=e);b._emit("seek",f)}else return b._webAudio?(e=b.playing(f)?c.ctx.currentTime-g._playStart:0,g._seek+((g._rateSeek?g._rateSeek-g._seek:0)+e*Math.abs(g._rate))):g._node.currentTime;return b},playing:function(b){if("number"===typeof b)return(b=this._soundById(b))?!b._paused:!1;for(b=0;b<this._sounds.length;b++)if(!this._sounds[b]._paused)return!0;
return!1},duration:function(b){var c=this._duration;(b=this._soundById(b))&&(c=this._sprite[b._sprite][1]/1E3);return c},state:function(){return this._state},unload:function(){for(var b=this._sounds,d=0;d<b.length;d++){b[d]._paused||(this.stop(b[d]._id),this._emit("end",b[d]._id));this._webAudio||(b[d]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",b[d]._node.removeEventListener("error",b[d]._errorFn,!1),b[d]._node.removeEventListener(c._canPlayEvent,
b[d]._loadFn,!1));delete b[d]._node;this._clearTimer(b[d]._id);var e=c._howls.indexOf(this);0<=e&&c._howls.splice(e,1)}b=!0;for(d=0;d<c._howls.length;d++)if(c._howls[d]._src===this._src){b=!1;break}f&&b&&delete f[this._src];c.noAudio=!1;this._state="unloaded";this._sounds=[];return null},on:function(b,c,d,e){b=this["_on"+b];"function"===typeof c&&b.push(e?{id:d,fn:c,once:e}:{id:d,fn:c});return this},off:function(b,c,d){var e=this["_on"+b],f=0;if(c)for(f=0;f<e.length;f++){if(c===e[f].fn&&d===e[f].id){e.splice(f,
1);break}}else if(b)this["_on"+b]=[];else{b=Object.keys(this);for(f=0;f<b.length;f++)0===b[f].indexOf("_on")&&Array.isArray(this[b[f]])&&(this[b[f]]=[])}return this},once:function(b,c,d){this.on(b,c,d,1);return this},_emit:function(b,c,d){for(var e=this["_on"+b],f=e.length-1;0<=f;f--)if(!e[f].id||e[f].id===c||"load"===b)setTimeout(function(b){b.call(this,c,d)}.bind(this,e[f].fn),0),e[f].once&&this.off(b,e[f].fn,e[f].id);return this},_loadQueue:function(){var b=this;if(0<b._queue.length){var c=b._queue[0];
b.once(c.event,function(){b._queue.shift();b._loadQueue()});c.action()}return b},_ended:function(b){var d=b._sprite,d=!(!b._loop&&!this._sprite[d][2]);this._emit("end",b._id);!this._webAudio&&d&&this.stop(b._id,!0).play(b._id);if(this._webAudio&&d){this._emit("play",b._id);b._seek=b._start||0;b._rateSeek=0;b._playStart=c.ctx.currentTime;var e=1E3*(b._stop-b._start)/Math.abs(b._rate);this._endTimers[b._id]=setTimeout(this._ended.bind(this,b),e)}this._webAudio&&!d&&(b._paused=!0,b._ended=!0,b._seek=
b._start||0,b._rateSeek=0,this._clearTimer(b._id),this._cleanBuffer(b._node),c._autoSuspend());!this._webAudio&&!d&&this.stop(b._id);return this},_clearTimer:function(b){this._endTimers[b]&&(clearTimeout(this._endTimers[b]),delete this._endTimers[b]);return this},_soundById:function(b){for(var c=0;c<this._sounds.length;c++)if(b===this._sounds[c]._id)return this._sounds[c];return null},_inactiveSound:function(){this._drain();for(var b=0;b<this._sounds.length;b++)if(this._sounds[b]._ended)return this._sounds[b].reset();
return new e(this)},_drain:function(){var b=this._pool,c=0,d=0;if(!(this._sounds.length<b)){for(d=0;d<this._sounds.length;d++)this._sounds[d]._ended&&c++;for(d=this._sounds.length-1;0<=d&&!(c<=b);d--)this._sounds[d]._ended&&(this._webAudio&&this._sounds[d]._node&&this._sounds[d]._node.disconnect(0),this._sounds.splice(d,1),c--)}},_getSoundIds:function(b){if("undefined"===typeof b){b=[];for(var c=0;c<this._sounds.length;c++)b.push(this._sounds[c]._id);return b}return[b]},_refreshBuffer:function(b){b._node.bufferSource=
c.ctx.createBufferSource();b._node.bufferSource.buffer=f[this._src];b._panner?b._node.bufferSource.connect(b._panner):b._node.bufferSource.connect(b._node);if(b._node.bufferSource.loop=b._loop)b._node.bufferSource.loopStart=b._start||0,b._node.bufferSource.loopEnd=b._stop;b._node.bufferSource.playbackRate.value=b._rate;return this},_cleanBuffer:function(b){if(this._scratchBuffer){b.bufferSource.onended=null;b.bufferSource.disconnect(0);try{b.bufferSource.buffer=this._scratchBuffer}catch(c){}}b.bufferSource=
null;return this}};var e=function(b){this._parent=b;this.init()};e.prototype={init:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._muted=b._muted;this._rate=b._rate;this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=Math.round(Date.now()*Math.random());b._sounds.push(this);this.create();return this},create:function(){var b=this._parent,d=c._muted||this._muted||this._parent._muted?0:this._volume;b._webAudio?(this._node="undefined"===
typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),this._node.gain.setValueAtTime(d,c.ctx.currentTime),this._node.paused=!0,this._node.connect(c.masterGain)):(this._node=new Audio,this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(c._canPlayEvent,this._loadFn,!1),this._node.src=b._src,this._node.preload="auto",this._node.volume=d*c.volume(),this._node.load());return this},
reset:function(){var b=this._parent;this._muted=b._muted;this._loop=b._loop;this._volume=b._volume;this._muted=b._muted;this._rate=b._rate;this._rateSeek=this._seek=0;this._ended=this._paused=!0;this._sprite="__default";this._id=Math.round(Date.now()*Math.random());return this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0);this._node.removeEventListener("error",this._errorListener,!1)},_loadListener:function(){var b=this._parent;b._duration=
Math.ceil(10*this._node.duration)/10;0===Object.keys(b._sprite).length&&(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue());this._node.removeEventListener(c._canPlayEvent,this._loadFn,!1)}};var f={},g=function(b,d){c.ctx.decodeAudioData(b,function(b){b&&0<d._sounds.length&&(f[d._src]=b,n(d,b))},function(){d._emit("loaderror",null,"Decoding audio data failed.")})},n=function(b,c){c&&!b._duration&&(b._duration=c.duration);0===Object.keys(b._sprite).length&&
(b._sprite={__default:[0,1E3*b._duration]});"loaded"!==b._state&&(b._state="loaded",b._emit("load"),b._loadQueue())},l=function(){try{"undefined"!==typeof AudioContext?c.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?c.ctx=new webkitAudioContext:c.usingWebAudio=!1}catch(b){c.usingWebAudio=!1}var d=/iP(hone|od|ad)/.test(c._navigator&&c._navigator.platform),e=c._navigator&&c._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=e?parseInt(e[1],10):null;if(d&&(e&&9>e)&&(d=/safari/.test(c._navigator&&
c._navigator.userAgent.toLowerCase()),c._navigator&&c._navigator.standalone&&!d||c._navigator&&!c._navigator.standalone&&!d))c.usingWebAudio=!1;c.usingWebAudio&&(c.masterGain="undefined"===typeof c.ctx.createGain?c.ctx.createGainNode():c.ctx.createGain(),c.masterGain.gain.value=1,c.masterGain.connect(c.ctx.destination));c._setup()};"function"===typeof define&&define.amd&&define([],function(){return{Howler:c,Howl:d}});"undefined"!==typeof exports&&(exports.Howler=c,exports.Howl=d);"undefined"!==typeof window?
(window.HowlerGlobal=b,window.Howler=c,window.Howl=d,window.Sound=e):"undefined"!==typeof global&&(global.HowlerGlobal=b,global.Howler=c,global.Howl=d,global.Sound=e)})();
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(b){if(!this.ctx||!this.ctx.listener)return this;for(var c=this._howls.length-1;0<=c;c--)this._howls[c].stereo(b);return this};HowlerGlobal.prototype.pos=function(b,c,d){if(!this.ctx||!this.ctx.listener)return this;c="number"!==typeof c?this._pos[1]:c;d="number"!==typeof d?this._pos[2]:d;if("number"===typeof b)this._pos=[b,c,d],this.ctx.listener.setPosition(this._pos[0],
this._pos[1],this._pos[2]);else return this._pos;return this};HowlerGlobal.prototype.orientation=function(b,c,d,e,m,r){if(!this.ctx||!this.ctx.listener)return this;var q=this._orientation;c="number"!==typeof c?q[1]:c;d="number"!==typeof d?q[2]:d;e="number"!==typeof e?q[3]:e;m="number"!==typeof m?q[4]:m;r="number"!==typeof r?q[5]:r;if("number"===typeof b)this._orientation=[b,c,d,e,m,r],this.ctx.listener.setOrientation(b,c,d,e,m,r);else return q;return this};var b=Howl.prototype.init;Howl.prototype.init=
function(c){this._orientation=c.orientation||[1,0,0];this._stereo=c.stereo||null;this._pos=c.pos||null;this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:0,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:"inverse",maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:1E4,panningModel:"undefined"!==
typeof c.panningModel?c.panningModel:"HRTF",refDistance:"undefined"!==typeof c.refDistance?c.refDistance:1,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:1};this._onstereo=c.onstereo?[{fn:c.onstereo}]:[];this._onpos=c.onpos?[{fn:c.onpos}]:[];this._onorientation=c.onorientation?[{fn:c.onorientation}]:[];return b.call(this,c)};Howl.prototype.stereo=function(b,c){var d=this;if(!d._webAudio)return d;if("loaded"!==d._state)return d._queue.push({event:"stereo",action:function(){d.stereo(b,
c)}}),d;var l="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof c)if("number"===typeof b)d._stereo=b,d._pos=[b,0,0];else return d._stereo;for(var m=d._getSoundIds(c),r=0;r<m.length;r++){var q=d._soundById(m[r]);if(q)if("number"===typeof b)q._stereo=b,q._pos=[b,0,0],q._node&&(q._pannerAttr.panningModel="equalpower",(!q._panner||!q._panner.pan)&&e(q,l),"spatial"===l?q._panner.setPosition(b,0,0):q._panner.pan.value=b),d._emit("stereo",q._id);else return q._stereo}return d};
Howl.prototype.pos=function(b,c,d,l){var m=this;if(!m._webAudio)return m;if("loaded"!==m._state)return m._queue.push({event:"pos",action:function(){m.pos(b,c,d,l)}}),m;c="number"!==typeof c?0:c;d="number"!==typeof d?-0.5:d;if("undefined"===typeof l)if("number"===typeof b)m._pos=[b,c,d];else return m._pos;for(var r=m._getSoundIds(l),q=0;q<r.length;q++){var s=m._soundById(r[q]);if(s)if("number"===typeof b)s._pos=[b,c,d],s._node&&((!s._panner||s._panner.pan)&&e(s,"spatial"),s._panner.setPosition(b,c,
d)),m._emit("pos",s._id);else return s._pos}return m};Howl.prototype.orientation=function(b,c,d,l){var m=this;if(!m._webAudio)return m;if("loaded"!==m._state)return m._queue.push({event:"orientation",action:function(){m.orientation(b,c,d,l)}}),m;c="number"!==typeof c?m._orientation[1]:c;d="number"!==typeof d?m._orientation[2]:d;if("undefined"===typeof l)if("number"===typeof b)m._orientation=[b,c,d];else return m._orientation;for(var r=m._getSoundIds(l),q=0;q<r.length;q++){var s=m._soundById(r[q]);
if(s)if("number"===typeof b)s._orientation=[b,c,d],s._node&&(s._panner||(s._pos||(s._pos=m._pos||[0,0,-0.5]),e(s,"spatial")),s._panner.setOrientation(b,c,d)),m._emit("orientation",s._id);else return s._orientation}return m};Howl.prototype.pannerAttr=function(){var b=arguments,c,d;if(!this._webAudio)return this;if(0===b.length)return this._pannerAttr;if(1===b.length)if("object"===typeof b[0])c=b[0],"undefined"===typeof d&&(this._pannerAttr={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:
this._coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:this._coneOuterAngle,coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:this._coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:this._distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:this._maxDistance,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:this._panningModel,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:
this._refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:this._rolloffFactor});else return(b=this._soundById(parseInt(b[0],10)))?b._pannerAttr:this._pannerAttr;else 2===b.length&&(c=b[0],d=parseInt(b[1],10));d=this._getSoundIds(d);for(var l=0;l<d.length;l++)if(b=this._soundById(d[l])){var m=b._pannerAttr,m={coneInnerAngle:"undefined"!==typeof c.coneInnerAngle?c.coneInnerAngle:m.coneInnerAngle,coneOuterAngle:"undefined"!==typeof c.coneOuterAngle?c.coneOuterAngle:m.coneOuterAngle,
coneOuterGain:"undefined"!==typeof c.coneOuterGain?c.coneOuterGain:m.coneOuterGain,distanceModel:"undefined"!==typeof c.distanceModel?c.distanceModel:m.distanceModel,maxDistance:"undefined"!==typeof c.maxDistance?c.maxDistance:m.maxDistance,panningModel:"undefined"!==typeof c.panningModel?c.panningModel:m.panningModel,refDistance:"undefined"!==typeof c.refDistance?c.refDistance:m.refDistance,rolloffFactor:"undefined"!==typeof c.rolloffFactor?c.rolloffFactor:m.rolloffFactor},r=b._panner;r?(r.coneInnerAngle=
m.coneInnerAngle,r.coneOuterAngle=m.coneOuterAngle,r.coneOuterGain=m.coneOuterGain,r.distanceModel=m.distanceModel,r.maxDistance=m.maxDistance,r.panningModel=m.panningModel,r.refDistance=m.refDistance,r.rolloffFactor=m.rolloffFactor):(b._pos||(b._pos=this._pos||[0,0,-0.5]),e(b,"spatial"))}return this};var c=Sound.prototype.init;Sound.prototype.init=function(){var b=this._parent;this._orientation=b._orientation;this._stereo=b._stereo;this._pos=b._pos;this._pannerAttr=b._pannerAttr;c.call(this);this._stereo?
b.stereo(this._stereo):this._pos&&b.pos(this._pos[0],this._pos[1],this._pos[2],this._id)};var d=Sound.prototype.reset;Sound.prototype.reset=function(){var b=this._parent;this._orientation=b._orientation;this._pos=b._pos;this._pannerAttr=b._pannerAttr;return d.call(this)};var e=function(b,c){"spatial"===(c||"spatial")?(b._panner=Howler.ctx.createPanner(),b._panner.coneInnerAngle=b._pannerAttr.coneInnerAngle,b._panner.coneOuterAngle=b._pannerAttr.coneOuterAngle,b._panner.coneOuterGain=b._pannerAttr.coneOuterGain,
b._panner.distanceModel=b._pannerAttr.distanceModel,b._panner.maxDistance=b._pannerAttr.maxDistance,b._panner.panningModel=b._pannerAttr.panningModel,b._panner.refDistance=b._pannerAttr.refDistance,b._panner.rolloffFactor=b._pannerAttr.rolloffFactor,b._panner.setPosition(b._pos[0],b._pos[1],b._pos[2]),b._panner.setOrientation(b._orientation[0],b._orientation[1],b._orientation[2])):(b._panner=Howler.ctx.createStereoPanner(),b._panner.pan.value=b._stereo);b._panner.connect(b._node);b._paused||b._parent.pause(b._id,
!0).play(b._id)}})();(function(b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define([],b):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).io=b()})(function(){return function c(d,e,f){function g(l,r){if(!e[l]){if(!d[l]){var q="function"==typeof require&&require;if(!r&&q)return q(l,!0);if(n)return n(l,!0);q=Error("Cannot find module '"+l+"'");throw q.code="MODULE_NOT_FOUND",q;}q=e[l]={exports:{}};
d[l][0].call(q.exports,function(c){var e=d[l][1][c];return g(e?e:c)},q,q.exports,c,d,e,f)}return e[l].exports}for(var n="function"==typeof require&&require,l=0;l<f.length;l++)g(f[l]);return g}({1:[function(c,d){d.exports=c("lib/index.html")},{"./lib/":2}],2:[function(c,d){d.exports=c("./socket");d.exports.parser=c("engine.io-parser")},{"./socket":3,"engine.io-parser":19}],3:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=function(c,
d){if(!(this instanceof f))return new f(c,d);d=d||{};c&&"object"==typeof c&&(d=c,c=null);c?(c=q(c),d.hostname=c.host,d.secure="https"==c.protocol||"wss"==c.protocol,d.port=c.port,c.query&&(d.query=c.query)):d.host&&(d.hostname=q(d.host).host);this.secure=null!=d.secure?d.secure:e.location&&"https:"==location.protocol;d.hostname&&!d.port&&(d.port=this.secure?"443":"80");this.agent=d.agent||!1;this.hostname=d.hostname||(e.location?location.hostname:"localhost");this.port=d.port||(e.location&&location.port?
location.port:this.secure?443:80);this.query=d.query||{};"string"==typeof this.query&&(this.query=u.decode(this.query));this.upgrade=!1!==d.upgrade;this.path=(d.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!d.forceJSONP;this.jsonp=!1!==d.jsonp;this.forceBase64=!!d.forceBase64;this.enablesXDR=!!d.enablesXDR;this.timestampParam=d.timestampParam||"t";this.timestampRequests=d.timestampRequests;this.transports=d.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.policyPort=
d.policyPort||843;this.rememberUpgrade=d.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=d.onlyBinaryUpgrades;this.perMessageDeflate=!1!==d.perMessageDeflate?d.perMessageDeflate||{}:!1;!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=d.pfx||null;this.key=d.key||null;this.passphrase=d.passphrase||null;this.cert=d.cert||null;this.ca=d.ca||null;this.ciphers=d.ciphers||
null;this.rejectUnauthorized=void 0===d.rejectUnauthorized?null:d.rejectUnauthorized;var g="object"==typeof e&&e;g.global===g&&(d.extraHeaders&&0<Object.keys(d.extraHeaders).length)&&(this.extraHeaders=d.extraHeaders);this.open()},g=c("./transports"),n=c("component-emitter"),l=c("debug")("engine.io-client:socket"),m=c("indexof"),r=c("engine.io-parser"),q=c("parseuri"),s=c("parsejson"),u=c("parseqs");d.exports=f;f.priorWebsocketSuccess=!1;n(f.prototype);f.protocol=r.protocol;f.Socket=f;f.Transport=
c("./transport");f.transports=c("./transports");f.parser=c("engine.io-parser");f.prototype.createTransport=function(c){l('creating transport "%s"',c);var d=this.query,e={},f;for(f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);e.EIO=r.protocol;e.transport=c;this.id&&(e.sid=this.id);return new g[c]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,
timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders})};f.prototype.open=function(){var c;if(this.rememberUpgrade&&f.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))c="websocket";else{if(0===this.transports.length){var d=this;setTimeout(function(){d.emit("error",
"No transports available")},0);return}c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(e){this.transports.shift();this.open();return}c.open();this.setTransport(c)};f.prototype.setTransport=function(c){l("setting transport %s",c.name);var d=this;this.transport&&(l("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=c;c.on("drain",function(){d.onDrain()}).on("packet",function(c){d.onPacket(c)}).on("error",function(c){d.onError(c)}).on("close",
function(){d.onClose("transport close")})};f.prototype.probe=function(c){function d(){if(C.onlyBinaryUpgrades){var e=!this.supportsBinary&&C.transport.supportsBinary;u=u||e}u||(l('probe transport "%s" opened',c),s.send([{type:"ping",data:"probe"}]),s.once("packet",function(d){u||("pong"==d.type&&"probe"==d.data?(l('probe transport "%s" pong',c),C.upgrading=!0,C.emit("upgrading",s),s&&(f.priorWebsocketSuccess="websocket"==s.name,l('pausing current transport "%s"',C.transport.name),C.transport.pause(function(){!u&&
"closed"!=C.readyState&&(l("changing transport and sending upgrade packet"),r(),C.setTransport(s),s.send([{type:"upgrade"}]),C.emit("upgrade",s),s=null,C.upgrading=!1,C.flush())}))):(l('probe transport "%s" failed',c),d=Error("probe error"),d.transport=s.name,C.emit("upgradeError",d)))}))}function e(){u||(u=!0,r(),s.close(),s=null)}function g(d){var f=Error("probe error: "+d);f.transport=s.name;e();l('probe transport "%s" failed because of error: %s',c,d);C.emit("upgradeError",f)}function m(){g("transport closed")}
function n(){g("socket closed")}function q(c){s&&c.name!=s.name&&(l('"%s" works - aborting "%s"',c.name,s.name),e())}function r(){s.removeListener("open",d);s.removeListener("error",g);s.removeListener("close",m);C.removeListener("close",n);C.removeListener("upgrading",q)}l('probing transport "%s"',c);var s=this.createTransport(c,{probe:1}),u=!1,C=this;f.priorWebsocketSuccess=!1;s.once("open",d);s.once("error",g);s.once("close",m);this.once("close",n);this.once("upgrading",q);s.open()};f.prototype.onOpen=
function(){l("socket open");this.readyState="open";f.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){l("starting upgrade probes");for(var c=0,d=this.upgrades.length;c<d;c++)this.probe(this.upgrades[c])}};f.prototype.onPacket=function(c){if("opening"==this.readyState||"open"==this.readyState)switch(l('socket receive: type "%s", data "%s"',c.type,c.data),this.emit("packet",c),this.emit("heartbeat"),
c.type){case "open":this.onHandshake(s(c.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var d=Error("server error");d.code=c.data;this.onError(d);break;case "message":this.emit("data",c.data),this.emit("message",c.data)}else l('packet received with socket readyState "%s"',this.readyState)};f.prototype.onHandshake=function(c){this.emit("handshake",c);this.id=c.sid;this.transport.query.sid=c.sid;this.upgrades=this.filterUpgrades(c.upgrades);this.pingInterval=c.pingInterval;
this.pingTimeout=c.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};f.prototype.onHeartbeat=function(c){clearTimeout(this.pingTimeoutTimer);var d=this;d.pingTimeoutTimer=setTimeout(function(){if("closed"!=d.readyState)d.onClose("ping timeout")},c||d.pingInterval+d.pingTimeout)};f.prototype.setPing=function(){var c=this;clearTimeout(c.pingIntervalTimer);c.pingIntervalTimer=setTimeout(function(){l("writing ping packet - expecting pong within %sms",
c.pingTimeout);c.ping();c.onHeartbeat(c.pingTimeout)},c.pingInterval)};f.prototype.ping=function(){var c=this;this.sendPacket("ping",function(){c.emit("ping")})};f.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};f.prototype.flush=function(){"closed"!=this.readyState&&(this.transport.writable&&!this.upgrading&&this.writeBuffer.length)&&(l("flushing %d packets in socket",this.writeBuffer.length),
this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};f.prototype.write=f.prototype.send=function(c,d,e){this.sendPacket("message",c,d,e);return this};f.prototype.sendPacket=function(c,d,e,f){"function"==typeof d&&(f=d,d=void 0);"function"==typeof e&&(f=e,e=null);if(!("closing"==this.readyState||"closed"==this.readyState)){e=e||{};e.compress=!1!==e.compress;c={type:c,data:d,options:e};this.emit("packetCreate",c);this.writeBuffer.push(c);if(f)this.once("flush",
f);this.flush()}};f.prototype.close=function(){function c(){f.onClose("forced close");l("socket closing - telling transport to close");f.transport.close()}function d(){f.removeListener("upgrade",d);f.removeListener("upgradeError",d);c()}function e(){f.once("upgrade",d);f.once("upgradeError",d)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var f=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?e():c()});else this.upgrading?e():c()}return this};
f.prototype.onError=function(c){l("socket error %j",c);f.priorWebsocketSuccess=!1;this.emit("error",c);this.onClose("transport error",c)};f.prototype.onClose=function(c,d){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState)l('socket close with reason: "%s"',c),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=
null,this.emit("close",c,d),this.writeBuffer=[],this.prevBufferLen=0};f.prototype.filterUpgrades=function(c){for(var d=[],e=0,f=c.length;e<f;e++)~m(this.transports,c[e])&&d.push(c[e]);return d}},{"./transport":4,"./transports":5,"component-emitter":15,debug:17,"engine.io-parser":19,indexof:23,parsejson:26,parseqs:27,parseuri:28}],4:[function(c,d){function e(c){this.path=c.path;this.hostname=c.hostname;this.port=c.port;this.secure=c.secure;this.query=c.query;this.timestampParam=c.timestampParam;this.timestampRequests=
c.timestampRequests;this.readyState="";this.agent=c.agent||!1;this.socket=c.socket;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.extraHeaders=c.extraHeaders}var f=c("engine.io-parser"),g=c("component-emitter");d.exports=e;g(e.prototype);e.prototype.onError=function(c,d){var e=Error(c);e.type="TransportError";e.description=d;this.emit("error",e);return this};
e.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};e.prototype.send=function(c){if("open"==this.readyState)this.write(c);else throw Error("Transport not open");};e.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};e.prototype.onData=function(c){c=f.decodePacket(c,
this.socket.binaryType);this.onPacket(c)};e.prototype.onPacket=function(c){this.emit("packet",c)};e.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":15,"engine.io-parser":19}],5:[function(c,d,e){var f="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},g=c("xmlhttprequest-ssl"),n=c("./polling-xhr"),l=c("./polling-jsonp");c=c("./websocket");e.polling=function(c){var d=!1,e=!1,s=!1!==c.jsonp;f.location&&
(e="https:"==location.protocol,(d=location.port)||(d=e?443:80),d=c.hostname!=location.hostname||d!=c.port,e=c.secure!=e);c.xdomain=d;c.xscheme=e;if("open"in new g(c)&&!c.forceJSONP)return new n(c);if(!s)throw Error("JSONP disabled");return new l(c)};e.websocket=c},{"./polling-jsonp":6,"./polling-xhr":7,"./websocket":9,"xmlhttprequest-ssl":10}],6:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=function(){},g=function(c){n.call(this,
c);this.query=this.query||{};q||(e.___eio||(e.___eio=[]),q=e.___eio);this.index=q.length;var d=this;q.push(function(c){d.onData(c)});this.query.j=this.index;e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){d.script&&(d.script.onerror=f)},!1)},n=c("./polling"),l=c("component-inherit");d.exports=g;var m=/\n/g,r=/\\n/g,q;l(g,n);g.prototype.supportsBinary=!1;g.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&
(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);n.prototype.doClose.call(this)};g.prototype.doPoll=function(){var c=this,d=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);d.async=!0;d.src=this.uri();d.onerror=function(d){c.onError("jsonp poll error",d)};var e=document.getElementsByTagName("script")[0];e?e.parentNode.insertBefore(d,e):(document.head||document.body).appendChild(d);this.script=d;"undefined"!=typeof navigator&&
/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var c=document.createElement("iframe");document.body.appendChild(c);document.body.removeChild(c)},100)};g.prototype.doWrite=function(c,d){function e(){f();d()}function f(){if(g.iframe)try{g.form.removeChild(g.iframe)}catch(c){g.onError("jsonp polling iframe removal error",c)}try{A=document.createElement('<iframe src="javascript:0" name="'+g.iframeId+'">')}catch(d){A=document.createElement("iframe"),A.name=g.iframeId,A.src="javascript:0"}A.id=
g.iframeId;g.form.appendChild(A);g.iframe=A}var g=this;if(!this.form){var l=document.createElement("form"),n=document.createElement("textarea"),q=this.iframeId="eio_iframe_"+this.index,A;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=q;l.method="POST";l.setAttribute("accept-charset","utf-8");n.name="d";l.appendChild(n);document.body.appendChild(l);this.form=l;this.area=n}this.form.action=this.uri();f();c=c.replace(r,"\\\n");this.area.value=
c.replace(m,"\\n");try{this.form.submit()}catch(J){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==g.iframe.readyState&&e()}:this.iframe.onload=e}},{"./polling":8,"component-inherit":16}],7:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=function(){},g=function(c){r.call(this,c);if(e.location){var d="https:"==location.protocol,f=location.port;f||(f=d?443:80);this.xd=c.hostname!=e.location.hostname||
f!=c.port;this.xs=c.secure!=d}else this.extraHeaders=c.extraHeaders},n=function(c){this.method=c.method||"GET";this.uri=c.uri;this.xd=!!c.xd;this.xs=!!c.xs;this.async=!1!==c.async;this.data=void 0!=c.data?c.data:null;this.agent=c.agent;this.isBinary=c.isBinary;this.supportsBinary=c.supportsBinary;this.enablesXDR=c.enablesXDR;this.pfx=c.pfx;this.key=c.key;this.passphrase=c.passphrase;this.cert=c.cert;this.ca=c.ca;this.ciphers=c.ciphers;this.rejectUnauthorized=c.rejectUnauthorized;this.extraHeaders=
c.extraHeaders;this.create()},l=function(){for(var c in n.requests)n.requests.hasOwnProperty(c)&&n.requests[c].abort()},m=c("xmlhttprequest-ssl"),r=c("./polling"),q=c("component-emitter"),s=c("component-inherit"),u=c("debug")("engine.io-client:polling-xhr");d.exports=g;d.exports.Request=n;s(g,r);g.prototype.supportsBinary=!0;g.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=this.supportsBinary;c.enablesXDR=this.enablesXDR;c.pfx=
this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;c.extraHeaders=this.extraHeaders;return new n(c)};g.prototype.doWrite=function(c,d){var e=this.request({method:"POST",data:c,isBinary:"string"!==typeof c&&void 0!==c}),f=this;e.on("success",d);e.on("error",function(c){f.onError("xhr post error",c)});this.sendXhr=e};g.prototype.doPoll=function(){u("xhr poll");var c=this.request(),d=this;c.on("data",
function(c){d.onData(c)});c.on("error",function(c){d.onError("xhr poll error",c)});this.pollXhr=c};q(n.prototype);n.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var d=this.xhr=new m(c),f=this;try{u("xhr open %s: %s",this.method,this.uri);d.open(this.method,this.uri,this.async);
try{if(this.extraHeaders){d.setDisableHeaderCheck(!0);for(var g in this.extraHeaders)this.extraHeaders.hasOwnProperty(g)&&d.setRequestHeader(g,this.extraHeaders[g])}}catch(l){}this.supportsBinary&&(d.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?d.setRequestHeader("Content-type","application/octet-stream"):d.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(q){}"withCredentials"in d&&(d.withCredentials=!0);this.hasXDR()?(d.onload=function(){f.onLoad()},d.onerror=
function(){f.onError(d.responseText)}):d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status||1223==d.status)f.onLoad();else setTimeout(function(){f.onError(d.status)},0)};u("xhr data %s",this.data);d.send(this.data)}catch(r){setTimeout(function(){f.onError(r)},0);return}e.document&&(this.index=n.requestsCount++,n.requests[this.index]=this)};n.prototype.onSuccess=function(){this.emit("success");this.cleanup()};n.prototype.onData=function(c){this.emit("data",c);this.onSuccess()};n.prototype.onError=
function(c){this.emit("error",c);this.cleanup(!0)};n.prototype.cleanup=function(c){if(!("undefined"==typeof this.xhr||null===this.xhr)){this.hasXDR()?this.xhr.onload=this.xhr.onerror=f:this.xhr.onreadystatechange=f;if(c)try{this.xhr.abort()}catch(d){}e.document&&delete n.requests[this.index];this.xhr=null}};n.prototype.onLoad=function(){var c;try{var d;try{d=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===d)c=this.xhr.response;else if(this.supportsBinary)try{c=
String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(f){var g=new Uint8Array(this.xhr.response);d=[];for(var l=0,m=g.length;l<m;l++)d.push(g[l]);c=String.fromCharCode.apply(null,d)}else c=this.xhr.responseText}catch(n){this.onError(n)}if(null!=c)this.onData(c)};n.prototype.hasXDR=function(){return"undefined"!==typeof e.XDomainRequest&&!this.xs&&this.enablesXDR};n.prototype.abort=function(){this.cleanup()};e.document&&(n.requestsCount=0,n.requests={},e.attachEvent?e.attachEvent("onunload",
l):e.addEventListener&&e.addEventListener("beforeunload",l,!1))},{"./polling":8,"component-emitter":15,"component-inherit":16,debug:17,"xmlhttprequest-ssl":10}],8:[function(c,d){function e(c){var d=c&&c.forceBase64;if(!q||d)this.supportsBinary=!1;f.call(this,c)}var f=c("../transport"),g=c("parseqs"),n=c("engine.io-parser"),l=c("component-inherit"),m=c("yeast"),r=c("debug")("engine.io-client:polling");d.exports=e;var q;q=null!=(new (c("xmlhttprequest-ssl"))({xdomain:!1})).responseType;l(e,f);e.prototype.name=
"polling";e.prototype.doOpen=function(){this.poll()};e.prototype.pause=function(c){function d(){r("paused");e.readyState="paused";c()}var e=this;this.readyState="pausing";if(this.polling||!this.writable){var f=0;this.polling&&(r("we are currently polling - waiting to pause"),f++,this.once("pollComplete",function(){r("pre-pause polling complete");--f||d()}));this.writable||(r("we are currently writing - waiting to pause"),f++,this.once("drain",function(){r("pre-pause writing complete");--f||d()}))}else d()};
e.prototype.poll=function(){r("polling");this.polling=!0;this.doPoll();this.emit("poll")};e.prototype.onData=function(c){var d=this;r("polling got data %s",c);n.decodePayload(c,this.socket.binaryType,function(c){if("opening"==d.readyState)d.onOpen();if("close"==c.type)return d.onClose(),!1;d.onPacket(c)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():r('ignoring poll - transport state "%s"',this.readyState))};e.prototype.doClose=function(){function c(){r("writing close packet");
d.write([{type:"close"}])}var d=this;"open"==this.readyState?(r("transport open - closing"),c()):(r("transport not open - deferring close"),this.once("open",c))};e.prototype.write=function(c){var d=this;this.writable=!1;var e=function(){d.writable=!0;d.emit("drain")},d=this;n.encodePayload(c,this.supportsBinary,function(c){d.doWrite(c,e)})};e.prototype.uri=function(){var c=this.query||{},d=this.secure?"https":"http",e="";!1!==this.timestampRequests&&(c[this.timestampParam]=m());!this.supportsBinary&&
!c.sid&&(c.b64=1);c=g.encode(c);if(this.port&&("https"==d&&443!=this.port||"http"==d&&80!=this.port))e=":"+this.port;c.length&&(c="?"+c);var f=-1!==this.hostname.indexOf(":");return d+"://"+(f?"["+this.hostname+"]":this.hostname)+e+this.path+c}},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,"xmlhttprequest-ssl":10,yeast:30}],9:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=function(c){c&&
c.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=c.perMessageDeflate;g.call(this,c)},g=c("../transport"),n=c("engine.io-parser"),l=c("parseqs"),m=c("component-inherit"),r=c("yeast"),q=c("debug")("engine.io-client:websocket"),s=e.WebSocket||e.MozWebSocket,u=s;if(!u&&"undefined"===typeof window)try{u=c("ws")}catch(t){}d.exports=f;m(f,g);f.prototype.name="websocket";f.prototype.supportsBinary=!0;f.prototype.doOpen=function(){if(this.check()){var c=this.uri(),d={agent:this.agent,perMessageDeflate:this.perMessageDeflate};
d.pfx=this.pfx;d.key=this.key;d.passphrase=this.passphrase;d.cert=this.cert;d.ca=this.ca;d.ciphers=this.ciphers;d.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(d.headers=this.extraHeaders);this.ws=s?new u(c):new u(c,void 0,d);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};f.prototype.addEventListeners=function(){var c=this;
this.ws.onopen=function(){c.onOpen()};this.ws.onclose=function(){c.onClose()};this.ws.onmessage=function(d){c.onData(d.data)};this.ws.onerror=function(d){c.onError("websocket error",d)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(f.prototype.onData=function(c){var d=this;setTimeout(function(){g.prototype.onData.call(d,c)},0)});f.prototype.write=function(c){var d=this;this.writable=!1;for(var f=c.length,g=0,l=f;g<l;g++)(function(c){n.encodePacket(c,d.supportsBinary,
function(g){if(!s){var l={};c.options&&(l.compress=c.options.compress);if(d.perMessageDeflate&&("string"==typeof g?e.Buffer.byteLength(g):g.length)<d.perMessageDeflate.threshold)l.compress=!1}try{s?d.ws.send(g):d.ws.send(g,l)}catch(m){q("websocket closed before onclose event")}--f||(d.emit("flush"),setTimeout(function(){d.writable=!0;d.emit("drain")},0))})})(c[g])};f.prototype.onClose=function(){g.prototype.onClose.call(this)};f.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};
f.prototype.uri=function(){var c=this.query||{},d=this.secure?"wss":"ws",e="";if(this.port&&("wss"==d&&443!=this.port||"ws"==d&&80!=this.port))e=":"+this.port;this.timestampRequests&&(c[this.timestampParam]=r());this.supportsBinary||(c.b64=1);c=l.encode(c);c.length&&(c="?"+c);var f=-1!==this.hostname.indexOf(":");return d+"://"+(f?"["+this.hostname+"]":this.hostname)+e+this.path+c};f.prototype.check=function(){return!!u&&!("__initialize"in u&&this.name===f.prototype.name)}},{"../transport":4,"component-inherit":16,
debug:17,"engine.io-parser":19,parseqs:27,ws:void 0,yeast:30}],10:[function(c,d){var e=c("has-cors");d.exports=function(c){var d=c.xdomain,n=c.xscheme;c=c.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!d||e))return new XMLHttpRequest}catch(l){}try{if("undefined"!=typeof XDomainRequest&&!n&&c)return new XDomainRequest}catch(m){}if(!d)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}}},{"has-cors":22}],11:[function(c,d){function e(){}d.exports=function(c,d,n){function l(c,e){if(0>=
l.count)throw Error("after called too many times");--l.count;c?(m=!0,d(c),d=n):0===l.count&&!m&&d(null,e)}var m=!1;n=n||e;l.count=c;return 0===c?d():l}},{}],12:[function(c,d){d.exports=function(c,d,g){var n=c.byteLength;d=d||0;g=g||n;if(c.slice)return c.slice(d,g);0>d&&(d+=n);0>g&&(g+=n);g>n&&(g=n);if(d>=n||d>=g||0===n)return new ArrayBuffer(0);c=new Uint8Array(c);for(var n=new Uint8Array(g-d),l=0;d<g;d++,l++)n[l]=c[d];return n.buffer}},{}],13:[function(c,d,e){e.encode=function(c){c=new Uint8Array(c);
var d,e=c.length,l="";for(d=0;d<e;d+=3)l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c[d]>>2],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(c[d]&3)<<4|c[d+1]>>4],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(c[d+1]&15)<<2|c[d+2]>>6],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c[d+2]&63];2===e%3?l=l.substring(0,l.length-1)+"=":1===e%3&&(l=l.substring(0,l.length-2)+"==");return l};e.decode=function(c){var d=
0.75*c.length,e=c.length,l=0,m,r,q,s;"="===c[c.length-1]&&(d--,"="===c[c.length-2]&&d--);for(var u=new ArrayBuffer(d),t=new Uint8Array(u),d=0;d<e;d+=4)m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c[d]),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c[d+1]),q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c[d+2]),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c[d+3]),t[l++]=m<<2|
r>>4,t[l++]=(r&15)<<4|q>>2,t[l++]=(q&3)<<6|s&63;return u}},{}],14:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=function(c){for(var d=0;d<c.length;d++){var e=c[d];if(e.buffer instanceof ArrayBuffer){var f=e.buffer;if(e.byteLength!==f.byteLength){var g=new Uint8Array(e.byteLength);g.set(new Uint8Array(f,e.byteOffset,e.byteLength));f=g.buffer}c[d]=f}}},g=function(c,d){d=d||{};var e=new l;f(c);for(var g=0;g<c.length;g++)e.append(c[g]);
return d.type?e.getBlob(d.type):e.getBlob()},n=function(c,d){f(c);return new Blob(c,d||{})},l=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,m;try{m=2===(new Blob(["hi"])).size}catch(r){m=!1}var q;if(q=m)try{q=2===(new Blob([new Uint8Array([1,2])])).size}catch(s){q=!1}var u=l&&l.prototype.append&&l.prototype.getBlob;e=m?q?e.Blob:n:u?g:void 0;d.exports=e},{}],15:[function(c,d){function e(c){if(c){for(var d in e.prototype)c[d]=e.prototype[d];return c}}d.exports=e;e.prototype.on=
e.prototype.addEventListener=function(c,d){this._callbacks=this._callbacks||{};(this._callbacks[c]=this._callbacks[c]||[]).push(d);return this};e.prototype.once=function(c,d){function e(){l.off(c,e);d.apply(this,arguments)}var l=this;this._callbacks=this._callbacks||{};e.fn=d;this.on(c,e);return this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(c,d){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks=
{},this;var e=this._callbacks[c];if(!e)return this;if(1==arguments.length)return delete this._callbacks[c],this;for(var l,m=0;m<e.length;m++)if(l=e[m],l===d||l.fn===d){e.splice(m,1);break}return this};e.prototype.emit=function(c){this._callbacks=this._callbacks||{};var d=[].slice.call(arguments,1),e=this._callbacks[c];if(e)for(var e=e.slice(0),l=0,m=e.length;l<m;++l)e[l].apply(this,d);return this};e.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks[c]||[]};
e.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],16:[function(c,d){d.exports=function(c,d){var g=function(){};g.prototype=d.prototype;c.prototype=new g;c.prototype.constructor=c}},{}],17:[function(c,d,e){function f(){var c;try{c=e.storage.debug}catch(d){}return c}e=d.exports=c("./debug");e.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};e.formatArgs=function(){var c=arguments,d=this.useColors;c[0]=
(d?"%c":"")+this.namespace+(d?" %c":" ")+c[0]+(d?"%c ":" ")+"+"+e.humanize(this.diff);if(!d)return c;var d="color: "+this.color,c=[c[0],d,"color: inherit"].concat(Array.prototype.slice.call(c,1)),f=0,g=0;c[0].replace(/%[a-z%]/g,function(c){"%%"!==c&&(f++,"%c"===c&&(g=f))});c.splice(g,0,d);return c};e.save=function(c){try{null==c?e.storage.removeItem("debug"):e.storage.debug=c}catch(d){}};e.load=f;e.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||
console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};var g;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)g=chrome.storage.local;else a:{try{g=window.localStorage;break a}catch(n){}g=void 0}e.storage=g;e.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");e.formatters.j=function(c){return JSON.stringify(c)};e.enable(f())},{"./debug":18}],18:[function(c,d,e){e=d.exports=function(c){function d(){}
function m(){var c=m,d=+new Date;c.diff=d-(g||d);c.prev=g;g=c.curr=d;null==c.useColors&&(c.useColors=e.useColors());null==c.color&&c.useColors&&(c.color=e.colors[f++%e.colors.length]);var l=Array.prototype.slice.call(arguments);l[0]=e.coerce(l[0]);"string"!==typeof l[0]&&(l=["%o"].concat(l));var n=0;l[0]=l[0].replace(/%([a-z%])/g,function(d,f){if("%%"===d)return d;n++;var g=e.formatters[f];"function"===typeof g&&(d=g.call(c,l[n]),l.splice(n,1),n--);return d});"function"===typeof e.formatArgs&&(l=
e.formatArgs.apply(c,l));(m.log||e.log||console.log.bind(console)).apply(c,l)}d.enabled=!1;m.enabled=!0;var r=e.enabled(c)?m:d;r.namespace=c;return r};e.coerce=function(c){return c instanceof Error?c.stack||c.message:c};e.disable=function(){e.enable("")};e.enable=function(c){e.save(c);for(var d=(c||"").split(/[\s,]+/),f=d.length,g=0;g<f;g++)d[g]&&(c=d[g].replace(/\*/g,".*?"),"-"===c[0]?e.skips.push(RegExp("^"+c.substr(1)+"$")):e.names.push(RegExp("^"+c+"$")))};e.enabled=function(c){var d,f;d=0;for(f=
e.skips.length;d<f;d++)if(e.skips[d].test(c))return!1;d=0;for(f=e.names.length;d<f;d++)if(e.names[d].test(c))return!0;return!1};e.humanize=c("ms");e.names=[];e.skips=[];e.formatters={};var f=0,g},{ms:25}],19:[function(c,d,e){var f="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},g=function(c,d,e){var f=Array(c.length);e=r(c.length,e);for(var g=function(c,e,g){d(e,function(d,e){f[c]=e;g(d,f)})},l=0;l<c.length;l++)g(l,c[l],e)};d=c("./keys");var n=
c("has-binary"),l=c("arraybuffer.slice"),m=c("base64-arraybuffer"),r=c("after"),q=c("utf8"),s=navigator.userAgent.match(/Android/i),u=/PhantomJS/i.test(navigator.userAgent),t=s||u;e.protocol=3;var v=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},x=d(v),E={type:"error",data:"parser error"},B=c("blob");e.encodePacket=function(c,d,g,l){"function"==typeof d&&(l=d,d=!1);"function"==typeof g&&(l=g,g=null);var m=void 0===c.data?void 0:c.data.buffer||c.data;if(f.ArrayBuffer&&m instanceof
ArrayBuffer){g=l;if(d){l=c.data;d=new Uint8Array(l);l=new Uint8Array(1+l.byteLength);l[0]=v[c.type];for(m=0;m<d.length;m++)l[m+1]=d[m];g=g(l.buffer)}else g=e.encodeBase64Packet(c,g);return g}if(B&&m instanceof f.Blob){var n=d,r=l;if(n)if(t)if(n){var s=new FileReader;s.onload=function(){c.data=s.result;e.encodePacket(c,n,!0,r)};g=s.readAsArrayBuffer(c.data)}else g=e.encodeBase64Packet(c,r);else g=new Uint8Array(1),g[0]=v[c.type],g=new B([g.buffer,c.data]),g=r(g);else g=e.encodeBase64Packet(c,r);return g}if(m&&
m.base64)return l("b"+e.packets[c.type]+c.data.data);d=v[c.type];void 0!==c.data&&(d+=g?q.encode(String(c.data)):String(c.data));return l(""+d)};e.encodeBase64Packet=function(c,d){var g="b"+e.packets[c.type];if(B&&c.data instanceof f.Blob){var l=new FileReader;l.onload=function(){var c=l.result.split(",")[1];d(g+c)};return l.readAsDataURL(c.data)}var m;try{m=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(n){m=new Uint8Array(c.data);for(var q=Array(m.length),r=0;r<m.length;r++)q[r]=m[r];
m=String.fromCharCode.apply(null,q)}g+=f.btoa(m);return d(g)};e.decodePacket=function(c,d,f){if("string"==typeof c||void 0===c){if("b"==c.charAt(0))return e.decodeBase64Packet(c.substr(1),d);if(f)try{c=q.decode(c)}catch(g){return E}f=c.charAt(0);return Number(f)!=f||!x[f]?E:1<c.length?{type:x[f],data:c.substring(1)}:{type:x[f]}}f=(new Uint8Array(c))[0];c=l(c,1);B&&"blob"===d&&(c=new B([c]));return{type:x[f],data:c}};e.decodeBase64Packet=function(c,d){var e=x[c.charAt(0)];if(!f.ArrayBuffer)return{type:e,
data:{base64:!0,data:c.substr(1)}};var g=m.decode(c.substr(1));"blob"===d&&B&&(g=new B([g]));return{type:e,data:g}};e.encodePayload=function(c,d,f){"function"==typeof d&&(f=d,d=null);var l=n(c);if(d&&l)return B&&!t?e.encodePayloadAsBlob(c,f):e.encodePayloadAsArrayBuffer(c,f);if(!c.length)return f("0:");g(c,function(c,f){e.encodePacket(c,!l?!1:d,!0,function(c){f(null,c.length+":"+c)})},function(c,d){return f(d.join(""))})};e.decodePayload=function(c,d,f){if("string"!=typeof c)return e.decodePayloadAsBinary(c,
d,f);"function"===typeof d&&(f=d,d=null);var g;if(""==c)return f(E,0,1);g="";for(var l,m,n=0,q=c.length;n<q;n++)if(m=c.charAt(n),":"!=m)g+=m;else{if(""==g||g!=(l=Number(g)))return f(E,0,1);m=c.substr(n+1,l);if(g!=m.length)return f(E,0,1);if(m.length){g=e.decodePacket(m,d,!0);if(E.type==g.type&&E.data==g.data)return f(E,0,1);if(!1===f(g,n+l,q))return}n+=l;g=""}if(""!=g)return f(E,0,1)};e.encodePayloadAsArrayBuffer=function(c,d){if(!c.length)return d(new ArrayBuffer(0));g(c,function(c,d){e.encodePacket(c,
!0,!0,function(c){return d(null,c)})},function(c,e){var f=e.reduce(function(c,d){var e;e="string"===typeof d?d.length:d.byteLength;return c+e.toString().length+e+2},0),g=new Uint8Array(f),l=0;e.forEach(function(c){var d="string"===typeof c,e=c;if(d){for(var e=new Uint8Array(c.length),f=0;f<c.length;f++)e[f]=c.charCodeAt(f);e=e.buffer}d?g[l++]=0:g[l++]=1;c=e.byteLength.toString();for(f=0;f<c.length;f++)g[l++]=parseInt(c[f]);g[l++]=255;e=new Uint8Array(e);for(f=0;f<e.length;f++)g[l++]=e[f]});return d(g.buffer)})};
e.encodePayloadAsBlob=function(c,d){g(c,function(c,d){e.encodePacket(c,!0,!0,function(c){var e=new Uint8Array(1);e[0]=1;if("string"===typeof c){for(var f=new Uint8Array(c.length),g=0;g<c.length;g++)f[g]=c.charCodeAt(g);c=f.buffer;e[0]=0}for(var f=(c instanceof ArrayBuffer?c.byteLength:c.size).toString(),l=new Uint8Array(f.length+1),g=0;g<f.length;g++)l[g]=parseInt(f[g]);l[f.length]=255;B&&(c=new B([e.buffer,l.buffer,c]),d(null,c))})},function(c,e){return d(new B(e))})};e.decodePayloadAsBinary=function(c,
d,f){"function"===typeof d&&(f=d,d=null);for(var g=[],m=!1;0<c.byteLength;){for(var n=new Uint8Array(c),q=0===n[0],r="",s=1;255!=n[s];s++){if(310<r.length){m=!0;break}r+=n[s]}if(m)return f(E,0,1);c=l(c,2+r.length);r=parseInt(r);n=l(c,0,r);if(q)try{n=String.fromCharCode.apply(null,new Uint8Array(n))}catch(v){q=new Uint8Array(n);n="";for(s=0;s<q.length;s++)n+=String.fromCharCode(q[s])}g.push(n);c=l(c,r)}var t=g.length;g.forEach(function(c,g){f(e.decodePacket(c,d,!0),g,t)})}},{"./keys":20,after:11,"arraybuffer.slice":12,
"base64-arraybuffer":13,blob:14,"has-binary":21,utf8:29}],20:[function(c,d){d.exports=Object.keys||function(c){var d=[],g=Object.prototype.hasOwnProperty,n;for(n in c)g.call(c,n)&&d.push(n);return d}},{}],21:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=c("isarray");d.exports=function(c){function d(c){if(!c)return!1;if(e.Buffer&&e.Buffer.isBuffer(c)||e.ArrayBuffer&&c instanceof ArrayBuffer||e.Blob&&c instanceof Blob||
e.File&&c instanceof File)return!0;if(f(c))for(var g=0;g<c.length;g++){if(d(c[g]))return!0}else if(c&&"object"==typeof c)for(g in c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,g)&&d(c[g]))return!0;return!1}return d(c)}},{isarray:24}],22:[function(c,d){try{d.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){d.exports=!1}},{}],23:[function(c,d){var e=[].indexOf;d.exports=function(c,d){if(e)return c.indexOf(d);for(var n=0;n<c.length;++n)if(c[n]===
d)return n;return-1}},{}],24:[function(c,d){d.exports=Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},{}],25:[function(c,d){function e(c){c=""+c;if(!(1E4<c.length)&&(c=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(c))){var d=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return d*r;case "days":case "day":case "d":return d*
m;case "hours":case "hour":case "hrs":case "hr":case "h":return d*l;case "minutes":case "minute":case "mins":case "min":case "m":return d*n;case "seconds":case "second":case "secs":case "sec":case "s":return d*g;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return d}}}function f(c,d,e){if(!(c<d))return c<1.5*d?Math.floor(c/d)+" "+e:Math.ceil(c/d)+" "+e+"s"}var g=1E3,n=60*g,l=60*n,m=24*l,r=365.25*m;d.exports=function(c,d){d=d||{};return"string"==typeof c?e(c):d.long?f(c,
m,"day")||f(c,l,"hour")||f(c,n,"minute")||f(c,g,"second")||c+" ms":c>=m?Math.round(c/m)+"d":c>=l?Math.round(c/l)+"h":c>=n?Math.round(c/n)+"m":c>=g?Math.round(c/g)+"s":c+"ms"}},{}],26:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g,m=/^\s+/,r=/\s+$/;d.exports=function(c){if("string"!=
typeof c||!c)return null;c=c.replace(m,"").replace(r,"");if(e.JSON&&JSON.parse)return JSON.parse(c);if(f.test(c.replace(g,"@").replace(n,"]").replace(l,"")))return(new Function("return "+c))()}},{}],27:[function(c,d,e){e.encode=function(c){var d="",e;for(e in c)c.hasOwnProperty(e)&&(d.length&&(d+="&"),d+=encodeURIComponent(e)+"="+encodeURIComponent(c[e]));return d};e.decode=function(c){var d={};c=c.split("&");for(var e=0,l=c.length;e<l;e++){var m=c[e].split("=");d[decodeURIComponent(m[0])]=decodeURIComponent(m[1])}return d}},
{}],28:[function(c,d){var e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");d.exports=function(c){var d=c,l=c.indexOf("["),m=c.indexOf("]");-1!=l&&-1!=m&&(c=c.substring(0,l)+c.substring(l,m).replace(/:/g,
";")+c.substring(m,c.length));c=e.exec(c||"");for(var r={},q=14;q--;)r[f[q]]=c[q]||"";-1!=l&&-1!=m&&(r.source=d,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0);return r}},{}],29:[function(c,d,e){var f="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{};c=this;var g=function(c){for(var d=[],e=0,f=c.length,g,l;e<f;)g=c.charCodeAt(e++),55296<=g&&56319>=
g&&e<f?(l=c.charCodeAt(e++),56320==(l&64512)?d.push(((g&1023)<<10)+(l&1023)+65536):(d.push(g),e--)):d.push(g);return d},n=function(c){if(55296<=c&&57343>=c)throw Error("Lone surrogate U+"+c.toString(16).toUpperCase()+" is not a scalar value");},l=function(){if(u>=s)throw Error("Invalid byte index");var c=q[u]&255;u++;if(128==(c&192))return c&63;throw Error("Invalid continuation byte");},m=function(){var c,d,e,f;if(u>s)throw Error("Invalid byte index");if(u==s)return!1;c=q[u]&255;u++;if(0==(c&128))return c;
if(192==(c&224)){d=l();c=(c&31)<<6|d;if(128<=c)return c;throw Error("Invalid continuation byte");}if(224==(c&240)){d=l();e=l();c=(c&15)<<12|d<<6|e;if(2048<=c)return n(c),c;throw Error("Invalid continuation byte");}if(240==(c&248)&&(d=l(),e=l(),f=l(),c=(c&15)<<18|d<<12|e<<6|f,65536<=c&&1114111>=c))return c;throw Error("Invalid UTF-8 detected");};e="object"==typeof e&&e;d="object"==typeof d&&d&&d.exports==e&&d;f="object"==typeof f&&f;if(f.global===f||f.window===f)c=f;var r=String.fromCharCode,q,s,u,
f={version:"2.0.0",encode:function(c){c=g(c);for(var d=c.length,e=-1,f,l="";++e<d;){f=c[e];if(0==(f&4294967168))f=r(f);else{var m="";0==(f&4294965248)?m=r(f>>6&31|192):0==(f&4294901760)?(n(f),m=r(f>>12&15|224),m+=r(f>>6&63|128)):0==(f&4292870144)&&(m=r(f>>18&7|240),m+=r(f>>12&63|128),m+=r(f>>6&63|128));f=m+=r(f&63|128)}l+=f}return l},decode:function(c){q=g(c);s=q.length;u=0;c=[];for(var d;!1!==(d=m());)c.push(d);d=c.length;for(var e=-1,f,l="";++e<d;)f=c[e],65535<f&&(f-=65536,l+=r(f>>>10&1023|55296),
f=56320|f&1023),l+=r(f);return l}};if(e&&!e.nodeType)if(d)d.exports=f;else{c={}.hasOwnProperty;for(var t in f)c.call(f,t)&&(e[t]=f[t])}else c.utf8=f},{}],30:[function(c,d){function e(c){var d="";do d=g[c%n]+d,c=Math.floor(c/n);while(0<c);return d}function f(){var c=e(+new Date);return c!==q?(m=0,q=c):c+"."+e(m++)}for(var g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=64,l={},m=0,r=0,q;r<n;r++)l[g[r]]=r;f.encode=e;f.decode=function(c){var d=0;for(r=0;r<c.length;r++)d=
d*n+l[c.charAt(r)];return d};d.exports=f},{}],31:[function(c,d,e){function f(c,d){"object"==typeof c&&(d=c,c=void 0);d=d||{};var e=g(c),f=e.source,n=e.id,x=e.path,x=r[n]&&x in r[n].nsps;d.forceNew||d["force new connection"]||!1===d.multiplex||x?(m("ignoring socket cache for %s",f),f=l(f,d)):(r[n]||(m("new io instance for %s",f),r[n]=l(f,d)),f=r[n]);return f.socket(e.path)}var g=c("./url"),n=c("socket.io-parser"),l=c("./manager"),m=c("debug")("socket.io-client");d.exports=e=f;var r=e.managers={};e.protocol=
n.protocol;e.connect=f;e.Manager=c("./manager");e.Socket=c("./socket")},{"./manager":32,"./socket":34,"./url":35,debug:39,"socket.io-parser":47}],32:[function(c,d){function e(c,d){if(!(this instanceof e))return new e(c,d);c&&"object"==typeof c&&(d=c,c=void 0);d=d||{};d.path=d.path||"/socket.io";this.nsps={};this.subs=[];this.opts=d;this.reconnection(!1!==d.reconnection);this.reconnectionAttempts(d.reconnectionAttempts||Infinity);this.reconnectionDelay(d.reconnectionDelay||1E3);this.reconnectionDelayMax(d.reconnectionDelayMax||
5E3);this.randomizationFactor(d.randomizationFactor||0.5);this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==d.timeout?2E4:d.timeout);this.readyState="closed";this.uri=c;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];this.encoder=new l.Encoder;this.decoder=new l.Decoder;(this.autoConnect=!1!==d.autoConnect)&&this.open()}var f=c("engine.io-client"),g=c("./socket"),n=c("component-emitter"),
l=c("socket.io-parser"),m=c("./on"),r=c("component-bind"),q=c("debug")("socket.io-client:manager"),s=c("indexof"),u=c("backo2"),t=Object.prototype.hasOwnProperty;d.exports=e;e.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var c in this.nsps)t.call(this.nsps,c)&&this.nsps[c].emit.apply(this.nsps[c],arguments)};e.prototype.updateSocketIds=function(){for(var c in this.nsps)t.call(this.nsps,c)&&(this.nsps[c].id=this.engine.id)};n(e.prototype);e.prototype.reconnection=function(c){if(!arguments.length)return this._reconnection;
this._reconnection=!!c;return this};e.prototype.reconnectionAttempts=function(c){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=c;return this};e.prototype.reconnectionDelay=function(c){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=c;this.backoff&&this.backoff.setMin(c);return this};e.prototype.randomizationFactor=function(c){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=c;this.backoff&&this.backoff.setJitter(c);
return this};e.prototype.reconnectionDelayMax=function(c){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=c;this.backoff&&this.backoff.setMax(c);return this};e.prototype.timeout=function(c){if(!arguments.length)return this._timeout;this._timeout=c;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&(this._reconnection&&0===this.backoff.attempts)&&this.reconnect()};e.prototype.open=e.prototype.connect=function(c){q("readyState %s",this.readyState);
if(~this.readyState.indexOf("open"))return this;q("opening %s",this.uri);var d=this.engine=f(this.uri,this.opts),e=this;this.readyState="opening";this.skipReconnect=!1;var g=m(d,"open",function(){e.onopen();c&&c()}),l=m(d,"error",function(d){q("connect_error");e.cleanup();e.readyState="closed";e.emitAll("connect_error",d);if(c){var f=Error("Connection error");f.data=d;c(f)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var n=this._timeout;q("connect attempt will timeout after %d",n);var r=
setTimeout(function(){q("connect attempt timed out after %d",n);g.destroy();d.close();d.emit("error","timeout");e.emitAll("connect_timeout",n)},n);this.subs.push({destroy:function(){clearTimeout(r)}})}this.subs.push(g);this.subs.push(l);return this};e.prototype.onopen=function(){q("open");this.cleanup();this.readyState="open";this.emit("open");var c=this.engine;this.subs.push(m(c,"data",r(this,"ondata")));this.subs.push(m(c,"ping",r(this,"onping")));this.subs.push(m(c,"pong",r(this,"onpong")));this.subs.push(m(c,
"error",r(this,"onerror")));this.subs.push(m(c,"close",r(this,"onclose")));this.subs.push(m(this.decoder,"decoded",r(this,"ondecoded")))};e.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};e.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};e.prototype.ondata=function(c){this.decoder.add(c)};e.prototype.ondecoded=function(c){this.emit("packet",c)};e.prototype.onerror=function(c){q("error",c);this.emitAll("error",c)};e.prototype.socket=function(c){function d(){~s(f.connecting,
e)||f.connecting.push(e)}var e=this.nsps[c];if(!e){e=new g(this,c);this.nsps[c]=e;var f=this;e.on("connecting",d);e.on("connect",function(){e.id=f.engine.id});this.autoConnect&&d()}return e};e.prototype.destroy=function(c){c=s(this.connecting,c);~c&&this.connecting.splice(c,1);this.connecting.length||this.close()};e.prototype.packet=function(c){q("writing packet %j",c);var d=this;d.encoding?d.packetBuffer.push(c):(d.encoding=!0,this.encoder.encode(c,function(e){for(var f=0;f<e.length;f++)d.engine.write(e[f],
c.options);d.encoding=!1;d.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var c=this.packetBuffer.shift();this.packet(c)}};e.prototype.cleanup=function(){q("cleanup");for(var c;c=this.subs.shift();)c.destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){q("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"==this.readyState&&this.cleanup();
this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};e.prototype.onclose=function(c){q("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",c);this._reconnection&&!this.skipReconnect&&this.reconnect()};e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)q("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=
!1;else{var d=this.backoff.duration();q("will wait %dms before reconnect attempt",d);this.reconnecting=!0;var e=setTimeout(function(){c.skipReconnect||(q("attempting reconnect"),c.emitAll("reconnect_attempt",c.backoff.attempts),c.emitAll("reconnecting",c.backoff.attempts),c.skipReconnect||c.open(function(d){d?(q("reconnect attempt error"),c.reconnecting=!1,c.reconnect(),c.emitAll("reconnect_error",d.data)):(q("reconnect success"),c.onreconnect())}))},d);this.subs.push({destroy:function(){clearTimeout(e)}})}};
e.prototype.onreconnect=function(){var c=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",c)}},{"./on":33,"./socket":34,backo2:36,"component-bind":37,"component-emitter":38,debug:39,"engine.io-client":1,indexof:42,"socket.io-parser":47}],33:[function(c,d){d.exports=function(c,d,g){c.on(d,g);return{destroy:function(){c.removeListener(d,g)}}}},{}],34:[function(c,d){function e(c,d){this.io=c;this.nsp=d;this.json=this;this.ids=0;this.acks=
{};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;this.io.autoConnect&&this.open()}var f=c("socket.io-parser"),g=c("component-emitter"),n=c("to-array"),l=c("./on"),m=c("component-bind"),r=c("debug")("socket.io-client:socket"),q=c("has-binary");d.exports=e;var s={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},u=g.prototype.emit;g(e.prototype);
e.prototype.subEvents=function(){if(!this.subs){var c=this.io;this.subs=[l(c,"open",m(this,"onopen")),l(c,"packet",m(this,"onpacket")),l(c,"close",m(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();this.emit("connecting");return this};e.prototype.send=function(){var c=n(arguments);c.unshift("message");this.emit.apply(this,c);return this};e.prototype.emit=function(c){if(s.hasOwnProperty(c))return u.apply(this,
arguments),this;var d=n(arguments),e=f.EVENT;q(d)&&(e=f.BINARY_EVENT);e={type:e,data:d,options:{}};e.options.compress=!this.flags||!1!==this.flags.compress;"function"==typeof d[d.length-1]&&(r("emitting packet with ack id %d",this.ids),this.acks[this.ids]=d.pop(),e.id=this.ids++);this.connected?this.packet(e):this.sendBuffer.push(e);delete this.flags;return this};e.prototype.packet=function(c){c.nsp=this.nsp;this.io.packet(c)};e.prototype.onopen=function(){r("transport is open - connecting");"/"!=
this.nsp&&this.packet({type:f.CONNECT})};e.prototype.onclose=function(c){r("close (%s)",c);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",c)};e.prototype.onpacket=function(c){if(c.nsp==this.nsp)switch(c.type){case f.CONNECT:this.onconnect();break;case f.EVENT:this.onevent(c);break;case f.BINARY_EVENT:this.onevent(c);break;case f.ACK:this.onack(c);break;case f.BINARY_ACK:this.onack(c);break;case f.DISCONNECT:this.ondisconnect();break;case f.ERROR:this.emit("error",c.data)}};
e.prototype.onevent=function(c){var d=c.data||[];r("emitting event %j",d);null!=c.id&&(r("attaching ack callback to event"),d.push(this.ack(c.id)));this.connected?u.apply(this,d):this.receiveBuffer.push(d)};e.prototype.ack=function(c){var d=this,e=!1;return function(){if(!e){e=!0;var g=n(arguments);r("sending ack %j",g);var l=q(g)?f.BINARY_ACK:f.ACK;d.packet({type:l,id:c,data:g})}}};e.prototype.onack=function(c){var d=this.acks[c.id];"function"==typeof d?(r("calling ack %s with %j",c.id,c.data),d.apply(this,
c.data),delete this.acks[c.id]):r("bad ack %s",c.id)};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=function(){var c;for(c=0;c<this.receiveBuffer.length;c++)u.apply(this,this.receiveBuffer[c]);this.receiveBuffer=[];for(c=0;c<this.sendBuffer.length;c++)this.packet(this.sendBuffer[c]);this.sendBuffer=[]};e.prototype.ondisconnect=function(){r("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};
e.prototype.destroy=function(){if(this.subs){for(var c=0;c<this.subs.length;c++)this.subs[c].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=function(){this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:f.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this};e.prototype.compress=function(c){this.flags=this.flags||{};this.flags.compress=c;return this}},{"./on":33,"component-bind":37,"component-emitter":38,
debug:39,"has-binary":41,"socket.io-parser":47,"to-array":51}],35:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=c("parseuri"),g=c("debug")("socket.io-client:url");d.exports=function(c,d){var m=c;d=d||e.location;null==c&&(c=d.protocol+"//"+d.host);"string"==typeof c&&("/"==c.charAt(0)&&(c="/"==c.charAt(1)?d.protocol+c:d.host+c),/^(https?|wss?):\/\//.test(c)||(g("protocol-less url %s",c),c="undefined"!=typeof d?d.protocol+
"//"+c:"https://"+c),g("parse %s",c),m=f(c));m.port||(/^(http|ws)$/.test(m.protocol)?m.port="80":/^(http|ws)s$/.test(m.protocol)&&(m.port="443"));m.path=m.path||"/";var r=-1!==m.host.indexOf(":")?"["+m.host+"]":m.host;m.id=m.protocol+"://"+r+":"+m.port;m.href=m.protocol+"://"+r+(d&&d.port==m.port?"":":"+m.port);return m}},{debug:39,parseuri:45}],36:[function(c,d){function e(c){c=c||{};this.ms=c.min||100;this.max=c.max||1E4;this.factor=c.factor||2;this.jitter=0<c.jitter&&1>=c.jitter?c.jitter:0;this.attempts=
0}d.exports=e;e.prototype.duration=function(){var c=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var d=Math.random(),e=Math.floor(d*this.jitter*c),c=0==(Math.floor(10*d)&1)?c-e:c+e;return Math.min(c,this.max)|0};e.prototype.reset=function(){this.attempts=0};e.prototype.setMin=function(c){this.ms=c};e.prototype.setMax=function(c){this.max=c};e.prototype.setJitter=function(c){this.jitter=c}},{}],37:[function(c,d){var e=[].slice;d.exports=function(c,d){"string"==typeof d&&(d=c[d]);if("function"!=
typeof d)throw Error("bind() requires a function");var n=e.call(arguments,2);return function(){return d.apply(c,n.concat(e.call(arguments)))}}},{}],38:[function(c,d){function e(c){if(c){for(var d in e.prototype)c[d]=e.prototype[d];return c}}d.exports=e;e.prototype.on=e.prototype.addEventListener=function(c,d){this._callbacks=this._callbacks||{};(this._callbacks["$"+c]=this._callbacks["$"+c]||[]).push(d);return this};e.prototype.once=function(c,d){function e(){this.off(c,e);d.apply(this,arguments)}
e.fn=d;this.on(c,e);return this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(c,d){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var e=this._callbacks["$"+c];if(!e)return this;if(1==arguments.length)return delete this._callbacks["$"+c],this;for(var l,m=0;m<e.length;m++)if(l=e[m],l===d||l.fn===d){e.splice(m,1);break}return this};e.prototype.emit=function(c){this._callbacks=this._callbacks||
{};var d=[].slice.call(arguments,1),e=this._callbacks["$"+c];if(e)for(var e=e.slice(0),l=0,m=e.length;l<m;++l)e[l].apply(this,d);return this};e.prototype.listeners=function(c){this._callbacks=this._callbacks||{};return this._callbacks["$"+c]||[]};e.prototype.hasListeners=function(c){return!!this.listeners(c).length}},{}],39:[function(c,d,e){arguments[4][17][0].apply(e,arguments)},{"./debug":40,dup:17}],40:[function(c,d,e){arguments[4][18][0].apply(e,arguments)},{dup:18,ms:44}],41:[function(c,d){var e=
"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},f=c("isarray");d.exports=function(c){function d(c){if(!c)return!1;if(e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(c)||e.ArrayBuffer&&c instanceof ArrayBuffer||e.Blob&&c instanceof Blob||e.File&&c instanceof File)return!0;if(f(c))for(var g=0;g<c.length;g++){if(d(c[g]))return!0}else if(c&&"object"==typeof c)for(g in c.toJSON&&"function"==typeof c.toJSON&&(c=c.toJSON()),c)if(Object.prototype.hasOwnProperty.call(c,
g)&&d(c[g]))return!0;return!1}return d(c)}},{isarray:43}],42:[function(c,d,e){arguments[4][23][0].apply(e,arguments)},{dup:23}],43:[function(c,d,e){arguments[4][24][0].apply(e,arguments)},{dup:24}],44:[function(c,d,e){arguments[4][25][0].apply(e,arguments)},{dup:25}],45:[function(c,d,e){arguments[4][28][0].apply(e,arguments)},{dup:28}],46:[function(c,d,e){var f="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},g=c("isarray"),n=c("./is-buffer");
e.deconstructPacket=function(c){function d(c){if(!c)return c;if(n(c)){var f={_placeholder:!0,num:e.length};e.push(c);return f}if(g(c)){for(var f=Array(c.length),l=0;l<c.length;l++)f[l]=d(c[l]);return f}if("object"==typeof c&&!(c instanceof Date)){f={};for(l in c)f[l]=d(c[l]);return f}return c}var e=[];c.data=d(c.data);c.attachments=e.length;return{packet:c,buffers:e}};e.reconstructPacket=function(c,d){function e(c){if(c&&c._placeholder)return d[c.num];if(g(c))for(var f=0;f<c.length;f++)c[f]=e(c[f]);
else if(c&&"object"==typeof c)for(f in c)c[f]=e(c[f]);return c}c.data=e(c.data);c.attachments=void 0;return c};e.removeBlobs=function(c,d){function e(c,l,v){if(!c)return c;if(f.Blob&&c instanceof Blob||f.File&&c instanceof File){q++;var x=new FileReader;x.onload=function(){v?v[l]=this.result:s=this.result;--q||d(s)};x.readAsArrayBuffer(c)}else if(g(c))for(x=0;x<c.length;x++)e(c[x],x,c);else if(c&&"object"==typeof c&&!n(c))for(x in c)e(c[x],x,c)}var q=0,s=c;e(s);q||d(s)}},{"./is-buffer":48,isarray:43}],
47:[function(c,d,e){function f(){}function g(c){var d,f=!1;d=""+c.type;if(e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type)d+=c.attachments,d+="-";c.nsp&&"/"!=c.nsp&&(f=!0,d+=c.nsp);null!=c.id&&(f&&(d+=",",f=!1),d+=c.id);null!=c.data&&(f&&(d+=","),d+=q.stringify(c.data));r("encoded %j as %s",c,d);return d}function n(){this.reconstructor=null}function l(c){this.reconPack=c;this.buffers=[]}function m(){return{type:e.ERROR,data:"parser error"}}var r=c("debug")("socket.io-parser"),q=c("json3");c("isarray");
d=c("component-emitter");var s=c("./binary"),u=c("./is-buffer");e.protocol=4;e.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=5;e.BINARY_ACK=6;e.Encoder=f;e.Decoder=n;f.prototype.encode=function(c,d){r("encoding packet %j",c);if(e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type)s.removeBlobs(c,function(c){var e=s.deconstructPacket(c);c=g(e.packet);e=e.buffers;e.unshift(c);d(e)});else{var f=g(c);d([f])}};
d(n.prototype);n.prototype.add=function(c){if("string"==typeof c){a:{var d={},f=0;d.type=Number(c.charAt(0));if(null==e.types[d.type])c=m();else{if(e.BINARY_EVENT==d.type||e.BINARY_ACK==d.type){for(var g="";"-"!=c.charAt(++f)&&!(g+=c.charAt(f),f==c.length););if(g!=Number(g)||"-"!=c.charAt(f))throw Error("Illegal attachments");d.attachments=Number(g)}if("/"==c.charAt(f+1))for(d.nsp="";++f;){g=c.charAt(f);if(","==g)break;d.nsp+=g;if(f==c.length)break}else d.nsp="index.html";g=c.charAt(f+1);if(""!==g&&Number(g)==
g){for(d.id="";++f;){g=c.charAt(f);if(null==g||Number(g)!=g){--f;break}d.id+=c.charAt(f);if(f==c.length)break}d.id=Number(d.id)}if(c.charAt(++f))try{d.data=q.parse(c.substr(f))}catch(n){c=m();break a}r("decoded %s as %j",c,d);c=d}}e.BINARY_EVENT==c.type||e.BINARY_ACK==c.type?(this.reconstructor=new l(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c)}else if(u(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=
null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};n.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};l.prototype.takeBinaryData=function(c){this.buffers.push(c);return this.buffers.length==this.reconPack.attachments?(c=s.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),c):null};l.prototype.finishedReconstruction=function(){this.reconPack=null;
this.buffers=[]}},{"./binary":46,"./is-buffer":48,"component-emitter":49,debug:39,isarray:43,json3:50}],48:[function(c,d){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{};d.exports=function(c){return e.Buffer&&e.Buffer.isBuffer(c)||e.ArrayBuffer&&c instanceof ArrayBuffer}},{}],49:[function(c,d,e){arguments[4][15][0].apply(e,arguments)},{dup:15}],50:[function(c,d,e){c="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==
typeof global?global:{};var f=function(c,d){function e(c){if(e[c]!==H)return e[c];var f;if("bug-string-char-index"==c)f="a"!="a"[0];else if("json"==c)f=e("json-stringify")&&e("json-parse");else{var g;if("json-stringify"==c){f=d.stringify;var n="function"==typeof f&&aa;if(n){(g=function(){return 1}).toJSON=g;try{n="0"===f(0)&&"0"===f(new l)&&'""'==f(new m)&&f(N)===H&&f(H)===H&&f()===H&&"1"===f(g)&&"[1]"==f([g])&&"[null]"==f([H])&&"null"==f(null)&&"[null,null,null]"==f([H,N,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==
f({a:[g,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===f(null,g)&&"[\n 1,\n 2\n]"==f([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==f(new r(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==f(new r(864E13))&&'"-000001-01-01T00:00:00.000Z"'==f(new r(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==f(new r(-1))}catch(p){n=!1}}f=n}if("json-parse"==c){f=d.parse;if("function"==typeof f)try{if(0===f("0")&&!f(!1)){g=f('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var q=5==g.a.length&&1===g.a[0];if(q){try{q=!f('"\t"')}catch(s){}if(q)try{q=
1!==f("01")}catch(y){}if(q)try{q=1!==f("1.")}catch(z){}}}}catch(A){q=!1}f=q}}return e[c]=!!f}c||(c=n.Object());d||(d=n.Object());var l=c.Number||n.Number,m=c.String||n.String,q=c.Object||n.Object,r=c.Date||n.Date,F=c.SyntaxError||n.SyntaxError,A=c.TypeError||n.TypeError,J=c.Math||n.Math,D=c.JSON||n.JSON;"object"==typeof D&&D&&(d.stringify=D.stringify,d.parse=D.parse);var q=q.prototype,N=q.toString,C,ia,H,aa=new r(-0xc782b5b800cec);try{aa=-109252==aa.getUTCFullYear()&&0===aa.getUTCMonth()&&1===aa.getUTCDate()&&
10==aa.getUTCHours()&&37==aa.getUTCMinutes()&&6==aa.getUTCSeconds()&&708==aa.getUTCMilliseconds()}catch(hb){}if(!e("json")){var O=e("bug-string-char-index");if(!aa)var X=J.floor,Ma=[0,31,59,90,120,151,181,212,243,273,304,334],ja=function(c,d){return Ma[d]+365*(c-1970)+X((c-1969+(d=+(1<d)))/4)-X((c-1901+d)/100)+X((c-1601+d)/400)};if(!(C=q.hasOwnProperty))C=function(c){var d={},e;(d.__proto__=null,d.__proto__={toString:1},d).toString!=N?C=function(c){var d=this.__proto__;c=c in(this.__proto__=null,
this);this.__proto__=d;return c}:(e=d.constructor,C=function(c){var d=(this.constructor||e).prototype;return c in this&&!(c in d&&this[c]===d[c])});d=null;return C.call(this,c)};ia=function(c,d){var e=0,f,l,m;(f=function(){this.valueOf=0}).prototype.valueOf=0;l=new f;for(m in l)C.call(l,m)&&e++;f=l=null;e?ia=2==e?function(c,d){var e={},f="[object Function]"==N.call(c),g;for(g in c)!(f&&"prototype"==g)&&(!C.call(e,g)&&(e[g]=1)&&C.call(c,g))&&d(g)}:function(c,d){var e="[object Function]"==N.call(c),
f,g;for(f in c)!(e&&"prototype"==f)&&(C.call(c,f)&&!(g="constructor"===f))&&d(f);(g||C.call(c,f="constructor"))&&d(f)}:(l="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),ia=function(c,d){var e="[object Function]"==N.call(c),f,m=!e&&"function"!=typeof c.constructor&&g[typeof c.hasOwnProperty]&&c.hasOwnProperty||C;for(f in c)!(e&&"prototype"==f)&&m.call(c,f)&&d(f);for(e=l.length;f=l[--e];m.call(c,f)&&d(f));});return ia(c,d)};if(!e("json-stringify")){var wa=
{92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},y=function(c,d){return("000000"+(d||0)).slice(-c)},Na=function(c){for(var d='"',e=0,f=c.length,g=!O||10<f,l=g&&(O?c.split(""):c);e<f;e++){var m=c.charCodeAt(e);switch(m){case 8:case 9:case 10:case 12:case 13:case 34:case 92:d+=wa[m];break;default:if(32>m){d+="\\u00"+y(2,m.toString(16));break}d+=g?l[e]:c.charAt(e)}}return d+'"'},Da=function(c,d,e,f,g,l,m){var n,p,q,r,s,u,t,v,x;try{n=d[c]}catch(z){}if("object"==typeof n&&n)if(p=N.call(n),
"[object Date]"==p&&!C.call(n,"toJSON"))if(n>-1/0&&n<1/0){if(ja){r=X(n/864E5);for(p=X(r/365.2425)+1970-1;ja(p+1,0)<=r;p++);for(q=X((r-ja(p,0))/30.42);ja(p,q+1)<=r;q++);r=1+r-ja(p,q);s=(n%864E5+864E5)%864E5;u=X(s/36E5)%24;t=X(s/6E4)%60;v=X(s/1E3)%60;s%=1E3}else p=n.getUTCFullYear(),q=n.getUTCMonth(),r=n.getUTCDate(),u=n.getUTCHours(),t=n.getUTCMinutes(),v=n.getUTCSeconds(),s=n.getUTCMilliseconds();n=(0>=p||1E4<=p?(0>p?"-":"+")+y(6,0>p?-p:p):y(4,p))+"-"+y(2,q+1)+"-"+y(2,r)+"T"+y(2,u)+":"+y(2,t)+":"+
y(2,v)+"."+y(3,s)+"Z"}else n=null;else if("function"==typeof n.toJSON&&("[object Number]"!=p&&"[object String]"!=p&&"[object Array]"!=p||C.call(n,"toJSON")))n=n.toJSON(c);e&&(n=e.call(d,c,n));if(null===n)return"null";p=N.call(n);if("[object Boolean]"==p)return""+n;if("[object Number]"==p)return n>-1/0&&n<1/0?""+n:"null";if("[object String]"==p)return Na(""+n);if("object"==typeof n){for(c=m.length;c--;)if(m[c]===n)throw A();m.push(n);x=[];d=l;l+=g;if("[object Array]"==p){q=0;for(c=n.length;q<c;q++)p=
Da(q,n,e,f,g,l,m),x.push(p===H?"null":p);c=x.length?g?"[\n"+l+x.join(",\n"+l)+"\n"+d+"]":"["+x.join(",")+"]":"[]"}else ia(f||n,function(c){var d=Da(c,n,e,f,g,l,m);d!==H&&x.push(Na(c)+":"+(g?" ":"")+d)}),c=x.length?g?"{\n"+l+x.join(",\n"+l)+"\n"+d+"}":"{"+x.join(",")+"}":"{}";m.pop();return c}};d.stringify=function(c,d,e){var f,l,m,n;if(g[typeof d]&&d)if("[object Function]"==(n=N.call(d)))l=d;else if("[object Array]"==n){m={};for(var p=0,q=d.length,r;p<q;r=d[p++],(n=N.call(r),"[object String]"==n||
"[object Number]"==n)&&(m[r]=1));}if(e)if("[object Number]"==(n=N.call(e))){if(0<(e-=e%1)){f="";for(10<e&&(e=10);f.length<e;f+=" ");}}else"[object String]"==n&&(f=10>=e.length?e:e.slice(0,10));return Da("",(r={},r[""]=c,r),l,m,f,"",[])}}if(!e("json-parse")){var ib=m.fromCharCode,jb={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},z,Y,M=function(){z=Y=null;throw F();},ga=function(){for(var c=Y,d=c.length,e,f,g,l,m;z<d;)switch(m=c.charCodeAt(z),m){case 9:case 10:case 13:case 32:z++;
break;case 123:case 125:case 91:case 93:case 58:case 44:return e=O?c.charAt(z):c[z],z++,e;case 34:e="@";for(z++;z<d;)if(m=c.charCodeAt(z),32>m)M();else if(92==m)switch(m=c.charCodeAt(++z),m){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=jb[m];z++;break;case 117:f=++z;for(g=z+4;z<g;z++)m=c.charCodeAt(z),48<=m&&57>=m||(97<=m&&102>=m||65<=m&&70>=m)||M();e+=ib("0x"+c.slice(f,z));break;default:M()}else{if(34==m)break;m=c.charCodeAt(z);for(f=z;32<=m&&92!=m&&34!=m;)m=c.charCodeAt(++z);
e+=c.slice(f,z)}if(34==c.charCodeAt(z))return z++,e;M();default:f=z;45==m&&(l=!0,m=c.charCodeAt(++z));if(48<=m&&57>=m){for(48==m&&(m=c.charCodeAt(z+1),48<=m&&57>=m)&&M();z<d&&(m=c.charCodeAt(z),48<=m&&57>=m);z++);if(46==c.charCodeAt(z)){for(g=++z;g<d&&(m=c.charCodeAt(g),48<=m&&57>=m);g++);g==z&&M();z=g}m=c.charCodeAt(z);if(101==m||69==m){m=c.charCodeAt(++z);(43==m||45==m)&&z++;for(g=z;g<d&&(m=c.charCodeAt(g),48<=m&&57>=m);g++);g==z&&M();z=g}return+c.slice(f,z)}l&&M();if("true"==c.slice(z,z+4))return z+=
4,!0;if("false"==c.slice(z,z+5))return z+=5,!1;if("null"==c.slice(z,z+4))return z+=4,null;M()}return"$"},oa=function(c){var d,e;"$"==c&&M();if("string"==typeof c){if("@"==(O?c.charAt(0):c[0]))return c.slice(1);if("["==c){for(d=[];;e||(e=!0)){c=ga();if("]"==c)break;e&&(","==c?(c=ga(),"]"==c&&M()):M());","==c&&M();d.push(oa(c))}return d}if("{"==c){for(d={};;e||(e=!0)){c=ga();if("}"==c)break;e&&(","==c?(c=ga(),"}"==c&&M()):M());(","==c||"string"!=typeof c||"@"!=(O?c.charAt(0):c[0])||":"!=ga())&&M();
d[c.slice(1)]=oa(ga())}return d}M()}return c},xa=function(c,d,e){e=p(c,d,e);e===H?delete c[d]:c[d]=e},p=function(c,d,e){var f=c[d],g;if("object"==typeof f&&f)if("[object Array]"==N.call(f))for(g=f.length;g--;)xa(f,g,e);else ia(f,function(c){xa(f,c,e)});return e.call(c,d,f)};d.parse=function(c,d){var e,f;z=0;Y=""+c;e=oa(ga());"$"!=ga()&&M();z=Y=null;return d&&"[object Function]"==N.call(d)?p((f={},f[""]=e,f),"",d):e}}}d.runInContext=f;return d},g={"function":!0,object:!0};e=g[typeof e]&&e&&!e.nodeType&&
e;var n=g[typeof window]&&window||this;if((d=e&&g[typeof d]&&d&&!d.nodeType&&"object"==typeof c&&c)&&(d.global===d||d.window===d||d.self===d))n=d;if(e)f(n,e);else{var l=n.JSON,m=n.JSON3,r=!1,q=f(n,n.JSON3={noConflict:function(){r||(r=!0,n.JSON=l,n.JSON3=m,l=m=null);return q}});n.JSON={parse:q.parse,stringify:q.stringify}}},{}],51:[function(c,d){d.exports=function(c,d){for(var g=[],n=(d=d||0)||0;n<c.length;n++)g[n-d]=c[n];return g}},{}]},{},[31])(31)});var shared_game={GameState:function(b){var c={startTime:0,minPlayerSize:1,maxPlayerSize:2,flashJoinDuration:2E3,matchAnnounceDuration:2E3,maxDecisionInterval:25E3,decisionAnimDuration:1E3,playerLeftDuration:2E3,resultsDuration:1E4,phase:0,playerTurn:0,playerTurnTime:0,boardState:[],boardRows:3,boardCols:3,init:function(b){c.startTime=b;c.players=[];c.playersHash={};c.resetBoard();return c},packData:function(){for(var b={players:[]},e=0,f=c.players.length;e<f;e++)b.players.push(c.players[e].packData());
b.startTime=c.startTime;b.phase=c.phase;b.playerTurn=c.playerTurn;b.playerTurnTime=c.playerTurnTime;b.boardState=[];e=0;for(f=c.boardState.length;e<f;e++)b.boardState.push(c.boardState[e]);return b},importData:function(b){if(b){isNaN(b.startTime)||(c.startTime=b.startTime);isNaN(b.phase)||(c.phase=b.phase);isNaN(b.playerTurn)||(c.playerTurn=b.playerTurn);isNaN(b.playerTurnTime)||(c.playerTurnTime=b.playerTurnTime);if(b.players){c.players=[];c.playersHash={};for(var e=0,f=b.players.length;e<f;e++){var g=
b.players[e],n=new shared_game.Player(g.id);n.importData(g);c.addPlayer(n)}}if(b.boardState){c.boardState=[];e=0;for(f=b.boardState.length;e<f;e++)c.boardState.push(b.boardState[e])}}},findPlayerById:function(b){var e=null;if(c.playersHash&&"undefined"!=typeof c.playersHash[b])return c.playersHash[b];for(var f=0,g=c.players.length;f<g;f++)if(c.players[f].id==b){e=c.players[f];c.playersHash&&(c.playersHash[e.id]=e);break}return e},addPlayer:function(b){if(!b||isNaN(b.id)||c.playersHash&&"undefined"!=
typeof c.playersHash[b.id])return null;c.players.push(b);c.playersHash[b.id]=b;c.reorderPlayers();return b.id},removePlayer:function(b){if(isNaN(b))return null;for(var e=[],f=0,g=c.players.length;f<g;f++)c.players[f].id!=b&&e.push(c.players[f]);c.players=e;delete c.playersHash[b];c.reorderPlayers()},reorderPlayers:function(){if(1==c.players.length){var b=c.players[0];0>b.order&&(b.order=0)}else for(var e=0,f=c.players.length;e<f;e++)if(b=c.players[e],0>b.order)for(var g=0,n=c.players.length;g<n;g++){var l=
c.players[g];if(l!=b)for(var m=0,r=c.maxPlayerSize;m<r;m++)if(m!=l.order){b.order=m;break}}},resetBoard:function(){c.boardState=[];for(var b=0,e=c.boardCols;b<e;b++)for(var f=0,g=c.boardRows;f<g;f++)c.boardState.push(-1)}};return c.init(b)},Player:function(b){var c={readyFlag:!1,leftGameFlag:!1,botFlag:!1,avatarId:0,order:-1,symbolId:0,lastDecision:-1,init:function(b){c.id=b;return c},packData:function(){var b={};b.id=c.id;b.name=c.name;b.avatarId=c.avatarId;b.readyFlag=c.readyFlag;b.leftGameFlag=
c.leftGameFlag;b.botFlag=c.botFlag;b.symbolId=c.symbolId;b.order=c.order;return b},importData:function(b){b&&(isNaN(b.id)||(c.id=b.id),null!=b.name&&(c.name=b.name),null!=b.avatarId&&(c.avatarId=b.avatarId),null!=b.readyFlag&&(c.readyFlag=b.readyFlag),null!=b.leftGameFlag&&(c.leftGameFlag=b.leftGameFlag),null!=b.botFlag&&(c.botFlag=b.botFlag),isNaN(b.symbolId)||(c.symbolId=b.symbolId),isNaN(b.order)||(c.order=b.order))}};return c.init(b)},Update:function(){var b={init:function(){b.eventList=[];return b},
packData:function(){for(var c={eventList:[]},d=0,e=b.eventList.length;d<e;d++)c.eventList.push(b.eventList[d].packData());return c}};return b.init()},Event:function(b,c){var d={init:function(b,c){d.type=b;d.time=c;d.info=null;return d},packData:function(){var b={};b.type=d.type;b.time=d.time;b.info=d.info;return b}};return d.init(b,c)},EventType:{PHASE_TRANSITION:0,PLAYER_READY:1,PLAYER_LEAVE:2,PLAYER_DECISION:3,MATCH_RESULT:4},PhaseEnum:{PHASE_INIT:0,PHASE_FLASHJOIN:1,PHASE_MATCH_ANNOUNCE:2,PHASE_PLAYER_DECISION:3,
PHASE_DECISION_ANIM:4,PHASE_MATCH_RESULTS:5,PHASE_PLAYER_LEFT:6,PHASE_END:7},MessageType:{ERROR:0,USER_CONFIRMED:1,USER_CONNECTED:2,USER_DISCONNECTED:3,REQUEST_ROOM:10,PLAYER_CONFIRMED:11,REQUEST_ROOM_CONFIRMED:12,REQUEST_ROOM_REJECTED:13,LEAVE_ROOM:20,REQUEST_GAMESTATE:30,GAMESTATE:31,GAMESTATE_UPDATE:32,CLIENT_UPDATE:40,ROOM_NOTIFICATION:50,CHAT_MESSAGE:60},ErrorType:{UNKNOWN:0,INVALID_REQUEST:1,VERSION_MISMATCH:2,INVALID_NAME:3,KICKED_DUE_TO_INACTIVITY:4},seed:6,seededRandom:function(b,c){c=c||
0;shared_game.seed=(9301*shared_game.seed+49297)%233280;return c+shared_game.seed/233280*((b||1)-c)}};"undefined"!==typeof module&&(module.exports.shared_game=shared_game);"undefined"!==typeof require&&(shared_game=require("shared_game.html").shared_game);
var decision_engine={updateGameState:function(b){if(b.gamestate.phase==shared_game.PhaseEnum.PHASE_INIT){var c=decision_engine.checkGameReady(b),d=decision_engine.getActivePlayerCount(b);0<d&&2>d&&(c=!1,b.addBotPlayer());if(c){var e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c);e.info={};e.info.phase=shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE;e.info.gamestate=b.gamestate.packData();b.pendingEventsQueue.push(e);b.applyEvent(e)}}else if(b.gamestate.phase==shared_game.PhaseEnum.PHASE_FLASHJOIN){var c=
Date.now(),e=!1,f=c-b.gamestate.playerTurnTime;f>b.gamestate.flashJoinDuration&&(e=!0);e&&(e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE,2>decision_engine.getActivePlayerCount(b)&&(e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData()),b.pendingEventsQueue.push(e),b.applyEvent(e))}else if(b.gamestate.phase==shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE){if(c=Date.now(),
e=!1,f=c-b.gamestate.playerTurnTime,f>b.gamestate.matchAnnounceDuration&&(e=!0),e){b.gamestate.playerTurn=0;if((d=b.gamestate.players[b.gamestate.playerTurn])&&1==d.symbolId)b.gamestate.playerTurn=1;e=shared_game.EventType.PHASE_TRANSITION;c=Date.now();e=new shared_game.Event(e,c);e.info={};e.info.phase=shared_game.PhaseEnum.PHASE_PLAYER_DECISION;e.info.playerTurn=b.gamestate.playerTurn;2>decision_engine.getActivePlayerCount(b)&&(e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData());
b.pendingEventsQueue.push(e);b.applyEvent(e)}}else if(b.gamestate.phase==shared_game.PhaseEnum.PHASE_PLAYER_DECISION){if(c=Date.now(),d=b.gamestate.players[b.gamestate.playerTurn])if(e=!1,f=c-b.gamestate.playerTurnTime,0<=b.gamestate.maxDecisionInterval&&f>b.gamestate.maxDecisionInterval&&(e=!0),e&&(d.botFlag?(b.removeBotPlayers(),e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData(),
b.pendingEventsQueue.push(e),b.applyEvent(e)):(e=b.findPlayerById(d.id))&&b.gamehost.kickPlayer(b,e,100)),d.botFlag){e=!1;f=c-b.gamestate.playerTurnTime;if(void 0==d.botDelay||null==d.botDelay)d.botDelay=Math.floor(1E3*(0.5+1*Math.random()));0<=d.botDelay&&f>d.botDelay&&(e=!0);e&&(f=decision_engine.makeBotDecision(b,d),null!=f&&(e=shared_game.EventType.PLAYER_DECISION,e=new shared_game.Event(e,c),e.info={},e.info.playerId=d.id,e.info.decision=f,b.pendingEventsQueue.push(e),b.applyEvent(e)))}}else b.gamestate.phase==
shared_game.PhaseEnum.PHASE_DECISION_ANIM?(c=Date.now(),e=!1,f=c-b.gamestate.playerTurnTime,f>b.gamestate.decisionAnimDuration&&(e=!0),e&&(c=!1,d=b.gamestate.players[b.gamestate.playerTurn],d=decision_engine.checkBoardConditions(b,{playerId:d.id,decision:d.lastDecision,symbolId:d.symbolId}),null!==d&&(c=!0),c?(e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_MATCH_RESULTS,e.info.winner=d):(b.gamestate.playerTurn+=
1,1<b.gamestate.playerTurn&&(b.gamestate.playerTurn=0),e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_PLAYER_DECISION,e.info.playerTurn=b.gamestate.playerTurn,2>decision_engine.getActivePlayerCount(b)&&(e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData())),b.pendingEventsQueue.push(e),b.applyEvent(e))):b.gamestate.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS?(c=Date.now(),e=
!1,f=c-b.gamestate.playerTurnTime,f>b.gamestate.resultsDuration&&(e=!0),e&&(e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE,2>decision_engine.getActivePlayerCount(b)&&(e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData()),b.pendingEventsQueue.push(e),b.applyEvent(e))):b.gamestate.phase==shared_game.PhaseEnum.PHASE_PLAYER_LEFT&&(c=Date.now(),e=!1,f=c-b.gamestate.playerTurnTime,
f>b.gamestate.playerLeftDuration&&(e=!0),e&&(e=shared_game.EventType.PHASE_TRANSITION,c=Date.now(),e=new shared_game.Event(e,c),e.info={},e.info.phase=shared_game.PhaseEnum.PHASE_INIT,e.info.gamestate=b.gamestate.packData(),b.pendingEventsQueue.push(e),b.applyEvent(e)))},kickPlayerId:function(b,c){if("function"==typeof b.gamehost.kickPlayer){var d=b.findPlayerById(c);b.gamehost.kickPlayer(b,d,shared_game.ErrorType.KICKED_DUE_TO_INACTIVITY)}},checkGameReady:function(b){for(var c=!0,d=0,e=b.gamestate.players.length;d<
e;d++){var f=b.gamestate.players[d];if(!f.botFlag&&!f.readyFlag){c=!1;break}}return c},checkBoardConditions:function(b,c){var d=b.gamestate.boardState;if(!c)return null;if(decision_engine.testWinBoard(b,c))return c.symbolId;for(var e=0,f=0,g=d.length;f<g;f++)-1!=d[f]&&(e+=1);return 8<=e?-1:null},getActivePlayerCount:function(b){for(var c=0,d=0,e=b.gamestate.players.length;d<e;d++)b.gamestate.players[d].leftGameFlag||c++;return c},onPlayerJoin:function(b){if(2<decision_engine.getActivePlayerCount(b))for(var c=
0,d=b.gamestate.players.length;c<d;c++){var e=b.gamestate.players[c];e.botFlag&&(e.leftGameFlag=!0)}2==decision_engine.getActivePlayerCount(b)&&(c=shared_game.EventType.PHASE_TRANSITION,d=Date.now(),c=new shared_game.Event(c,d),c.info={},c.info.phase=shared_game.PhaseEnum.PHASE_FLASHJOIN,c.info.gamestate=b.gamestate.packData(),b.pendingEventsQueue.push(c),b.applyEvent(c))},makeBotDecision:function(b,c){c.botDelay=Math.floor(1E3*(0.5+1*Math.random()));var d=b.gamestate.boardState,e=c.symbolId,f=0;
0==e&&(f=1);for(var g=!0,n=0,l=d.length;n<l;n++)if(-1!=d[n]){g=!1;break}if(g){if(0.5>Math.random()){var m=[0,2,6,8],d=Math.floor(Math.random()*m.length);return m[d]}return 4}for(var r=0,m=0,g=[],n=0,l=d.length;n<l;n++)-1!=d[n]?d[n]==e?r+=1:m+=1:g.push(n);if(0==r){if(-1==d[4])return 4;m=[0,2,6,8];d=Math.floor(Math.random()*m.length);return m[d]}if(2<=r){n=0;for(l=g.length;n<l;n++){r={};r.decision=g[n];r.symbolId=e;d[r.decision]=r.symbolId;var q=decision_engine.testWinBoard(b,r);d[r.decision]=-1;if(q)return r.decision}}if(2<=
m){n=0;for(l=g.length;n<l;n++)if(r={},r.decision=g[n],r.symbolId=f,d[r.decision]=r.symbolId,q=decision_engine.testWinBoard(b,r),d[r.decision]=-1,q)return r.decision}e=[0,2,8,6];n=0;for(l=e.length;n<l;n++)if(m=e[n],d[m]==f&&(m=null,n+2<e.length?m=e[n+2]:0<=n-2&&(m=e[n-2]),d[m]==f)){m=[];r=0;for(q=g.length;r<q;r++){var s=g[r];(1==s||3==s||5==s||7==s)&&m.push(s)}if(0<m.length)return d=Math.floor(Math.random()*m.length),m[d]}if(-1==d[4])return 4;e=[0,2,8,6];n=0;for(l=e.length;n<l;n++)if(m=e[n],d[m]==
f&&(m=null,n+2<e.length?m=e[n+2]:0<=n-2&&(m=e[n-2]),null!=m&&-1==d[m]))return m;m=[];n=0;for(l=g.length;n<l;n++)s=g[n],(0==s||2==s||6==s||8==s)&&m.push(s);if(0<m.length)return d=Math.floor(Math.random()*m.length),m[d];m=[];n=0;for(l=g.length;n<l;n++)s=g[n],(1==s||3==s||5==s||7==s)&&m.push(s);return 0<m.length?(d=Math.floor(Math.random()*m.length),m[d]):null},testWinBoard:function(b,c){var d=b.gamestate.boardState,e=b.gamestate.boardCols,f=b.gamestate.boardRows;if(!c)return null;for(var g=c.decision,
n=c.symbolId,l=g%e,g=Math.floor(g/e),m=0,r=0,q=e;r<q;r++){var s=g*e,s=s+r;if(d[s]!=n)m=0;else if(m+=1,3<=m)break}if(3<=m)return!0;r=m=0;for(q=f;r<q;r++)if(s=l,s+=r*e,d[s]!=n)m=0;else if(m+=1,3<=m)break;if(3<=m)return!0;m=!0;2>l&&g>f-2+l&&(m=!1);l>f-2&&g<2-(e-l)&&(m=!1);if(m){var u=0,t=l-g;0>t&&(u=-t,t=0);r=m=0;for(q=f;r<q;r++)if(s=t+u*e,s+=r*(e+1),s<d.length)if(d[s]!=n)m=0;else{if(m+=1,3<=m)break}else break;if(3<=m)return!0}m=!0;2>l&&g<2-l&&(m=!1);l>f-2&&g>f-2+(e-l)&&(m=!1);if(m){u=0;t=l+g;t>e-1&&
(u=t-(e-1),t=e-1);r=m=0;for(q=f;r<q;r++)if(s=t+u*e,s+=r*(e-1),0<=s)if(d[s]!=n)m=0;else{if(m+=1,3<=m)break}else break;if(3<=m)return!0}return!1}};"undefined"!==typeof module&&(module.exports.decision_engine=decision_engine);"undefined"!==typeof require&&(shared_game=require("shared_game.html").shared_game);
var simulator={},simulator={simulateEvent:function(b,c,d,e){if(e&&e.copy){var f=c.packData();c=new shared_game.GameState;c.importData(f)}(f=simulator.EventSimulatorFactory.create(b.type))&&f.simulate(b,c,d,e);return c},EventSimulatorFactory:{create:function(b){switch(b){case shared_game.EventType.PLAYER_READY:return new simulator.PlayerReadyEventSimulator;case shared_game.EventType.PLAYER_LEAVE:return new simulator.PlayerLeaveEventSimulator;case shared_game.EventType.PHASE_TRANSITION:return new simulator.PhaseTransitionEventSimulator;
case shared_game.EventType.PLAYER_DECISION:return new simulator.PlayerDecisionEventSimulator;case shared_game.EventType.MATCH_RESULT:return new simulator.MatchResultEventSimulator}}},PlayerReadyEventSimulator:function(){return{simulate:function(b,c){if(!b||!c)return!1;var d=c.findPlayerById(b.info.playerId);return!d?!0:d.readyFlag=!0}}},PlayerLeaveEventSimulator:function(){return{simulate:function(b,c){if(!b||!c)return!1;var d=c.findPlayerById(b.info.playerId);if(!d)return!0;d.leftGameFlag=!0;c.phase=
shared_game.PhaseEnum.PHASE_PLAYER_LEFT;c.playerTurn=0;c.playerTurnTime=b.time;return!0}}},PhaseTransitionEventSimulator:function(){return{simulate:function(b,c){if(!b||!c)return!1;b.info.gamestate&&c.importData(b.info.gamestate);var d=b.info.phase;if(void 0!=d&&null!=d)if(c.phase=d,c.playerTurnTime=b.time,(d==shared_game.PhaseEnum.PHASE_INIT||d==shared_game.PhaseEnum.PHASE_FLASHJOIN||d==shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE)&&c.resetBoard(),d==shared_game.PhaseEnum.PHASE_INIT||d==shared_game.PhaseEnum.PHASE_FLASHJOIN){for(var d=
[],e=0,f=c.players.length;e<f;e++){var g=c.players[e];g.lastDecision=-1;g.order=-1;g.leftGameFlag&&d.push(g.id)}e=0;for(f=d.length;e<f;e++)c.removePlayer(d[e]);c.reorderPlayers()}else d==shared_game.PhaseEnum.PHASE_PLAYER_DECISION?2!=c.players.length?c.phase=shared_game.PhaseEnum.PHASE_INIT:void 0!=b.info.playerTurn&&(c.playerTurn=b.info.playerTurn):d==shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE&&(2!=c.players.length?c.phase=shared_game.PhaseEnum.PHASE_INIT:c.players[0].symbolId==c.players[1].symbolId?
0.5>Math.random()?(c.players[0].symbolId=0,c.players[1].symbolId=1):(c.players[1].symbolId=1,c.players[0].symbolId=0):1==c.players[0].symbolId?(c.players[0].symbolId=0,c.players[1].symbolId=1):(c.players[0].symbolId=1,c.players[1].symbolId=0));return!0}}},PlayerDecisionEventSimulator:function(){return{simulate:function(b,c){if(!b||!c)return!1;var d=c.findPlayerById(b.info.playerId);if(d){if(c.playerTurn<c.players.length&&d&&d!=c.players[c.playerTurn]||c.phase!=shared_game.PhaseEnum.PHASE_PLAYER_DECISION)return!1;
var e=!1;if(void 0!=b.info.decision){var f=b.info.decision;0<=f&&f<c.boardState.length&&-1==c.boardState[f]&&(c.boardState[f]=d.symbolId,d.lastDecision=f,e=!0)}if(!e)return!1;c.phase=shared_game.PhaseEnum.PHASE_DECISION_ANIM;c.playerTurnTime=b.time;return!0}}}},MatchResultEventSimulator:function(){return{simulate:function(b,c,d,e){if(!b||!c)return!1;e&&e.clientside&&b.info.gamestate&&c.importData(b.info.gamestate);return!0}}}};"undefined"!==typeof module&&(module.exports.simulator=simulator);(function(b){Number.prototype.map=function(b,c,d,e){return d+(e-d)*((this-b)/(c-b))};Number.prototype.limit=function(b,c){return Math.min(c,Math.max(b,this))};Number.prototype.round=function(b){b=Math.pow(10,b||0);return Math.round(this*b)/b};Number.prototype.floor=function(){return Math.floor(this)};Number.prototype.ceil=function(){return Math.ceil(this)};Number.prototype.toInt=function(){return this|0};Number.prototype.toRad=function(){return this/180*Math.PI};Number.prototype.toDeg=function(){return 180*
this/Math.PI};Array.prototype.erase=function(b){for(var c=this.length;c--;)this[c]===b&&this.splice(c,1);return this};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Function.prototype.bind=Function.prototype.bind||function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e&&b?
this:b,c.concat(Array.prototype.slice.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f};b.ig={game:null,debug:null,version:"1.23",global:b,modules:{},resources:[],ready:!1,baked:!1,nocache:"",ua:{},prefix:b.ImpactPrefix||"",lib:"lib/",_current:null,_loadQueue:[],_waitForOnload:0,$:function(b){return"#"==b.charAt(0)?document.getElementById(b.substr(1)):document.getElementsByTagName(b)},$new:function(b){return document.createElement(b)},copy:function(b){if(!b||"object"!=typeof b||
b instanceof HTMLElement||b instanceof ig.Class)return b;if(b instanceof Array)for(var c=[],d=0,e=b.length;d<e;d++)c[d]=ig.copy(b[d]);else for(d in c={},b)c[d]=ig.copy(b[d]);return c},merge:function(b,c){for(var d in c){var e=c[d];if("object"!=typeof e||e instanceof HTMLElement||e instanceof ig.Class||null===e)b[d]=e;else{if(!b[d]||"object"!=typeof b[d])b[d]=e instanceof Array?[]:{};ig.merge(b[d],e)}}return b},ksort:function(b){if(!b||"object"!=typeof b)return[];var c=[],d=[],e;for(e in b)c.push(e);
c.sort();for(e=0;e<c.length;e++)d.push(b[c[e]]);return d},setVendorAttribute:function(b,c,d){var e=c.charAt(0).toUpperCase()+c.substr(1);b[c]="undefined"!==typeof b.imageSmoothingEnabled?b["ms"+e]=b["moz"+e]=b["o"+e]=d:b["ms"+e]=b["moz"+e]=b["webkit"+e]=b["o"+e]=d},getVendorAttribute:function(b,c){var d=c.charAt(0).toUpperCase()+c.substr(1);return"undefined"!==typeof b.imageSmoothingEnabled?b[c]||b["ms"+d]||b["moz"+d]||b["o"+d]:b[c]||b["ms"+d]||b["moz"+d]||b["webkit"+d]||b["o"+d]},normalizeVendorAttribute:function(b,
c){var d=ig.getVendorAttribute(b,c);!b[c]&&d&&(b[c]=d)},getImagePixels:function(b,c,d,e,f){var g=ig.$new("canvas");g.width=b.width;g.height=b.height;var n=g.getContext("2d");ig.System.SCALE.CRISP(g,n);var v=ig.getVendorAttribute(n,"backingStorePixelRatio")||1;ig.normalizeVendorAttribute(n,"getImageDataHD");var x=b.width/v,E=b.height/v;g.width=Math.ceil(x);g.height=Math.ceil(E);n.drawImage(b,0,0,x,E);return 1===v?n.getImageData(c,d,e,f):n.getImageDataHD(c,d,e,f)},module:function(b){if(ig._current)throw"Module '"+
ig._current.name+"' defines nothing";if(ig.modules[b]&&ig.modules[b].body)throw"Module '"+b+"' is already defined";ig._current={name:b,requires:[],loaded:!1,body:null};ig.modules[b]=ig._current;ig._loadQueue.push(ig._current);return ig},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig},defines:function(b){ig._current.body=b;ig._current=null;ig._initDOMReady()},addResource:function(b){ig.resources.push(b)},setNocache:function(b){ig.nocache=b?"?"+Date.now():""},
log:function(){},assert:function(){},show:function(){},mark:function(){},_loadScript:function(b,c){ig.modules[b]={name:b,requires:[],loaded:!1,body:null};ig._waitForOnload++;var d=ig.prefix+ig.lib+b.replace(/\./g,"index.html")+".js"+ig.nocache,e=ig.$new("script");e.type="text/javascript";e.src=d;e.onload=function(){ig._waitForOnload--;ig._execModules()};e.onerror=function(){throw"Failed to load module "+b+" at "+d+" required from "+c;};ig.$("head")[0].appendChild(e)},_execModules:function(){for(var b=!1,c=
0;c<ig._loadQueue.length;c++){for(var d=ig._loadQueue[c],e=!0,f=0;f<d.requires.length;f++){var g=d.requires[f];ig.modules[g]?ig.modules[g].loaded||(e=!1):(e=!1,ig._loadScript(g,d.name))}e&&d.body&&(ig._loadQueue.splice(c,1),d.loaded=!0,d.body(),b=!0,c--)}if(b)ig._execModules();else if(!ig.baked&&0==ig._waitForOnload&&0!=ig._loadQueue.length){b=[];for(c=0;c<ig._loadQueue.length;c++){e=[];g=ig._loadQueue[c].requires;for(f=0;f<g.length;f++)d=ig.modules[g[f]],(!d||!d.loaded)&&e.push(g[f]);b.push(ig._loadQueue[c].name+
" (requires: "+e.join(", ")+")")}throw"Unresolved (or circular?) dependencies. Most likely there's a name/path mismatch for one of the listed modules or a previous syntax error prevents a module from loading:\n"+b.join("\n");}},_DOMReady:function(){if(!ig.modules["dom.ready"].loaded){if(!document.body)return setTimeout(ig._DOMReady,13);ig.modules["dom.ready"].loaded=!0;ig._waitForOnload--;ig._execModules()}return 0},_boot:function(){document.location.href.match(/\?nocache/)&&ig.setNocache(!0);ig.ua.pixelRatio=
b.devicePixelRatio||1;ig.ua.viewport={width:b.innerWidth,height:b.innerHeight};ig.ua.screen={width:b.screen.availWidth*ig.ua.pixelRatio,height:b.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone/i.test(navigator.userAgent);ig.ua.iPhone4=ig.ua.iPhone&&2==ig.ua.pixelRatio;ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);
ig.ua.is_safari_or_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.iOS6_tag=/OS 6_/i.test(navigator.userAgent);ig.ua.iOS6=(ig.ua.iPhone||ig.ua.iPad)&&ig.ua.iOS6_tag;ig.ua.iOSgt5=ig.ua.iOS&&5<parseInt(navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)[1]);ig.ua.HTCONE=/HTC_One/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.Kindle=/Silk/i.test(navigator.userAgent);ig.ua.touchDevice="ontouchstart"in
b||b.navigator.msMaxTouchPoints;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.iOS6||ig.ua.winPhone||ig.ua.Kindle||/mobile/i.test(navigator.userAgent)},_initDOMReady:function(){ig.modules["dom.ready"]?ig._execModules():(ig._boot(),ig.modules["dom.ready"]={requires:[],loaded:!1,body:null},ig._waitForOnload++,"complete"===document.readyState?ig._DOMReady():(document.addEventListener("DOMContentLoaded",ig._DOMReady,!1),b.addEventListener("load",ig._DOMReady,!1)))}};ig.normalizeVendorAttribute(b,"requestAnimationFrame");
if(b.requestAnimationFrame){var c=1,d={};b.ig.setAnimation=function(e,f){var g=c++;d[g]=!0;var n=function(){d[g]&&(b.requestAnimationFrame(n,f),e())};b.requestAnimationFrame(n,f);return g};b.ig.clearAnimation=function(b){delete d[b]}}else b.ig.setAnimation=function(c){return b.setInterval(c,1E3/60)},b.ig.clearAnimation=function(c){b.clearInterval(c)};var e=!1,f=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/,g=0;b.ig.Class=function(){};var n=function(b){var c=this.prototype,d={},e;for(e in b)"function"==
typeof b[e]&&"function"==typeof c[e]&&f.test(b[e])?(d[e]=c[e],c[e]=function(b,c){return function(){var e=this.parent;this.parent=d[b];var f=c.apply(this,arguments);this.parent=e;return f}}(e,b[e])):c[e]=b[e]};b.ig.Class.extend=function(c){function d(){if(!e){if(this.staticInstantiate){var b=this.staticInstantiate.apply(this,arguments);if(b)return b}for(var c in this)"object"==typeof this[c]&&(this[c]=ig.copy(this[c]));this.init&&this.init.apply(this,arguments)}return this}var r=this.prototype;e=!0;
var q=new this;e=!1;for(var s in c)q[s]="function"==typeof c[s]&&"function"==typeof r[s]&&f.test(c[s])?function(b,c){return function(){var d=this.parent;this.parent=r[b];var e=c.apply(this,arguments);this.parent=d;return e}}(s,c[s]):c[s];d.prototype=q;d.prototype.constructor=d;d.extend=b.ig.Class.extend;d.inject=n;d.classId=q.classId=++g;return d};b.ImpactMixin&&ig.merge(ig,b.ImpactMixin)})(window);ig.baked=!0;
ig.module("impact.image").defines(function(){ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:!1,failed:!1,loadCallback:null,path:"",staticInstantiate:function(b){return ig.Image.cache[b]||null},init:function(b){this.path=b;this.load()},load:function(b){this.loaded?b&&b(this.path,!0):(!this.loaded&&ig.ready?(this.loadCallback=b||null,this.data=new Image,this.data.onload=this.onload.bind(this),this.data.onerror=this.onerror.bind(this),this.data.src=ig.prefix+this.path+ig.nocache):ig.addResource(this),
ig.Image.cache[this.path]=this)},reload:function(){this.loaded=!1;this.data=new Image;this.data.onload=this.onload.bind(this);this.data.src=this.path+"?"+Date.now()},onload:function(){this.width=this.data.width;this.height=this.data.height;this.loaded=!0;1!=ig.system.scale&&this.resize(ig.system.scale);this.loadCallback&&this.loadCallback(this.path,!0)},onerror:function(){this.failed=!0;this.loadCallback&&this.loadCallback(this.path,!1)},resize:function(b){var c=ig.getImagePixels(this.data,0,0,this.width,
this.height),d=this.width*b,e=this.height*b,f=ig.$new("canvas");f.width=d;f.height=e;for(var g=f.getContext("2d"),n=g.getImageData(0,0,d,e),l=0;l<e;l++)for(var m=0;m<d;m++){var r=4*(Math.floor(l/b)*this.width+Math.floor(m/b)),q=4*(l*d+m);n.data[q]=c.data[r];n.data[q+1]=c.data[r+1];n.data[q+2]=c.data[r+2];n.data[q+3]=c.data[r+3]}g.putImageData(n,0,0);this.data=f},draw:function(b,c,d,e,f,g){if(this.loaded){var n=ig.system.scale;f=(f?f:this.width)*n;g=(g?g:this.height)*n;ig.system.context.drawImage(this.data,
d?d*n:0,e?e*n:0,f,g,ig.system.getDrawPos(b),ig.system.getDrawPos(c),f,g);ig.Image.drawCount++}},drawTile:function(b,c,d,e,f,g,n){f=f?f:e;if(this.loaded&&!(e>this.width||f>this.height)){var l=ig.system.scale,m=Math.floor(e*l),r=Math.floor(f*l),q=g?-1:1,s=n?-1:1;if(g||n)ig.system.context.save(),ig.system.context.scale(q,s);ig.system.context.drawImage(this.data,Math.floor(d*e)%this.width*l,Math.floor(d*e/this.width)*f*l,m,r,ig.system.getDrawPos(b)*q-(g?m:0),ig.system.getDrawPos(c)*s-(n?r:0),m,r);(g||
n)&&ig.system.context.restore();ig.Image.drawCount++}}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var b in ig.Image.cache)ig.Image.cache[b].reload()}});ig.baked=!0;
ig.module("impact.font").requires("impact.image").defines(function(){ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(b){this._loadMetrics(this.data);this.parent(b)},widthForString:function(b){if(-1!==b.indexOf("\n")){b=b.split("\n");for(var c=0,d=0;d<b.length;d++)c=Math.max(c,this._widthForLine(b[d]));return c}return this._widthForLine(b)},_widthForLine:function(b){for(var c=0,d=0;d<b.length;d++)c+=this.widthMap[b.charCodeAt(d)-this.firstChar]+
this.letterSpacing;return c},heightForString:function(b){return b.split("\n").length*(this.height+this.lineSpacing)},draw:function(b,c,d,e){"string"!=typeof b&&(b=b.toString());if(-1!==b.indexOf("\n")){b=b.split("\n");for(var f=this.height+this.lineSpacing,g=0;g<b.length;g++)this.draw(b[g],c,d+g*f,e)}else{if(e==ig.Font.ALIGN.RIGHT||e==ig.Font.ALIGN.CENTER)g=this._widthForLine(b),c-=e==ig.Font.ALIGN.CENTER?g/2:g;1!==this.alpha&&(ig.system.context.globalAlpha=this.alpha);for(g=0;g<b.length;g++)e=b.charCodeAt(g),
c+=this._drawChar(e-this.firstChar,c,d);1!==this.alpha&&(ig.system.context.globalAlpha=1);ig.Image.drawCount+=b.length}},_drawChar:function(b,c,d){if(!this.loaded||0>b||b>=this.indices.length)return 0;var e=ig.system.scale,f=this.widthMap[b]*e,g=(this.height-2)*e;ig.system.context.drawImage(this.data,this.indices[b]*e,0,f,g,ig.system.getDrawPos(c),ig.system.getDrawPos(d),f,g);return this.widthMap[b]+this.letterSpacing},_loadMetrics:function(b){this.height=b.height-1;this.widthMap=[];this.indices=
[];for(var c=ig.getImagePixels(b,0,b.height-1,b.width,1),d=0,e=0,f=0;f<b.width;f++){var g=4*f+3;127<c.data[g]?e++:128>c.data[g]&&e&&(this.widthMap.push(e),this.indices.push(f-e),d++,e=0)}this.widthMap.push(e);this.indices.push(f-e)}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2}});ig.baked=!0;
ig.module("impact.sound").defines(function(){ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio)ig.Sound.enabled=!1;else{for(var b=new Audio,c=0;c<ig.Sound.use.length;c++){var d=ig.Sound.use[c];if(b.canPlayType(d.mime)){this.format=d;break}}this.format||(ig.Sound.enabled=!1)}},load:function(b,c,d){var e=ig.prefix+b.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[b]){if(c&&this.clips[b].length<ig.Sound.channels)for(c=this.clips[b].length;c<
ig.Sound.channels;c++){var f=new Audio(e);f.load();this.clips[b].push(f)}return this.clips[b][0]}var g=new Audio(e);d&&(g.addEventListener("canplaythrough",function l(c){g.removeEventListener("canplaythrough",l,!1);d(b,!0,c)},!1),g.addEventListener("error",function(c){d(b,!1,c)},!1));g.preload="auto";g.load();this.clips[b]=[g];if(c)for(c=1;c<ig.Sound.channels;c++)f=new Audio(e),f.load(),this.clips[b].push(f);return g},get:function(b){b=this.clips[b];for(var c=0,d;d=b[c++];)if(d.paused||d.ended)return d.ended&&
(d.currentTime=0),d;b[0].pause();b[0].currentTime=0;return b[0]}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:!1,_volume:1,_loop:!1,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty?(Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)}),Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)})):
this.__defineGetter__&&(this.__defineGetter__("volume",this.getVolume.bind(this)),this.__defineSetter__("volume",this.setVolume.bind(this)),this.__defineGetter__("loop",this.getLooping.bind(this)),this.__defineSetter__("loop",this.setLooping.bind(this)))},add:function(b,c){if(ig.Sound.enabled){var d=ig.soundManager.load(b instanceof ig.Sound?b.path:b,!1);d.loop=this._loop;d.volume=this._volume;d.addEventListener("ended",this._endedCallbackBound,!1);this.tracks.push(d);c&&(this.namedTracks[c]=d);this.currentTrack||
(this.currentTrack=d)}},next:function(){this.tracks.length&&(this.stop(),this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length,this.currentTrack=this.tracks[this.currentIndex],this.play())},pause:function(){this.currentTrack&&this.currentTrack.pause()},stop:function(){this.currentTrack&&(this.currentTrack.pause(),this.currentTrack.currentTime=0)},play:function(b){if(b&&this.namedTracks[b])b=this.namedTracks[b],b!=this.currentTrack&&(this.stop(),
this.currentTrack=b);else if(!this.currentTrack)return;this.currentTrack.play()},getLooping:function(){return this._loop},setLooping:function(b){this._loop=b;for(var c in this.tracks)this.tracks[c].loop=b},getVolume:function(){return this._volume},setVolume:function(b){this._volume=b.limit(0,1);for(var c in this.tracks)this.tracks[c].volume=this._volume},fadeOut:function(b){this.currentTrack&&(clearInterval(this._fadeInterval),this.fadeTimer=new ig.Timer(b),this._fadeInterval=setInterval(this._fadeStep.bind(this),
50))},_fadeStep:function(){var b=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;0.01>=b?(this.stop(),this.currentTrack.volume=this._volume,clearInterval(this._fadeInterval)):this.currentTrack.volume=b},_endedCallback:function(){this._loop?this.play():this.next()}});ig.Sound=ig.Class.extend({path:"",volume:1,currentClip:null,multiChannel:!0,init:function(b,c){this.path=b;this.multiChannel=!1!==c;this.load()},load:function(b){ig.Sound.enabled?ig.ready?ig.soundManager.load(this.path,
this.multiChannel,b):ig.addResource(this):b&&b(this.path,!0)},play:function(){ig.Sound.enabled&&(this.currentClip=ig.soundManager.get(this.path),this.currentClip.volume=ig.soundManager.volume*this.volume,this.currentClip.play())},stop:function(){this.currentClip&&(this.currentClip.pause(),this.currentClip.currentTime=0)}});ig.Sound.FORMAT={MP3:{ext:"mp3",mime:"audio/mpeg"},M4A:{ext:"m4a",mime:"audio/mp4; codecs=mp4a"},OGG:{ext:"ogg",mime:"audio/ogg; codecs=vorbis"},WEBM:{ext:"webm",mime:"audio/webm; codecs=vorbis"},
CAF:{ext:"caf",mime:"audio/x-caf"}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=!0});ig.baked=!0;
ig.module("impact.loader").requires("impact.image","impact.font","impact.sound").defines(function(){ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:!1,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(b,c){this.gameClass=b;this.resources=c;this._loadCallbackBound=this._loadCallback.bind(this);for(var d=0;d<this.resources.length;d++)this._unloaded.push(this.resources[d].path)},load:function(){ig.system.clear("#000");if(this.resources.length){for(var b=
0;b<this.resources.length;b++)this.loadResource(this.resources[b]);this._intervalId=setInterval(this.draw.bind(this),16)}else this.end()},loadResource:function(b){b.load(this._loadCallbackBound)},end:function(){this.done||(this.done=!0,clearInterval(this._intervalId))},draw:function(){},_loadCallback:function(b,c){if(c)this._unloaded.erase(b);else throw"Failed to load resource: "+b;this.status=1-this._unloaded.length/this.resources.length;0==this._unloaded.length&&setTimeout(this.end.bind(this),250)}})});
ig.baked=!0;
ig.module("impact.timer").defines(function(){ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(b){this.last=this.base=ig.Timer.time;this.target=b||0},set:function(b){this.target=b||0;this.base=ig.Timer.time;this.pausedAt=0},reset:function(){this.base=ig.Timer.time;this.pausedAt=0},tick:function(){var b=ig.Timer.time-this.last;this.last=ig.Timer.time;return this.pausedAt?0:b},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target},pause:function(){this.pausedAt||(this.pausedAt=
ig.Timer.time)},unpause:function(){this.pausedAt&&(this.base+=ig.Timer.time-this.pausedAt,this.pausedAt=0)}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var b=Date.now();ig.Timer.time+=Math.min((b-ig.Timer._last)/1E3,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=b}});ig.baked=!0;
ig.module("impact.system").requires("impact.timer","impact.image").defines(function(){ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:!1,delegate:null,clock:null,canvas:null,context:null,init:function(b,c,d,e,f){this.fps=c;this.clock=new ig.Timer;this.canvas=ig.$(b);this.resize(d,e,f);this.context=this.canvas.getContext("2d");this.getDrawPos=ig.System.drawMode;1!=this.scale&&(ig.System.scaleMode=ig.System.SCALE.CRISP);
ig.System.scaleMode(this.canvas,this.context)},resize:function(b,c,d){this.width=b;this.height=c;this.scale=d||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight},setGame:function(b){this.running?this.newGameClass=b:this.setGameNow(b)},setGameNow:function(b){ig.game=new b;ig.system.setDelegate(ig.game)},setDelegate:function(b){if("function"==typeof b.run)this.delegate=b,this.startRunLoop();else throw"System.setDelegate: No run() function in object";
},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=!1},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this),this.canvas);this.running=!0},clear:function(b){this.context.fillStyle=b;this.context.fillRect(0,0,this.realWidth,this.realHeight)},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();this.newGameClass&&(this.setGameNow(this.newGameClass),this.newGameClass=null)},getDrawPos:null});
ig.System.DRAW={AUTHENTIC:function(b){return Math.round(b)*this.scale},SMOOTH:function(b){return Math.round(b*this.scale)},SUBPIXEL:function(b){return b*this.scale}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(b,c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!1);b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},
SMOOTH:function(b,c){ig.setVendorAttribute(c,"imageSmoothingEnabled",!0);b.style.imageRendering="";b.style.msInterpolationMode=""}};ig.System.scaleMode=ig.System.SCALE.SMOOTH});ig.baked=!0;
ig.module("impact.input").defines(function(){ig.KEY={MOUSE1:-1,MOUSE2:-3,MWHEEL_UP:-4,MWHEEL_DOWN:-5,BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,_0:48,_1:49,_2:50,_3:51,_4:52,_5:53,_6:54,_7:55,_8:56,_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,
NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:!1,isUsingKeyboard:!1,isUsingAccelerometer:!1,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(!this.isUsingMouse){this.isUsingMouse=
!0;var b=this.mousewheel.bind(this);ig.system.canvas.addEventListener("mousewheel",b,!1);ig.system.canvas.addEventListener("DOMMouseScroll",b,!1);ig.system.canvas.addEventListener("contextmenu",this.contextmenu.bind(this),!1);ig.system.canvas.addEventListener("mousedown",this.keydown.bind(this),!1);ig.system.canvas.addEventListener("mouseup",this.keyup.bind(this),!1);ig.system.canvas.addEventListener("mousemove",this.mousemove.bind(this),!1);ig.ua.touchDevice&&(ig.system.canvas.addEventListener("touchstart",
this.keydown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.mousemove.bind(this),!1),ig.system.canvas.addEventListener("MSPointerDown",this.keydown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.keyup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",this.mousemove.bind(this),!1),ig.system.canvas.style.msTouchAction="none")}},initKeyboard:function(){this.isUsingKeyboard||(this.isUsingKeyboard=
!0,window.addEventListener("keydown",this.keydown.bind(this),!1),window.addEventListener("keyup",this.keyup.bind(this),!1))},initAccelerometer:function(){this.isUsingAccelerometer||window.addEventListener("devicemotion",this.devicemotion.bind(this),!1)},mousewheel:function(b){var c=this.bindings[0<(b.wheelDelta?b.wheelDelta:-1*b.detail)?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN];c&&(this.actions[c]=!0,this.presses[c]=!0,this.delayedKeyup[c]=!0,b.stopPropagation(),b.preventDefault())},mousemove:function(b){var c=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;ig.ua.mobile&&(c=ig.system.realWidth);var c=ig.system.scale*(c/ig.system.realWidth),d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());b=b.touches?b.touches[0]:b;this.mouse.x=(b.clientX-d.left)/c;this.mouse.y=(b.clientY-d.top)/c},contextmenu:function(b){this.bindings[ig.KEY.MOUSE2]&&(b.stopPropagation(),b.preventDefault())},keydown:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==
c))if(c="keydown"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,("touchstart"==b.type||"mousedown"==b.type)&&this.mousemove(b),c=this.bindings[c])this.actions[c]=!0,this.locks[c]||(this.presses[c]=!0,this.locks[c]=!0),b.stopPropagation(),b.preventDefault()},keyup:function(b){var c=b.target.tagName;if(!("INPUT"==c||"TEXTAREA"==c))if(c=this.bindings["keyup"==b.type?b.keyCode:2==b.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1])this.delayedKeyup[c]=!0,b.stopPropagation(),b.preventDefault()},devicemotion:function(b){this.accel=
b.accelerationIncludingGravity},bind:function(b,c){0>b?this.initMouse():0<b&&this.initKeyboard();this.bindings[b]=c},bindTouch:function(b,c){var d=ig.$(b),e=this;d.addEventListener("touchstart",function(b){e.touchStart(b,c)},!1);d.addEventListener("touchend",function(b){e.touchEnd(b,c)},!1);d.addEventListener("MSPointerDown",function(b){e.touchStart(b,c)},!1);d.addEventListener("MSPointerUp",function(b){e.touchEnd(b,c)},!1)},unbind:function(b){this.delayedKeyup[this.bindings[b]]=!0;this.bindings[b]=
null},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={}},state:function(b){return this.actions[b]},pressed:function(b){return this.presses[b]},released:function(b){return!!this.delayedKeyup[b]},clearPressed:function(){for(var b in this.delayedKeyup)this.actions[b]=!1,this.locks[b]=!1;this.delayedKeyup={};this.presses={}},touchStart:function(b,c){this.actions[c]=!0;this.presses[c]=!0;b.stopPropagation();b.preventDefault();return!1},touchEnd:function(b,
c){this.delayedKeyup[c]=!0;b.stopPropagation();b.preventDefault();return!1}})});ig.baked=!0;ig.module("impact.impact").requires("dom.ready","impact.loader","impact.system","impact.input","impact.sound").defines(function(){ig.main=function(b,c,d,e,f,g,n){ig.system=new ig.System(b,d,e,f,g||1);ig.input=new ig.Input;ig.soundManager=new ig.SoundManager;ig.music=new ig.Music;ig.ready=!0;(new (n||ig.Loader)(c,ig.resources)).load()}});ig.baked=!0;
ig.module("impact.animation").requires("impact.timer","impact.image").defines(function(){ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(b,c,d){this.width=c;this.height=d;this.image=new ig.Image(b)}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:!1,y:!1},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(b,c,d,e){this.sheet=b;this.pivot={x:b.width/2,y:b.height/2};this.timer=new ig.Timer;this.frameTime=c;this.sequence=d;
this.stop=!!e;this.tile=this.sequence[0]},rewind:function(){this.timer.set();this.frame=this.loopCount=0;this.tile=this.sequence[0];return this},gotoFrame:function(b){this.timer.set(this.frameTime*-b-1E-4);this.update()},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var b=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(b/this.sequence.length);this.frame=this.stop&&0<this.loopCount?this.sequence.length-1:b%this.sequence.length;
this.tile=this.sequence[this.frame]},draw:function(b,c){var d=Math.max(this.sheet.width,this.sheet.height);b>ig.system.width||(c>ig.system.height||0>b+d||0>c+d)||(1!=this.alpha&&(ig.system.context.globalAlpha=this.alpha),0==this.angle?this.sheet.image.drawTile(b,c,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y):(ig.system.context.save(),ig.system.context.translate(ig.system.getDrawPos(b+this.pivot.x),ig.system.getDrawPos(c+this.pivot.y)),ig.system.context.rotate(this.angle),
this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y),ig.system.context.restore()),1!=this.alpha&&(ig.system.context.globalAlpha=1))}})});ig.baked=!0;
ig.module("impact.entity").requires("impact.animation","impact.impact").defines(function(){ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:!1,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:!1,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(b,
c,d){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=b;this.pos.y=this.last.y=c;ig.merge(this,d)},reset:function(b,c,d){var e=this.constructor.prototype;this.pos.x=b;this.pos.y=c;this.last.x=b;this.last.y=c;this.vel.x=e.vel.x;this.vel.y=e.vel.y;this.accel.x=e.accel.x;this.accel.y=e.accel.y;this.health=e.health;this._killed=e._killed;this.standing=e.standing;this.type=e.type;this.checkAgainst=e.checkAgainst;this.collides=e.collides;ig.merge(this,d)},addAnim:function(b,c,d,e){if(!this.animSheet)throw"No animSheet to add the animation "+
b+" to.";c=new ig.Animation(this.animSheet,c,d,e);this.anims[b]=c;this.currentAnim||(this.currentAnim=c);return c},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var b=ig.game.collisionMap.trace(this.pos.x,this.pos.y,this.vel.x*ig.system.tick,this.vel.y*
ig.system.tick,this.size.x,this.size.y);this.handleMovementTrace(b);this.currentAnim&&this.currentAnim.update()},getNewVelocity:function(b,c,d,e){return c?(b+c*ig.system.tick).limit(-e,e):d?(c=d*ig.system.tick,0<b-c?b-c:0>b+c?b+c:0):b.limit(-e,e)},handleMovementTrace:function(b){this.standing=!1;b.collision.y&&(0<this.bounciness&&Math.abs(this.vel.y)>this.minBounceVelocity?this.vel.y*=-this.bounciness:(0<this.vel.y&&(this.standing=!0),this.vel.y=0));b.collision.x&&(this.vel.x=0<this.bounciness&&Math.abs(this.vel.x)>
this.minBounceVelocity?this.vel.x*-this.bounciness:0);if(b.collision.slope){var c=b.collision.slope;if(0<this.bounciness){var d=this.vel.x*c.nx+this.vel.y*c.ny;this.vel.x=(this.vel.x-2*c.nx*d)*this.bounciness;this.vel.y=(this.vel.y-2*c.ny*d)*this.bounciness}else d=(this.vel.x*c.x+this.vel.y*c.y)/(c.x*c.x+c.y*c.y),this.vel.x=c.x*d,this.vel.y=c.y*d,c=Math.atan2(c.x,c.y),c>this.slopeStanding.min&&c<this.slopeStanding.max&&(this.standing=!0)}this.pos=b.pos},draw:function(){this.currentAnim&&this.currentAnim.draw(this.pos.x-
this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y)},kill:function(){ig.game.removeEntity(this)},receiveDamage:function(b){this.health-=b;0>=this.health&&this.kill()},touches:function(b){return!(this.pos.x>=b.pos.x+b.size.x||this.pos.x+this.size.x<=b.pos.x||this.pos.y>=b.pos.y+b.size.y||this.pos.y+this.size.y<=b.pos.y)},distanceTo:function(b){var c=this.pos.x+this.size.x/2-(b.pos.x+b.size.x/2);b=this.pos.y+this.size.y/2-(b.pos.y+b.size.y/2);return Math.sqrt(c*c+b*b)},angleTo:function(b){return Math.atan2(b.pos.y+
b.size.y/2-(this.pos.y+this.size.y/2),b.pos.x+b.size.x/2-(this.pos.x+this.size.x/2))},check:function(){},collideWith:function(){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(b,c){b.checkAgainst&c.type&&b.check(c);c.checkAgainst&b.type&&c.check(b);b.collides&&(c.collides&&b.collides+c.collides>ig.Entity.COLLIDES.ACTIVE)&&ig.Entity.solveCollision(b,c)};ig.Entity.solveCollision=
function(b,c){var d=null;if(b.collides==ig.Entity.COLLIDES.LITE||c.collides==ig.Entity.COLLIDES.FIXED)d=b;else if(c.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED)d=c;b.last.x+b.size.x>c.last.x&&b.last.x<c.last.x+c.size.x?(b.last.y<c.last.y?ig.Entity.seperateOnYAxis(b,c,d):ig.Entity.seperateOnYAxis(c,b,d),b.collideWith(c,"y"),c.collideWith(b,"y")):b.last.y+b.size.y>c.last.y&&b.last.y<c.last.y+c.size.y&&(b.last.x<c.last.x?ig.Entity.seperateOnXAxis(b,c,d):ig.Entity.seperateOnXAxis(c,
b,d),b.collideWith(c,"x"),c.collideWith(b,"x"))};ig.Entity.seperateOnXAxis=function(b,c,d){var e=b.pos.x+b.size.x-c.pos.x;d?(d.vel.x=-d.vel.x*d.bounciness+(b===d?c:b).vel.x,c=ig.game.collisionMap.trace(d.pos.x,d.pos.y,d==b?-e:e,0,d.size.x,d.size.y),d.pos.x=c.pos.x):(d=(b.vel.x-c.vel.x)/2,b.vel.x=-d,c.vel.x=d,d=ig.game.collisionMap.trace(b.pos.x,b.pos.y,-e/2,0,b.size.x,b.size.y),b.pos.x=Math.floor(d.pos.x),b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,e/2,0,c.size.x,c.size.y),c.pos.x=Math.ceil(b.pos.x))};
ig.Entity.seperateOnYAxis=function(b,c,d){var e=b.pos.y+b.size.y-c.pos.y;if(d){c=b===d?c:b;d.vel.y=-d.vel.y*d.bounciness+c.vel.y;var f=0;d==b&&Math.abs(d.vel.y-c.vel.y)<d.minBounceVelocity&&(d.standing=!0,f=c.vel.x*ig.system.tick);b=ig.game.collisionMap.trace(d.pos.x,d.pos.y,f,d==b?-e:e,d.size.x,d.size.y);d.pos.y=b.pos.y;d.pos.x=b.pos.x}else ig.game.gravity&&(c.standing||0<b.vel.y)?(d=ig.game.collisionMap.trace(b.pos.x,b.pos.y,0,-(b.pos.y+b.size.y-c.pos.y),b.size.x,b.size.y),b.pos.y=d.pos.y,0<b.bounciness&&
b.vel.y>b.minBounceVelocity?b.vel.y*=-b.bounciness:(b.standing=!0,b.vel.y=0)):(d=(b.vel.y-c.vel.y)/2,b.vel.y=-d,c.vel.y=d,f=c.vel.x*ig.system.tick,d=ig.game.collisionMap.trace(b.pos.x,b.pos.y,f,-e/2,b.size.x,b.size.y),b.pos.y=d.pos.y,b=ig.game.collisionMap.trace(c.pos.x,c.pos.y,0,e/2,c.size.x,c.size.y),c.pos.y=b.pos.y)}});ig.baked=!0;
ig.module("impact.map").defines(function(){ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(b,c){this.tilesize=b;this.data=c;this.height=c.length;this.width=c[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize},getTile:function(b,c){var d=Math.floor(b/this.tilesize),e=Math.floor(c/this.tilesize);return 0<=d&&d<this.width&&0<=e&&e<this.height?this.data[e][d]:0},setTile:function(b,c,d){b=Math.floor(b/this.tilesize);c=Math.floor(c/
this.tilesize);0<=b&&b<this.width&&(0<=c&&c<this.height)&&(this.data[c][b]=d)}})});ig.baked=!0;
ig.module("impact.collision-map").requires("impact.map").defines(function(){ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(b,c,f){this.parent(b,c);this.tiledef=f||ig.CollisionMap.defaultTileDef;for(var g in this.tiledef)g|0>this.lastSlope&&(this.lastSlope=g|0)},trace:function(b,c,f,g,n,l){var m={collision:{x:!1,y:!1,slope:!1},pos:{x:b,y:c},tile:{x:0,y:0}},r=Math.ceil(Math.max(Math.abs(f),Math.abs(g))/this.tilesize);if(1<r)for(var q=f/r,s=g/r,u=0;u<r&&(q||s)&&!(this._traceStep(m,
b,c,q,s,n,l,f,g,u),b=m.pos.x,c=m.pos.y,m.collision.x&&(f=q=0),m.collision.y&&(g=s=0),m.collision.slope);u++);else this._traceStep(m,b,c,f,g,n,l,f,g,0);return m},_traceStep:function(b,c,f,g,n,l,m,r,q,s){b.pos.x+=g;b.pos.y+=n;var u=0;if(g){var t=0<g?l:0,v=0>g?this.tilesize:0,u=Math.max(Math.floor(f/this.tilesize),0),x=Math.min(Math.ceil((f+m)/this.tilesize),this.height);g=Math.floor((b.pos.x+t)/this.tilesize);var E=Math.floor((c+t)/this.tilesize);if(0<s||g==E||0>E||E>=this.width)E=-1;if(0<=g&&g<this.width)for(var B=
u;B<x&&!(-1!=E&&(u=this.data[B][E],1<u&&u<=this.lastSlope&&this._checkTileDef(b,u,c,f,r,q,l,m,E,B)));B++)if(u=this.data[B][g],1==u||u>this.lastSlope||1<u&&this._checkTileDef(b,u,c,f,r,q,l,m,g,B)){if(1<u&&u<=this.lastSlope&&b.collision.slope)break;b.collision.x=!0;b.tile.x=u;c=b.pos.x=g*this.tilesize-t+v;r=0;break}}if(n){t=0<n?m:0;n=0>n?this.tilesize:0;u=Math.max(Math.floor(b.pos.x/this.tilesize),0);v=Math.min(Math.ceil((b.pos.x+l)/this.tilesize),this.width);B=Math.floor((b.pos.y+t)/this.tilesize);
x=Math.floor((f+t)/this.tilesize);if(0<s||B==x||0>x||x>=this.height)x=-1;if(0<=B&&B<this.height)for(g=u;g<v&&!(-1!=x&&(u=this.data[x][g],1<u&&u<=this.lastSlope&&this._checkTileDef(b,u,c,f,r,q,l,m,g,x)));g++)if(u=this.data[B][g],1==u||u>this.lastSlope||1<u&&this._checkTileDef(b,u,c,f,r,q,l,m,g,B)){if(1<u&&u<=this.lastSlope&&b.collision.slope)break;b.collision.y=!0;b.tile.y=u;b.pos.y=B*this.tilesize-t+n;break}}},_checkTileDef:function(b,c,f,g,n,l,m,r,q,s){var u=this.tiledef[c];if(!u)return!1;c=(u[2]-
u[0])*this.tilesize;var t=(u[3]-u[1])*this.tilesize,v=u[4];m=f+n+(0>t?m:0)-(q+u[0])*this.tilesize;r=g+l+(0<c?r:0)-(s+u[1])*this.tilesize;if(0<c*r-t*m){if(0>n*-t+l*c)return v;q=Math.sqrt(c*c+t*t);s=t/q;q=-c/q;var x=m*s+r*q,u=s*x,x=q*x;if(u*u+x*x>=n*n+l*l)return v||0.5>c*(r-l)-t*(m-n);b.pos.x=f+n-u;b.pos.y=g+l-x;b.collision.slope={x:c,y:t,nx:s,ny:q};return!0}return!1}});var b=1/3,c=2/3;ig.CollisionMap.defaultTileDef={5:[0,1,1,c,!0],6:[0,c,1,b,!0],7:[0,b,1,0,!0],3:[0,1,1,0.5,!0],4:[0,0.5,1,0,!0],2:[0,
1,1,0,!0],10:[0.5,1,1,0,!0],21:[0,1,0.5,0,!0],32:[c,1,1,0,!0],43:[b,1,c,0,!0],54:[0,1,b,0,!0],27:[0,0,1,b,!0],28:[0,b,1,c,!0],29:[0,c,1,1,!0],25:[0,0,1,0.5,!0],26:[0,0.5,1,1,!0],24:[0,0,1,1,!0],11:[0,0,0.5,1,!0],22:[0.5,0,1,1,!0],33:[0,0,b,1,!0],44:[b,0,c,1,!0],55:[c,0,1,1,!0],16:[1,b,0,0,!0],17:[1,c,0,b,!0],18:[1,1,0,c,!0],14:[1,0.5,0,0,!0],15:[1,1,0,0.5,!0],13:[1,1,0,0,!0],8:[0.5,1,0,0,!0],19:[1,1,0.5,0,!0],30:[b,1,0,0,!0],41:[c,1,b,0,!0],52:[1,1,c,0,!0],38:[1,c,0,1,!0],39:[1,b,0,c,!0],40:[1,0,
0,b,!0],36:[1,0.5,0,1,!0],37:[1,0,0,0.5,!0],35:[1,0,0,1,!0],9:[1,0,0.5,1,!0],20:[0.5,0,0,1,!0],31:[1,0,c,1,!0],42:[c,0,b,1,!0],53:[b,0,0,1,!0],12:[0,0,1,0,!1],23:[1,1,0,1,!1],34:[1,0,1,1,!1],45:[0,1,0,0,!1]};ig.CollisionMap.staticNoCollision={trace:function(b,c,f,g){return{collision:{x:!1,y:!1,slope:!1},pos:{x:b+f,y:c+g},tile:{x:0,y:0}}}}});ig.baked=!0;
ig.module("impact.background-map").requires("impact.map","impact.image").defines(function(){ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:!1,tilesetName:"",foreground:!1,enabled:!0,preRender:!1,preRenderedChunks:null,chunkSize:512,debugChunks:!1,anims:{},init:function(b,c,d){this.parent(b,c);this.setTileset(d)},setTileset:function(b){this.tilesetName=b instanceof ig.Image?b.path:b;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null},setScreenPos:function(b,
c){this.scroll.x=b/this.distance;this.scroll.y=c/this.distance},preRenderMapToChunks:function(){var b=this.width*this.tilesize*ig.system.scale,c=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(b,c),this.chunkSize);var d=Math.ceil(b/this.chunkSize),e=Math.ceil(c/this.chunkSize);this.preRenderedChunks=[];for(var f=0;f<e;f++){this.preRenderedChunks[f]=[];for(var g=0;g<d;g++)this.preRenderedChunks[f][g]=this.preRenderChunk(g,f,g==d-1?b-g*this.chunkSize:this.chunkSize,f==e-1?
c-f*this.chunkSize:this.chunkSize)}},preRenderChunk:function(b,c,d,e){var f=d/this.tilesize/ig.system.scale+1,g=e/this.tilesize/ig.system.scale+1,n=b*this.chunkSize/ig.system.scale%this.tilesize,l=c*this.chunkSize/ig.system.scale%this.tilesize;b=Math.floor(b*this.chunkSize/this.tilesize/ig.system.scale);c=Math.floor(c*this.chunkSize/this.tilesize/ig.system.scale);var m=ig.$new("canvas");m.width=d;m.height=e;m.retinaResolutionEnabled=!1;e=m.getContext("2d");ig.System.scaleMode(m,e);d=ig.system.context;
ig.system.context=e;for(e=0;e<f;e++)for(var r=0;r<g;r++)if(e+b<this.width&&r+c<this.height){var q=this.data[r+c][e+b];q&&this.tiles.drawTile(e*this.tilesize-n,r*this.tilesize-l,q-1,this.tilesize)}ig.system.context=d;return m},draw:function(){this.tiles.loaded&&this.enabled&&(this.preRender?this.drawPreRendered():this.drawTiled())},drawPreRendered:function(){this.preRenderedChunks||this.preRenderMapToChunks();var b=ig.system.getDrawPos(this.scroll.x),c=ig.system.getDrawPos(this.scroll.y);if(this.repeat)var d=
this.width*this.tilesize*ig.system.scale,b=(b%d+d)%d,d=this.height*this.tilesize*ig.system.scale,c=(c%d+d)%d;var d=Math.max(Math.floor(b/this.chunkSize),0),e=Math.max(Math.floor(c/this.chunkSize),0),f=Math.ceil((b+ig.system.realWidth)/this.chunkSize),g=Math.ceil((c+ig.system.realHeight)/this.chunkSize),n=this.preRenderedChunks[0].length,l=this.preRenderedChunks.length;this.repeat||(f=Math.min(f,n),g=Math.min(g,l));for(var m=0;e<g;e++){for(var r=0,q=d;q<f;q++){var s=this.preRenderedChunks[e%l][q%n],
u=-b+q*this.chunkSize-r,t=-c+e*this.chunkSize-m;ig.system.context.drawImage(s,u,t);ig.Image.drawCount++;this.debugChunks&&(ig.system.context.strokeStyle="#f0f",ig.system.context.strokeRect(u,t,this.chunkSize,this.chunkSize));this.repeat&&(s.width<this.chunkSize&&u+s.width<ig.system.realWidth)&&(r+=this.chunkSize-s.width,f++)}this.repeat&&(s.height<this.chunkSize&&t+s.height<ig.system.realHeight)&&(m+=this.chunkSize-s.height,g++)}},drawTiled:function(){for(var b=0,c=null,d=(this.scroll.x/this.tilesize).toInt(),
e=(this.scroll.y/this.tilesize).toInt(),f=this.scroll.x%this.tilesize,g=this.scroll.y%this.tilesize,n=-f-this.tilesize,f=ig.system.width+this.tilesize-f,l=ig.system.height+this.tilesize-g,m=-1,g=-g-this.tilesize;g<l;m++,g+=this.tilesize){var r=m+e;if(r>=this.height||0>r){if(!this.repeat)continue;r=(r%this.height+this.height)%this.height}for(var q=-1,s=n;s<f;q++,s+=this.tilesize){b=q+d;if(b>=this.width||0>b){if(!this.repeat)continue;b=(b%this.width+this.width)%this.width}if(b=this.data[r][b])(c=this.anims[b-
1])?c.draw(s,g):this.tiles.drawTile(s,g,b-1,this.tilesize)}}}})});ig.baked=!0;
ig.module("impact.game").requires("impact.impact","impact.entity","impact.collision-map","impact.background-map").defines(function(){ig.Game=ig.Class.extend({clearColor:"#000000",gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:!1,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:!1,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;
ig.game=this;return null},loadLevel:function(b){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var c=0;c<b.entities.length;c++){var d=b.entities[c];this.spawnEntity(d.type,d.x,d.y,d.settings)}this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(c=0;c<b.layer.length;c++)if(d=b.layer[c],"collision"==d.name)this.collisionMap=new ig.CollisionMap(d.tilesize,d.data);else{var e=new ig.BackgroundMap(d.tilesize,d.data,d.tilesetName);e.anims=this.backgroundAnims[d.tilesetName]||
{};e.repeat=d.repeat;e.distance=d.distance;e.foreground=!!d.foreground;e.preRender=!!d.preRender;e.name=d.name;this.backgroundMaps.push(e)}for(c=0;c<this.entities.length;c++)this.entities[c].ready()},loadLevelDeferred:function(b){this._levelToLoad=b},getMapByName:function(b){if("collision"==b)return this.collisionMap;for(var c=0;c<this.backgroundMaps.length;c++)if(this.backgroundMaps[c].name==b)return this.backgroundMaps[c];return null},getEntityByName:function(b){return this.namedEntities[b]},getEntitiesByType:function(b){b=
"string"===typeof b?ig.global[b]:b;for(var c=[],d=0;d<this.entities.length;d++){var e=this.entities[d];e instanceof b&&!e._killed&&c.push(e)}return c},spawnEntity:function(b,c,d,e){var f="string"===typeof b?ig.global[b]:b;if(!f)throw"Can't spawn entity of type "+b;b=new f(c,d,e||{});this.entities.push(b);b.name&&(this.namedEntities[b.name]=b);return b},sortEntities:function(){this.entities.sort(this.sortBy)},sortEntitiesDeferred:function(){this._doSortEntities=!0},removeEntity:function(b){b.name&&
delete this.namedEntities[b.name];b._killed=!0;b.type=ig.Entity.TYPE.NONE;b.checkAgainst=ig.Entity.TYPE.NONE;b.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(b)},run:function(){this.update();this.draw()},update:function(){this._levelToLoad&&(this.loadLevel(this._levelToLoad),this._levelToLoad=null);this.updateEntities();this.checkEntities();for(var b=0;b<this._deferredKill.length;b++)this._deferredKill[b].erase(),this.entities.erase(this._deferredKill[b]);this._deferredKill=[];if(this._doSortEntities||
this.autoSort)this.sortEntities(),this._doSortEntities=!1;for(var c in this.backgroundAnims){var b=this.backgroundAnims[c],d;for(d in b)b[d].update()}},updateEntities:function(){for(var b=0;b<this.entities.length;b++){var c=this.entities[b];c._killed||c.update()}},draw:function(){this.clearColor&&ig.system.clear(this.clearColor);this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var b;for(b=0;b<this.backgroundMaps.length;b++){var c=
this.backgroundMaps[b];if(c.foreground)break;c.setScreenPos(this.screen.x,this.screen.y);c.draw()}this.drawEntities();for(b;b<this.backgroundMaps.length;b++)c=this.backgroundMaps[b],c.setScreenPos(this.screen.x,this.screen.y),c.draw()},drawEntities:function(){for(var b=0;b<this.entities.length;b++)this.entities[b].draw()},checkEntities:function(){for(var b={},c=0;c<this.entities.length;c++){var d=this.entities[c];if(!(d.type==ig.Entity.TYPE.NONE&&d.checkAgainst==ig.Entity.TYPE.NONE&&d.collides==ig.Entity.COLLIDES.NEVER))for(var e=
{},f=Math.floor(d.pos.y/this.cellSize),g=Math.floor((d.pos.x+d.size.x)/this.cellSize)+1,n=Math.floor((d.pos.y+d.size.y)/this.cellSize)+1,l=Math.floor(d.pos.x/this.cellSize);l<g;l++)for(var m=f;m<n;m++)if(b[l])if(b[l][m]){for(var r=b[l][m],q=0;q<r.length;q++)d.touches(r[q])&&!e[r[q].id]&&(e[r[q].id]=!0,ig.Entity.checkPair(d,r[q]));r.push(d)}else b[l][m]=[d];else b[l]={},b[l][m]=[d]}}});ig.Game.SORT={Z_INDEX:function(b,c){return b.zIndex-c.zIndex},POS_X:function(b,c){return b.pos.x+b.size.x-(c.pos.x+
c.size.x)},POS_Y:function(b,c){return b.pos.y+b.size.y-(c.pos.y+c.size.y)}}});ig.baked=!0;
ig.module("plugins.patches.webkit-image-smoothing-patch").defines(function(){ig.System&&(ig.System.SCALE={CRISP:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!1;b.style.imageRendering="-moz-crisp-edges";b.style.imageRendering="-o-crisp-edges";b.style.imageRendering="-webkit-optimize-contrast";b.style.imageRendering="crisp-edges";b.style.msInterpolationMode="nearest-neighbor"},SMOOTH:function(b,c){c.imageSmoothingEnabled=c.msImageSmoothingEnabled=
c.mozImageSmoothingEnabled=c.oImageSmoothingEnabled=!0;b.style.imageRendering="";b.style.msInterpolationMode=""}},ig.System.scaleMode=ig.System.SCALE.SMOOTH)});ig.baked=!0;
ig.module("plugins.patches.windowfocus-onMouseDown-patch").defines(function(){var b=!1;try{b=window.self!==window.top,!1===b&&(b=0<window.frames.length)}catch(c){b=!0}ig.Input.inject({keydown:function(c){var e=c.target.tagName;if(!("INPUT"==e||"TEXTAREA"==e))if(e="keydown"==c.type?c.keyCode:2==c.button?ig.KEY.MOUSE2:ig.KEY.MOUSE1,b&&0>e&&window.focus(),("touchstart"==c.type||"mousedown"==c.type)&&this.mousemove(c),e=this.bindings[e])this.actions[e]=!0,this.locks[e]||(this.presses[e]=!0,this.locks[e]=
!0),c.stopPropagation(),c.preventDefault()}})});ig.baked=!0;
ig.module("plugins.handlers.dom-handler").defines(function(){ig.DomHandler=ig.Class.extend({JQUERYAVAILABLE:!1,init:function(){this.JQUERYAVAILABLE=this._jqueryAvailable()},_jqueryAvailable:function(){return"undefined"!==typeof jQuery},addEvent:function(b,c,d,e){if(this.JQUERYAVAILABLE)b.on(c,d);else b.addEventListener(c,d,e)},create:function(b){return this.JQUERYAVAILABLE?$("<"+b+">"):ig.$new(b)},getElementByClass:function(b){return this.JQUERYAVAILABLE?$("."+b):document.getElementsByClassName(b)},
getElementById:function(b){return this.JQUERYAVAILABLE?0<$(b).length?$(b):null:ig.$(b)},appendChild:function(b,c){this.JQUERYAVAILABLE?b.append(c):b.appendChild(c)},appendToBody:function(b){this.JQUERYAVAILABLE?$("body").append(b):document.body.appendChild(b)},resize:function(b,c,d){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(d.toFixed(2));else{var e=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+d.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=e}},resizeOffsetLeft:function(b,
c,d,e){if(this.JQUERYAVAILABLE)b.width(c.toFixed(2)),b.height(d.toFixed(2)),b.css("left",e);else{var f=b.style.visibility;c="width:"+c.toFixed(2)+"px; height:"+d.toFixed(2)+"px; left: "+e.toFixed(2)+"px;";this.attr(b,"style",c);b.style.visibility=f}},css:function(b,c){if(this.JQUERYAVAILABLE)b.css(c);else{var d="",e;for(e in c)d+=e+":"+c[e]+";";this.attr(b,"style",d)}},getOffsets:function(b){return this.JQUERYAVAILABLE?(b=b.offset(),{left:b.left,top:b.top}):{left:b.offsetLeft,top:b.offsetTop}},attr:function(b,
c,d){if("undefined"===typeof d)return this.JQUERYAVAILABLE?b.attr(c):b.getAttribute(c);this.JQUERYAVAILABLE?b.attr(c,d):b.setAttribute(c,d)},show:function(b){this.JQUERYAVAILABLE?(b.show(),b.css("visibility","visible")):b&&(b.style?b.style.visibility="visible":b[0]&&(b[0].style.visibility="visible"))},hide:function(b){this.JQUERYAVAILABLE?(b.hide(),b.css("visibility","hidden")):b&&(b.style?b.style.visibility="hidden":b[0]&&(b[0].style.visibility="hidden"))},getQueryVariable:function(b){for(var c=
window.location.search.substring(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(decodeURIComponent(e[0])==b)return decodeURIComponent(e[1])}},forcedDeviceDetection:function(){var b=this.getQueryVariable("device");if(b)switch(b){case "mobile":console.log("serving mobile version ...");ig.ua.mobile=!0;break;case "desktop":console.log("serving desktop version ...");ig.ua.mobile=!1;break;default:console.log("serving universal version ...")}else console.log("serving universal version ...")},
forcedDeviceRotation:function(){var b=this.getQueryVariable("force-rotate");if(b)switch(b){case "portrait":console.log("force rotate to portrait");window.orientation=0;break;case "landscape":console.log("force rotate to horizontal");window.orientation=90;break;default:alert("wrong command/type in param force-rotate. Defaulting value to portrait"),window.orientation=0}}})});ig.baked=!0;
ig.module("plugins.data.vector").defines(function(){Vector2=ig.Class.extend({x:null,y:null,valType:"number",init:function(b,c){typeof b===this.valType&&typeof c===this.valType&&(this.x=b,this.y=c)},row:function(b){typeof b===this.valType&&(this.y=b);return this.y},col:function(b){typeof b===this.valType&&(this.x=b);return this.x}})});ig.baked=!0;
ig.module("plugins.handlers.size-handler").requires("plugins.data.vector").defines(function(){ig.SizeHandler=ig.Class.extend({portraitMode:!1,desktop:{actualSize:new Vector2(window.innerWidth,$(window).height()),actualResolution:new Vector2(960,540)},mobile:{actualSize:new Vector2(window.innerWidth,$(window).height()),actualResolution:new Vector2(960,540)},windowSize:new Vector2(window.innerWidth,$(window).height()),scaleRatioMultiplier:new Vector2(1,1),sizeRatio:new Vector2(1,1),scale:1,domHandler:null,
dynamicClickableEntityDivs:{},coreDivsToResize:["#canvas","#play","#orientate"],adsToResize:{},init:function(b){this.domHandler=b;if("undefined"===typeof b)throw"undefined Dom Handler for Size Handler";this.sizeCalcs();this.eventListenerSetup();this.samsungFix()},sizeCalcs:function(){this.windowSize=new Vector2(window.innerWidth,window.innerHeight);if(ig.ua.mobile){this.mobile.actualSize=new Vector2(window.innerWidth,window.innerHeight);var b=new Vector2(this.mobile.actualResolution.x,this.mobile.actualResolution.y);
this.scaleRatioMultiplier=new Vector2(this.mobile.actualSize.x/b.x,this.mobile.actualSize.y/b.y);var c=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y);this.mobile.actualSize.x=b.x*this.scaleRatioMultiplier.x;this.mobile.actualSize.y=b.y*this.scaleRatioMultiplier.y}else this.desktop.actualSize=new Vector2(window.innerWidth,window.innerHeight),b=new Vector2(this.desktop.actualResolution.x,this.desktop.actualResolution.y),this.scaleRatioMultiplier=new Vector2(this.desktop.actualSize.x/
b.x,this.desktop.actualSize.y/b.y),c=Math.min(this.scaleRatioMultiplier.x,this.scaleRatioMultiplier.y),this.desktop.actualSize.x=b.x*c,this.desktop.actualSize.y=b.y*c;this.sizeRatio.x=window.innerWidth/this.mobile.actualResolution.x;this.sizeRatio.y=window.innerHeight/this.mobile.actualResolution.y},resizeLayers:function(){for(var b=0;b<this.coreDivsToResize.length;b++){var c=ig.domHandler.getElementById(this.coreDivsToResize[b]);ig.ua.mobile?ig.domHandler.resize(c,Math.floor(ig.sizeHandler.mobile.actualSize.x),
Math.floor(ig.sizeHandler.mobile.actualSize.y)):ig.domHandler.resizeOffsetLeft(c,Math.floor(ig.sizeHandler.desktop.actualSize.x),Math.floor(ig.sizeHandler.desktop.actualSize.y),Math.floor(ig.sizeHandler.windowSize.x/2-ig.sizeHandler.desktop.actualSize.x/2))}for(var d in this.adsToResize){var b=ig.domHandler.getElementById("#"+d),c=ig.domHandler.getElementById("#"+d+"-Box"),e=(window.innerWidth-this.adsToResize[d]["box-width"])/2+"px",f=(window.innerHeight-this.adsToResize[d]["box-height"])/2+"px";
b&&ig.domHandler.css(b,{width:window.innerWidth,height:window.innerHeight});c&&ig.domHandler.css(c,{left:e,top:f})}for(d in this.dynamicClickableEntityDivs){c=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y);b=ig.domHandler.getElementById("#"+d);if(ig.ua.mobile)var g=this.dynamicClickableEntityDivs[d].entity_pos_x,n=this.dynamicClickableEntityDivs[d].entity_pos_y,f=this.dynamicClickableEntityDivs[d].width,e=this.dynamicClickableEntityDivs[d].height,l=Math.floor(g*
this.scaleRatioMultiplier.x)+"px",n=Math.floor(n*this.scaleRatioMultiplier.y)+"px",f=Math.floor(f*this.scaleRatioMultiplier.x)+"px",c=Math.floor(e*this.scaleRatioMultiplier.y)+"px";else var e=ig.domHandler.getElementById("#canvas"),e=ig.domHandler.getOffsets(e),l=e.left,m=e.top,g=this.dynamicClickableEntityDivs[d].entity_pos_x,n=this.dynamicClickableEntityDivs[d].entity_pos_y,f=this.dynamicClickableEntityDivs[d].width,e=this.dynamicClickableEntityDivs[d].height,l=Math.floor(l+g*c)+"px",n=Math.floor(m+
n*c)+"px",f=Math.floor(f*c)+"px",c=Math.floor(e*c)+"px";ig.domHandler.css(b,{"float":"left",position:"absolute",left:l,top:n,width:f,height:c,"z-index":3})}},resize:function(){this.sizeCalcs();this.resizeLayers()},reorient:function(){if(ig.ua.mobile){var b=this.portraitMode?window.innerHeight<window.innerWidth:window.innerHeight>window.innerWidth,c=this.domHandler.getElementById("#orientate"),d=this.domHandler.getElementById("#game");b?(this.domHandler.show(c),this.domHandler.hide(d)):(this.domHandler.show(d),
this.domHandler.hide(c))}ig.ua.mobile?(this.resize(),this.resizeAds()):this.resize()},resizeAds:function(){for(var b in this.adsToResize){var c=ig.domHandler.getElementById("#"+b),d=ig.domHandler.getElementById("#"+b+"-Box"),e=(window.innerWidth-this.adsToResize[b]["box-width"])/2+"px",f=(window.innerHeight-this.adsToResize[b]["box-height"])/2+"px";c&&ig.domHandler.css(c,{width:window.innerWidth,height:window.innerHeight});d&&ig.domHandler.css(d,{left:e,top:f})}},samsungFix:function(){ig.ua.android&&
(!(4.2>parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8,navigator.userAgent.indexOf("Android")+11)))&&!(0>navigator.userAgent.indexOf("GT"))&&!(0<navigator.userAgent.indexOf("Chrome"))&&!(0<navigator.userAgent.indexOf("Firefox")))&&(document.addEventListener("touchstart",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchmove",function(b){b.preventDefault();return!1},!1),document.addEventListener("touchend",function(b){b.preventDefault();return!1},
!1))},orientationInterval:null,orientationTimeout:null,orientationHandler:function(){this.reorient();window.scrollTo(0,1)},orientationDelayHandler:function(){null==this.orientationInterval&&(this.orientationInterval=window.setInterval(this.orientationHandler.bind(this),100));null==this.orientationTimeout&&(this.orientationTimeout=window.setTimeout(function(){this.clearAllIntervals()}.bind(this),2E3))},clearAllIntervals:function(){window.clearInterval(this.orientationInterval);this.orientationInterval=
null;window.clearTimeout(this.orientationTimeout);this.orientationTimeout=null},eventListenerSetup:function(){ig.ua.iOS?(window.addEventListener("orientationchange",this.orientationDelayHandler.bind(this)),window.addEventListener("resize",this.orientationDelayHandler.bind(this))):(window.addEventListener("orientationchange",this.orientationHandler.bind(this)),window.addEventListener("resize",this.orientationHandler.bind(this)))}})});ig.baked=!0;
ig.module("plugins.handlers.api-handler").defines(function(){ig.ApiHandler=ig.Class.extend({apiAvailable:{MJSPreroll:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS&&_SETTINGS.Ad.Mobile.Preroll.Enabled&&MobileAdInGamePreroll.Initialize()},MJSHeader:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Header.Enabled&&MobileAdInGameHeader.Initialize()},MJSFooter:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.Footer.Enabled&&MobileAdInGameFooter.Initialize()},
MJSEnd:function(){ig.ua.mobile&&ig.domHandler.JQUERYAVAILABLE&&_SETTINGS.Ad.Mobile.End.Enabled&&MobileAdInGameEnd.Initialize()}},run:function(){}})});ig.baked=!0;
ig.module("plugins.audio.sound-player").defines(function(){SoundPlayer=ig.Class.extend({tagName:"SoundPlayer",muteFlag:!1,debug:!1,init:function(){this.debug&&console.log(this.tagName)},play:function(b){this.debug&&console.log("play sound ",b)},stop:function(){this.debug&&console.log("stop sound ")},volume:function(){this.debug&&console.log("set volume")},mute:function(b){this.debug&&console.log("mute");"undefined"===typeof b?this.muteFlag=!0:b.flagChange&&(this.muteFlag=!0)},unmute:function(b){this.debug&&
console.log("unmute");"undefined"===typeof b?this.muteFlag=!1:b.flagChange&&(this.muteFlag=!1)}})});ig.baked=!0;
ig.module("plugins.audio.impact-music-player").requires("plugins.audio.sound-player").defines(function(){ImpactMusicPlayer=SoundPlayer.extend({tagName:"ImpactMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b,c){this.parent(b,c);for(var d in b)this.soundList[d]=d,ig.music.add(b[d].path+".*",d);c&&c.loop&&(ig.music.loop=c.loop)},play:function(b){this.muteFlag||(this.bgmPlaying=!0,"undefined"===typeof b?ig.music.play(b):ig.music.play())},stop:function(){this.bgmPlaying=!1;ig.music.pause()},volume:function(b){console.log("impactmusic:",
b);ig.music.volume=0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.music.volume},mute:function(b){this.parent(b);this.bgmPlaying&&this.stop()},unmute:function(b){this.parent(b);this.play()}})});ig.baked=!0;
ig.module("plugins.audio.impact-sound-player").requires("plugins.audio.sound-player").defines(function(){ImpactSoundPlayer=SoundPlayer.extend({tagName:"ImpactSoundPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var d in b){var e=new ig.Sound(b[d].path+".*");this.soundList[d]=e}},play:function(b){this.muteFlag||("object"===typeof b?(console.log(b+" exists"),b.play()):"string"===typeof b&&this.soundList[b].play())},stop:function(b){this.parent(b);b.stop()},volume:function(b){ig.soundManager.volume=
0>b?0:isNaN(b)?1:1<b?1:b},getVolume:function(){return ig.soundManager.volume},mute:function(b){this.parent(b);ig.Sound.enabled=!1},unmute:function(b){this.parent(b);ig.Sound.enabled=!0}})});ig.baked=!0;
ig.module("plugins.audio.howler-player").requires("plugins.audio.sound-player").defines(function(){HowlerPlayer=SoundPlayer.extend({tagName:"HowlerPlayer",soundList:{},init:function(b,c){this.parent(b,c);for(var d in b){var e=b[d].path,e=new Howl({src:[e+"."+ig.Sound.FORMAT.OGG.ext,e+"."+ig.Sound.FORMAT.MP3.ext]});this.soundList[d]=e}},play:function(b){this.muteFlag||("object"===typeof b?b.play():"string"===typeof b&&this.soundList[b].play())},stop:function(b){this.parent(b);b.stop()},volume:function(b){isNaN(b)||
(1<b&&(b=1),0>b&&(b=0),Howler.volume(b))},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},mute:function(b){this.parent(b);for(var c in this.soundList)this.soundList[c].mute(!0),this.prevVol=this.soundList[c].volume(),this.soundList[c].volume(0)},unmute:function(b){this.parent(b);for(var c in this.soundList)this.soundList[c].mute(!1),isNaN(this.prevVol)||this.soundList[c].volume(this.prevVol)}})});ig.baked=!0;
ig.module("plugins.audio.howler-music-player").requires("plugins.audio.sound-player").defines(function(){HowlerMusicPlayer=SoundPlayer.extend({tagName:"HowlerMusicPlayer",bgmPlaying:!1,soundList:{},init:function(b){for(var c in b){var d=b[c].path,e=d+"."+ig.Sound.FORMAT.OGG.ext,d=d+"."+ig.Sound.FORMAT.MP3.ext,f=e;if(ig.ua.mobile)ig.ua.iOS&&(f=d);else{var g=navigator.userAgent.toLowerCase();-1!=g.indexOf("safari")&&-1>=g.indexOf("chrome")&&(f=d)}e=new Howl({src:[f,e,d],loop:!0,autoplay:!1});this.soundList[c]=
e}},play:function(b){if(!this.muteFlag&&!this.bgmPlaying){for(var c in this.soundList)if(this.soundList[c].isPlaying){this.bgmPlaying=!0;return}if("object"===typeof b)b.isPlaying||b.play(),this.bgmPlaying=!0;else if("string"===typeof b)this.soundList[b].isPlaying||this.soundList[b].play(),this.bgmPlaying=!0;else for(var d in this.soundList){this.soundList[d].isPlaying||this.soundList[d].play();this.bgmPlaying=!0;break}}},stop:function(){if(this.bgmPlaying){for(var b in this.soundList)this.soundList[b].stop();
this.bgmPlaying=!1}},volume:function(b){for(var c in this.soundList){if(0>b){this.soundList[c].volume(0);break}isNaN(b)?this.soundList[c].volume(1):1<b?this.soundList[c].volume(1):this.soundList[c].volume(b)}},getVolume:function(){for(var b in this.soundList)return this.soundList[b].volume()},mute:function(){if(!this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying))for(var b in this.soundList)this.soundList[b].stop()},unmute:function(){if(this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying))for(var b in this.soundList)this.soundList[b].isPlaying||
this.soundList[b].play()}})});ig.baked=!0;
ig.module("plugins.audio.jukebox-player").requires("plugins.audio.sound-player").defines(function(){JukeboxPlayer=SoundPlayer.extend({tagName:"JukeboxPlayer",bgmPlaying:!1,soundList:{},jukeboxPlayer:null,pausePosition:0,premuteVolume:0,minVolume:0.001,init:function(b,c){this.parent(b,c);for(var d in b){this.soundList[d]=d;var e=b[d].path;this.jukeboxPlayer=new jukebox.Player({resources:[e+"."+ig.Sound.FORMAT.OGG.ext,e+"."+ig.Sound.FORMAT.MP3.ext],autoplay:!1,spritemap:{music:{start:b[d].startMp3,
end:b[d].endMp3,loop:!0}}})}},play:function(){this.muteFlag||(this.bgmPlaying=!0,this.pausePosition?(console.log("resume"),this.jukeboxPlayer.resume(this.pausePosition)):(console.log("play"),this.jukeboxPlayer.play(this.jukeboxPlayer.settings.spritemap.music.start,!0)),this.premuteVolume=this.getVolume())},stop:function(){this.bgmPlaying=!1;this.pausePosition=this.jukeboxPlayer.pause()},volume:function(b){console.log("jukebox:",b);0>=b?this.jukeboxPlayer.setVolume(this.minVolume):isNaN(b)?this.jukeboxPlayer.setVolume(1):
1<b?this.jukeboxPlayer.setVolume(1):this.jukeboxPlayer.setVolume(b)},getVolume:function(){return this.jukeboxPlayer.getVolume()},mute:function(b){this.parent(b);this.bgmPlaying&&(console.log("jukebox",this.premuteVolume),this.muteFlag||(this.premuteVolume=this.getVolume()),this.jukeboxPlayer.pause(),this.jukeboxPlayer.setVolume(this.minVolume))},unmute:function(b){this.parent(b);this.muteFlag||(console.log("jukebox",this.premuteVolume),this.jukeboxPlayer.setVolume(this.premuteVolume),this.jukeboxPlayer.resume())}})});
ig.baked=!0;
ig.module("plugins.audio.webaudio-music-player").requires("plugins.audio.sound-player").defines(function(){WebaudioMusicPlayer=SoundPlayer.extend({tagName:"WebaudioMusicPlayer",bgmPlaying:!1,isSupported:!1,muteFlag:!1,pausedTime:0,webaudio:null,useHTML5Audio:!1,audio:null,inactiveAudio:null,codecs:null,_volume:1,soundList:{},init:function(b){this.webaudio={compatibility:{},gainNode:null,buffer:null,source_loop:{},source_once:{}};try{this.AudioContext=window.AudioContext||window.webkitAudioContext,this.webaudio.context=
new this.AudioContext,this.isSupported=!0}catch(c){console.log("Web Audio API not supported in this browser."),this.webaudio=null,this.useHTML5Audio=!0}if(this.useHTML5Audio)if("undefined"!==typeof Audio)try{new Audio}catch(d){this.useHTML5Audio=!1}else this.useHTML5Audio=!1;this.useHTML5Audio&&(this.audio=new Audio,this.isSupported=!0,this.initHTML5Audio(b));if(!this.isSupported)return null;this.webaudio&&this.initWebAudio(b)},initWebAudio:function(b){ig.ua.iOS&&this.initIOSWebAudioUnlock();this.webaudio.gainNode=
this.webaudio.context.createGain();this.webaudio.gainNode.connect(this.webaudio.context.destination);this.webaudio.gainNode.gain.value=this._volume;var c="start",d="stop",e=this.webaudio.context.createBufferSource();"function"!==typeof e.start&&(c="noteOn");this.webaudio.compatibility.start=c;"function"!==typeof e.stop&&(d="noteOff");this.webaudio.compatibility.stop=d;for(var f in b){this.soundList[f]=f;c=b[f].path;b=c+"."+ig.Sound.FORMAT.MP3.ext;var g=c+"."+ig.Sound.FORMAT.OGG.ext;ig.ua.mobile?ig.ua.iOS&&
(g=b):(c=navigator.userAgent.toLowerCase(),-1!=c.indexOf("safari")&&-1>=c.indexOf("chrome")&&(g=b));var n=new XMLHttpRequest;n.open("GET.html",g,!0);n.responseType="arraybuffer";n.onload=function(){this.webaudio.context.decodeAudioData(n.response,function(b){this.webaudio.buffer=b;this.webaudio.source_loop={};this.bgmPlaying?this.play():this.stop()}.bind(this),function(){console.log('Error decoding audio "'+g+'".')})}.bind(this);n.send();break}},initIOSWebAudioUnlock:function(){if(this.webaudio){webaudio=
this.webaudio;var b=function(){var c=webaudio.context,d=c.createBuffer(1,1,22050),e=c.createBufferSource();e.buffer=d;e.connect(c.destination);"undefined"===typeof e.start?e.noteOn(0):e.start(0);setTimeout(function(){(e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE)&&window.removeEventListener("touchend",b,!1)},0)};window.addEventListener("touchend",b,!1)}},initHTML5Audio:function(b){if(this.useHTML5Audio&&this.audio){var c=this.audio;this.codecs={};this.codecs={mp3:!!c.canPlayType("audio/mpeg;").replace(/^no$/,
""),opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!c.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,
"")};this.is={ff:Boolean(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase())),ie:Boolean(document.all&&!window.opera),opera:Boolean(window.opera),chrome:Boolean(window.chrome),safari:Boolean(!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase())&&window.getComputedStyle&&!window.globalStorage&&!window.opera)};this.playDelay=-60;this.stopDelay=30;this.is.chrome&&(this.playDelay=-25);this.is.chrome&&(this.stopDelay=25);this.is.ff&&(this.playDelay=-25);this.is.ff&&
(this.stopDelay=85);this.is.opera&&(this.playDelay=5);this.is.opera&&(this.stopDelay=0);for(var d in b){this.soundList[d]=d;var e=b[d].path,c=e+"."+ig.Sound.FORMAT.OGG.ext,e=e+"."+ig.Sound.FORMAT.MP3.ext,f=null;this.codecs[ig.Sound.FORMAT.OGG.ext.toLowerCase()]?f=c:this.codecs[ig.Sound.FORMAT.MP3.ext.toLowerCase()]&&(f=e);if(f){ig.ua.mobile?ig.ua.iOS&&(f=e):(b=navigator.userAgent.toLowerCase(),-1!=b.indexOf("safari")&&-1>=b.indexOf("chrome")&&(f=e));this.audio.addEventListener("error",function(){this.audio.error&&
4===this.audio.error.code&&(this.isSupported=!1)},!1);this.audio.src=f;this.audio._pos=0;this.audio.preload="auto";this.audio.volume=this._volume;this.inactiveAudio=new Audio;this.inactiveAudio.src=f;this.inactiveAudio._pos=0;this.inactiveAudio.preload="auto";this.inactiveAudio.volume=this._volume;this.inactiveAudio.load();var g=function(){this._duration=this.audio.duration;this._loaded||(this._loaded=!0);this.bgmPlaying?this.play():this.stop();this.audio.removeEventListener("canplaythrough",g,!1)}.bind(this);
this.audio.addEventListener("canplaythrough",g,!1);this.audio.load();break}}}},play:function(b){if(this.isSupported)if(this.bgmPlaying=!0,this.webaudio)if(this.webaudio.buffer){if(!this.muteFlag&&(this.bgmPlaying=!0,!this.webaudio.source_loop._playing)){this.webaudio.source_loop=this.webaudio.context.createBufferSource();this.webaudio.source_loop.buffer=this.webaudio.buffer;this.webaudio.source_loop.loop=!0;this.webaudio.source_loop.connect(this.webaudio.gainNode);isNaN(b)&&(b=0,this.pausedTime&&
(b=this.pausedTime));this.webaudio.source_loop._startTime=this.webaudio.context.currentTime;if("noteOn"===this.webaudio.compatibility.start)this.webaudio.source_once=this.webaudio.context.createBufferSource(),this.webaudio.source_once.buffer=this.webaudio.buffer,this.webaudio.source_once.connect(this.webaudio.gainNode),this.webaudio.source_once.noteGrainOn(0,b,this.webaudio.buffer.duration-b),this.webaudio.source_loop[this.webaudio.compatibility.start](this.webaudio.context.currentTime+(this.webaudio.buffer.duration-
b));else this.webaudio.source_loop[this.webaudio.compatibility.start](0,b);this.webaudio.source_loop._playing=!0}}else this.bgmPlaying=!0;else if(this.audio){var c=this.audio;if(!this.muteFlag){this.bgmPlaying=!0;isNaN(b)&&(b=0,this.pausedTime&&(b=this.pausedTime));var d=this._duration-b;this._onEndTimer&&(clearTimeout(this._onEndTimer),this._onEndTimer=null);this._onEndTimer=setTimeout(function(){this.audio.currentTime=0;this.audio.pause();this.pausedTime=0;if(this.inactiveAudio){var b=this.audio;
this.audio=this.inactiveAudio;this.inactiveAudio=b}this.play()}.bind(this),1E3*d+this.playDelay);4===c.readyState||!c.readyState&&navigator.isCocoonJS?(c.readyState=4,c.currentTime=b,c.muted=this.muteFlag||c.muted,c.volume=this._volume,setTimeout(function(){c.play()},0)):(clearTimeout(this._onEndTimer),this._onEndTimer=null,function(){var b=function(){this.play();c.removeEventListener("canplaythrough",b,!1)}.bind(this);c.addEventListener("canplaythrough",b,!1)}())}}},stop:function(){this.bgmPlaying=
!1;if(this.isSupported)if(this.webaudio){if(this.webaudio.source_loop._playing&&(this.webaudio.source_loop[this.webaudio.compatibility.stop](0),this.webaudio.source_loop._playing=!1,this.pausedTime+=this.webaudio.context.currentTime-this.webaudio.source_loop._startTime,this.pausedTime%=this.webaudio.source_loop.buffer.duration,this.webaudio.source_loop._startTime=0,"noteOn"===this.webaudio.compatibility.start))this.webaudio.source_once[this.webaudio.compatibility.stop](0)}else if(this.audio){var b=
this.audio;this.pausedTime=b.currentTime;b.currentTime=0;b.pause();clearTimeout(this._onEndTimer);this._onEndTimer=null}},volume:function(b){this.isSupported&&(this._volume=b,0>this._volume?this._volume=0:1<this._volume&&(this._volume=1),this.webaudio?this.webaudio.gainNode&&(this.webaudio.gainNode.gain.value=this._volume):this.audio&&(this.audio.volume=this._volume,this.inactiveAudio&&(this.inactiveAudio.volume=this._volume)))},getVolume:function(){return!this.isSupported?0:this._volume},mute:function(){!1==
this.muteFlag&&(this.muteFlag=!0,this.bgmPlaying&&(this.stop(),this.bgmPlaying=!0))},unmute:function(){!0==this.muteFlag&&(this.muteFlag=!1,this.bgmPlaying&&this.play())}})});ig.baked=!0;
ig.module("plugins.audio.sound-info").defines(function(){SoundInfo=ig.Class.extend({FORMATS:{OGG:".ogg",MP3:".mp3"},sfx:{kittyopeningSound:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/opening/kittyopening"},staticSound:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/play/static"},openingSound:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/opening/opening"},placemarker:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/coin"},button:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/click"},reset:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/slide-out"},
win:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/win"},lost:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/lost"},tied:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/tied"}},bgm:{background:{path:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/audio/bgm",startOgg:0,endOgg:21.463,startMp3:0,endMp3:21.463}}})});ig.baked=!0;
ig.module("plugins.audio.sound-handler").requires("plugins.audio.impact-music-player","plugins.audio.impact-sound-player","plugins.audio.howler-player","plugins.audio.howler-music-player","plugins.audio.jukebox-player","plugins.audio.webaudio-music-player","plugins.audio.sound-info").defines(function(){ig.SoundHandler=ig.Class.extend({bgmPlayer:null,sfxPlayer:null,focusBlurMute:!1,soundInfo:new SoundInfo,init:function(){console.log("Initiating sound handler");this.initWindowHandler();ig.ua.mobile&&
this.initPowerButtonFix();this.bgmPlayer=new WebaudioMusicPlayer(this.soundInfo.bgm);this.bgmPlayer.isSupported||(this.bgmPlayer=new HowlerMusicPlayer(this.soundInfo.bgm));this.sfxPlayer=new HowlerPlayer(this.soundInfo.sfx)},checkBGM:function(){return this.bgmPlayer.muteFlag},checkSFX:function(){return this.sfxPlayer.muteFlag},muteAll:function(b){this.bgmPlayer&&this.bgmPlayer.mute({flagChange:b});this.sfxPlayer&&this.sfxPlayer.mute({flagChange:b})},unmuteAll:function(b){this.bgmPlayer&&this.bgmPlayer.unmute({flagChange:b});
this.sfxPlayer&&this.sfxPlayer.unmute({flagChange:b})},forceMuteAll:function(){this.focusBlurMute||this.muteAll(!1);this.focusBlurMute=!0},forceUnMuteAll:function(){this.focusBlurMute&&(this.unmuteAll(!1),this.focusBlurMute=!1)},initWindowHandler:function(){"true"===ig.domHandler.getQueryVariable("webview")?($(window).focus(function(){ig.game&&ig.game.resume();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()}),$(window).blur(function(){ig.game&&ig.game.pause();ig.soundHandler&&ig.soundHandler.forceMuteAll()})):
(window.onfocus=function(){ig.game&&ig.game.resume();ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},window.onblur=function(){ig.game&&ig.game.pause();ig.soundHandler&&ig.soundHandler.forceMuteAll()})},initPowerButtonFix:function(){var b=this.getHiddenProp();b&&(b=b.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(b,this.visChange));window.addEventListener("pagehide",function(){ig.soundHandler&&ig.soundHandler.forceMuteAll()},!1);window.addEventListener("pageshow",function(){ig.soundHandler&&
ig.soundHandler.forceUnMuteAll()},!1)},getHiddenProp:function(){var b=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var c=0;c<b.length;c++)if(b[c]+"Hidden"in document)return b[c]+"Hidden";return null},isHidden:function(){var b=this.getHiddenProp();return!b?!1:document[b]},visChange:function(){ig.soundHandler.isHidden()?ig.soundHandler&&ig.soundHandler.forceMuteAll():ig.soundHandler&&ig.soundHandler.forceUnMuteAll()},saveVolume:function(){this.sfxPlayer&&ig.game.io.storageSet("soundVolume",
this.sfxPlayer.getVolume());this.bgmPlayer&&ig.game.io.storageSet("musicVolume",this.bgmPlayer.getVolume())},forceLoopBGM:function(){var b;if(!this.focusBlurMute&&this.bgmPlayer.bgmPlaying&&this.bgmPlayer){var c=this.bgmPlayer.jukeboxPlayer;if(c){null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase());b=Boolean(window.chrome);!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase());var d=0.1;ig.ua.mobile&&(d=0.115,ig.ua.android&&(d=0.45,b&&(d=0.3)));c.settings.spritemap.music&&
(b=c.settings.spritemap.music.end-d,c.getCurrentTime()>=b&&(b=c.settings.spritemap.music.start,ig.ua.android?this.forcelooped||(c.play(b,!0),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},d)):c.setCurrentTime(b)))}else"ImpactMusicPlayer"==this.bgmPlayer.tagName&&(null!=window.mozInnerScreenX&&/firefox/.test(navigator.userAgent.toLowerCase()),b=Boolean(window.chrome),!window.chrome&&/safari/.test(navigator.userAgent.toLowerCase()),d=0.1,ig.ua.mobile&&(d=0.115,ig.ua.android&&
(d=0.45,b&&(d=0.3))),c=0,"mp3"==ig.soundManager.format.ext&&(c=0.05),ig.music.currentTrack&&(b=ig.music.currentTrack.duration-d,ig.music.currentTrack.currentTime>=b&&(ig.ua.android?this.forcelooped||(ig.music.currentTrack.pause(),ig.music.currentTrack.currentTime=c,ig.music.currentTrack.play(),this.forcelooped=!0,setTimeout(function(){ig.soundHandler.forcelooped=!1},d)):ig.music.currentTrack.currentTime=c)))}}})});ig.baked=!0;
ig.module("plugins.io.storage").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return"undefined"!==typeof window.localStorage},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(d){console.log(d)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;ig.module("plugins.io.mouse").defines(function(){Mouse=ig.Class.extend({bindings:{click:[ig.KEY.MOUSE1]},init:function(){ig.input.initMouse();for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}},getPos:function(){if(ig.ua.mobile)var b=ig.input.mouse.x/ig.sizeHandler.sizeRatio.x,c=ig.input.mouse.y/ig.sizeHandler.sizeRatio.y;else b=ig.input.mouse.x,c=ig.input.mouse.y;return new Vector2(b,c)}})});
ig.baked=!0;ig.module("plugins.io.keyboard").defines(function(){Keyboard=ig.Class.extend({bindings:{esc:[ig.KEY.ESC],enter:[ig.KEY.ENTER]},init:function(){for(var b in this.bindings){this[b]=b;for(var c=0;c<this.bindings[b].length;c++)ig.input.bind(this.bindings[b][c],b)}}})});ig.baked=!0;
ig.module("plugins.io.gamepad-input").defines(function(){ig.PADKEY={BUTTON_0:0,PADBUTTON_1:1,BUTTON_2:2,BUTTON_3:3,BUTTON_LEFT_BUMPER:4,BUTTON_RIGHT_BUMPER:5,BUTTON_LEFT_TRIGGER:6,BUTTON_RIGHT_TRIGGER:7,BUTTON_LEFT_JOYSTICK:10,BUTTON_RIGHT_JOYSTICK:11,BUTTON_DPAD_UP:12,BUTTON_DPAD_DOWN:13,BUTTON_DPAD_LEFT:14,BUTTON_DPAD_RIGHT:15,BUTTON_MENU:16,AXIS_LEFT_JOYSTICK_X:0,AXIS_LEFT_JOYSTICK_Y:1,AXIS_RIGHT_JOYSTICK_X:2,AXIS_RIGHT_JOYSTICK_Y:3};ig.GamepadInput=ig.Class.extend({isInit:!1,isSupported:!1,list:[],
bindings:{},states:{},presses:{},releases:{},downLocks:{},upLocks:{},leftStick:{x:0,y:0},rightStick:{x:0,y:0},start:function(){if(!this.isInit){this.isInit=!0;var b=navigator.getGamepads||navigator.webkitGetGamepads;b&&(!navigator.getGamepads&&navigator.webkitGetGamepads&&(navigator.getGamepads=navigator.webkitGetGamepads),this.list=navigator.getGamepads());this.isSupported=b}},isAvailable:function(){return this.isInit&&this.isSupported},buttonPressed:function(b){return"object"==typeof b?b.pressed:
1==b},buttonDown:function(b){if(b=this.bindings[b])this.states[b]=!0,this.downLocks[b]||(this.presses[b]=!0,this.downLocks[b]=!0)},buttonUp:function(b){if((b=this.bindings[b])&&this.downLocks[b]&&!this.upLocks[b])this.states[b]=!1,this.releases[b]=!0,this.upLocks[b]=!0},clearPressed:function(){for(var b in this.releases)this.states[b]=!1,this.downLocks[b]=!1;this.releases={};this.presses={};this.upLocks={}},bind:function(b,c){this.bindings[b]=c},unbind:function(b){this.releases[this.bindings[b]]=
!0;this.bindings[b]=null},unbindAll:function(){this.bindings={};this.states={};this.presses={};this.releases={};this.downLocks={};this.upLocks={}},state:function(b){return this.states[b]},pressed:function(b){return this.presses[b]},released:function(b){return this.releases[b]},clamp:function(b,c,d){return b<c?c:b>d?d:b},pollGamepads:function(){if(this.isSupported){this.leftStick.x=0;this.leftStick.y=0;this.rightStick.x=0;this.rightStick.y=0;this.list=navigator.getGamepads();for(var b in this.bindings){for(var c=
!1,d=0;d<this.list.length;d++){var e=this.list[d];if(e&&e.buttons&&this.buttonPressed(e.buttons[b])){c=!0;break}}c?this.buttonDown(b):this.buttonUp(b)}for(d=0;d<this.list.length;d++)if((e=this.list[d])&&e.axes){b=e.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_X];var c=e.axes[ig.GAMEPADINPUT.AXIS_LEFT_JOYSTICK_Y],f=e.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_X],e=e.axes[ig.GAMEPADINPUT.AXIS_RIGHT_JOYSTICK_Y];this.leftStick.x+=isNaN(b)?0:b;this.leftStick.y+=isNaN(c)?0:c;this.rightStick.x+=isNaN(f)?0:f;this.rightStick.y+=
isNaN(e)?0:e}0<this.list.length&&(this.leftStick.x=this.clamp(this.leftStick.x,-1,1),this.leftStick.y=this.clamp(this.leftStick.y,-1,1),this.rightStick.x=this.clamp(this.rightStick.x,-1,1),this.rightStick.y=this.clamp(this.rightStick.y,-1,1))}}})});ig.baked=!0;
ig.module("plugins.io.gamepad").requires("plugins.io.gamepad-input").defines(function(){Gamepad=ig.Class.extend({bindings:{padJump:[ig.PADKEY.BUTTON_0]},init:function(){ig.gamepadInput.start();for(var b in this.bindings)for(var c=0;c<this.bindings[b].length;c++)ig.gamepadInput.bind(this.bindings[b][c],b)},press:function(){},held:function(){},release:function(){}})});ig.baked=!0;
ig.module("plugins.io.multitouch").defines(function(){Multitouch=ig.Class.extend({init:function(){ig.multitouchInput.start()},getTouchesPos:function(){if(ig.ua.mobile){if(0<ig.multitouchInput.touches.length){for(var b=[],c=0;c<ig.multitouchInput.touches.length;c++){var d=ig.multitouchInput.touches[c];b.push({x:d.x,y:d.y})}return b}return null}}})});ig.baked=!0;
ig.module("plugins.io.multitouch-input").defines(function(){ig.MultitouchInput=ig.Class.extend({isStart:!1,touches:[],multitouchCapable:!1,lastEventUp:null,start:function(){this.isStart||(this.isStart=!0,navigator.maxTouchPoints&&1<navigator.maxTouchPoints&&(this.multitouchCapable=!0),ig.ua.touchDevice&&(window.navigator.msPointerEnabled&&(ig.system.canvas.addEventListener("MSPointerDown",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("MSPointerUp",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("MSPointerMove",
this.touchmove.bind(this),!1),ig.system.canvas.style.msContentZooming="none",ig.system.canvas.style.msTouchAction="none"),ig.system.canvas.addEventListener("touchstart",this.touchdown.bind(this),!1),ig.system.canvas.addEventListener("touchend",this.touchup.bind(this),!1),ig.system.canvas.addEventListener("touchmove",this.touchmove.bind(this),!1)))},touchmove:function(b){if(ig.ua.touchDevice){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,d=parseInt(ig.system.canvas.offsetHeight)||
ig.system.realHeight,c=ig.system.scale*(c/ig.system.realWidth),d=ig.system.scale*(d/ig.system.realHeight);if(b.touches){for(;0<this.touches.length;)this.touches.pop();!this.multitouchCapable&&1<b.touches.length&&(this.multitouchCapable=!0);var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());for(var f=0;f<b.touches.length;f++){var g=b.touches[f];g&&this.touches.push({x:(g.clientX-e.left)/c,y:(g.clientY-e.top)/d})}}else this.windowMove(b)}},touchdown:function(b){var c=
parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,d=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight,c=ig.system.scale*(c/ig.system.realWidth),d=ig.system.scale*(d/ig.system.realHeight);if(window.navigator.msPointerEnabled)this.windowKeyDown(b);else if(ig.ua.touchDevice&&b.touches){for(;0<this.touches.length;)this.touches.pop();!this.multitouchCapable&&1<b.touches.length&&(this.multitouchCapable=!0);var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());
for(var f=0;f<b.touches.length;f++){var g=b.touches[f];g&&this.touches.push({x:(g.clientX-e.left)/c,y:(g.clientY-e.top)/d})}}},touchup:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;parseInt(ig.system.canvas.offsetHeight);c=ig.system.scale*(c/ig.system.realWidth);if(window.navigator.msPointerEnabled)this.windowKeyUp(b);else{this.lastEventUp=b;var d={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(d=ig.system.canvas.getBoundingClientRect());if(ig.ua.touchDevice){b=
(b.changedTouches[0].clientX-d.left)/c;for(c=0;c<this.touches.length;c++)this.touches[c].x>=b-40&&this.touches[c].x<=b+40&&this.touches.splice(c,1)}}},windowKeyDown:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,d=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight,c=ig.system.scale*(c/ig.system.realWidth),d=ig.system.scale*(d/ig.system.realHeight);if(window.navigator.msPointerEnabled){var e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());
b=b.changedTouches?b.changedTouches:[b];for(var f=0;f<b.length;++f){for(var g=b[f],n="undefined"!=typeof g.identifier?g.identifier:"undefined"!=typeof g.pointerId?g.pointerId:1,l=(g.clientX-e.left)/c,g=(g.clientY-e.top)/d,m=0;m<this.touches.length;++m)this.touches[m].identifier==n&&this.touches.splice(m,1);this.touches.push({x:l,y:g,identifier:n})}for(c=0;c<this.touches.length;c++);}},windowKeyUp:function(b){b="undefined"!=typeof b.identifier?b.identifier:"undefined"!=typeof b.pointerId?b.pointerId:
1;for(var c=0;c<this.touches.length;++c)this.touches[c].identifier==b&&this.touches.splice(c,1);for(;0<this.touches.length;)this.touches.pop()},windowMove:function(b){var c=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth,d=parseInt(ig.system.canvas.offsetHeight)||ig.system.realHeight,c=ig.system.scale*(c/ig.system.realWidth),d=ig.system.scale*(d/ig.system.realHeight),e={left:0,top:0};ig.system.canvas.getBoundingClientRect&&(e=ig.system.canvas.getBoundingClientRect());if(window.navigator.msPointerEnabled)for(var f=
"undefined"!=typeof b.identifier?b.identifier:"undefined"!=typeof b.pointerId?b.pointerId:1,g=0;g<this.touches.length;++g)if(this.touches[g].identifier==f){var n=(b.clientY-e.top)/d;this.touches[g].x=(b.clientX-e.left)/c;this.touches[g].y=n}}})});ig.baked=!0;
ig.module("plugins.io.io-manager").requires("plugins.io.storage","plugins.io.mouse","plugins.io.keyboard","plugins.io.gamepad","plugins.io.multitouch","plugins.io.multitouch-input","plugins.io.gamepad-input").defines(function(){IoManager=ig.Class.extend({storage:null,localStorageSupport:!1,gamekey:"TeamKaboom",mouse:null,keyboard:null,multitouch:null,gamepad:null,init:function(){ig.multitouchInput=new ig.MultitouchInput;ig.gamepadInput=new ig.GamepadInput;this.unbindAll();this.initStorage();this.initMouse();
this.initKeyboard()},unbindAll:function(){ig.input.unbindAll();ig.gamepadInput.unbindAll()},initStorage:function(){this._supportsLocalStorage()&&(this.storage=new ig.Storage)},initMouse:function(){this.mouse=new Mouse},initKeyboard:function(){this.keyboard=new Keyboard},initMultitouch:function(){this.multitouch=new Multitouch},initGamepad:function(){this.gamepad=new Gamepad},press:function(b){return ig.input.pressed(b)||this.gamepad.press(b)?!0:!1},held:function(b){return ig.input.state(b)||this.gamepad.state(b)?
!0:!1},release:function(b){return ig.input.released(b)||this.gamepad.released(b)?!0:!1},getClickPos:function(){return this.mouse.getPos()},getTouchesPos:function(){return this.multitouch.getTouchesPos()},checkOverlap:function(b,c,d,e,f){return b.x>c+e||b.x<c||b.y>d+f||b.y<d?!1:!0},_supportsLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorageSupport="localStorage"in window&&null!==window.localStorage}catch(b){return this.localStorageSupport}},
storageIsSet:function(b){return!this.localStorageSupport?null:this.storage.isSet(b)},storageGet:function(b){return!this.localStorageSupport?null:this.storage.get(b)},storageSet:function(b,c){if(!this.localStorageSupport)return null;this.storage.set(b,c)},assert:function(b,c,d){if(c!==d)throw"actualValue:"+c+" not equal to testValue:"+d+" at "+b;}})});ig.baked=!0;
ig.module("plugins.image-extension").requires("impact.image").defines(function(){ig.MobileImage=ig.Image.extend({load:function(b){ig.ua.mobile&&this.parent(b)}});ig.DesktopImage=ig.Image.extend({load:function(b){ig.ua.mobile||this.parent(b)}})});ig.baked=!0;
ig.module("plugins.font-loaded-test").defines(function(){ig.FontLoadedTest=ig.Class.extend({testFont:function(b){function c(b){f.clearRect(0,0,e.width,e.height);f.fillStyle="rgba(0,0,0,1.0)";f.fillRect(0,0,40,40);f.font="20px "+b;f.textBaseline="top";f.fillStyle="rgba(255,255,255,1.0)";f.fillText("a",18,5);return f.getImageData(0,0,40,40)}var d="arial";ig.ua.ios&&(d="times");if(b.toLowerCase()==d)return!0;var e=ig.$new("canvas");e.width=40;e.height=40;var f=e.getContext("2d");b=c(b+","+d);for(var d=
c(d),g=!1,n=0;n<b.data.length;n++)if(b.data[n]!=d.data[n]){g=!0;break}return!g?!1:!0}})});ig.baked=!0;
ig.module("plugins.splash-loader").requires("impact.loader","impact.animation","plugins.image-extension","plugins.font-loaded-test").defines(function(){ig.SplashLoader=ig.Loader.extend({splashImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/mainbg.png"),preloadingDone:!1,preloadDoneTime:0,fadeInDuration:0.2,adjustedStatus:0,preloadedStatus:0,fontTestAttempts:0,font:"leaguespartan",titlePos:{x:0,y:0},titleImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/maintitle.png"),
init:function(b,c){this.parent(b,c);this.fontTester=new ig.FontLoadedTest;this.titlePos.x=ig.system.width/2;this.titlePos.y=200;console.log("Checking for AdInGamePreroll ...");"undefined"!=typeof AdInGamePreroll&&AdInGamePreroll.Initialize();console.log("Checking for BrandingSplashScreen ...");"undefined"!=typeof BrandingSplashScreen&&InitializeSplashScreen();console.log("Injecting Loading Game API ...");try{console.log('enabled loading api11');}catch(d){console.log(d.message)}this.fontTestAttempts=0},end:function(){this.parent();
if(ig.ua.mobile){var b=ig.domHandler.getElementById("#play");ig.domHandler.show(b)}b=0<=document.URL.indexOf("localhost")?500:3E3;window.setTimeout("ig.system.setGame(MyGame)",b);this.preloadDoneTime=this.fadeInDuration;this.draw()},setupCustomAnimation:function(){this.customAnim=new ig.Animation(this.customAnim,0.05,[0,1,2,3,4,5]);this.customAnim.currentFrame=0;ig.loadingScreen=this;ig.loadingScreen.animationTimer=window.setInterval("ig.loadingScreen.animate()",100)},animate:function(){this.customAnim.currentFrame<
this.customAnim.sequence.length?this.customAnim.currentFrame++:this.customAnim.currentFrame=0;this.customAnim.gotoFrame(this.customAnim.currentFrame)},update:function(){this.adjustedStatus=this.status-this.preloadedStatus;this._drawStatus+=(this.adjustedStatus-this._drawStatus)/5;1<=this.status&&(this._drawStatus=1);if(this.preloadingDone)this.preloadDoneTime+=1/60;else if(this.splashImage.loaded&&this.titleImage.loaded){if(300>this.fontTestAttempts){this.fontTestAttempts++;var b=this.fontTester.testFont(this.font),
c=this.fontTester.testFont("lobster13");if(!b||!c)return}this.preloadingDone=!0;this.preloadDoneTime=0;this.preloadedStatus=this.status;$("#ajaxbar").css("background","none")}},draw:function(){this.update();ig.system.context.fillStyle="#000";ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);var b=ig.system.context;if(this.splashImage){var c=this.splashImage,d=1,e=0,f=0;c.width*d<ig.system.width&&(d=ig.system.width/c.width);c.height*d<ig.system.height&&(d=ig.system.height/c.height);
c.width*d>ig.system.width&&(e=-(c.width*d-ig.system.width)/2);c.height*d>ig.system.height&&(f=-(c.height*d-ig.system.height)/2);e=Math.round(e);f=Math.round(f);b.save();1!=d&&(b.translate(e,f),b.scale(d,d));this.splashImage.draw(0,0);b.restore()}else b.fillStyle="#777777",b.fillRect(0,0,ig.system.width,ig.system.height);this.titleImage&&(d=this.titlePos.x,c=this.titlePos.y,this.titleImage.draw(d-this.titleImage.width/2,c-this.titleImage.height/2));d=ig.system.width/2-200;c=380;b=_STRINGS.Loading.Loading;
ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));d+=200;c=c+15+2;ig.system.context.font="20px "+this.font+", Arial";ig.system.context.textAlign="center";ig.system.context.textBaseline="middle";ig.system.context.fillStyle="rgba(0,0,0,0.5)";ig.system.context.fillText(b,d+1,c+2);ig.system.context.fillStyle="#fff";ig.system.context.fillText(b,d,c);ig.system.context.restore();b=this.preloadDoneTime/this.fadeInDuration;1>b&&(ig.system.context.globalAlpha=1-b,ig.system.context.fillStyle=
"#000",ig.system.context.fillRect(0,0,ig.system.width,ig.system.height),ig.system.context.globalAlpha=1)}})});ig.baked=!0;
ig.module("plugins.tween").requires("impact.entity").defines(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(b){for(var c=0;c<this.length;++c)if(this[c]===b)return c;return-1});ig.Entity.prototype.tweens=[];ig.Entity.prototype._preTweenUpdate=ig.Entity.prototype.update;ig.Entity.prototype.update=function(){this._preTweenUpdate();if(0<this.tweens.length){for(var b=[],c=0;c<this.tweens.length;c++)this.tweens[c].update(),this.tweens[c].complete||b.push(this.tweens[c]);this.tweens=
b}};ig.Entity.prototype.tween=function(b,c,d){b=new ig.Tween(this,b,c,d);this.tweens.push(b);return b};ig.Entity.prototype.pauseTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].pause()};ig.Entity.prototype.resumeTweens=function(){for(var b=0;b<this.tweens.length;b++)this.tweens[b].resume()};ig.Entity.prototype.stopTweens=function(b){for(var c=0;c<this.tweens.length;c++)this.tweens[c].stop(b)};ig.Tween=function(b,c,d,e){var f={},g={},n={},l=0,m=!1,r=!1,q=!1;this.duration=d;this.paused=
this.complete=!1;this.easing=ig.Tween.Easing.Linear.EaseNone;this.onComplete=!1;this.loop=this.delay=0;this.loopCount=-1;ig.merge(this,e);this.loopNum=this.loopCount;this.chain=function(b){q=b};this.initEnd=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.initEnd(subprop,c[b],d[b])};this.initStart=function(b,c,d,e){if("object"!==typeof d[b])"undefined"!==typeof c[b]&&(e[b]=d[b]);else for(subprop in d[b])e[b]||(e[b]={}),"undefined"!==typeof c[b]&&this.initStart(subprop,
c[b],d[b],e[b])};this.start=function(){this.paused=this.complete=!1;this.loopNum=this.loopCount;l=0;-1==b.tweens.indexOf(this)&&b.tweens.push(this);r=!0;m=new ig.Timer;for(var d in c)this.initEnd(d,c,g);for(d in g)this.initStart(d,g,b,f),this.initDelta(d,n,b,g)};this.initDelta=function(b,c,d,e){if("object"!==typeof e[b])c[b]=e[b]-d[b];else for(subprop in e[b])c[b]||(c[b]={}),this.initDelta(subprop,c[b],d[b],e[b])};this.propUpdate=function(b,c,d,e,f){if("object"!==typeof d[b])c[b]="undefined"!=typeof d[b]?
d[b]+e[b]*f:c[b];else for(subprop in d[b])this.propUpdate(subprop,c[b],d[b],e[b],f)};this.propSet=function(b,c,d){if("object"!==typeof c[b])d[b]=c[b];else for(subprop in c[b])d[b]||(d[b]={}),this.propSet(subprop,c[b],d[b])};this.update=function(){if(!r)return!1;if(this.delay){if(m.delta()<this.delay)return;this.delay=0;m.reset()}if(this.paused||this.complete)return!1;var c=(m.delta()+l)/this.duration,c=1<c?1:c,d=this.easing(c);for(property in n)this.propUpdate(property,b,f,n,d);if(1<=c){if(0==this.loopNum||
!this.loop){this.complete=!0;if(this.onComplete)this.onComplete();q&&q.start();return!1}if(this.loop==ig.Tween.Loop.Revert){for(property in f)this.propSet(property,f,b);l=0;m.reset();-1!=this.loopNum&&this.loopNum--}else if(this.loop==ig.Tween.Loop.Reverse){c={};d={};ig.merge(c,g);ig.merge(d,f);ig.merge(f,c);ig.merge(g,d);for(property in g)this.initDelta(property,n,b,g);l=0;m.reset();-1!=this.loopNum&&this.loopNum--}}};this.pause=function(){this.paused=!0;l+=m.delta()};this.resume=function(){this.paused=
!1;m.reset()};this.stop=function(b){b&&(this.loop=this.complete=this.paused=!1,l+=d,this.update());this.complete=!0}};ig.Tween.Loop={Revert:1,Reverse:2};ig.Tween.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};ig.Tween.Easing.Linear.EaseNone=function(b){return b};ig.Tween.Easing.Quadratic.EaseIn=function(b){return b*b};ig.Tween.Easing.Quadratic.EaseOut=function(b){return-b*(b-2)};ig.Tween.Easing.Quadratic.EaseInOut=
function(b){return 1>(b*=2)?0.5*b*b:-0.5*(--b*(b-2)-1)};ig.Tween.Easing.Cubic.EaseIn=function(b){return b*b*b};ig.Tween.Easing.Cubic.EaseOut=function(b){return--b*b*b+1};ig.Tween.Easing.Cubic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b:0.5*((b-=2)*b*b+2)};ig.Tween.Easing.Quartic.EaseIn=function(b){return b*b*b*b};ig.Tween.Easing.Quartic.EaseOut=function(b){return-(--b*b*b*b-1)};ig.Tween.Easing.Quartic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b:-0.5*((b-=2)*b*b*b-2)};ig.Tween.Easing.Quintic.EaseIn=
function(b){return b*b*b*b*b};ig.Tween.Easing.Quintic.EaseOut=function(b){return(b-=1)*b*b*b*b+1};ig.Tween.Easing.Quintic.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*b*b*b:0.5*((b-=2)*b*b*b*b+2)};ig.Tween.Easing.Sinusoidal.EaseIn=function(b){return-Math.cos(b*Math.PI/2)+1};ig.Tween.Easing.Sinusoidal.EaseOut=function(b){return Math.sin(b*Math.PI/2)};ig.Tween.Easing.Sinusoidal.EaseInOut=function(b){return-0.5*(Math.cos(Math.PI*b)-1)};ig.Tween.Easing.Exponential.EaseIn=function(b){return 0==b?0:Math.pow(2,
10*(b-1))};ig.Tween.Easing.Exponential.EaseOut=function(b){return 1==b?1:-Math.pow(2,-10*b)+1};ig.Tween.Easing.Exponential.EaseInOut=function(b){return 0==b?0:1==b?1:1>(b*=2)?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2)};ig.Tween.Easing.Circular.EaseIn=function(b){return-(Math.sqrt(1-b*b)-1)};ig.Tween.Easing.Circular.EaseOut=function(b){return Math.sqrt(1- --b*b)};ig.Tween.Easing.Circular.EaseInOut=function(b){return 1>(b/=0.5)?-0.5*(Math.sqrt(1-b*b)-1):0.5*(Math.sqrt(1-(b-=2)*b)+1)};ig.Tween.Easing.Elastic.EaseIn=
function(b){var c,d=0.1,e=0.4;if(0==b)return 0;if(1==b)return 1;e||(e=0.3);!d||1>d?(d=1,c=e/4):c=e/(2*Math.PI)*Math.asin(1/d);return-(d*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/e))};ig.Tween.Easing.Elastic.EaseOut=function(b){var c,d=0.1,e=0.4;if(0==b)return 0;if(1==b)return 1;e||(e=0.3);!d||1>d?(d=1,c=e/4):c=e/(2*Math.PI)*Math.asin(1/d);return d*Math.pow(2,-10*b)*Math.sin((b-c)*2*Math.PI/e)+1};ig.Tween.Easing.Elastic.EaseInOut=function(b){var c,d=0.1,e=0.4;if(0==b)return 0;if(1==b)return 1;
e||(e=0.3);!d||1>d?(d=1,c=e/4):c=e/(2*Math.PI)*Math.asin(1/d);return 1>(b*=2)?-0.5*d*Math.pow(2,10*(b-=1))*Math.sin((b-c)*2*Math.PI/e):0.5*d*Math.pow(2,-10*(b-=1))*Math.sin((b-c)*2*Math.PI/e)+1};ig.Tween.Easing.Back.EaseIn=function(b){return b*b*(2.70158*b-1.70158)};ig.Tween.Easing.Back.EaseOut=function(b){return(b-=1)*b*(2.70158*b+1.70158)+1};ig.Tween.Easing.Back.EaseInOut=function(b){return 1>(b*=2)?0.5*b*b*(3.5949095*b-2.5949095):0.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)};ig.Tween.Easing.Bounce.EaseIn=
function(b){return 1-ig.Tween.Easing.Bounce.EaseOut(1-b)};ig.Tween.Easing.Bounce.EaseOut=function(b){return(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};ig.Tween.Easing.Bounce.EaseInOut=function(b){return 0.5>b?0.5*ig.Tween.Easing.Bounce.EaseIn(2*b):0.5*ig.Tween.Easing.Bounce.EaseOut(2*b-1)+0.5}});ig.baked=!0;
ig.module("plugins.url-parameters").defines(function(){ig.UrlParameters=ig.Class.extend({init:function(){switch(getQueryVariable("iphone")){case "true":ig.ua.iPhone=!0,console.log("iPhone mode")}var b=getQueryVariable("webview");if(b)switch(b){case "true":ig.ua.is_uiwebview=!0,console.log("webview mode")}if(b=getQueryVariable("debug"))switch(b){case "true":ig.game.showDebugMenu(),console.log("debug mode")}switch(getQueryVariable("view")){case "stats":ig.game.resetPlayerStats(),ig.game.endGame()}getQueryVariable("ad")}})});
ig.baked=!0;
ig.module("plugins.director").requires("impact.impact").defines(function(){ig.Director=ig.Class.extend({init:function(b,c){this.game=b;this.levels=[];this.currentLevel=0;this.append(c)},loadLevel:function(b){for(var c in ig.sizeHandler.dynamicClickableEntityDivs){var d=ig.domHandler.getElementById("#"+c);ig.domHandler.hide(d)}this.currentLevel=b;this.game.loadLevel(this.levels[b]);return!0},loadLevelWithoutEntities:function(b){this.currentLevel=b;this.game.loadLevelWithoutEntities(this.levels[b]);return!0},
append:function(b){newLevels=[];return"object"===typeof b?(b.constructor===[].constructor?newLevels=b:newLevels[0]=b,this.levels=this.levels.concat(newLevels),!0):!1},nextLevel:function(){return this.currentLevel+1<this.levels.length?this.loadLevel(this.currentLevel+1):!1},previousLevel:function(){return 0<=this.currentLevel-1?this.loadLevel(this.currentLevel-1):!1},jumpTo:function(b){var c=null;for(i=0;i<this.levels.length;i++)this.levels[i]==b&&(c=i);return 0<=c?this.loadLevel(c):!1},firstLevel:function(){return this.loadLevel(0)},
lastLevel:function(){return this.loadLevel(this.levels.length-1)},reloadLevel:function(){return this.loadLevel(this.currentLevel)}})});ig.baked=!0;
ig.module("plugins.impact-storage").requires("impact.game").defines(function(){ig.Storage=ig.Class.extend({staticInstantiate:function(){return!ig.Storage.instance?null:ig.Storage.instance},init:function(){ig.Storage.instance=this},isCapable:function(){return!("undefined"===typeof window.localStorage||null==window.localStorage)},isSet:function(b){return null!==this.get(b)},initUnset:function(b,c){null===this.get(b)&&this.set(b,c)},get:function(b){if(!this.isCapable())return null;try{return JSON.parse(localStorage.getItem(b))}catch(c){return window.localStorage.getItem(b)}},
getInt:function(b){return~~this.get(b)},getFloat:function(b){return parseFloat(this.get(b))},getBool:function(b){return!!this.get(b)},key:function(b){return this.isCapable()?window.localStorage.key(b):null},set:function(b,c){if(!this.isCapable())return null;try{window.localStorage.setItem(b,JSON.stringify(c))}catch(d){console.log(d)}},setHighest:function(b,c){c>this.getFloat(b)&&this.set(b,c)},remove:function(b){if(!this.isCapable())return null;window.localStorage.removeItem(b)},clear:function(){if(!this.isCapable())return null;
window.localStorage.clear()}})});ig.baked=!0;
ig.module("plugins.mjs-network-client").defines(function(){ig.MjsNetworkClient=ig.Class.extend({MESSAGE_TAG:"mjs_msg",PING_TAG:"mjs_ping",PING_REPLY_TAG:"mjs_ping_reply",server_ip:null,socket:null,round_trip_time:0,time_diff:0,last_ping_time:0,latency_average:0,latency_log:[],latency_log_size:10,onServerConnectHandlers:[],onServerDisconnectHandlers:[],onServerMessageHandlers:[],onServerPingHandlers:[],onServerPingReplyHandlers:[],init:function(){this.server_ip=getQueryVariable("server_ip")},getServerTime:function(){return Date.now()-
this.time_diff},connect:function(b,c){var d=!1;this.latency_log=[];this.last_pong_time=this.last_ping_time=this.time_diff=this.round_trip_time=this.latency_average=0;if(this.socket)this.socket.disconnected&&(this.socket.connect(),d=!0);else{if("undefined"==typeof this.server_ip||!this.server_ip)this.server_ip="undefined"==typeof SERVER_IP||!SERVER_IP?"localhost":SERVER_IP;var e="3001",e=document.location.protocol&&"function"==typeof document.location.protocol.includes&&document.location.protocol.includes("https")?
"3001":"3000";this.server_ip+=":"+e;console.log("using port "+e);console.log("connecting to "+this.server_ip);(this.socket=io(this.server_ip))&&(d=!0)}if(d)return this.socket.off(),this.socket.on("connect",function(){console.log("connected");this.onServerConnect();this.socket.off("disconnect");this.socket.on("disconnect",function(){console.log("disconnected");this.onServerDisconnect()}.bind(this));this.socket.off(this.MESSAGE_TAG);this.socket.on(this.MESSAGE_TAG,function(b){this.onServerMessage(b)}.bind(this));
this.socket.off(this.PING_TAG);this.socket.on(this.PING_TAG,function(b){this.onServerPing(b)}.bind(this));this.socket.off(this.PING_REPLY_TAG);this.socket.on(this.PING_REPLY_TAG,function(b){this.onServerPingReply(b)}.bind(this))}.bind(this)),"function"==typeof b&&b(),!0;"function"==typeof c&&c();return!1},disconnect:function(b,c){if(this.socket&&!this.socket.disconnected)return this.socket.once("disconnect",function(){"function"==typeof b&&b()}.bind(this)),this.socket.disconnect(),!0;"function"==
typeof c&&c();return!1},onServerConnect:function(){for(var b=0,c=this.onServerConnectHandlers.length;b<c;b++){var d=this.onServerConnectHandlers[b];"function"===typeof d&&d()}},onServerDisconnect:function(){for(var b=0,c=this.onServerDisconnectHandlers.length;b<c;b++){var d=this.onServerDisconnectHandlers[b];"function"===typeof d&&d()}},onServerMessage:function(b){if(b)for(var c=0,d=this.onServerMessageHandlers.length;c<d;c++){var e=this.onServerMessageHandlers[c];"function"===typeof e&&e(b)}},onServerPing:function(b){b.pongTime=
Date.now();this.socket.emit(this.PING_REPLY_TAG,b);this.last_ping_time=Date.now();for(var c=0,d=this.onServerPingHandlers.length;c<d;c++){var e=this.onServerPingHandlers[c];"function"===typeof e&&e(b)}},onServerPingReply:function(b){if(b&&!isNaN(b.pingTime)&&!(null===b.pingTime||isNaN(b.pongTime)||null===b.pongTime)){this.last_ping_time=Date.now();this.round_trip_time=Date.now()-b.pingTime;this.time_diff=Date.now()-b.pongTime+this.round_trip_time/2;this.recalculateTimeDiff(Math.floor(this.round_trip_time/
2),b.pongTime);for(var c=0,d=this.onServerPingReplyHandlers.length;c<d;c++){var e=this.onServerPingReplyHandlers[c];"function"===typeof e&&e(b)}}},pingServer:function(){if(this.socket){var b={};b.pingTime=Date.now();this.socket.emit(this.PING_TAG,b)}},sendMessage:function(b){this.socket.emit(this.MESSAGE_TAG,b)},recalculateTimeDiff:function(b,c){if(!(null===b||isNaN(b)||null===c||isNaN(c))){this.latency_log.length>=this.latency_log_size&&this.latency_log.shift();this.latency_log.push(b);for(var d=
0,e=0,f=this.latency_log.length;e<f;e++)d+=this.latency_log[e];this.latency_average=Math.round(d/this.latency_log.length);this.time_diff=Date.now()-(c+this.latency_average)}}})});ig.baked=!0;
ig.module("game.classes.network-game").defines(function(){NetworkGame=ig.Class.extend({network_client:null,clientVersion:0.01,clientRequestGameTime:0,gameJoinedServerTime:0,gameJoinedLocalTime:0,initialGameState:null,pingReplyPending:!1,pingTimeout:5E3,roomId:null,playerId:null,userCount:0,playerConfirmedCallback:null,requestGameCallback:null,requestGameFailedCallback:null,requestGameStateCallback:null,gameStateUpdateCallback:null,pingReplyCallback:null,pendingUpdate:null,unhandledUpdateQueue:[],
init:function(b){b&&(this.network_client=b,this.boundOnPingReply=this.onPingReply.bind(this),this.network_client.onServerConnectHandlers.push(this.onServerConnect.bind(this)),this.network_client.onServerDisconnectHandlers.push(this.onServerConnectFailed.bind(this)),this.network_client.onServerMessageHandlers.push(this.onServerMessage.bind(this)))},getServerTime:function(){return!this.network_client||!this.network_client.socket?0:this.network_client.getServerTime()},pingServer:function(b,c){if(!this.network_client||
!this.network_client.socket)return!1;if(this.pingReplyPending)return"function"==typeof c&&c(),this.pingReplyPending=!1;this.pingReplyCallback=b;0>this.network_client.onServerPingReplyHandlers.indexOf(this.boundOnPingReply)&&this.network_client.onServerPingReplyHandlers.push(this.boundOnPingReply);this.network_client.pingServer();return!0},requestGame:function(b,c,d){if(!this.network_client||!this.network_client.socket)return"function"==typeof d&&d(),!1;if(!b||"object"!=typeof b)b={};this.clientRequestGameTime=
Date.now();b.clientVersion=this.clientVersion;this.unhandledUpdateQueue=[];this.playerConfirmedCallback=c;this.requestGameCallback=null;this.requestGameFailedCallback=d;this.network_client.sendMessage({type:shared_game.MessageType.REQUEST_ROOM,data:b});return!0},cancelRequestGame:function(){if(!this.network_client||!this.network_client.socket)return!1;this.network_client.sendMessage({type:shared_game.MessageType.LEAVE_ROOM});return!0},requestGameState:function(b,c,d){if(!this.network_client||!this.network_client.socket)return"function"==
typeof d&&d(),!1;this.requestGameStateCallback=c;this.network_client.sendMessage({type:shared_game.MessageType.REQUEST_GAMESTATE,data:b});return!0},leaveGame:function(b,c){if(!this.network_client||!this.network_client.socket)return"function"==typeof c&&c(),!1;this.network_client.sendMessage({type:shared_game.MessageType.LEAVE_ROOM});this.unhandledUpdateQueue=[];this.playerId=this.roomId=null;this.pingReplyPending=!1;this.gameStateUpdateCallback=null;"function"==typeof b&&b();return!0},addEventToClientUpdate:function(b){null==
this.pendingUpdate&&(this.pendingUpdate=new shared_game.Update);b&&"function"==typeof b.packData&&this.pendingUpdate.eventList.push(b)},sendClientUpdate:function(){if(this.network_client&&this.network_client.socket){if(isNaN(this.roomId)||null===this.roomId||isNaN(this.playerId)||null===this.playerId)return!1;null==this.pendingUpdate&&(this.pendingUpdate=new shared_game.Update);var b=this.pendingUpdate;0<b.eventList.length&&(b=b.packData(),this.network_client.sendMessage({type:shared_game.MessageType.CLIENT_UPDATE,
data:b}),this.pendingUpdate=new shared_game.Update);return!0}},sendChatMessage:function(b){this.network_client&&this.network_client.socket&&b&&this.network_client.sendMessage({type:shared_game.MessageType.CHAT_MESSAGE,data:b})},sendPlayerReady:function(){var b=new shared_game.Event(shared_game.EventType.PLAYER_READY,this.getServerTime());this.addEventToClientUpdate(b);this.sendClientUpdate()},sendPlayerDecision:function(b){var c=new shared_game.Event(shared_game.EventType.PLAYER_DECISION,this.getServerTime());
c.info={};c.info.decision=b;this.addEventToClientUpdate(c);this.sendClientUpdate()},onServerConnect:function(){var b=ig.game.entities[0];b&&b.isHome&&b.showConnecting()},onServerConnectFailed:function(){ig.game.resetApp();var b=ig.game.entities[0];b&&b.isHome&&b.showConnectionFailed()},onServerMessage:function(b){if(b&&shared_game)switch(b.type){case shared_game.MessageType.ERROR:this.onError(b.data);break;case shared_game.MessageType.USER_CONFIRMED:this.onUserConfirmed(b.data);break;case shared_game.MessageType.USER_CONNECTED:this.onUserConnected(b.data);
break;case shared_game.MessageType.USER_DISCONNECTED:this.onUserDisconnected(b.data);break;case shared_game.MessageType.PLAYER_CONFIRMED:this.onPlayerConfirmed(b.data);break;case shared_game.MessageType.REQUEST_ROOM_CONFIRMED:this.onRequestRoomConfirmed(b.data);break;case shared_game.MessageType.REQUEST_ROOM_REJECTED:this.onRequestRoomRejected(b.data);break;case shared_game.MessageType.GAMESTATE:this.onGameStateReply(b.data);break;case shared_game.MessageType.GAMESTATE_UPDATE:this.onGameStateUpdate(b.data);
break;case shared_game.MessageType.ROOM_NOTIFICATION:this.onRoomNotification(b.data);break;case shared_game.MessageType.CHAT_MESSAGE:this.onChatMessage(b.data)}},onUserConfirmed:function(b){this.userCount=b;if((b=ig.game.entities[0])&&b.isHome)b.hideConnecting(),b.hideConnectionFailed()},onUserConnected:function(b){this.userCount=b},onUserDisconnected:function(b){this.userCount=b},onRequestRoomRejected:function(b){console.log("game join rejected");this.playerId=this.roomId=null;"function"==typeof this.requestGameFailedCallback&&
this.requestGameFailedCallback(b);this.requestGameFailedCallback=null},onPlayerConfirmed:function(b){this.roomId=b.roomId;this.playerId=b.playerId;this.gameJoinedServerTime=b.joinedTime;this.gameJoinedLocalTime=Date.now();var c=Math.floor((Date.now()-this.clientRequestGameTime)/2);this.network_client.recalculateTimeDiff(c,b.joinedTime);console.log("game latency: "+this.network_client.latency_average+"ms");console.log("client/server time diff: "+this.network_client.time_diff+"ms");"function"==typeof this.playerConfirmedCallback&&
this.playerConfirmedCallback(b);this.playerConfirmedCallback=null},onRequestRoomConfirmed:function(b){this.roomId=b.roomId;this.playerId=b.playerId;this.initialGameState=b.gameState;this.network_client.recalculateTimeDiff(Math.floor(b.latency/2),b.serverTime);ig.global.initialGameState=b.gameState;var c=ig.game.entities[0];c&&c.gameConfirmed(b);"function"==typeof this.requestGameCallback&&this.requestGameCallback(b);this.requestGameCallback=null},onRequestGameState:function(b){"function"==typeof this.requestGameStateCallback&&
this.requestGameStateCallback(b);this.requestGameStateCallback=null},onRoomNotification:function(b){var c=ig.game.entities[0];c&&"function"==typeof c.gameMeta&&c.gameMeta(b)},onChatMessage:function(b){var c=ig.game.entities[0];c&&"function"==typeof c.gameChat&&c.gameChat(b)},onGameStateReply:function(){},onGameStateUpdate:function(b){var c=!1;"function"==typeof this.gameStateUpdateCallback&&(c=this.gameStateUpdateCallback(b));c||this.unhandledUpdateQueue.push(b)},onError:function(b){switch(b){case shared_game.ErrorType.INVALID_REQUEST:console.log("Server Error: INVALID_REQUEST");
break;case shared_game.ErrorType.VERSION_MISMATCH:console.log("Server Error: VERSION_MISMATCH");break;case shared_game.ErrorType.INVALID_NAME:console.log("Server Error: INVALID_NAME");break;case shared_game.ErrorType.KICKED_DUE_TO_INACTIVITY:console.log("Server Error: KICKED_DUE_TO_INACTIVITY")}ig.game.resetApp()},onPingReply:function(){var b=this.network_client.onServerPingReplyHandlers.indexOf(this.boundOnPingReply);0<=b&&this.network_client.onServerPingReplyHandlers.splice(b,1);this.pingReplyPending=
!1;"function"==typeof this.pingReplyCallback&&this.pingReplyCallback(this.clientLatencyAverage);this.pingReplyCallback=null}})});ig.baked=!0;
ig.module("game.entities.opening-shield").requires("impact.entity").defines(function(){EntityOpeningShield=ig.Entity.extend({size:{x:48,y:48},move:0,mIconAnim:0,shieldAnim:0,titleAnim:0,shieldImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/opening/shield.png"),mIconImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/opening/m_icon.png"),titleImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/opening/title.png"),init:function(b,c,d){this.parent(b,c,d)},ready:function(){if(!ig.wm)if(_SETTINGS.DeveloperBranding.Splash.Enabled){this.initTimer=
new ig.Timer(0.1);try{ig.soundHandler.playSound(ig.soundHandler.SOUNDID.openingSound)}catch(b){console.log(b)}}else ig.game.director.nextLevel(),ig.system.context.globalAlpha=1,this.kill()},update:function(){this.parent();this.updateOriginalShieldOpening()},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawOriginalShieldOpening())},updateOriginalShieldOpening:function(){this.initTimer&&
0<this.initTimer.delta()&&(this.initTimer=null,this.sheildTimer=new ig.Timer(0.05));this.sheildTimer&&0<this.sheildTimer.delta()&&(3>this.shieldAnim?(this.shieldAnim++,this.sheildTimer.reset()):(this.sheildTimer=null,this.moveTimer=new ig.Timer(0.001),this.mIconTimer=new ig.Timer(0.05),this.titleTimer=new ig.Timer(0.15)));this.moveTimer&&0<this.moveTimer.delta()&&(this.move+=0.3,this.moveTimer.reset());this.mIconTimer&&0<this.mIconTimer.delta()&&(12>this.mIconAnim?(this.mIconAnim++,this.moveTimer.reset()):
this.mIconTimer=null);this.titleTimer&&0<this.titleTimer.delta()&&(11>this.titleAnim?(this.titleAnim++,this.titleTimer.reset()):(this.titleTimer=null,this.nextLevelTimer=new ig.Timer(1)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawOriginalShieldOpening:function(){if(this.moveTimer){var b=ig.system.context;b.save();var c=ig.system.width/2,d=ig.system.height/2;b.translate(c,d);b.rotate(this.move*Math.PI/
180);b.beginPath();b.moveTo(0,0);for(var e=0,f=1;48>=f;f+=1)b.lineTo(0+800*Math.cos(2*f*Math.PI/48),0+800*Math.sin(2*f*Math.PI/48)),e++,2==e&&(e=0,b.lineTo(0,0));b.translate(-c,-d);c=b.createRadialGradient(c,d,100,c,d,250);c.addColorStop(0,"rgba(255,255,255,0.1)");c.addColorStop(1,"rgba(0,0,0,0)");b.fillStyle=c;b.fill();b.restore()}this.shieldImage.drawTile(ig.system.width/2-91,0-(768-ig.system.height)/2,this.shieldAnim,182,768);this.moveTimer&&(this.mIconImage.drawTile(ig.system.width/2-96,ig.system.height/
2-70,this.mIconAnim,166,160),this.titleImage.drawTile(ig.system.width/2-204,ig.system.height/2+100,this.titleAnim,409,76));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.opening-kitty").requires("impact.entity").defines(function(){EntityOpeningKitty=ig.Entity.extend({size:{x:48,y:48},kittyAnim:-1,kittyImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/opening/kitty.png"),kittyTitleImage:new ig.Image("../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/opening/kittytitle.png"),soundKey:"kittyopeningSound",init:function(b,c,d){this.parent(b,c,d)},ready:function(){if(!ig.wm)if(_SETTINGS.DeveloperBranding.Splash.Enabled){this.initTimer=new ig.Timer(0.1);
try{ig.soundHandler.sfxPlayer.play(this.soundKey)}catch(b){console.log(b)}}else ig.game.director.nextLevel(),ig.system.context.globalAlpha=1,this.kill()},update:function(){this.parent();this.updateKittyOpening()},draw:function(){this.parent();ig.global.wm||(this.nextLevelTimer&&0>this.nextLevelTimer.delta()&&(ig.system.context.globalAlpha=-this.nextLevelTimer.delta()),this.drawKittyOpening())},updateKittyOpening:function(){this.initTimer&&0<this.initTimer.delta()&&(this.initTimer=null,this.kittyTimer=
new ig.Timer(0.15));this.kittyTimer&&0<this.kittyTimer.delta()&&(7>this.kittyAnim?(this.kittyAnim++,this.kittyTimer.reset()):(this.kittyTimer=null,this.nextLevelTimer=new ig.Timer(2)));this.nextLevelTimer&&0<this.nextLevelTimer.delta()&&(this.nextLevelTimer=null,ig.game.director.nextLevel(),ig.system.context.globalAlpha=1)},drawKittyOpening:function(){var b=ig.system.context.createLinearGradient(0,0,0,ig.system.height);b.addColorStop(0,"#ffed94");b.addColorStop(1,"#ffcd85");ig.system.context.fillStyle=
b;ig.system.context.fillRect(0,0,ig.system.width,ig.system.height);0<=this.kittyAnim&&(this.kittyImage.drawTile(ig.system.width/2-this.kittyImage.width/8,ig.system.height/2-this.kittyImage.height/4,this.kittyAnim,218,325),this.kittyTitleImage.drawTile(ig.system.width/2-this.kittyTitleImage.width/2,ig.system.height/2+this.kittyImage.height/4+10,this.kittyAnim,380,37));ig.system.context.globalAlpha=1}})});ig.baked=!0;
ig.module("game.entities.pointer").requires("impact.entity").defines(function(){EntityPointer=ig.Entity.extend({checkAgainst:ig.Entity.TYPE.BOTH,isFirstPressed:!1,isPressed:!1,isReleased:!1,isHovering:!1,hoveringItem:null,objectArray:[],clickedObjectList:[],ignorePause:!0,zIndex:5E3,check:function(b){this.objectArray.push(b)},clickObject:function(b){this.isFirstPressed&&"function"==typeof b.clicked&&(b.clicked(),this.addToClickedObjectList(b));this.isPressed&&!this.isReleased&&"function"==typeof b.clicking&&
b.clicking();this.isReleased&&"function"==typeof b.released&&(b.released(),this.removeFromClickedObjectList(b))},refreshPos:function(){this.pos=ig.game.io.getClickPos()},update:function(){this.parent();this.refreshPos();var b=null,c=-1;for(a=this.objectArray.length-1;-1<a;a--)this.objectArray[a].zIndex>c&&(c=this.objectArray[a].zIndex,b=this.objectArray[a]);if(null!=b)null!=this.hoveringItem?this.hoveringItem!=b&&("function"==typeof this.hoveringItem.leave&&this.hoveringItem.leave(),"function"==typeof b.over&&
b.over()):"function"==typeof b.over&&b.over(),this.hoveringItem=b,this.clickObject(b),this.objectArray=[];else if(null!=this.hoveringItem&&"function"==typeof this.hoveringItem.leave&&(this.hoveringItem.leave(),this.hoveringItem=null),this.isReleased){for(b=0;b<this.clickedObjectList.length;b++)c=this.clickedObjectList[b],"function"==typeof c.releasedOutside&&c.releasedOutside();this.clickedObjectList=[]}this.isFirstPressed=ig.input.pressed("click");this.isReleased=ig.input.released("click");this.isPressed=
ig.input.state("click")},addToClickedObjectList:function(b){this.clickedObjectList.push(b)},removeFromClickedObjectList:function(b){for(var c=[],d=0;d<this.clickedObjectList.length;d++){var e=this.clickedObjectList[d];e!=b&&c.push(e)}this.clickedObjectList=c}})});ig.baked=!0;
ig.module("game.entities.pointer-selector").requires("game.entities.pointer").defines(function(){EntityPointerSelector=EntityPointer.extend({zIndex:1E3,_wmDrawBox:!0,_wmBoxColor:"rgba(0, 0, 255, 0.7)",size:{x:20,y:20},init:function(b,c,d){this.parent(b,c,d)}})});ig.baked=!0;
ig.module("game.entities.select").requires("impact.entity").defines(function(){EntitySelect=ig.Entity.extend({type:ig.Entity.TYPE.B,checkAgainst:ig.Entity.TYPE.A,collides:ig.Entity.COLLIDES.NEVER,canSelect:!1,canSelectTimerDuration:0.35,zIndex:99999,isHovering:!1,isSelected:!1,init:function(b,c,d){this.parent(b,c,d);this.canSelectTimer=new ig.Timer(this.canSelectTimerDuration)},doesClickableLayerExist:function(b){for(k in dynamicClickableEntityDivs)if(k==b)return!0;return!1},checkClickableLayer:function(b,
c,d){"undefined"==typeof wm&&(this.doesClickableLayerExist(b)?(ig.game.showOverlay([b]),$("#"+b).find("[href]").attr("href",c)):this.createClickableOutboundLayer(b,c,"../cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/misc/invisible.html",d))},createClickableOutboundLayer:function(b,c,d,e){var f=ig.$new("div");f.id=b;document.body.appendChild(f);$("#"+f.id).css("float","left");$("#"+f.id).css("width",this.size.x*multiplier);$("#"+f.id).css("height",this.size.y*multiplier);$("#"+f.id).css("position","absolute");
var g=w/2-destW/2,n=h/2-destH/2;w==mobileWidth?($("#"+f.id).css("left",this.pos.x),$("#"+f.id).css("top",this.pos.y)):($("#"+f.id).css("left",g+this.pos.x*multiplier),$("#"+f.id).css("top",n+this.pos.y*multiplier));e?$("#"+f.id).html("<a target='_blank' href='"+c+"'><img style='width:100%;height:100%' src='"+d+"'></a>"):$("#"+f.id).html("<a href='"+c+"'><img style='width:100%;height:100%' src='"+d+"'></a>");dynamicClickableEntityDivs[b]={};dynamicClickableEntityDivs[b].width=$("#"+f.id).width();dynamicClickableEntityDivs[b].height=
$("#"+f.id).height();dynamicClickableEntityDivs[b].entity_pos_x=this.pos.x;dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y},hovered:function(){this.isHovering=!0;this.dehoverOthers()},dehoverOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isHovering=!1)},deselectOthers:function(){var b=ig.game.getEntitiesByType(EntitySelect);for(i=0;i<b.length;i++)b[i]!=this&&(b[i].isSelected=!1)},update:function(){this.parent();this.canSelectTimer&&0<
this.canSelectTimer.delta()&&(this.canSelect=!0,this.canSelectTimer=null)}})});ig.baked=!0;ig.module("game.levels.opening").requires("impact.image","game.entities.opening-kitty").defines(function(){LevelOpening={entities:[{type:"EntityOpeningKitty",x:520,y:212}],layer:[]}});ig.baked=!0;
ig.module("plugins.fade-transition").defines(function(){ig.FadeTransition=ig.Class.extend({targetOverlayAlpha:1,overlayAlpha:1,transitionDuration:0.2,transitionTime:0,transitionFadein:!1,transitionFadeout:!1,transitionEndFunction:null,init:function(){},draw:function(){this.drawTransition()},update:function(){if(this.transitionFadein){var b=ig.system.clock.delta()-this.transitionTime,b=0==this.transitionDuration?1:b/this.transitionDuration;1<b&&(b=1);this.overlayAlpha=this.targetOverlayAlpha*(1-b);
1<=b&&(this.transitionFadein=!1,this.transitionEndFunction&&this.transitionEndFunction())}else this.transitionFadeout&&(b=ig.system.clock.delta()-this.transitionTime,b=0==this.transitionDuration?1:b/this.transitionDuration,1<b&&(b=1),this.overlayAlpha=this.targetOverlayAlpha*b,1<=b&&(this.transitionFadeout=!1,this.transitionEndFunction&&this.transitionEndFunction()))},drawTransition:function(){if(this.transitionFadein||this.transitionFadeout)this.overlayAlpha>this.targetOverlayAlpha&&(this.overlayAlpha=
this.targetOverlayAlpha),ig.system.context.globalAlpha=this.overlayAlpha,ig.system.context.fillStyle="#000000",ig.system.context.fillRect(0,0,ig.system.width,ig.system.height),ig.system.context.globalAlpha=1},startFadeinTransition:function(){this.transitionFadein||(this.transitionFadein=!0,this.transitionTime=ig.system.clock.delta(),this.overlayAlpha=1)},startFadeoutTransition:function(){this.transitionFadeout||(this.transitionFadeout=!0,this.transitionTime=ig.system.clock.delta(),this.overlayAlpha=
0)}})});ig.baked=!0;
ig.module("plugins.sat").defines(function(){ig.SAT=ig.Class.extend({init:function(){},mtvForShapeIntersect:function(b,c){var d=1E4,e=null,f=[],g=[];if(b.isCircle()&&c.isCircle())f.push(c.center.subtract(b.center).normalized());else if(b.isCircle()){for(var n=c.pointList[0],l=b.center.manhattanDistance(n),m=1,r=c.pointList.length;m<r;m++){var q=c.pointList[m],s=b.center.manhattanDistance(q);s<l&&(l=s,n=q)}f.push(n.subtract(b.center).normalized());g=c.getNormalizedAxes()}else if(c.isCircle()){n=b.pointList[0];
l=c.center.manhattanDistance(n);m=1;for(r=b.pointList.length;m<r;m++)q=b.pointList[m],s=c.center.manhattanDistance(q),s<l&&(l=s,n=q);f=b.getNormalizedAxes();g.push(c.center.subtract(n).normalized())}else f=b.getNormalizedAxes(),g=c.getNormalizedAxes();m=0;for(r=f.length;m<r;m++)if(n=f[m],l=b.project(n),q=c.project(n),l.overlap(q)){s=l.getOverlap(q);if(l.contains(q)||q.contains(l))var u=Math.abs(l.min-q.min),t=Math.abs(l.max-q.max),s=u>t?s+u:s+t;s<d&&(d=s,e=n,l.max<q.max&&(e.x=-e.x,e.y=-e.y))}else return null;
m=0;for(r=g.length;m<r;m++)if(n=g[m],l=b.project(n),q=c.project(n),l.overlap(q)){s=l.getOverlap(q);if(l.contains(q)||q.contains(l))u=Math.abs(l.min-q.min),t=Math.abs(l.max-q.max),s=u>t?s+u:s+t;s<d&&(d=s,e=n,l.max<q.max&&(e.x=-e.x,e.y=-e.y))}else return null;return!e?null:new SAT.MTV(e,d)},overshootForShape1ContainsShape2:function(b,c){var d=[],e=[],f=[];if(b.isCircle()&&c.isCircle())e.push(c.center.subtract(b.center).normalized());else if(b.isCircle()){for(var g=c.pointList[0],n=b.center.manhattanDistance(g),
l=1,m=c.pointList.length;l<m;l++){var r=c.pointList[l],q=b.center.manhattanDistance(r);q<n&&(n=q,g=r)}e.push(g.subtract(b.center).normalized());f=b.getNormalizedAxes()}else if(c.isCircle()){g=b.pointList[0];n=c.center.manhattanDistance(g);l=1;for(m=b.pointList.length;l<m;l++)r=b.pointList[l],q=c.center.manhattanDistance(r),q<n&&(n=q,g=r);e=b.getNormalizedAxes();f.push(c.center.subtract(g).normalized())}else e=b.getNormalizedAxes(),f=c.getNormalizedAxes();l=0;for(m=e.length;l<m;l++)if(g=e[l],n=b.project(g),
r=c.project(g),!n.contains(r)){var q=r.max-n.max,s={};s.x=g.x;s.y=g.y;s.l=q;0>q&&(s.x=-s.x,s.y=-s.y,s.l=n.min-r.min);d.push(s)}if(0==d.length){l=0;for(m=f.length;l<m;l++)g=f[l],n=b.project(g),r=c.project(g),n.contains(r)||(q=r.max-n.max,s={},s.x=g.x,s.y=g.y,s.l=q,0>q&&(s.x=-s.x,s.y=-s.y,s.l=n.min-r.min),d.push(s))}if(0<d.length){e={x:0,y:0};l=0;for(m=d.length;l<m;l++)f=d[l],e.x+=f.x*f.l,e.y+=f.y*f.l;return e}return null},simpleShapeIntersect:function(b,c){var d=[],e=[];if(b.isCircle()&&c.isCircle())d.push(c.center.subtract(b.center).normalized());
else if(c.isCircle()||b.isCircle()){if(b.isCircle()){var f=c;c=b;b=f}for(var d=b.pointList[0],g=c.center.manhattanDistance(d),f=1,n=b.pointList.length;f<n;f++){var l=b.pointList[f],m=c.center.manhattanDistance(l);m<g&&(g=m,d=l)}e.push(c.center.subtract(d).normalized());d=b.getNormalizedAxes()}else d=b.getNormalizedAxes(),e=c.getNormalizedAxes();f=0;for(n=d.length;f<n;f++)if(l=d[f],g=b.project(l),l=c.project(l),!g.overlap(l))return!1;f=0;for(n=e.length;f<n;f++)if(l=e[f],g=b.project(l),l=c.project(l),
!l.overlap(g))return!1;return!0},simpleShape1ContainsShape2:function(b,c){var d=[],e=[];if(b.isCircle()&&c.isCircle())d.push(c.center.subtract(b.center).normalized());else if(b.isCircle()){for(var f=c.pointList[0],g=b.center.manhattanDistance(f),n=1,l=c.pointList.length;n<l;n++){var m=c.pointList[n],r=b.center.manhattanDistance(m);r<g&&(g=r,f=m)}d.push(f.subtract(b.center).normalized());e=b.getNormalizedAxes()}else if(c.isCircle()){f=b.pointList[0];g=c.center.manhattanDistance(f);n=1;for(l=b.pointList.length;n<
l;n++)m=b.pointList[n],r=c.center.manhattanDistance(m),r<g&&(g=r,f=m);d=b.getNormalizedAxes();e.push(c.center.subtract(f).normalized())}else d=b.getNormalizedAxes(),e=c.getNormalizedAxes();n=0;for(l=d.length;n<l;n++)if(g=d[n],f=b.project(g),g=c.project(g),!f.contains(g))return!1;n=0;for(l=e.length;n<l;n++)if(g=e[n],f=b.project(g),g=c.project(g),!f.contains(g))return!1;return!0}});ig.SAT.Vector2D=ig.Class.extend({x:0,y:0,init:function(b,c){this.x=b;this.y=c},subtract:function(b){return new ig.SAT.Vector2D(this.x-
b.x,this.y-b.y)},getNormal:function(){return new ig.SAT.Vector2D(-this.y,this.x)},getNormalizedNormal:function(){return(new ig.SAT.Vector2D(-this.y,this.x)).normalized()},normalized:function(){var b=Math.sqrt(this.x*this.x+this.y*this.y);return 0==b?new ig.SAT.Vector2D(0,0):new ig.SAT.Vector2D(this.x/b,this.y/b)},distance:function(b){var c=b.x-this.x;b=b.y-this.y;return Math.sqrt(c*c+b*b)},manhattanDistance:function(b){var c=b.x-this.x;b=b.y-this.y;return c*c+b*b},dotProduct:function(b){return this.x*
b.x+this.y*b.y},crossProduct:function(b){return this.x*b.y-this.y*b.x},getAngle:function(b){return Math.atan2(this.crossProduct(b),this.dotProduct(b))}});ig.SAT.Shape=ig.Class.extend({pointList:[],center:null,init:function(b){this.pointList=[];for(var c=0,d=b.length;c<d;c++){var e=b[c];this.pointList.push(new ig.SAT.Vector2D(e.x,e.y))}},isCircle:function(){return!1},getAxes:function(){var b=[];if(1>=this.pointList.length)return b;if(2==this.pointList.length){var c=this.pointList[0],d=this.pointList[1],
c=c.subtract(d),c=c.getNormal();(0!=c.x||0!=c.y)&&b.push(c);return b}for(var e=0,f=this.pointList.length;e<f;e++){for(var c=this.pointList[e],d=this.pointList[e+1==this.pointList.length?0:e+1],c=c.subtract(d),c=c.getNormal(),d=!1,g=0,n=b.length;g<n;g++)if(b[g].x==c.x&&b[g].y==c.y||b[g].x==-c.x&&b[g].y==-c.y){d=!0;break}d||b.push(c)}return b},getNormalizedAxes:function(){for(var b=[],c=0,d=this.pointList.length;c<d;c++){for(var e=this.pointList[c].subtract(this.pointList[c+1==this.pointList.length?
0:c+1]).getNormalizedNormal(),f=!1,g=0,n=b.length;g<n;g++)if(b[g].x==e.x&&b[g].y==e.y||b[g].x==-e.x&&b[g].y==-e.y){f=!0;break}f||b.push(e)}return b},project:function(b){return new ig.SAT.Projection(this.pointList,b)}});ig.SAT.Circle=ig.SAT.Shape.extend({center:null,radius:0,init:function(b,c){this.center=new ig.SAT.Vector2D(b.x,b.y);this.radius=c},isCircle:function(){return!0},getAxes:function(){return[]},getNormalizedAxes:function(){return[]},project:function(b){var c=new ig.SAT.Projection([],b);
b=this.center.dotProduct(b);c.min=b-this.radius;c.max=b+this.radius;return c}});ig.SAT.Projection=ig.Class.extend({min:null,max:null,init:function(b,c){if(!b||0>=b.length)return this;this.min=b[0].dotProduct(c);this.max=b[0].dotProduct(c);for(var d=0,e=b.length;d<e;d++){var f=b[j].dotProduct(c);this.min>f&&(this.min=f);f>this.max&&(this.max=f)}},overlap:function(b){return!(this.max<b.min||b.max<this.min)},getOverlap:function(b){var c=this.max-b.min;b=b.max-this.min;b<c&&(c=b);return c},contains:function(b){var c=
self;return b.max-b.min<=c.max-c.min&&b.max<=c.max&&b.min>=c.min?!0:!1}});ig.SAT.MTV=ig.Class.extend({axis:null,overlapAmount:0,init:function(b,c){this.axis=b;this.overlapAmount=c}})});ig.baked=!0;
ig.module("plugins.button").requires("plugins.sat").defines(function(){ig.Button=ig.Class.extend({buttonType:0,animSheet:null,upImage:null,downImage:null,hoverImage:null,upAnim:null,downAnim:null,hoverAnim:null,pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},points:[],offset:{x:0,y:0},scale:{x:1,y:1},skew:{x:0,y:0},angle:0,alpha:1,down:!1,over:!1,posRelativeTo:null,image:null,imageOffset:{x:0,y:0},fillStyle:null,strokeStyle:null,strokeWidth:0,roundedRadius:5,edgeRadius:5,downFillStyle:null,downStrokeStyle:null,
overFillStyle:null,overStrokeStyle:null,text:null,textList:null,textCanvas:null,textShadowCanvas:null,textFont:null,textFontSize:24,textLineHeight:24,textHeightAdjustment:0,textOffset:{x:0,y:0},textScale:{x:1,y:1},textSkew:{x:0,y:0},textAngle:0,textAlpha:1,textColor:{r:255,g:255,b:255},btnShadowImage:null,btnShadowOffset:{x:0,y:2},btnShadowColor:"rgba(0,0,0,0.5)",textShadowOffset:{x:0,y:2},textShadowColor:"rgba(0,0,0,0.5)",btnShadowDisabled:!0,textShadowDisabled:!0,textWrap:!0,textOnlyOnHover:!1,
disabled:!1,hidden:!1,antialiasingEnabled:!1,clickStateName:"click",keyStateName:"",overOffset:{x:0,y:0},downOffset:{x:0,y:1},scaleMultiplier:1,overScaleMultiplier:1.01,downScaleMultiplier:0.99,detectionRect:{x:0,y:0,w:0,h:0},detectionPoints:[],parentEntity:null,init:function(b){this.textFont="Impact, Charcoal, sans-serif";this.textLineHeight=this.textFontSize=24;this.parentEntity=b;this.sat=new ig.SAT},setPos:function(b,c){b&&(this.pos.x=b.x,this.pos.y=b.y,this.setPosRelativeTo(c))},setPosRelativeTo:function(b,
c){if(b&&b.pos&&!(null==b.pos.x||null==b.pos.y))this.posRelativeTo=b,this.setPos(c)},setRect:function(b){b&&(this.rect.x=b.x,this.rect.y=b.y,this.rect.w=0<=b.w?b.w:1,this.rect.h=0<=b.h?b.h:1,this.detectionRect.x=this.rect.x,this.detectionRect.y=this.rect.y,this.detectionRect.w=this.rect.w,this.detectionRect.h=this.rect.h)},setPoints:function(b){if(b){for(var c=0,d=b.length;c<d;c++){var e=b[c];this.points.push({x:e.x,y:e.y})}this.recalculateDetectionPoints()}},setAngle:function(b){this.angle=b;this.recalculateDetectionRect();
this.recalculateDetectionPoints()},setScale:function(b,c){b&&c&&(this.scale.x=b,this.scale.y=c,this.recalculateDetectionRect(),this.recalculateDetectionPoints())},setFont:function(b,c){this.textFont=c;this.textLineHeight=this.textFontSize=b;this.textHeightAdjustment=this.textList?this.rect.y/2-this.textList.length/2*this.textLineHeight:this.rect.y/2;this.createTextCanvas()},setTextColor:function(b){b&&(this.textColor={},this.textColor.r=b.r,this.textColor.g=b.g,this.textColor.b=b.b,this.createTextCanvas())},
setText:function(b){isNaN(b)||(b=""+b);this.text=b;this.textWrap&&1<=this.rect.w?(this.textList=this.wrapText(b,this.rect.w),this.textHeightAdjustment=-this.textList.length/2*this.textLineHeight):(this.textList=null,this.textHeightAdjustment=0);this.createTextCanvas()},createTextCanvas:function(){this.textShadowCanvas=this.textCanvas=null;var b=this.rect.w,c=this.rect.h;this.textWrap&&this.textList&&0<this.textList.length&&1<=this.rect.w?(b=this.rect.w,c=this.textList.length*this.textLineHeight):
(c=this.getTextSize(this.text,this.textFont,this.textFontSize),b=c.x,c=c.y);this.textCanvas=ig.$new("canvas");this.textCanvas.width=b;this.textCanvas.height=c;var d=this.textCanvas.getContext("2d");d.font=this.textFontSize+"px "+this.textFont;d.textAlign="center";d.textBaseline="middle";var e=b/2,f=c/2;d.fillStyle=this.getTextColorStr();if(this.textList)for(var f=this.textLineHeight/2,g=0,n=0,l=this.textList.length;n<l;n++)d.fillText(this.textList[n],e,f+g),g+=this.textLineHeight;else d.fillText(this.text,
e,f);if(!this.textShadowDisabled)if(this.textShadowCanvas=ig.$new("canvas"),this.textShadowCanvas.width=b,this.textShadowCanvas.height=c,d=this.textShadowCanvas.getContext("2d"),d.font=this.textFontSize+"px "+this.textFont,d.textAlign="center",d.textBaseline="middle",e=b/2,f=c/2,d.fillStyle=this.textShadowColor,this.textList){f=this.textLineHeight/2;n=g=0;for(l=this.textList.length;n<l;n++)d.fillText(this.textList[n],e,f+g),g+=this.textLineHeight}else d.fillText(this.text,e,f)},setTextOffset:function(b){b&&
(this.textOffset.x=b.x,this.textOffset.y=b.y)},setImage:function(b,c){this.image=b;this.setImageOffset(c)},setImageOffset:function(b){b&&(this.imageOffset.x=b.x,this.imageOffset.y=b.y)},setUpImage:function(b){if(this.upImage=b)this.buttonType=ig.BUTTONTYPE.IMAGE},setOverImage:function(b){if(this.overImage=b)this.buttonType=ig.BUTTONTYPE.IMAGE},setDownImage:function(b){if(this.downImage=b)this.buttonType=ig.BUTTONTYPE.IMAGE},setAnimSheet:function(b){if(this.animSheet=b){b=this.animSheet.image.width/
this.animSheet.width;var c=this.animSheet.image.height/this.animSheet.height;b=Math.floor(b);c=Math.floor(c);3==b*c?(this.upAnim=new ig.Animation(this.animSheet,1,[0]),this.overAnim=new ig.Animation(this.animSheet,1,[1]),this.downAnim=new ig.Animation(this.animSheet,1,[2]),this.buttonType=ig.BUTTONTYPE.ANIMSHEET):2==b*c?(this.upAnim=new ig.Animation(this.animSheet,1,[0]),this.overAnim=null,this.downAnim=new ig.Animation(this.animSheet,1,[1]),this.buttonType=ig.BUTTONTYPE.ANIMSHEET):1==b*c&&this.setUpImage(this.animSheet.image)}},
draw:function(){if(!this.hidden){this.btnShadowDisabled||this.drawBtnShadow();var b=ig.system.context,c=this.pos.x+this.offset.x,d=this.pos.y+this.offset.y;this.down?(c+=this.downOffset.x,d+=this.downOffset.y):this.over&&(c+=this.overOffset.x,d+=this.overOffset.y);this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x*this.scaleMultiplier,this.skew.x,
this.skew.y,this.scale.y*this.scaleMultiplier,c,d);b.rotate(this.angle);if(this.buttonType==ig.BUTTONTYPE.ROUNDED_RECT||this.buttonType==ig.BUTTONTYPE.SQUARE_RECT||this.buttonType==ig.BUTTONTYPE.OCTOGON||this.buttonType==ig.BUTTONTYPE.PILL||this.buttonType==ig.BUTTONTYPE.CIRCLE){var e=this.strokeStyle,c=this.fillStyle;this.down?(this.downStrokeStyle&&(e=this.downStrokeStyle),this.downFillStyle&&(c=this.downFillStyle)):this.over&&(this.overStrokeStyle&&(e=this.overStrokeStyle),this.overFillStyle&&
(c=this.overFillStyle));b.strokeStyle=e;b.fillStyle=c;var f=d=!1;e&&0<this.strokeWidth&&(f=!0,b.lineWidth=this.strokeWidth);c&&(d=!0);this.buttonType==ig.BUTTONTYPE.SQUARE_RECT?(d&&b.fillRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h),f&&b.strokeRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h)):this.buttonType==ig.BUTTONTYPE.ROUNDED_RECT?this.roundRect(b,this.rect.x,this.rect.y,this.rect.w,this.rect.h,this.roundedRadius,d,f):this.buttonType==ig.BUTTONTYPE.OCTOGON?this.octogon(b,this.rect.x,
this.rect.y,this.rect.w,this.rect.h,this.edgeRadius,d,f):this.buttonType==ig.BUTTONTYPE.PILL?this.pill(b,this.rect.x,this.rect.y,this.rect.w,this.rect.h,d,f):this.buttonType==ig.BUTTONTYPE.CIRCLE&&this.circle(b,this.rect.x,this.rect.y,this.rect.w,this.rect.h,d,f)}else this.buttonType==ig.BUTTONTYPE.IMAGE&&null!=this.upImage?(e=this.upImage,this.down&&this.downImage?e=this.downImage:this.over&&this.overImage&&(e=this.overImage),c=-e.width/2,d=-e.height/2,this.antialiasingEnabled||(c=this.bitwiseRound(c),
d=this.bitwiseRound(d)),e.draw(c,d)):this.buttonType==ig.BUTTONTYPE.ANIMSHEET&&null!=this.upAnim&&(e=this.upAnim,this.down&&this.downAnim?e=this.downAnim:this.over&&this.overAnim&&(e=this.overAnim),c=-this.animSheet.width/2,d=-this.animSheet.height/2,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),e.draw(c,d));this.image?(c=this.imageOffset.x-this.image.width/2,d=this.imageOffset.y-this.image.height/2,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),
this.image.draw(c,d)):this.anim&&(c=this.imageOffset.x-this.anim.sheet.width/2,d=this.imageOffset.y-this.anim.sheet.height/2,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),this.anim.draw(c,d));e=!1;this.textOnlyOnHover&&(!this.over&&!this.down)&&(e=!0);if(!e&&this.textShadowDisabled&&this.text&&""!=this.text)if(this.textCanvas)c=this.textOffset.x,d=this.textOffset.y,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,
this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),c=this.textCanvas.width,d=this.textCanvas.height,b.drawImage(this.textCanvas,0,0,c,d,-c/2,-d/2,c,d);else if(b.font=this.textFontSize+"px "+this.textFont,b.textAlign="center",b.textBaseline="middle",c=this.textOffset.x,d=this.textOffset.y,d+=this.textHeightAdjustment,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),
this.textList){d=c=0;for(f=this.textList.length;d<f;d++)b.fillStyle=this.getTextColorStr(),b.fillText(this.textList[d],0,c),c+=this.textLineHeight}else b.fillStyle=this.getTextColorStr(),b.fillText(this.text,0,0);b.restore();!e&&!this.textShadowDisabled&&this.drawTextShadow()}},drawDebug:function(){var b=ig.system.context;b.lineWidth=2;b.strokeStyle="rgb(255,0,0)";var c=this.pos.x+this.offset.x,d=this.pos.y+this.offset.y;this.down?(c+=this.downOffset.x,d+=this.downOffset.y):this.over&&(c+=this.overOffset.x,
d+=this.overOffset.y);this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.strokeRect(c+this.detectionRect.x,d+this.detectionRect.y,this.detectionRect.w,this.detectionRect.h);if(!(0>=this.detectionPoints.length)){b.save();b.lineWidth=2;b.strokeStyle="rgb(255,0,0)";b.beginPath();c=this.pos.x+this.offset.x;d=this.pos.y+this.offset.y;this.down?(c+=this.downOffset.x,d+=this.downOffset.y):this.over&&(c+=
this.overOffset.x,d+=this.overOffset.y);this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.moveTo(c+this.detectionPoints[0].x,d+this.detectionPoints[0].y);for(var e=0,f=this.detectionPoints.length;e<f;e++){var g=this.detectionPoints[e];b.lineTo(c+g.x,d+g.y)}b.closePath();b.stroke();b.restore()}},update:function(){if(!this.disabled)if(this.pointerInputOverlap()||this.keyInputReleased()){if(this.scaleMultiplier=
1,ig.ua.mobile||(!this.over&&!this.down&&"function"===typeof this.enterFunction&&this.enterFunction(this),this.over=!0,this.scaleMultiplier=this.overScaleMultiplier,"function"===typeof this.overFunction&&this.overFunction(this)),this.clickInputDetected()&&(this.down=!0,this.over=!1,this.scaleMultiplier=this.downScaleMultiplier,"function"===typeof this.downFunction&&this.downFunction(this)),this.clickInputReleased()||this.keyInputReleased())this.over=this.down=!1,this.scaleMultiplier=1,ig.ua.mobile||
(this.over=!0,this.scaleMultiplier=this.overScaleMultiplier),"function"===typeof this.clickedFunction&&this.clickedFunction(this)}else this.over&&"function"===typeof this.leaveFunction&&this.leaveFunction(this),this.over=this.down=!1,this.scaleMultiplier=1},pointerInputOverlap:function(){var b=ig.game.inputPos;null==b&&(b=this.getInputPos());if(this.sat&&0<this.detectionPoints.length){var c=[],d=this.pos.x+this.offset.x,e=this.pos.y+this.offset.y;this.down?(d+=this.downOffset.x,e+=this.downOffset.y):
this.over&&(d+=this.overOffset.x,e+=this.overOffset.y);this.posRelativeTo&&(d+=this.posRelativeTo.pos.x,e+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(d=this.bitwiseRound(d),e=this.bitwiseRound(e));for(var f=0,g=this.detectionPoints.length;f<g;f++){var n=this.detectionPoints[f];c.push({x:d+n.x,y:e+n.y})}b=new ig.SAT.Shape([b]);c=new ig.SAT.Shape(c);result=this.sat.mtvForShapeIntersect(b,c);return null==result?!1:!0}c={};c.x=b.x;c.y=b.y;c.w=1;c.h=1;b={};b.x=this.pos.x+this.detectionRect.x;
b.y=this.pos.y+this.detectionRect.y;b.w=this.detectionRect.w;b.h=this.detectionRect.h;this.posRelativeTo&&(b.x+=this.posRelativeTo.pos.x,b.y+=this.posRelativeTo.pos.y);return this.aabbCheck(c,b)?!0:!1},keyInputReleased:function(){return ig.input.released(this.keyStateName)?!0:!1},clickInputDetected:function(){return ig.input.state(this.clickStateName)?!0:!1},clickInputReleased:function(){return ig.input.released(this.clickStateName)?!0:!1},show:function(){this.hidden&&(this.hidden=!1)},hide:function(){this.hidden||
(this.hidden=!0)},enable:function(){this.disabled&&(this.disabled=!1)},disable:function(){this.disabled||(this.disabled=!0)},recalculateDetectionRect:function(){var b=this.rect.w/2-Math.abs(Math.cos(this.angle)*(this.rect.w/2)),c=Math.abs(Math.sin(this.angle)*(this.rect.w/2))-Math.abs(Math.sin(this.angle)*(this.rect.h/2)),b=Math.abs(b),c=Math.abs(c);b>this.rect.w/2-this.rect.h/2&&(b=this.rect.w/2-this.rect.h/2);this.detectionRect.x=this.rect.x+b;this.detectionRect.y=this.rect.y-c;this.detectionRect.w=
this.rect.w-2*b;this.detectionRect.h=this.rect.h+2*c;this.detectionRect.x=this.detectionRect.x+this.detectionRect.w/2-this.detectionRect.w/2*this.scale.x;this.detectionRect.y=this.detectionRect.y+this.detectionRect.h/2-this.detectionRect.h/2*this.scale.y;this.detectionRect.w*=this.scale.x;this.detectionRect.h*=this.scale.y;0>this.detectionRect.w&&(this.detectionRect.x+=this.detectionRect.w,this.detectionRect.w*=-1);0>this.detectionRect.h&&(this.detectionRect.y+=this.detectionRect.h,this.detectionRect.h*=
-1)},recalculateDetectionPoints:function(){if(0!=this.points.length){this.detectionPoints=[];for(var b=0,c=this.points.length;b<c;b++){var d=this.rotatePointAroundOrigin(this.angle,this.points[b]);d.x*=this.scale.x;d.y*=this.scale.y;this.detectionPoints.push(d)}}},rotatePointAroundOrigin:function(b,c){var d=Math.sin(b),e=Math.cos(b);return{x:c.x*e+c.y*d,y:-c.x*d+c.y*e}},drawBtnShadow:function(){var b=ig.system.context,c=this.pos.x+this.offset.x+this.btnShadowOffset.x,d=this.pos.y+this.offset.y+this.btnShadowOffset.y;
this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x,this.skew.x,this.skew.y,this.scale.y,c,d);b.rotate(this.angle);if(this.buttonType==ig.BUTTONTYPE.ROUNDED_RECT||this.buttonType==ig.BUTTONTYPE.SQUARE_RECT||this.buttonType==ig.BUTTONTYPE.OCTOGON||this.buttonType==ig.BUTTONTYPE.PILL||this.buttonType==ig.BUTTONTYPE.CIRCLE)if(b.strokeStyle=this.strokeStyle,
b.fillStyle=this.btnShadowColor,d=c=!1,this.strokeStyle&&0<this.strokeWidth&&(d=!0,b.lineWidth=this.strokeWidth),this.fillStyle&&(c=!0),this.buttonType==ig.BUTTONTYPE.SQUARE_RECT)if(c&&d){var d=this.rect.x-(this.strokeWidth-1)/2,e=this.rect.y-(this.strokeWidth-1)/2,f=this.rect.w+(this.strokeWidth-1),g=this.rect.h+(this.strokeWidth-1);this.antialiasingEnabled||(d=this.bitwiseRound(d),e=this.bitwiseRound(e),f=this.bitwiseRound(f),g=this.bitwiseRound(g));b.fillRect(d,e,f,g)}else c&&!d?b.fillRect(this.rect.x,
this.rect.y,this.rect.w,this.rect.h):!c&&d&&b.strokeRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h);else this.buttonType==ig.BUTTONTYPE.ROUNDED_RECT?(d=this.rect.x-(this.strokeWidth-1)/2,e=this.rect.y-(this.strokeWidth-1)/2,f=this.rect.w+(this.strokeWidth-1),g=this.rect.h+(this.strokeWidth-1),this.antialiasingEnabled||(d=this.bitwiseRound(d),e=this.bitwiseRound(e),f=this.bitwiseRound(f),g=this.bitwiseRound(g)),this.roundRect(b,d,e,f,g,2*this.roundedRadius,c,!1)):this.buttonType==ig.BUTTONTYPE.OCTOGON?
(d=this.rect.x-(this.strokeWidth-1)/2,e=this.rect.y-(this.strokeWidth-1)/2,f=this.rect.w+(this.strokeWidth-1),g=this.rect.h+(this.strokeWidth-1),this.antialiasingEnabled||(d=this.bitwiseRound(d),e=this.bitwiseRound(e),f=this.bitwiseRound(f),g=this.bitwiseRound(g)),this.octogon(b,d,e,f,g,2*this.edgeRadius,c,!1)):this.buttonType==ig.BUTTONTYPE.PILL?(d=this.rect.x-(this.strokeWidth-1)/2,e=this.rect.y-(this.strokeWidth-1)/2,f=this.rect.w+(this.strokeWidth-1),g=this.rect.h+(this.strokeWidth-1),this.antialiasingEnabled||
(d=this.bitwiseRound(d),e=this.bitwiseRound(e),f=this.bitwiseRound(f),g=this.bitwiseRound(g)),this.pill(b,d,e,f,g,c,!1)):this.buttonType==ig.BUTTONTYPE.CIRCLE&&(d=this.rect.x-(this.strokeWidth-1)/2,e=this.rect.y-(this.strokeWidth-1)/2,f=this.rect.w+(this.strokeWidth-1),g=this.rect.h+(this.strokeWidth-1),this.antialiasingEnabled||(d=this.bitwiseRound(d),e=this.bitwiseRound(e),f=this.bitwiseRound(f),g=this.bitwiseRound(g)),this.circle(b,d,e,f,g,c,!1));b.restore()},drawTextShadow:function(){var b=ig.system.context,
c=this.pos.x+this.offset.x+this.textShadowOffset.x,d=this.pos.y+this.offset.y+this.textShadowOffset.y;this.down?(c+=this.downOffset.x,d+=this.downOffset.y):this.over&&(c+=this.overOffset.x,d+=this.overOffset.y);this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x*this.scaleMultiplier,this.skew.x,this.skew.y,this.scale.y*this.scaleMultiplier,
c,d);b.rotate(this.angle);if(this.text&&""!=this.text)if(this.textShadowCanvas)c=this.textOffset.x,d=this.textOffset.y,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),c=this.textShadowCanvas.width,d=this.textShadowCanvas.height,b.drawImage(this.textShadowCanvas,0,0,c,d,-c/2,-d/2,c,d);else if(b.font=this.textFontSize+"px "+this.textFont,b.textAlign="center",b.textBaseline=
"middle",c=this.textOffset.x,d=this.textOffset.y,d+=this.textHeightAdjustment,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),this.textList)for(var d=c=0,e=this.textList.length;d<e;d++)b.fillStyle=this.textShadowColor,b.fillText(this.textList[d],0,c),c+=this.textLineHeight;else b.fillStyle=this.textShadowColor,b.fillText(this.text,0,0);b.restore();c=this.pos.x+this.offset.x;
d=this.pos.y+this.offset.y;this.down?(c+=this.downOffset.x,d+=this.downOffset.y):this.over&&(c+=this.overOffset.x,d+=this.overOffset.y);this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d));b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x*this.scaleMultiplier,this.skew.x,this.skew.y,this.scale.y*this.scaleMultiplier,c,d);b.rotate(this.angle);if(this.text&&""!=this.text)if(this.textCanvas)c=
this.textOffset.x,d=this.textOffset.y,this.antialiasingEnabled||(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),c=this.textCanvas.width,d=this.textCanvas.height,b.drawImage(this.textCanvas,0,0,c,d,-c/2,-d/2,c,d);else if(b.font=this.textFontSize+"px "+this.textFont,b.textAlign="center",b.textBaseline="middle",c=this.textOffset.x,d=this.textOffset.y,d+=this.textHeightAdjustment,this.antialiasingEnabled||
(c=this.bitwiseRound(c),d=this.bitwiseRound(d)),b.transform(this.textScale.x,this.textSkew.x,this.textSkew.y,this.textScale.y,c,d),b.rotate(this.textAngle),this.textList){d=c=0;for(e=this.textList.length;d<e;d++)b.fillStyle=this.getTextColorStr(),b.fillText(this.textList[d],0,c),c+=this.textLineHeight}else b.fillStyle=this.getTextColorStr(),b.fillText(this.text,0,0);b.restore()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},wrapText:function(b,c){var d=ig.system.context;
d.font=this.textFontSize+"px "+this.textFont;var e=b.split(" "),f="",g=[];if(1==e.length)for(var n=0,l=b.length;n<l;n++){var m=f+b[n],r=d.measureText(m),r=r.width;r>c&&0<n?(g.push(f),f=b[n]):f=m}else{n=0;for(l=e.length;n<l;n++)m=f+e[n]+" ",r=d.measureText(m),r=r.width,r>c&&0<n?(g.push(f),f=e[n]+" "):f=m}g.push(f);return g},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);b.quadraticCurveTo(c+e,d,c+e,d+g);
b.lineTo(c+e,d+f-g);b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},octogon:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);b.lineTo(c+e,d+g);b.lineTo(c+e,d+f-g);b.lineTo(c+e-g,d+f);b.lineTo(c+g,d+f);b.lineTo(c,d+f-g);b.lineTo(c,d+g);b.lineTo(c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},
pill:function(b,c,d,e,f,g,n){"undefined"==typeof n&&(n=!0);var l=f/2;b.beginPath();b.arc(c+l,d+l,l,0.5*Math.PI,1.5*Math.PI);b.lineTo(c+e-l,d);b.arc(c+e-l,d+l,l,1.5*Math.PI,0.5*Math.PI);b.lineTo(c+l,d+f);b.closePath();n&&b.stroke();g&&b.fill()},circle:function(b,c,d,e,f,g,n){e=this.rect.h/2;c=this.rect.x+this.rect.w/2;d=this.rect.y+e;b.beginPath();b.arc(c,d,e,0,2*Math.PI);b.closePath();n&&b.stroke();g&&b.fill()},bitwiseRound:function(b){return 0.5+b<<0},getInputPos:function(){return ig.game.io.getClickPos()},
getTextColorStr:function(){return"rgba("+this.textColor.r+","+this.textColor.g+","+this.textColor.b+","+this.textAlpha+")"},getTextSize:function(b,c,d,e){var f=document.createElement("div");f.innerHTML=b;f.style.position="absolute";f.style.top="-9999px";f.style.left="-9999px";f.style.fontFamily=c;f.style.fontWeight=e?"bold":"normal";f.style.fontSize=d+"px";document.body.appendChild(f);d={x:f.offsetWidth,y:f.offsetHeight};document.body.removeChild(f);return d}});ig.BUTTONTYPE={LABEL_ONLY:0,SQUARE_RECT:1,
ROUNDED_RECT:2,OCTOGON:3,PILL:4,CIRCLE:5,IMAGE:6,ANIMSHEET:7}});ig.baked=!0;
ig.module("plugins.clickable-div-layer").requires("plugins.data.vector").defines(function(){ClickableDivLayer=ig.Class.extend({pos:new Vector2(0,0),size:new Vector2(0,0),identifier:null,invisImagePath:"http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/misc/invisible.png",init:function(b){this.pos=new Vector2(b.pos.x,b.pos.y);this.size=new Vector2(b.size.x,b.size.y);var c="more-games",d="www.google.com",e=!1;b.div_layer_name&&(c=b.div_layer_name);b.link&&(d=b.link);b.newWindow&&(e=b.newWindow);this.createClickableLayer(c,
d,e)},createClickableLayer:function(b,c,d){this.identifier=b;var e=ig.domHandler.getElementById("#"+b);e?(ig.domHandler.show(e),ig.domHandler.attr(e,"href",c)):this.createClickableOutboundLayer(b,c,this.invisImagePath,d)},update:function(b,c){this.pos.x===b&&this.pos.y===c||(ig.sizeHandler.dynamicClickableEntityDivs[this.identifier]={},ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].width=this.size.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].height=this.size.y,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_x=
this.pos.x,ig.sizeHandler.dynamicClickableEntityDivs[this.identifier].entity_pos_y=this.pos.y)},createClickableOutboundLayer:function(b,c,d,e){var f=ig.domHandler.create("div");ig.domHandler.attr(f,"id",b);var g=ig.domHandler.create("a");e?(ig.domHandler.attr(g,"href",c),ig.domHandler.attr(g,"target","_blank")):ig.domHandler.attr(g,"href",c);c=ig.domHandler.create("img");ig.domHandler.css(c,{width:"100%",height:"100%"});ig.domHandler.attr(c,"src",d);d=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,
ig.sizeHandler.scaleRatioMultiplier.y);if(ig.ua.mobile){e=Math.floor(this.pos.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";var n=Math.floor(this.pos.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px",l=Math.floor(this.size.x*ig.sizeHandler.scaleRatioMultiplier.x)+"px";d=Math.floor(this.size.y*ig.sizeHandler.scaleRatioMultiplier.y)+"px"}else e=ig.domHandler.getElementById("#canvas"),e=ig.domHandler.getOffsets(e),n=e.top,e=Math.floor(e.left+this.pos.x*d)+"px",n=Math.floor(n+this.pos.y*d)+"px",l=Math.floor(this.size.x*
d)+"px",d=Math.floor(this.size.y*d)+"px";ig.domHandler.css(f,{"float":"left",position:"absolute",left:e,top:n,width:l,height:d,"z-index":3});ig.domHandler.addEvent(f,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(g,c);ig.domHandler.appendChild(f,g);ig.domHandler.appendToBody(f);ig.sizeHandler.dynamicClickableEntityDivs[b]={};ig.sizeHandler.dynamicClickableEntityDivs[b].width=this.size.x;ig.sizeHandler.dynamicClickableEntityDivs[b].height=this.size.y;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_x=
this.pos.x;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_y=this.pos.y}})});ig.baked=!0;
ig.module("game.entities.button-more-games").requires("impact.entity","plugins.clickable-div-layer").defines(function(){EntityButtonMoreGames=ig.Entity.extend({size:{x:41,y:28},zIndex:750,type:ig.Entity.TYPE.B,image:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/mainmenu/moregames.png#ffffff^screen"),imageOffset:{x:0,y:0},hidden:!1,disabled:!0,init:function(b,c,d){this.parent(b,c,d);this.image&&(this.pos.x=ig.system.width-this.image.width,this.pos.y=ig.system.height-2-this.image.height,
this.size.x=this.image.width,this.size.y=this.image.height,this.imageOffset.x=0,this.imageOffset.y=0)},ready:function(){setTimeout(this.spawnDiv(),5)},spawnDiv:function(){_SETTINGS.MoreGames.Enabled?(_SETTINGS.MoreGames.Link&&(this.link=_SETTINGS.MoreGames.Link),_SETTINGS.MoreGames.NewWindow&&(this.newWindow=_SETTINGS.MoreGames.NewWindow),this.divLayerName="more-games",this.clickableLayer=new ClickableDivLayer(this),this.enable()):this.kill()},hide:function(){this.hidden||(this.hidden=!1)},show:function(){this.hidden&&
(this.hidden=!0)},disable:function(){this.divLayerName&&(id=this.divLayerName,document.getElementById(id).style.visibility="hidden",$("#"+id).hide(),this.disabled=!0)},enable:function(){this.divLayerName&&(id=this.divLayerName,document.getElementById(id).style.visibility="visible",$("#"+id).show(),this.disabled=!1)},kill:function(){this.parent();this.hide()},draw:function(){},drawImage:function(){if(this.image){var b=this.pos.x+this.imageOffset.x,c=this.pos.y+this.imageOffset.y;this.shadowImage&&
this.shadowImage.draw(b+1,c+1);this.image.draw(b,c)}}})});ig.baked=!0;
ig.module("plugins.slider").defines(function(){ig.Slider=ig.Class.extend({pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},offset:{x:0,y:0},isVertical:!1,posRelativeTo:null,scale:{x:1,y:1},skew:{x:0,y:0},angle:0,alpha:1,bgImage:null,bgRect:null,bgShadowRect:null,bgFillStyle:null,bgStrokeStyle:null,bgStrokeWidth:2,bgRoundedRadius:5,bgShadowFillStyle:null,knobImage:null,knobRect:null,knobShadowRect:null,knobFillStyle:null,knobStrokeStyle:null,knobStrokeWidth:2,knobRoundedRadius:5,knobShadowFillStyle:null,value:0,
clickStateName:"click",valueChangedFunction:null,sliderReleasedFunction:null,hidden:!1,activated:!1,init:function(b){this.textFont="Impact, Charcoal, sans-serif";this.textLineHeight=this.textFontSize=24;this.parentEntity=b},setPos:function(b,c){b&&(this.pos.x=b.x,this.pos.y=b.y,this.setPosRelativeTo(c))},setPosRelativeTo:function(b,c){if(b&&b.pos&&!(null==b.pos.x||null==b.pos.y))this.posRelativeTo=b,this.setPos(c)},setRect:function(b){b&&(this.rect.x=b.x,this.rect.y=b.y,this.rect.w=0<=b.w?b.w:1,this.rect.h=
0<=b.h?b.h:1)},setAngle:function(b){this.angle=b},setScale:function(b,c){b&&c&&(this.scale.x=b,this.scale.y=c)},setKnobImage:function(b){(this.knobImage=b)?(this.knobRect||(this.knobRect={x:0,y:0}),this.knobRect.w=b.width,this.knobRect.h=b.height,this.knobRect.x=-this.knobRect.w/2,this.knobRect.y=-this.knobRect.h/2):this.knobRect=null},setBgImage:function(b){(this.bgImage=b)?(this.bgRect||(this.bgRect={x:0,y:0}),this.bgRect.w=b.width,this.bgRect.h=b.height,this.bgRect.x=-this.bgRect.w/2,this.bgRect.y=
-this.bgRect.h/2):this.bgRect=null},draw:function(){if(!this.hidden){var b=ig.system.context,c=this.pos.x+this.offset.x,d=this.pos.y+this.offset.y;this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x,this.skew.x,this.skew.y,this.scale.y,c,d);b.rotate(this.angle);if(this.bgImage)this.bgImage.draw(this.bgRect.x,this.bgRect.y);else if(null!=this.bgRect){d=c=!1;if(null!=this.bgShadowRect&&this.bgShadowFillStyle){b.fillStyle=
this.bgShadowFillStyle;var e=this.bgShadowRect.x,f=this.bgShadowRect.y,g=this.bgShadowRect.w,n=this.bgShadowRect.h;this.roundRect(b,e,f,g,n,2*this.bgRoundedRadius,!0,!1)}n=1;this.bgFillStyle&&(b.fillStyle=this.bgFillStyle,c=!0);this.bgStrokeStyle&&(b.strokeStyle=this.bgStrokeStyle,n=b.lineWidth=this.bgStrokeWidth,d=!0);e=this.bgRect.x-(n-1)/2;f=this.bgRect.y-(n-1)/2;g=this.bgRect.w+(n-1);n=this.bgRect.h+(n-1);this.roundRect(b,e,f,g,n,2*this.bgRoundedRadius,c,d)}if(null!=this.knobRect){var c=this.knobRect.x,
d=this.knobRect.y,l=(this.value-0.5)*this.bgRect.w;this.knobImage?this.knobImage.draw(c+l,d):(d=c=!1,null!=this.knobShadowRect&&this.knobShadowFillStyle&&(b.fillStyle=this.knobShadowFillStyle,e=this.knobShadowRect.x,f=this.knobShadowRect.y,g=this.knobShadowRect.w,n=this.knobShadowRect.h,this.roundRect(b,e+l,f,g,n,2*this.knobRoundedRadius,!0,!1)),n=1,this.knobFillStyle&&(b.fillStyle=this.knobFillStyle,c=!0),this.knobStrokeStyle&&(b.strokeStyle=this.knobStrokeStyle,n=b.lineWidth=this.knobStrokeWidth,
d=!0),e=this.knobRect.x-(n-1)/2,f=this.knobRect.y-(n-1)/2,g=this.knobRect.w+(n-1),n=this.knobRect.h+(n-1),this.roundRect(b,e+l,f,g,n,2*this.knobRoundedRadius,c,d))}b.restore()}},update:function(){var b=!1,c=!1,d=!1;ig.input.pressed(this.clickStateName)?d=!0:ig.input.released(this.clickStateName)?b=!0:ig.input.state(this.clickStateName)&&(c=!0);if(d||c||b){var e=ig.game.inputPos;null==e&&(e=this.getInputPos());if(d){d={};d.x=e.x;d.y=e.y;d.w=1;d.h=1;var f={};f.x=this.pos.x+this.rect.x;f.y=this.pos.y+
this.rect.y;f.w=this.rect.w;f.h=this.rect.h;this.posRelativeTo&&(f.x+=this.posRelativeTo.pos.x,f.y+=this.posRelativeTo.pos.y);this.aabbCheck(d,f)&&(this.activated=!0)}if(this.activated){if(c||b)c=this.pos.x-this.bgRect.w/2,this.posRelativeTo&&(c+=this.posRelativeTo.pos.x),this.value=(e.x-c)/this.bgRect.w,1<this.value&&(this.value=1),0>this.value&&(this.value=0),this.valueChangedFunction&&"function"==typeof this.valueChangedFunction&&this.valueChangedFunction();b&&(this.activated=!1,this.sliderReleasedFunction&&
"function"==typeof this.sliderReleasedFunction&&this.sliderReleasedFunction())}}},show:function(){this.hidden&&(this.hidden=!1)},hide:function(){this.hidden||(this.hidden=!0)},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);0<g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);0<g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);0<g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);0<g&&b.quadraticCurveTo(c,
d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},getInputPos:function(){return ig.game.io.getClickPos()}})});ig.baked=!0;
ig.module("game.classes.tutorial-panel").defines(function(){TutorialPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.6,buttonImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png"),alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},backButton:null,relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},backButton:null,hideDoneCallback:null,control:null,init:function(b){this.control=b},
ready:function(){this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=ig.system.height/2;this.pos.x=this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y;this.bgRect.w=560;this.bgRect.h=420;this.bgRect.x=-this.bgRect.w/2;this.bgRect.y=-this.bgRect.h/2;var b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this);d.setPos({x:0,y:-this.bgRect.y-30});d.posRelativeTo=this;d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.textOffset.x=0;d.textOffset.y=
2;d.textShadowDisabled=!1;d.textShadowColor="rgba(0,0,0,0.5)";d.setTextColor({r:255,g:255,b:255});d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=16;b=_STRINGS.UI.Back;ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));d.setText(b);d.textShadowOffset={x:1,y:1};d.clickedFunction=this.backButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);
this.backButton=d},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.x+this.bgRect.x,d=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.fillStyle="rgba(0,0,0,0.95)";this.roundRect(b,c,d,this.bgRect.w,this.bgRect.h,10,!0,!1);b.restore();d=this.pos.y+this.bgRect.y;c=_STRINGS.UI.Rules;ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));
b.font="48px lobster13, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+60+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+60);c=_STRINGS.Rules[0];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="24px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+122+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+122);c=_STRINGS.Rules[1];
ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+152+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+152);c=_STRINGS.Rules[2];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+
212+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+212);c=_STRINGS.Rules[3];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+242+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+242);c=_STRINGS.Rules[4];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+272+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+272);c=_STRINGS.Rules[5];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+302+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+302);this.backButton.draw()}},update:function(){if(!this.hidden){if(this.transitionIn){var b=
ig.system.clock.delta()-this.transitionTime,b=b/this.transitionDuration;1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+
this.offset.y}else this.transitionOut&&(b=ig.system.clock.delta()-this.transitionTime,b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y);this.backButton.update()}},show:function(){if(this.hidden&&
!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();this.hidden=!1}},showDone:function(){},hide:function(){if(!this.hidden&&!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=
!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=!0;this.hideDoneCallback&&"function"==typeof this.hideDoneCallback&&this.hideDoneCallback()},backButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.hide()},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);
g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.classes.options-panel").requires("plugins.button","plugins.slider","game.classes.tutorial-panel").defines(function(){OptionsPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.6,buttonImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png"),alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},musicMaxVolume:1,musicButton:null,
soundButton:null,backButton:null,musicSlider:null,soundSlider:null,hasTutorialButton:null,tutorialButton:null,hasMainmenuButton:!1,mainmenuButton:null,hideDoneCallback:null,control:null,ignoreInputsFlag:!1,init:function(b){this.control=b;this.musicMaxVolume=1;ig.ua.mobile&&(this.musicMaxVolume=0.25)},ready:function(){"function"==typeof this.control.playTutorial&&(this.hasTutorialButton=!0);this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=ig.system.height/2;this.pos.x=
this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y;this.bgRect.w=480;this.bgRect.h=360;this.bgRect.x=-this.bgRect.w/2;this.bgRect.y=-this.bgRect.h/2;var b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this);d.setPos({x:0,y:-this.bgRect.y-50});d.posRelativeTo=this;d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.textOffset.x=0;d.textOffset.y=2;d.textShadowDisabled=!1;d.textShadowColor="rgba(0,0,0,0.5)";d.setTextColor({r:255,g:255,b:255});d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");
d.textLineHeight=16;b=_STRINGS.UI.Back;ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));d.setText(b);d.textShadowOffset={x:1,y:1};d.clickedFunction=this.backButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);this.backButton=d;d=new ig.Slider(this);d.setPos({x:60,y:-30},this);d.setRect({x:-60,y:-15,w:120,h:30});d.bgRect={x:-50,y:-3,w:100,h:6};
d.bgShadowRect={x:-50,y:0,w:100,h:6};d.bgRoundedRadius=0;d.bgFillStyle="rgb(100,100,100)";d.bgShadowFillStyle="#aaaaaa";d.knobRect={x:-10,y:-10,w:20,h:20};d.knobShadowRect={x:-8,y:-8,w:20,h:20};d.knobRoundedRadius=2;d.knobFillStyle="rgb(200,200,200)";d.value=ig.game.sfxVolume;d.valueChangedFunction=this.soundSliderValueChanged.bind(this);d.sliderReleasedFunction=this.soundSliderReleased.bind(this);this.soundSlider=d;d=new ig.Slider(this);d.setPos({x:60,y:10},this);d.setRect({x:-60,y:-15,w:120,h:30});
d.bgRect={x:-50,y:-3,w:100,h:6};d.bgShadowRect={x:-50,y:0,w:100,h:6};d.bgRoundedRadius=0;d.bgFillStyle="rgb(100,100,100)";d.bgShadowFillStyle="#aaaaaa";d.knobRect={x:-10,y:-10,w:20,h:20};d.knobShadowRect={x:-8,y:-8,w:20,h:20};d.knobRoundedRadius=2;d.knobFillStyle="rgb(200,200,200)";d.value=ig.game.musicVolume;d.valueChangedFunction=this.musicSliderValueChanged.bind(this);d.sliderReleasedFunction=this.musicSliderReleased.bind(this);this.musicSlider=d;this.hasMainmenuButton&&(b=this.buttonImage.width,
c=this.buttonImage.height,d=new ig.Button(this),d.setPos({x:0,y:80}),d.posRelativeTo=this,d.setRect({x:-b/2,y:-c/2,w:b,h:c}),d.textOffset.y=2,d.textShadowDisabled=!1,d.textShadowColor="rgba(0,0,0,0.5)",d.setTextColor({r:255,g:255,b:255}),d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif"),d.textLineHeight=16,b=_STRINGS.UI["Main Menu"],ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202))),d.setText(b),d.textShadowOffset={x:1,y:1},d.clickedFunction=this.mainmenuButtonPressed.bind(this),
d.downOffset={x:0,y:1},d.overOffset={x:0,y:-1},d.overScaleMultiplier=1,d.downScaleMultiplier=1,d.buttonType=ig.BUTTONTYPE.IMAGE,d.setUpImage(this.buttonImage),this.mainmenuButton=d);this.hasTutorialButton&&(b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this),d.setPos({x:0,y:80}),d.posRelativeTo=this,d.setRect({x:-b/2,y:-c/2,w:b,h:c}),d.textOffset.y=2,d.textShadowDisabled=!1,d.textShadowColor="rgba(0,0,0,0.5)",d.setTextColor({r:255,g:255,b:255}),d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif"),
b=_STRINGS.UI.Rules,d.textLineHeight=16,ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202))),d.setText(b),d.textShadowOffset={x:1,y:1},d.clickedFunction=this.tutorialButtonPressed.bind(this),d.downOffset={x:0,y:1},d.overOffset={x:0,y:-1},d.overScaleMultiplier=1,d.downScaleMultiplier=1,d.buttonType=ig.BUTTONTYPE.IMAGE,d.setUpImage(this.buttonImage),this.tutorialButton=d,this.hasMainmenuButton&&(d.setPos({x:0,y:30}),this.soundSlider.pos.y-=40,this.musicSlider.pos.y-=40),this.tutorialPanel=
new TutorialPanel(this),this.tutorialPanel.hideDoneCallback=function(){this.ignoreInputsFlag=!1}.bind(this),this.tutorialPanel.maxBgAlpha=0,this.tutorialPanel.ready())},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.x+this.bgRect.x,d=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.fillStyle="rgba(0,0,0,0.95)";this.roundRect(b,
c,d,this.bgRect.w,this.bgRect.h,10,!0,!1);b.restore();d=this.pos.y+this.bgRect.y;c=_STRINGS.UI.Options;ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="48px lobster13, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+62+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+62);c=_STRINGS.UI.Sound;ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="24px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="right";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x-25+1,this.pos.y+this.soundSlider.pos.y+10+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x-25,this.pos.y+this.soundSlider.pos.y+10);c=_STRINGS.UI.Music;ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="24px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="right";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x-25+1,this.pos.y+this.musicSlider.pos.y+10+1);b.fillStyle="#FFFFFF";b.fillText(c,
this.pos.x-25,this.pos.y+this.musicSlider.pos.y+10);this.tutorialButton&&this.tutorialButton.draw();this.mainmenuButton&&this.mainmenuButton.draw();this.backButton.draw();this.soundButton&&this.soundButton.draw();this.musicButton&&this.musicButton.draw();this.soundSlider&&this.soundSlider.draw();this.musicSlider&&this.musicSlider.draw();this.tutorialPanel&&this.tutorialPanel.draw()}},update:function(){if(!this.hidden){if(this.transitionIn){var b=ig.system.clock.delta()-this.transitionTime,b=b/this.transitionDuration;
1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+this.offset.y}else this.transitionOut&&(b=ig.system.clock.delta()-this.transitionTime,
b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y);this.tutorialPanel&&this.tutorialPanel.update();this.ignoreInputsFlag||(this.tutorialButton&&this.tutorialButton.update(),this.mainmenuButton&&this.mainmenuButton.update(),
this.backButton.update(),this.musicButton&&this.musicButton.update(),this.soundButton&&this.soundButton.update(),this.soundSlider&&this.soundSlider.update(),this.musicSlider&&this.musicSlider.update(),ig.input.pressed("esc")&&this.backButtonPressed())}},show:function(){if(this.hidden&&!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();
this.hidden=!1;this.soundSlider.value=ig.game.sfxVolume;this.musicSlider.value=ig.game.musicVolume}},showDone:function(){},hide:function(){if(!this.hidden&&!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=!0;this.hideDoneCallback&&"function"==typeof this.hideDoneCallback&&
this.hideDoneCallback()},muteAudio:function(){ig.game.muted=!0;this.setMusicVolume(0);this.setSfxVolume(0);ig.game.savePlayerStats()},unmuteAudio:function(){ig.game.muted=!1;this.setMusicVolume(ig.game.musicVolume);this.setSfxVolume(ig.game.sfxVolume);ig.game.savePlayerStats()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},musicButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");if(ig.game.musicVolume<
this.musicMaxVolume){this.musicSlider.value=this.musicMaxVolume;this.setMusicVolume(this.musicMaxVolume);var b=_STRINGS.UI.Music,b=b+(" "+_STRINGS.UI.On)}else this.musicSlider.value=0,this.setMusicVolume(0),b=_STRINGS.UI.Music,b+=" "+_STRINGS.UI.Off;ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));this.musicButton.setText(b)},soundButtonPressed:function(){if(1>ig.game.sfxVolume){this.soundSlider.value=1;this.setSfxVolume(1);var b=_STRINGS.UI.Sound,b=b+(" "+_STRINGS.UI.On);
ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));this.soundButton.setText(b);ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button")}else this.soundSlider.value=0,this.setSfxVolume(0),b=_STRINGS.UI.Sound,b+=" "+_STRINGS.UI.Off,ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202))),this.soundButton.setText(b)},backButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.hide()},
tutorialButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.ignoreInputsFlag=!0;this.tutorialPanel.show()},mainmenuButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.control&&"function"==typeof this.control.returnToMainMenu&&this.control.returnToMainMenu()},soundSliderValueChanged:function(){this.setSfxVolume(this.soundSlider.value)},musicSliderValueChanged:function(){this.setMusicVolume(this.musicSlider.value)},
soundSliderReleased:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button")},musicSliderReleased:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button")},setSfxVolume:function(b){ig.soundHandler.sfxVolume=b;ig.soundHandler.sfxPlayer.volume(b);ig.game.sfxVolume=b;ig.game.savePlayerStats()},setMusicVolume:function(b){ig.soundHandler.musicVolume=b;ig.soundHandler.bgmPlayer.volume(b);ig.soundHandler.bgmPlayer.bgmPlaying||
ig.soundHandler.bgmPlayer.play();ig.game.musicVolume=b;ig.game.savePlayerStats()},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.classes.connectionfailed-panel").requires("plugins.button").defines(function(){ConnectionFailedPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.8,alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},control:null,init:function(b){this.control=b},ready:function(){this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=ig.system.height/
2;this.pos.x=this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.restore();var d=_STRINGS.UI.Disconnected;ig.global.addTextSpacing&&(d=d.split("").join(String.fromCharCode(8202)));b.font="30px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="center";b.fillStyle="#000000";b.fillText(d,this.pos.x+1,c+1);b.fillStyle="#ffffff";b.fillText(d,this.pos.x,c);c+=100;d=_STRINGS.UI["Attempting to reconnect..."];ig.global.addTextSpacing&&(d=d.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="#000000";b.fillText(d,this.pos.x+1,c+1);b.fillStyle="#ffffff";b.fillText(d,this.pos.x,c)}},update:function(){if(!this.hidden)if(this.transitionIn){var b=ig.system.clock.delta()-
this.transitionTime,b=b/this.transitionDuration;1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+this.offset.y}else this.transitionOut&&
(b=ig.system.clock.delta()-this.transitionTime,b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y)},show:function(){if(this.hidden&&!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;
var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();this.hidden=!1}},showDone:function(){},hide:function(){if(!this.hidden&&!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=
!0}})});ig.baked=!0;
ig.module("game.classes.connecting-panel").requires("plugins.button").defines(function(){ConnectingPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.8,alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},showDoneCallback:null,control:null,init:function(b){this.control=b},ready:function(){this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=
ig.system.height/2;this.pos.x=this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.restore();var d=_STRINGS.UI["Connecting..."];ig.global.addTextSpacing&&(d=d.split("").join(String.fromCharCode(8202)));b.font="30px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="center";b.fillStyle="#000000";b.fillText(d,this.pos.x+1,c+1);b.fillStyle="#ffffff";b.fillText(d,this.pos.x,c)}},update:function(){if(!this.hidden)if(this.transitionIn){var b=ig.system.clock.delta()-this.transitionTime,b=b/this.transitionDuration;1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=
-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+this.offset.y}else this.transitionOut&&(b=ig.system.clock.delta()-this.transitionTime,b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=
b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y)},show:function(){if(this.hidden&&!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();this.hidden=!1}},showDone:function(){"function"==typeof this.showDoneCallback&&this.showDoneCallback()},hide:function(){if(!this.hidden&&
!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=!0}})});ig.baked=!0;
ig.module("plugins.text-container").defines(function(){ig.TextContainer=ig.Class.extend({pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},offset:{x:0,y:0},margin:{top:0,bottom:0,left:0,right:0},posRelativeTo:null,scale:{x:1,y:1},skew:{x:0,y:0},angle:0,alpha:1,backgroundType:1,bgFillStyle:null,bgStrokeStyle:null,bgStrokeWidth:2,bgRoundedRadius:5,text:null,textList:null,textCanvas:null,textAlpha:1,textFont:null,textFontSize:24,textLineHeight:24,textHeightAdjustment:0,textColor:{r:255,g:255,b:255},textAlign:"center",
textBaseline:"middle",textShadowOffset:{x:0,y:2},textShadowColor:"rgba(0,0,0,0.5)",textShadowDisabled:!0,textWrap:!0,hidden:!1,textCanvasPos:{x:0,y:0},init:function(b){this.textFont="Impact, Charcoal, sans-serif";this.textLineHeight=this.textFontSize=24;this.parentEntity=b},setPos:function(b,c){b&&(this.pos.x=b.x,this.pos.y=b.y,this.setPosRelativeTo(c))},setPosRelativeTo:function(b,c){if(b&&b.pos&&!(null==b.pos.x||null==b.pos.y))this.posRelativeTo=b,this.setPos(c)},setRect:function(b){b&&(this.rect.x=
b.x,this.rect.y=b.y,this.rect.w=0<=b.w?b.w:1,this.rect.h=0<=b.h?b.h:1,this.refreshTextCanvasPos())},setAngle:function(b){this.angle=b},setScale:function(b,c){b&&c&&(this.scale.x=b,this.scale.y=c)},setFont:function(b,c){this.textFont=c;this.textLineHeight=this.textFontSize=b;this.textHeightAdjustment=this.textList?this.rect.y/2-this.textList.length/2*this.textLineHeight:this.rect.y/2;this.createTextCanvas()},setTextColor:function(b){b&&(this.textColor={},this.textColor.r=b.r,this.textColor.g=b.g,this.textColor.b=
b.b,this.textColor.a=b.a,this.createTextCanvas())},setText:function(b){if(null==b||"undefined"==typeof b)b="";isNaN(b)||(b=""+b);this.text=b;this.textWrap&&1<=this.rect.w?(this.textList=this.wrapText(b,this.rect.w-this.margin.left-this.margin.right),this.textHeightAdjustment=-this.textList.length/2*this.textLineHeight):(this.textList=null,this.textHeightAdjustment=0);this.createTextCanvas()},createTextCanvas:function(){this.textShadowCanvas=this.textCanvas=null;var b=this.rect.w,c=this.rect.h;this.textWrap&&
this.textList&&0<this.textList.length&&1<=this.rect.w?(b=this.rect.w,c=this.textList.length*this.textLineHeight):(c=this.getTextSize(this.text,this.textFont,this.textFontSize),b=this.margin.left+this.margin.right+c.x,c=c.y);this.textCanvas=ig.$new("canvas");this.textCanvas.width=b;this.textCanvas.height=c;c=this.textCanvas.getContext("2d");c.font=this.textFontSize+"px "+this.textFont;c.textAlign=this.textAlign;c.textBaseline=this.textBaseline;var d=0+this.margin.left,e=this.textLineHeight/2;"center"==
this.textAlign?d=this.margin.left+(b-this.margin.left-this.margin.right)/2:"right"==this.textAlign&&(d=b-this.margin.right);if(!this.textShadowDisabled){var b=d+this.textShadowOffset.x,f=e+this.textShadowOffset.y;c.fillStyle=this.textShadowColor;if(this.textList)for(var e=this.textLineHeight/2,g=0,n=0,l=this.textList.length;n<l;n++)c.fillText(this.textList[n],b,f+g),g+=this.textLineHeight;else c.fillText(this.text,b,f)}c.fillStyle=this.getTextColorStr();if(this.textList){e=this.textLineHeight/2;n=
g=0;for(l=this.textList.length;n<l;n++)c.fillText(this.textList[n],d,e+g),g+=this.textLineHeight}else c.fillText(this.text,d,e);this.refreshTextCanvasPos()},draw:function(){if(!this.hidden){var b=ig.system.context,c=this.pos.x+this.offset.x,d=this.pos.y+this.offset.y;this.posRelativeTo&&(c+=this.posRelativeTo.pos.x,d+=this.posRelativeTo.pos.y);b.save();b.globalAlpha=this.alpha;b.transform(this.scale.x,this.skew.x,this.skew.y,this.scale.y,c,d);b.rotate(this.angle);this.backgroundType&&(d=c=!1,this.bgFillStyle&&
(b.fillStyle=this.bgFillStyle,c=!0),this.bgStrokeStyle&&(b.strokeStyle=this.bgStrokeStyle,b.lineWidth=this.bgStrokeWidth,d=!0),this.roundRect(b,this.rect.x-(this.bgStrokeWidth-1)/2,this.rect.y-(this.bgStrokeWidth-1)/2,this.rect.w+(this.bgStrokeWidth-1),this.rect.h+(this.bgStrokeWidth-1),2*this.bgRoundedRadius,c,d));this.text&&""!=this.text&&(this.textCanvas||this.createTextCanvas(),this.textCanvas&&(c=this.textCanvas.width,d=this.textCanvas.height,b.drawImage(this.textCanvas,0,0,c,d,this.textCanvasPos.x,
this.textCanvasPos.y,c,d)));b.restore()}},show:function(){this.hidden&&(this.hidden=!1)},hide:function(){this.hidden||(this.hidden=!0)},refreshTextCanvasPos:function(){if(this.textCanvas){var b=this.textCanvas.width,c=this.textCanvas.height;this.textCanvasPos.x=this.rect.x;this.textWrap||("center"==this.textAlign?this.textCanvasPos.x+=this.rect.w/2-b/2:"right"==this.textAlign&&(this.textCanvasPos.x+=this.rect.w-b));this.textCanvasPos.y=this.rect.y+this.margin.top+(this.rect.h-this.margin.top-this.margin.bottom)/
2-c/2}},wrapText:function(b,c){var d=ig.system.context;d.font=this.textFontSize+"px "+this.textFont;var e=b.split(" "),f="",g=[];if(1==e.length)for(var n=0,l=b.length;n<l;n++){var m=f+b[n],r=d.measureText(m),r=r.width;r>c&&0<n?(g.push(f),f=b[n]):f=m}else{n=0;for(l=e.length;n<l;n++)m=f+e[n]+" ",r=d.measureText(m),r=r.width,r>c&&0<n?(g.push(f),f=e[n]+" "):f=m}g.push(f);return g},getTextColorStr:function(){var b=this.textAlpha;isNaN(this.textColor.a)||(b=this.textColor.a);return"rgba("+this.textColor.r+
","+this.textColor.g+","+this.textColor.b+","+b+")"},getTextSize:function(b,c,d,e){var f=document.createElement("div");f.innerHTML=b;f.style.position="absolute";f.style.top="-9999px";f.style.left="-9999px";f.style.fontFamily=c;f.style.fontWeight=e?"bold":"normal";f.style.fontSize=d+"px";document.body.appendChild(f);d={x:f.offsetWidth,y:f.offsetHeight};document.body.removeChild(f);return d},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();
b.moveTo(c+g,d);b.lineTo(c+e-g,d);b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.classes.avatar").defines(function(){Avatar=ig.Class.extend({rect:{x:0,y:0,w:0,y:0},id:0,border:!1,borderFillStyle:"rgba(255,255,255,0.8)",borderStrokeStyle:"",borderLineWidth:2,alpha:1,images:[new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/00.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/01.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/02.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/03.png"),
new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/04.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/05.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/06.png"),new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/avatars/07.png")],init:function(b){this.id=b;this.rect.w=70;this.rect.h=70;this.rect.x=-this.rect.w/2;this.rect.y=-this.rect.h/2},update:function(){},draw:function(b,c,d){d||(d=ig.system.context);var e=0,f=0;isNaN(b)||(e+=
b);isNaN(c)||(f+=c);d.save();0<this.alpha&&1>this.alpha&&(d.globalAlpha=this.alpha);if(null!=this.id&&this.id<this.images.length){var g=this.images[this.id];g&&(e-=g.width/2,f-=g.height/2,d.drawImage(g.data,0,0,g.width,g.height,ig.system.getDrawPos(this.bitwiseRound(e)),ig.system.getDrawPos(this.bitwiseRound(f)),g.width,g.height))}f=e=0;isNaN(b)||(e+=b);isNaN(c)||(f+=c);b=this.bitwiseRound(e);f=this.bitwiseRound(f);c=31;d.save();e=d.createRadialGradient(b,f,c-3,b,f,c+3);e.addColorStop(0,"rgba(255,255,255,0)");
e.addColorStop(0.25,"rgba(255,255,255,1)");e.addColorStop(0.75,"rgba(255,255,255,1)");e.addColorStop(1,"rgba(255,255,255,0)");d.strokeStyle=e;d.lineWidth=6;d.beginPath();d.arc(b,f,c,0,2*Math.PI);d.stroke();d.restore();this.border&&(c=34,d.save(),e=d.createRadialGradient(b,f,c-4,b,f,c+4),e.addColorStop(0,"rgba(192,92,64,0)"),e.addColorStop(0.25,"rgba(192,92,64,1)"),e.addColorStop(0.75,"rgba(192,92,64,1)"),e.addColorStop(1,"rgba(192,92,64,0)"),d.strokeStyle=e,d.lineWidth=8,d.beginPath(),d.arc(b,f,c,
0,2*Math.PI),d.stroke(),d.restore());d.restore()},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},bitwiseRound:function(b){return 0.5+b<<0}})});ig.baked=!0;
ig.module("game.classes.matchmaking-panel").requires("plugins.button","plugins.text-container","game.classes.avatar").defines(function(){MatchmakingPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.6,buttonImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png"),alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},backButton:null,playButton:null,
startTime:null,hideDoneCallback:null,control:null,maxWaitDuration:3E4,showOvertimeFlag:!1,playersJoined:0,maxPlayerSize:0,playerSlots:null,init:function(b){this.control=b;this.playerSlots=new MatchmakingPlayerSlots(this)},ready:function(){this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=ig.system.height/2;this.pos.x=this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y;this.bgRect.w=480;this.bgRect.h=360;this.bgRect.x=-this.bgRect.w/2;this.bgRect.y=
-this.bgRect.h/2;var b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this);d.setPos({x:this.bgRect.x+60,y:-this.bgRect.y-20});d.posRelativeTo=this;d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.textOffset.x=0;d.textOffset.y=2;d.textShadowDisabled=!1;d.textShadowColor="rgba(0,0,0,0.5)";d.setTextColor({r:255,g:255,b:255});d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=16;b=_STRINGS.UI.Back;ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));
d.setText(b);d.textShadowOffset={x:1,y:1};d.clickedFunction=this.backButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);this.backButton=d;b=this.buttonImage.width;c=this.buttonImage.height;d=new ig.Button(this);d.setPos({x:-this.bgRect.x-85,y:-this.bgRect.y-20});d.posRelativeTo=this;d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.textOffset.x=0;d.textOffset.y=2;d.textShadowDisabled=
!1;d.textShadowColor="rgba(0,0,0,0.5)";d.setTextColor({r:255,g:255,b:255});d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=16;b=_STRINGS.UI["Casual Play"];ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));d.setText(b);d.textShadowOffset={x:1,y:1};d.clickedFunction=this.playButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);
this.playButton=d},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.x+this.bgRect.x,d=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.fillStyle="rgba(0,0,0,0.95)";this.roundRect(b,c,d,this.bgRect.w,this.bgRect.h,10,!0,!1);b.restore();this.playerSlots&&(this.playerSlots.pos.x=this.pos.x,this.playerSlots.pos.y=this.pos.y+this.bgRect.y+
110,this.playerSlots.draw());d=this.pos.y+this.bgRect.y;c=_STRINGS.UI["Waiting for Other Players"];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+this.bgRect.h/2+20+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+this.bgRect.h/2+20);if(!isNaN(this.startTime)){c=Date.now()-this.startTime;if(0<this.maxWaitDuration){var e=c/this.maxWaitDuration;
1<e&&(e=1);var f=this.pos.x-125,g=d+this.bgRect.h/2+30;b.fillStyle="rgba(255,255,255,0.2)";b.fillRect(f,g,250,6);b.fillStyle="rgba(255,255,255,0.4)";b.fillRect(f+4,g+2,242*e,2)}c=Math.floor(c/1E3)+"s";ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+this.bgRect.h/2+60+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+this.bgRect.h/2+60)}c=
"";1<this.playersJoined&&(c+=this.playersJoined-1);c=1<this.playersJoined-1?c+_STRINGS.UI[" Players Found"]:0<this.playersJoined-1?c+_STRINGS.UI[" Player Found"]:c+_STRINGS.UI["No Players Found"];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="14px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+this.bgRect.h/2+90+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+this.bgRect.h/2+90);this.showOvertimeFlag&&
this.playersJoined<this.maxPlayerSize&&(c=_STRINGS.UI["You May Continue to Wait"]+" "+_STRINGS.UI["or Try Casual Play"],ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202))),b.font="14px leaguespartan, Impact, Charcoal, sans-serif",b.textAlign="center",b.fillStyle="rgba(0,0,0,0.5)",b.fillText(c,this.pos.x+1,d+this.bgRect.h/2+115+1),b.fillStyle="#FFFFFF",b.fillText(c,this.pos.x,d+this.bgRect.h/2+115),this.playButton.draw());this.backButton.draw()}},update:function(){if(!this.hidden){if(this.transitionIn){var b=
ig.system.clock.delta()-this.transitionTime,b=b/this.transitionDuration;1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+
this.offset.y}else this.transitionOut&&(b=ig.system.clock.delta()-this.transitionTime,b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y);this.showOvertimeFlag&&this.playButton.update();this.backButton.update();
this.playerSlots&&this.playerSlots.update()}},show:function(){if(this.hidden&&!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();this.showOvertimeFlag=this.hidden=!1}},showDone:function(){},hide:function(){if(!this.hidden&&!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-
this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=!0;this.showOvertimeFlag=!1;this.hideDoneCallback&&"function"==typeof this.hideDoneCallback&&this.hideDoneCallback()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},backButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");
this.hide();this.control.cancelMatchmaking()},playButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.hide();this.control.requestingArena=!1;this.hideDoneCallback=function(){this.moregames&&this.moregames.enable();this.playButton.enable();this.optionsButton.enable();this.tutorialButton.enable();this.textinput.show();this.optionsPanel.hideDoneCallback=null;this.playGame()}.bind(this.control);var b={};b.playerId=ig.game.network_game.playerId;
ig.game.cancelRequestGame(b)},processGameMeta:function(b){b.timeExpired&&(this.showOvertimeFlag=!0);b.players&&(this.playersJoined=b.players.length,this.playerSlots.playerList=b.players);b.roomSize&&(this.maxPlayerSize=b.roomSize,this.playerSlots.gameSize=b.roomSize);this.playerSlots.refresh()},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+
e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}});MatchmakingPlayerSlots=ig.Class.extend({pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},gameSize:0,slots:[],playerList:[],spacing:16,slotRect:{x:-35,y:-45,w:70,h:70},init:function(b){this.parent=b;this.rect.w=420;this.rect.h=100;this.rect.x=-this.rect.w/2;this.rect.y=-this.rect.h/2},update:function(){},draw:function(){var b=ig.system.context;b.save();
this.parent&&(b.globalAlpha=this.parent.alpha);var c=this.pos.x,d=this.pos.y;b.translate(c,d);for(var e=0,f=this.slots.length;e<f;e++){var g=this.slots[e],n=g.rect.w;g.player?(c=g.pos.x,d=g.pos.y-10,b.fillStyle="rgba(255,255,255,0.8)",b.beginPath(),b.arc(c,d,32,0,2*Math.PI),b.fill(),g.avatar&&(c=g.pos.x,d=g.pos.y-10,g.avatar.draw(c,d)),c=g.pos.x,d=g.pos.y,d+=42,g=g.player.name,b.font="9px leaguespartan, Impact, Charcoal, sans-serif",b.measureText(g).width>n&&(b.font="6px leaguespartan, Impact, Charcoal, sans-serif"),
b.textAlign="center",b.fillStyle="rgba(0,0,0,0.5)",b.fillText(g,c+1,d+1),b.fillStyle="#FFFFFF",b.fillText(g,c,d)):(c=g.pos.x,d=g.pos.y-10,b.fillStyle="rgba(255,255,255,0.2)",b.beginPath(),b.arc(c,d,32,0,2*Math.PI),b.fill())}b.restore()},refresh:function(){var b=0,c=this.slotRect.w+this.spacing;1<this.gameSize&&(b=-c*((this.gameSize-1)/2));this.slots=[];for(var d=0,e=this.gameSize;d<e;d++){var f={pos:{}};f.pos.x=b+d*c;f.pos.y=0;f.rect=this.slotRect;this.slots.push(f)}b=Math.floor(this.slots.length/
2);1<this.playerList.length&&(b+=Math.floor(this.playerList.length/2));d=0;for(e=this.playerList.length;d<e;d++)if(c=this.playerList[d],f=this.slots[b-d])f.player=c,f.avatar=new Avatar(c.avatarId)},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,
d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.classes.casualplay-panel").requires("plugins.button","plugins.text-container").defines(function(){CasualplayPanel=ig.Class.extend({pos:{x:0,y:0},bgAlpha:0,maxBgAlpha:0.6,buttonImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png"),alpha:1,transitionDuration:0.2,transitionTime:0,transitionIn:!1,transitionOut:!1,hidden:!0,offset:{x:0,y:0},relStartPos:{x:0,y:0},endPos:{x:0,y:0},bgRect:{x:0,y:0,w:0,h:0},backButton:null,playButton:null,startTime:null,
hideDoneCallback:null,control:null,init:function(b){this.control=b},ready:function(){this.relStartPos.y=-ig.system.height;this.endPos.x=ig.system.width/2;this.endPos.y=ig.system.height/2;this.pos.x=this.endPos.x+this.relStartPos.x;this.pos.y=this.endPos.y+this.relStartPos.y;this.bgRect.w=480;this.bgRect.h=360;this.bgRect.x=-this.bgRect.w/2;this.bgRect.y=-this.bgRect.h/2;var b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this);d.setPos({x:this.bgRect.x+60,y:-this.bgRect.y-20});
d.posRelativeTo=this;d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.textOffset.x=0;d.textOffset.y=2;d.textShadowDisabled=!1;d.textShadowColor="rgba(0,0,0,0.5)";d.setTextColor({r:255,g:255,b:255});d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=16;b=_STRINGS.UI.Back;ig.global.addTextSpacing&&(b=b.split("").join(String.fromCharCode(8202)));d.setText(b);d.textShadowOffset={x:1,y:1};d.clickedFunction=this.backButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=
1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);this.backButton=d},draw:function(){if(!this.hidden){var b=ig.system.context;0<this.bgAlpha&&(b.save(),b.globalAlpha=this.bgAlpha,b.fillStyle="#000000",b.fillRect(0,0,ig.system.width,ig.system.height),b.restore());var c=this.pos.x+this.bgRect.x,d=this.pos.y+this.bgRect.y;b.save();b.globalAlpha=this.alpha;b.fillStyle="rgba(0,0,0,0.95)";this.roundRect(b,c,d,this.bgRect.w,this.bgRect.h,10,!0,!1);b.restore();d=this.pos.y+
this.bgRect.y;c=_STRINGS.UI["Connecting to the Server"];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+this.bgRect.h/2-10+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+this.bgRect.h/2-10);c=_STRINGS.UI["Please Wait"];ig.global.addTextSpacing&&(c=c.split("").join(String.fromCharCode(8202)));b.font="20px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(c,this.pos.x+1,d+this.bgRect.h/2+30+1);b.fillStyle="#FFFFFF";b.fillText(c,this.pos.x,d+this.bgRect.h/2+30);this.backButton.draw()}},update:function(){if(!this.hidden){if(this.transitionIn){var b=ig.system.clock.delta()-this.transitionTime,b=b/this.transitionDuration;1<b&&(b=1);this.alpha=b;this.bgAlpha=this.maxBgAlpha*b;if(0.8>b){var c=b/0.8;this.offset.x=(1-c)*this.relStartPos.x;this.offset.y=(1-c)*this.relStartPos.y}else 1>b?(c=(b-0.8)/
0.2*Math.PI,this.offset.x=-0.05*this.relStartPos.x*Math.sin(c),this.offset.y=-0.05*this.relStartPos.y*Math.sin(c)):(this.offset.x=0,this.offset.y=0);1<=b&&(this.transitionIn=!1,this.showDone());this.pos.x=this.endPos.x+this.offset.x;this.pos.y=this.endPos.y+this.offset.y}else this.transitionOut&&(b=ig.system.clock.delta()-this.transitionTime,b/=this.transitionDuration,1<b&&(b=1),this.alpha=1-b,this.bgAlpha=this.maxBgAlpha*(1-b),1>b?(this.offset.x=b*this.relStartPos.x,this.offset.y=b*this.relStartPos.y):
(this.offset.x=this.relStartPos.x,this.offset.y=this.relStartPos.y),1<=b&&(this.transitionOut=!1,this.hideDone()),this.pos.x=this.endPos.x+this.offset.x,this.pos.y=this.endPos.y+this.offset.y);this.backButton.update()}},show:function(){if(this.hidden&&!this.transitionIn){if(this.transitionOut){this.transitionOut=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b&&(this.transitionIn=!0,this.transitionTime+=b)}else this.transitionIn=!0,this.transitionTime=ig.system.clock.delta();this.hidden=!1}},
showDone:function(){},hide:function(){if(!this.hidden&&!this.transitionOut)if(this.transitionIn){this.transitionIn=!1;var b=ig.system.clock.delta()-this.transitionTime;0<b?(this.transitionOut=!0,this.transitionTime+=b):this.hidden=!0}else this.transitionOut=!0,this.transitionTime=ig.system.clock.delta()},hideDone:function(){this.hidden=!0;this.hideDoneCallback&&"function"==typeof this.hideDoneCallback&&this.hideDoneCallback()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&
b.y+b.h>=c.y},backButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.hide();this.control.cancelMatchmaking()},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,
d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.classes.avatar-selector").requires("game.classes.avatar").defines(function(){AvatarSelector=ig.Class.extend({pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},blockRect:{x:0,y:0,w:0,h:0},viewRect:{x:0,y:0,w:0,h:0},blocksCanvas:null,blockSpacing:10,maxBlockSize:3,viewMod:{x:0,y:0,w:0,h:0},blocks:[],block_offset:{x:0,y:0},prevButton:null,nextButton:null,expandedFlag:!1,shrinkingFlag:!1,shrinkAnimTime:0,shrinkAnimDuration:0.15,expandingFlag:!1,expandAnimTime:0,expandAnimDuration:0.15,slideAnimFlag:!1,
slideAnimTime:0,slideAnimDuration:0.15,slideOffset:{x:0,y:0},autoshrinkFlag:!1,autoshrinkTime:0,autoshrinkDuration:5,maxExpandWidth:0,prevButtonOffset:{x:0,y:0},nextButtonOffset:{x:0,y:0},currentShownAvatarId:0,init:function(b){this.control=b;this.rect.w=70;this.rect.h=70;this.rect.x=-this.rect.w/2;this.rect.y=-this.rect.h/2;this.blockRect.w=70;this.blockRect.h=70;this.blockRect.x=-this.blockRect.w/2;this.blockRect.y=-this.blockRect.h/2;this.maxExpandWidth=this.blockRect.w+this.blockSpacing;this.numAvatars=
(new Avatar(0)).images.length;this.currentShownAvatarId=ig.game.avatarId;this.refreshBlocks();this.createBlocksCanvas();this.shrinkingFlag=this.expandingFlag=this.expandedFlag=!1;this.viewMod.w=this.blockRect.w-this.viewRect.w;this.viewMod.x=Math.floor(this.maxBlockSize/2)*this.blockRect.w+this.blockSpacing;this.prevButtonOffset.x=-this.rect.w/2-30;var c=b=32,d=this.prevButtonOffset.x,e=0,f=new ig.Button(this);f.setPos({x:d,y:e});f.setRect({x:-b/2,y:-c/2,w:b,h:c});f.posRelativeTo=this;f.clickedFunction=
this.prevButtonPressed.bind(this);f.downOffset={x:0,y:1};f.overOffset={x:0,y:-1};f.overScaleMultiplier=1;f.downScaleMultiplier=1;f.btnShadowDisabled=!0;this.prevButton=f;this.nextButtonOffset.x=this.rect.w/2+30;c=b=32;d=this.nextButtonOffset.x;e=0;f=new ig.Button(this);f.setPos({x:d,y:e});f.setRect({x:-b/2,y:-c/2,w:b,h:c});f.posRelativeTo=this;f.clickedFunction=this.nextButtonPressed.bind(this);f.downOffset={x:0,y:1};f.overOffset={x:0,y:-1};f.overScaleMultiplier=1;f.downScaleMultiplier=1;f.btnShadowDisabled=
!0;this.nextButton=f},update:function(){this.shrinkingFlag?this.playShrinkAnim():this.expandingFlag&&this.playExpandAnim();if(this.prevButton){var b=this.prevButtonOffset.x,c=this.prevButtonOffset.y;this.prevButton.setPos({x:b,y:c});this.prevButton.update()}this.nextButton&&(b=this.nextButtonOffset.x,c=this.nextButtonOffset.y,this.nextButton.setPos({x:b,y:c}),this.nextButton.update());this.autoshrinkFlag&&(this.autoshrinkTime>=this.autoshrinkDuration?(this.autoshrinkTime=0,this.shrink(),this.autoshrinkFlag=
!1):this.autoshrinkTime+=ig.system.tick);this.slideAnimFlag?this.playSlideAnim():this.checkAvatarClicks()},draw:function(){var b=ig.system.context;if(this.blocksCanvas&&0<this.blocksCanvas.width&&0<this.blocksCanvas.height){var c=this.viewRect.w+this.viewMod.w,d=this.viewRect.h+this.viewMod.h,e=this.pos.x-c/2,f=this.pos.y-d/2,g;g=0+(this.viewRect.x+this.viewMod.x+this.block_offset.x);g+=this.viewRect.y+this.viewMod.y+this.block_offset.y;c>this.blocksCanvas.width-g&&(c=this.blocksCanvas.width-g);d>
this.blocksCanvas.height-0&&(d=this.blocksCanvas.height-0);b.drawImage(this.blocksCanvas,g,0,c,d,e,f,c,d)}this.drawExpandedEffects();this.prevButton&&(c=this.prevButton,c.draw(),e=this.pos.x+c.pos.x,f=this.pos.y+c.pos.y,c.down?(e+=c.downOffset.x,f+=c.downOffset.y):c.over&&(e+=c.overOffset.x,f+=c.overOffset.y),b.beginPath(),b.arc(e,f,16,0,2*Math.PI),b.fillStyle="rgba(0,0,0,0.7)",b.fill(),b.beginPath(),b.moveTo(e-8,f),b.lineTo(e+4,f+9),b.lineTo(e+4,f-9),b.closePath(),b.fillStyle="#fff",b.fill());this.nextButton&&
(c=this.nextButton,c.draw(),e=this.pos.x+c.pos.x,f=this.pos.y+c.pos.y,c.down?(e+=c.downOffset.x,f+=c.downOffset.y):c.over&&(e+=c.overOffset.x,f+=c.overOffset.y),b.beginPath(),b.arc(e,f,16,0,2*Math.PI),b.fillStyle="rgba(0,0,0,0.7)",b.fill(),b.beginPath(),b.moveTo(e+8,f),b.lineTo(e-4,f+9),b.lineTo(e-4,f-9),b.closePath(),b.fillStyle="#fff",b.fill())},shrink:function(){this.shrinkingFlag||(this.shrinkingFlag=!0,this.expandingFlag=!1,0!=this.expandAnimTime&&(this.shrinkAnimTime=this.shrinkAnimDuration-
this.expandAnimTime,this.expandAnimTime=0))},expand:function(){!this.expandingFlag&&!this.expandedFlag&&(this.expandingFlag=!0,this.shrinkingFlag=!1,0!=this.shrinkAnimTime&&(this.expandAnimTime=this.expandAnimDuration-this.shrinkAnimTime,this.shrinkAnimTime=0))},playShrinkAnim:function(){if(this.shrinkAnimTime>=this.shrinkAnimDuration)this.shrinkAnimTime=0,this.expandedFlag=this.shrinkingFlag=!1,this.prevButtonOffset.x=-this.rect.w/2-30,this.nextButtonOffset.x=this.rect.w/2+30,this.viewMod.w=this.blockRect.w-
this.viewRect.w,this.viewMod.x=Math.floor(this.maxBlockSize/2)*this.blockRect.w+this.blockSpacing;else{this.shrinkAnimTime+=ig.system.tick;var b=1-this.shrinkAnimTime/this.shrinkAnimDuration;1<b&&(b=1);0>b&&(b=0);var c=this.maxExpandWidth;this.prevButtonOffset.x=-this.rect.w/2-30-b*c;this.nextButtonOffset.x=this.rect.w/2+30+b*c;this.viewMod.w=(1-b)*(this.blockRect.w-this.viewRect.w);this.viewMod.x=(1-b)*(Math.floor(this.maxBlockSize/2)*this.blockRect.w+this.blockSpacing)}},playExpandAnim:function(){if(this.expandAnimTime>=
this.expandAnimDuration)this.expandAnimTime=0,this.expandingFlag=!1,this.expandedFlag=!0,"function"==typeof this.expandCallback&&this.expandCallback(),this.prevButtonOffset.x=-this.rect.w/2-30-this.maxExpandWidth,this.nextButtonOffset.x=this.rect.w/2+30+this.maxExpandWidth,this.viewMod.w=0,this.viewMod.x=0;else{this.expandAnimTime+=ig.system.tick;var b=this.expandAnimTime/this.expandAnimDuration;1<b&&(b=1);0>b&&(b=0);var c=this.maxExpandWidth;this.prevButtonOffset.x=-this.rect.w/2-30-b*c;this.nextButtonOffset.x=
this.rect.w/2+30+b*c;this.viewMod.w=(1-b)*(this.blockRect.w-this.viewRect.w);this.viewMod.x=(1-b)*(Math.floor(this.maxBlockSize/2)*this.blockRect.w+this.blockSpacing)}},playSlideAnim:function(){this.slideAnimTime>=this.slideAnimDuration?(this.slideAnimTime=0,this.slideAnimFlag=!1,this.block_offset.x=0,this.slideOffset.x=0):(this.slideAnimTime+=ig.system.tick,this.block_offset.x=this.slideOffset.x*(1-this.slideAnimTime/this.slideAnimDuration))},prevButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&
ig.soundHandler.sfxPlayer.play("button");this.autoshrinkTime=0;this.autoshrinkFlag=!0;this.expandedFlag?this.slideToAvatarId(ig.game.avatarId+1):(this.expand(),this.expandCallback=function(){this.slideToAvatarId(ig.game.avatarId+1);this.expandCallback=null}.bind(this))},nextButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.autoshrinkTime=0;this.autoshrinkFlag=!0;this.expand();this.expandedFlag?this.slideToAvatarId(ig.game.avatarId-1):
(this.expand(),this.expandCallback=function(){this.slideToAvatarId(ig.game.avatarId-1);this.expandCallback=null}.bind(this))},slideToAvatarId:function(b){if(!(isNaN(b)||null==b))if(isNaN(ig.game.avatarId)&&(ig.game.avatarId=0),b=ig.game.avatarId-b,0!=b){var c=Math.abs(b),c=c*this.blockRect.w+c*this.blockSpacing;this.block_offset.x=0>b?this.block_offset.x+c:this.block_offset.x-c;this.slideOffset.x=this.block_offset.x;this.slideAnimFlag=!0;this.slideAnimTime=0;ig.game.avatarId+=b;0>ig.game.avatarId?
ig.game.avatarId=this.numAvatars-1:ig.game.avatarId>=this.numAvatars&&(ig.game.avatarId=0);this.currentShownAvatarId=ig.game.avatarId;this.refreshBlocks();this.createBlocksCanvas();ig.game.savePlayerStats()}},refresh:function(){},refreshBlocks:function(){this.blocks=[];for(var b=this.maxBlockSize+2,c=this.currentShownAvatarId-Math.floor(b/2),d=0;d<b;d++){var e=c+d;0>e?e=this.numAvatars+e:e>=this.numAvatars&&(e=0+(e-this.numAvatars));var f={};f.avatar=new Avatar(e);e!=this.currentShownAvatarId&&(f.avatar.alpha=
0.6);this.blocks.push(f)}},createBlocksCanvas:function(){this.blocksCanvas=null;var b=this.blocks.length;if(0!=b){var c=this.blockRect.w*b+(b-1)*this.blockSpacing,d=this.blockRect.h;this.blocksCanvas=ig.$new("canvas");this.blocksCanvas.width=c;this.blocksCanvas.height=d;for(var b=this.blockRect.w/2,e=this.blockRect.h/2,f=this.blocksCanvas.getContext("2d"),g=0,n=this.blocks.length;g<n;g++){var l=this.blocks[g],m=g*this.blockRect.w+g*this.blockSpacing;l.avatar&&l.avatar.draw(b+m,e,f)}b=this.maxBlockSize;
this.viewRect.w=this.blockRect.w*b+(b-1)*this.blockSpacing;this.viewRect.h=d;this.viewRect.x=(c-this.viewRect.w)/2;this.viewRect.y=0}},checkAvatarClicks:function(){if(!this.expandingFlag&&!this.shrinkingFlag&&ig.input.state("click")){var b=this.getInputPos(),c={};c.x=b.x;c.y=b.y;c.w=1;c.h=1;var b=this.viewRect.h+this.viewMod.h,d=this.pos.x,e=this.pos.y;if(this.blocks.length>this.maxBlockSize)for(var f=Math.floor(this.blocks.length/2),g=Math.floor((this.blocks.length-this.maxBlockSize)/2),n=0,l=this.maxBlockSize;n<
l;n++){var m=n-Math.floor(l/2),r=d+m*(this.blockRect.w+this.blockSpacing),r=r-this.blockRect.w/2,q={};q.x=r;q.y=e-b/2;q.w=this.blockRect.w;q.h=this.blockRect.h;if(this.aabbCheck(c,q)){this.expandedFlag?(ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button"),g+n==f?(this.shrink(),this.autoshrinkFlag=!1):(this.slideToAvatarId(this.currentShownAvatarId-m),this.autoshrinkTime=0,this.autoshrinkFlag=!0)):g+n==f&&(ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button"),
this.expand(),this.autoshrinkTime=0,this.autoshrinkFlag=!0);break}}}},drawExpandedEffects:function(){var b=ig.system.context,c=this.pos.x,d=this.pos.y;if(this.blocks.length>this.maxBlockSize)for(var e=Math.floor((this.blocks.length-this.maxBlockSize)/2),f=0,g=this.maxBlockSize;f<g;f++){var n=this.blocks[e+f],l=c+(f-Math.floor(g/2))*(this.blockRect.w+this.blockSpacing),l=l-this.block_offset.x;if(n.avatar.id==this.currentShownAvatarId&&(this.expandedFlag||this.expandingFlag)){n=1-this.shrinkAnimTime/
this.shrinkAnimDuration;this.expandingFlag&&(n=this.expandAnimTime/this.expandAnimDuration);1<n&&(n=1);0>n&&(n=0);var m;m=d;b.save();b.globalAlpha=n;n=b.createRadialGradient(l,m,25,l,m,35);n.addColorStop(0,"rgba(247,174,30,0)");n.addColorStop(0.4,"rgba(247,174,30,1)");n.addColorStop(0.6,"rgba(247,174,30,1)");n.addColorStop(1,"   rgba(247,174,30,0)");b.strokeStyle=n;b.lineWidth=10;b.beginPath();b.arc(l,m,30,0,2*Math.PI);b.stroke();b.restore()}}},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&
(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},getInputPos:function(){return ig.game.io.getClickPos()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y}})});ig.baked=!0;
ig.module("plugins.textinput-container").defines(function(){ig.TextinputContainer=ig.Class.extend({containerName:"text_input_container",textInputName:"text_input",containerElement:null,textInputElement:null,textFontSize:14,textFont:"Impact, Charcoal, sans-serif",maxTextLength:100,defaultValue:"",pos:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},init:function(b,c,d,e,f,g,n){b&&(this.textInputName=b,this.containerName=b+"_container");c&&(this.textFontSize=c);d&&(this.textFont=d);null!=e&&(this.maxTextLength=e);
null!=f&&(this.defaultValue=f);!isNaN(g)&&!isNaN(n)&&this.setRect(-g/2,-n/2,g,n);this.spawnTextInput()},setRect:function(b,c,d,e){!isNaN(b)&&(!isNaN(c)&&!isNaN(d)&&!isNaN(e))&&(this.rect.x=b,this.rect.y=c,this.rect.w=d,this.rect.h=e,this.updateElementPosition())},setPos:function(b,c){!isNaN(b)&&!isNaN(c)&&(this.pos.x=b,this.pos.y=c,this.updateElementPosition())},updateElementPosition:function(){var b=this.containerName;if(ig.domHandler.getElementById("#"+b)){var c,d;c=this.pos.x+this.rect.x;d=this.pos.y+
this.rect.y;var e=this.rect,f=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,ig.sizeHandler.scaleRatioMultiplier.y),g=this.containerElement;if(ig.ua.mobile)var n=Math.floor(c*ig.sizeHandler.scaleRatioMultiplier.x)+"px",l=Math.floor(d*ig.sizeHandler.scaleRatioMultiplier.y)+"px",m=Math.floor(e.w*ig.sizeHandler.scaleRatioMultiplier.x)+"px",f=Math.floor(e.h*ig.sizeHandler.scaleRatioMultiplier.y)+"px";else n=ig.domHandler.getElementById("#canvas"),n=ig.domHandler.getOffsets(n),l=n.top,n=Math.floor(n.left+
c*f)+"px",l=Math.floor(l+d*f)+"px",m=Math.floor(e.w*f)+"px",f=Math.floor(e.h*f)+"px";ig.domHandler.css(g,{"float":"left",position:"absolute",left:n,top:l,width:m,height:f,"z-index":3});ig.sizeHandler.dynamicClickableEntityDivs[b]={};ig.sizeHandler.dynamicClickableEntityDivs[b].width=e.w;ig.sizeHandler.dynamicClickableEntityDivs[b].height=e.h;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_x=c;ig.sizeHandler.dynamicClickableEntityDivs[b].entity_pos_y=d}},show:function(){this.containerElement&&
(ig.domHandler.show(this.containerElement),ig.domHandler.show(this.textInputElement))},hide:function(){this.containerElement&&(ig.domHandler.hide(this.containerElement),ig.domHandler.hide(this.textInputElement))},val:function(b){return!this.textInputElement?"":null==b?this.textInputElement.val():this.textInputElement.val(b)},spawnTextInput:function(){var b,c;b=this.pos.x+this.rect.x;c=this.pos.y+this.rect.y;var d=this.rect,e=this.containerName,f=this.textInputName,g=ig.domHandler.getElementById("#"+
e),n=ig.domHandler.getElementById("#"+f);if(g&&n)this.containerElement=$("#"+e),this.textInputElement=$("#"+f),ig.domHandler.show(this.containerElement),ig.domHandler.show(this.textInputElement);else{g=ig.domHandler.create("div");ig.domHandler.attr(g,"id",e);g.blur(function(b){b.stopPropagation()});this.containerElement=g;n=ig.domHandler.create("input");ig.domHandler.attr(n,"id",f);n.blur(function(b){b.stopPropagation()});this.textInputElement=n;var l=Math.min(ig.sizeHandler.scaleRatioMultiplier.x,
ig.sizeHandler.scaleRatioMultiplier.y),m=this.textFontSize*l;if(ig.ua.mobile)var r=Math.floor(b*ig.sizeHandler.scaleRatioMultiplier.x)+"px",q=Math.floor(c*ig.sizeHandler.scaleRatioMultiplier.y)+"px",s=Math.floor(d.w*ig.sizeHandler.scaleRatioMultiplier.x)+"px",l=Math.floor(d.h*ig.sizeHandler.scaleRatioMultiplier.y)+"px";else r=ig.domHandler.getElementById("#canvas"),r=ig.domHandler.getOffsets(r),q=r.top,r=Math.floor(r.left+b*l)+"px",q=Math.floor(q+c*l)+"px",s=Math.floor(d.w*l)+"px",l=Math.floor(d.h*
l)+"px";ig.domHandler.css(g,{"float":"left",position:"absolute",left:r,top:q,width:s,height:l,"z-index":3});ig.domHandler.css(n,{width:"100%",height:"100%","font-family":this.textFont,"font-size":m+"px","z-index":3});ig.domHandler.css(n,{});n.attr("maxlength",this.maxTextLength);n.attr("size",this.maxTextLength);n.attr("autocomplete","off");n.attr("autocapitalize","off");n.attr("autocorrect","off");n.val(this.defaultValue);n.keyup(function(b){13==b.keyCode&&this.textInputElement.blur()}.bind(this));
ig.domHandler.addEvent(g,"mousemove",ig.input.mousemove.bind(ig.input),!1);ig.domHandler.appendChild(g,n);ig.domHandler.appendToBody(g);ig.sizeHandler.dynamicClickableEntityDivs[e]={};ig.sizeHandler.dynamicClickableEntityDivs[e].width=d.w;ig.sizeHandler.dynamicClickableEntityDivs[e].height=d.h;ig.sizeHandler.dynamicClickableEntityDivs[e].entity_pos_x=b;ig.sizeHandler.dynamicClickableEntityDivs[e].entity_pos_y=c;ig.sizeHandler.dynamicClickableEntityDivs[f]={};ig.sizeHandler.dynamicClickableEntityDivs[f]["font-size"]=
this.textFontSize}}})});ig.baked=!0;
ig.module("game.entities.home-control").requires("impact.entity","plugins.fade-transition","plugins.button","plugins.image-extension","game.entities.button-more-games","game.classes.options-panel","game.classes.connectionfailed-panel","game.classes.connecting-panel","game.classes.matchmaking-panel","game.classes.casualplay-panel","game.classes.tutorial-panel","game.classes.avatar-selector","plugins.textinput-container").defines(function(){EntityHomeControl=ig.Entity.extend({zIndex:100,isHome:!0,bgImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/mainbg.png"),
titleImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/maintitle.png"),buttonImage:new ig.Image("http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png"),bgOffset:{x:0,y:0},bgScale:1,upgradeNoticeFlag:!1,playButton:null,optionsButton:null,tutorialButton:null,moregames:null,matchmakingPanel:null,casualplayPanel:null,optionsPanel:null,tutorialPanel:null,connectionFailedPanel:null,connectingPanel:null,fadeTransition:null,menuPaused:!1,mainMenuAlpha:1,maxNameLength:12,
textinput:null,textInputPos:null,textInputRect:null,avatar_selector:null,titlePos:{x:0,y:0},init:function(b,c,d){this.parent(b,c,d);ig.global.wm||(this.avatar_selector=new AvatarSelector(this),this.avatar_selector.pos.x=ig.system.width/2,this.avatar_selector.pos.y=ig.system.height/2+20,this.bgImage&&(c=b=0,this.bgImage.width*this.bgScale<ig.system.width&&(this.bgScale=d=ig.system.width/this.bgImage.width),this.bgImage.height*this.bgScale<ig.system.height&&(this.bgScale=d=ig.system.height/this.bgImage.height),
this.bgImage.width*this.bgScale>ig.system.width&&(b=-(this.bgImage.width*this.bgScale-ig.system.width)/2),this.bgImage.height*this.bgScale>ig.system.height&&(c=-(this.bgImage.height*this.bgScale-ig.system.height)/2),this.bgOffset.x=this.bitwiseRound(b),this.bgOffset.y=this.bitwiseRound(c)),this.titlePos.x=ig.system.width/2,this.titlePos.y=130,this.initButtons(),this.textInputPos={},this.textInputPos.x=ig.system.width/2,this.textInputPos.y=ig.system.height/2+90,this.textInputRect={},this.textInputRect.w=
200,this.textInputRect.h=30,this.textInputRect.x=-this.textInputRect.w/2,this.textInputRect.y=-this.textInputRect.h/2,this.textinput=new ig.TextinputContainer("home_player_name",16,"leaguespartan, Impact, Charcoal, sans-serif",this.maxNameLength),b=this.textInputPos.x,c=this.textInputPos.y,d=this.textInputRect,this.textinput.setRect(d.x,d.y,d.w,d.h),this.textinput.setPos(b,c),ig.domHandler.css(this.textinput.textInputElement,{margin:"0px",border:"0px",padding:"3px 0px 0px 0px",background:"none",color:"rgba(0,0,0,0)",
"text-align":"center"}),this.textinput.val(ig.game.playerName),(b=ig.domHandler.getElementById("#chatbox_input_container"))&&ig.domHandler.hide(b))},ready:function(){if(!ig.global.wm&&(ig.game.network_client.gameStateUpdateCallback=null,ig.soundHandler.bgmPlayer.bgmPlaying||ig.soundHandler.bgmPlayer.play(),this.fadeTransition=new ig.FadeTransition,!ig.game.network_client.socket||ig.game.network_client.socket.disconnected))this.showConnecting(),this.connectingPanel.showDoneCallback=function(){setTimeout(function(){this.connectToServer()}.bind(this),
1E3)}.bind(this)},initButtons:function(){this.optionsPanel=new OptionsPanel(this);this.optionsPanel.ready();this.connectionFailedPanel=new ConnectionFailedPanel(this);this.connectionFailedPanel.ready();this.connectingPanel=new ConnectingPanel(this);this.connectingPanel.ready();this.matchmakingPanel=new MatchmakingPanel(this);this.matchmakingPanel.ready();this.casualplayPanel=new CasualplayPanel(this);this.casualplayPanel.ready();this.tutorialPanel=new TutorialPanel(this);this.tutorialPanel.hideDoneCallback=
function(){this.moregames&&this.moregames.enable();this.playButton.enable();this.optionsButton.enable();this.tutorialButton.enable()}.bind(this);this.tutorialPanel.ready();var b=this.buttonImage.width,c=this.buttonImage.height,d=new ig.Button(this);d.setPos({x:ig.system.width/2,y:0.5*ig.system.height+135});d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.posRelativeTo=this;d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=20;d.setTextColor({r:255,g:255,b:255});d.setText(_STRINGS.UI["Casual Play"]);
d.textOffset.x=0;d.textOffset.y=2;d.textAlpha=1;d.clickedFunction=this.playButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);d.btnShadowDisabled=!0;this.playButton=d;b=this.buttonImage.width;c=this.buttonImage.height;d=new ig.Button(this);d.setPos({x:ig.system.width/2,y:0.5*ig.system.height+180});d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.posRelativeTo=this;d.setFont(12,
"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=20;d.setTextColor({r:255,g:255,b:255});d.setText(_STRINGS.UI.Options);d.textOffset.x=0;d.textOffset.y=2;d.textAlpha=1;d.clickedFunction=this.optionsButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);d.btnShadowDisabled=!0;this.optionsButton=d;b=this.buttonImage.width;c=this.buttonImage.height;d=new ig.Button(this);
d.setPos({x:ig.system.width/2,y:0.5*ig.system.height+225});d.setRect({x:-b/2,y:-c/2,w:b,h:c});d.posRelativeTo=this;d.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");d.textLineHeight=20;d.setTextColor({r:255,g:255,b:255});d.setText(_STRINGS.UI.Rules);d.textOffset.x=0;d.textOffset.y=2;d.textAlpha=1;d.clickedFunction=this.tutorialButtonPressed.bind(this);d.downOffset={x:0,y:1};d.overOffset={x:0,y:-1};d.overScaleMultiplier=1;d.downScaleMultiplier=1;d.buttonType=ig.BUTTONTYPE.IMAGE;d.setUpImage(this.buttonImage);
d.btnShadowDisabled=!0;this.tutorialButton=d;_SETTINGS.MoreGames.Enabled&&(this.moregames=ig.game.spawnEntity(EntityButtonMoreGames,0,0),this.moregames.pos.x=25,this.moregames.pos.y=ig.system.height-50,this.moregames.ready())},draw:function(){if(0!=this.mainMenuAlpha){var b=ig.system.context;b.globalAlpha=this.mainMenuAlpha;this.drawMainMenu();this.drawPlayerCount();this.optionsButton.draw();this.playButton.draw();this.tutorialButton.draw();this.moregames&&!this.moregames.hidden&&this.moregames.drawImage();
this.avatar_selector&&this.avatar_selector.draw();var c=this.textInputPos.x,d=this.textInputPos.y;b.fillStyle="rgba(0,0,0,0.7)";b.fillRect(c+this.textInputRect.x,d+this.textInputRect.y,this.textInputRect.w,this.textInputRect.h+3);var d=d+3,e=this.textinput.val();b.font="16px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(e,c+1,d+1);b.fillStyle="#FFFFFF";b.fillText(e,c,d);d-=26;e=_STRINGS.UI["Enter Your Name"];ig.global.addTextSpacing&&(e=
e.split("").join(String.fromCharCode(8202)));b.font="12px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(e,c+1,d+1);b.fillStyle="#FFFFFF";b.fillText(e,c,d);this.upgradeNoticeFlag&&this.drawUpgradeNotice();this.matchmakingPanel.draw();this.casualplayPanel.draw();this.optionsPanel.draw();this.tutorialPanel.draw();this.connectionFailedPanel.draw();this.connectingPanel.draw();b.globalAlpha=1;this.fadeTransition&&this.fadeTransition.draw()}},
update:function(){this.fadeTransition&&this.fadeTransition.update();this.menuPaused||(this.updateMainMenu(),this.optionsButton.update(),this.playButton.update(),this.tutorialButton.update(),this.connectionFailedPanel.update(),this.connectingPanel.update(),this.matchmakingPanel.update(),this.casualplayPanel.update(),this.optionsPanel.update(),this.tutorialPanel.update(),this.connectionFailedPanel.hidden||ig.input.pressed("click")&&this.connectToServer(),this.textinput&&this.textinput.textInputElement&&
ig.input.state("click")&&this.textinput.textInputElement.blur(),this.avatar_selector&&!this.playButton.disabled&&this.avatar_selector.update())},playGame:function(){if(ig.game.network_client.socket&&!ig.game.network_client.socket.disconnected&&!this.requestingArena){this.requestingArena=!0;var b={};b.playerName=ig.game.playerName;b.avatarId=ig.game.avatarId;ig.game.network_game.requestGame(b,function(){this.showCasualplay()}.bind(this),function(){ig.game.resetApp();this.requestingArena=!1;this.upgradeNoticeFlag=
!0;console.log("requestGame failed")}.bind(this))}},playButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");if(this.textinput){var b=this.textinput.val();b&&"string"===typeof b&&(0<b.length&&b.length<=this.maxNameLength)&&(ig.game.playerName=b,ig.game.savePlayerStats(),this.playGame())}},optionsButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.showOptions()},tutorialButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&
ig.soundHandler.sfxPlayer.play("button");this.showTutorial()},disableBaseControls:function(){this.moregames&&this.moregames.disable();this.playButton.disable();this.optionsButton.disable();this.tutorialButton.disable();this.textinput.hide()},enableBaseControls:function(){this.moregames&&this.moregames.enable();this.playButton.enable();this.optionsButton.enable();this.tutorialButton.enable();this.textinput.show()},showOptions:function(){this.optionsButton.disabled||(this.disableBaseControls(),this.optionsPanel.show(),
this.optionsPanel.hideDoneCallback=function(){this.enableBaseControls();this.optionsPanel.hideDoneCallback=null}.bind(this))},showMatchmaking:function(){this.optionsButton.disabled||(this.disableBaseControls(),this.casualplayPanel.hide(),this.matchmakingPanel.show(),this.matchmakingPanel.hideDoneCallback=function(){this.enableBaseControls();this.optionsPanel.hideDoneCallback=null}.bind(this),this.matchmakingPanel.startTime=Date.now())},cancelMatchmaking:function(){this.matchmakingPanel.hide();this.requestingArena=
!1;this.matchmakingPanel.hideDoneCallback=function(){this.enableBaseControls();this.optionsPanel.hideDoneCallback=null}.bind(this);var b={};b.playerId=ig.game.network_game.playerId;ig.game.network_game.cancelRequestGame(b)},showCasualplay:function(){this.optionsButton.disabled||(this.disableBaseControls(),this.matchmakingPanel.hide(),this.casualplayPanel.show(),this.casualplayPanel.hideDoneCallback=function(){this.enableBaseControls();this.optionsPanel.hideDoneCallback=null}.bind(this),this.casualplayPanel.startTime=
Date.now())},cancelCasualplay:function(){this.casualplayPanel.hide();this.requestingArena=!1;this.matchmakingPanel.hideDoneCallback=function(){this.enableBaseControls();this.optionsPanel.hideDoneCallback=null}.bind(this);var b={};b.playerId=ig.game.network_game.playerId;ig.game.network_game.cancelRequestGame(b)},showTutorial:function(){this.tutorialPanel.disabled||(this.disableBaseControls(),this.tutorialPanel.show(),this.tutorialPanel.hideDoneCallback=function(){this.enableBaseControls();this.tutorialPanel.hideDoneCallback=
null}.bind(this))},showConnectionFailed:function(){this.reset();this.disableBaseControls();this.connectionFailedPanel.show()},hideConnectionFailed:function(){this.reset()},showConnecting:function(){this.reset();this.disableBaseControls();this.connectingPanel.show()},hideConnecting:function(){this.reset()},reset:function(){this.enableBaseControls();this.connectingPanel.hide();this.connectionFailedPanel.hide();this.casualplayPanel.hide();this.matchmakingPanel.hide();this.tutorialPanel.hide();this.optionsPanel.hide()},
pause:function(){this.menuPaused=!0;this.moregames&&this.moregames.disable()},unpause:function(){this.menuPaused=!1;this.moregames&&this.moregames.enable()},drawMainMenu:function(){var b=ig.system.context;this.bgImage?(b.save(),1!=this.bgScale&&(b.translate(this.bgOffset.x,this.bgOffset.y),b.scale(this.bgScale,this.bgScale)),this.bgImage.draw(0,0),b.restore()):(b.fillStyle="#777777",b.fillRect(0,0,ig.system.width,ig.system.height));this.titleImage.draw(this.titlePos.x-this.titleImage.width/2,this.titlePos.y-
this.titleImage.height/2)},updateMainMenu:function(){},drawPlayerCount:function(){if(ig.game.network_game){var b=ig.system.width-10,c;c=""+ig.game.network_game.userCount;c=1==ig.game.network_game.userCount?c+(" "+_STRINGS.UI["Player Online"]):c+(" "+_STRINGS.UI["Players Online"]);var d=ig.system.context;d.save();d.font="12px leaguespartan, Impact, Charcoal, sans-serif";d.textAlign="right";d.fillStyle="rgba(0,0,0,0.5)";d.fillText(c,b+1,21);d.fillStyle="#ffffff";d.fillText(c,b,20);d.restore()}},drawUpgradeNotice:function(){var b=
ig.system.width/2,c=ig.system.height-3,d;d=""+_STRINGS.UI["Game Request Rejected"];d=d+". "+_STRINGS.UI["Please Refresh the Client and Try Again"];var e=ig.system.context;e.save();e.font="10px leaguespartan, Impact, Charcoal, sans-serif";e.textAlign="center";e.fillStyle="rgba(0,0,0,0.5)";e.fillText(d,b+1,c+1);e.fillStyle="#fff";e.fillText(d,b,c);e.restore()},connectToServer:function(){ig.game.network_client&&ig.game.network_client.connect(function(){},function(){this.showConnectionFailed()}.bind(this))},
gameConfirmed:function(){if(this.requestingArena){this.requestingArena=!1;var b=!0,c=ig.global.initialGameState;if(c)if(c.players&&0==c.players.length)b=!1;else{if(c.players&&(c.players.length<c.minPlayerSize||c.players.length>c.maxPlayerSize))b=!1}else b=!1;b?(ig.input.clearPressed(),this.moregames&&this.moregames.disable(),ig.game.director.jumpTo(LevelGame)):this.cancelMatchmaking()}},gameMeta:function(b){this.requestingArena&&this.matchmakingPanel.processGameMeta(b)},bitwiseRound:function(b){return 0.5+
b<<0},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("game.levels.home").requires("impact.image","game.entities.home-control").defines(function(){LevelHome={entities:[{type:"EntityHomeControl",x:0,y:0}],layer:[]}});ig.baked=!0;
ig.module("game.classes.chatbox").requires("plugins.textinput-container").defines(function(){Chatbox=ig.Class.extend({pos:{x:0,y:0},rect:{x:0,y:0,w:250,h:125},contentPos:{x:5,y:3},contentRect:{x:0,y:0,w:220,h:92},contentCanvas:null,contentArray:[],textinput:null,textInputPos:null,textInputRect:null,sendButton:null,scrollUpButton:null,scrollDownButton:null,scrollBarPos:{x:229,y:22},scrollBarRect:{x:0,y:0,w:16,h:54},scrollBarKnobPos:1,scrollBarKnobRect:{x:-5,y:-5,w:10,h:10},textFontSize:10,textFont:"leaguespartan, Impact, Charcoal, sans-serif",
contentMaxSize:20,control:null,init:function(b){this.control=b;b=!1;b=ig.domHandler.getElementById("#chatbox_input_container");this.textInputPos={};this.textInputPos.x=100;this.textInputPos.y=109;this.textInputRect={};this.textInputRect.w=182;this.textInputRect.h=25;this.textInputRect.x=-this.textInputRect.w/2;this.textInputRect.y=-this.textInputRect.h/2;this.textinput=new ig.TextinputContainer("chatbox_input",this.textFontSize,this.textFont);var c,d;c=this.textInputPos.x;d=this.textInputPos.y;var e=
this.textInputRect;this.textinput.setRect(e.x,e.y,e.w,e.h);this.textinput.setPos(c,d);ig.domHandler.css(this.textinput.textInputElement,{margin:"0px",border:"0px",padding:"0px",background:"none",color:"rgb(255,255,255)","text-align":"left"});this.textinput.val("");b||(this.textinput.textInputElement.keyup(function(b){13===b.keyCode&&ig.global.control&&ig.global.control.chatbox&&ig.global.control.chatbox.sendButtonPressed()}),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",
this.onKeyUp,!1));b=46;c=21;d=this.textInputPos.x+this.textInputRect.w/2+5+4+b/2;var e=this.textInputPos.y,f=new ig.Button(this);f.setPos({x:d,y:e});f.setRect({x:-b/2,y:-c/2,w:b,h:c});f.posRelativeTo=this;f.setFont(12,"leaguespartan, Impact, Charcoal, sans-serif");f.textLineHeight=20;f.setTextColor({r:255,g:255,b:255});f.setText(_STRINGS.UI.Send);f.textOffset.x=0;f.textOffset.y=2;f.textAlpha=1;f.clickedFunction=this.sendButtonPressed.bind(this);f.downOffset={x:0,y:1};f.overOffset={x:0,y:-1};f.overScaleMultiplier=
1;f.downScaleMultiplier=1;f.buttonType=ig.BUTTONTYPE.SQUARE_RECT;f.fillStyle="#49211F";f.strokeStyle="rgb(255,255,255)";f.strokeWidth=0;f.btnShadowDisabled=!0;this.sendButton=f;c=b=16;d=this.scrollBarPos.x+b/2;e=this.scrollBarPos.y-3-c+c/2;f=new ig.Button(this);f.setPos({x:d,y:e});f.setRect({x:-b/2,y:-c/2,w:b,h:c});f.posRelativeTo=this;f.clickedFunction=this.scrollUpButtonPressed.bind(this);f.downOffset={x:0,y:1};f.overOffset={x:0,y:-1};f.overScaleMultiplier=1;f.downScaleMultiplier=1;f.buttonType=
ig.BUTTONTYPE.SQUARE_RECT;f.fillStyle="rgba(0,0,0,0.5)";f.btnShadowDisabled=!0;this.scrollUpButton=f;c=b=16;d=this.scrollBarPos.x+b/2;e=this.scrollBarPos.y+this.scrollBarRect.h+3+c/2;f=new ig.Button(this);f.setPos({x:d,y:e});f.setRect({x:-b/2,y:-c/2,w:b,h:c});f.posRelativeTo=this;f.clickedFunction=this.scrollDownButtonPressed.bind(this);f.downOffset={x:0,y:1};f.overOffset={x:0,y:-1};f.overScaleMultiplier=1;f.downScaleMultiplier=1;f.buttonType=ig.BUTTONTYPE.SQUARE_RECT;f.fillStyle="rgba(0,0,0,0.5)";
f.btnShadowDisabled=!0;this.scrollDownButton=f;this.createContentCanvas()},ready:function(){},draw:function(){var b=ig.system.context,c=this.pos.x+this.rect.x,d=this.pos.y+this.rect.y,e=this.rect.w,f=this.rect.h;b.fillStyle="rgba(0,0,0,0.5)";b.fillRect(c,d,e,f);c=this.contentPos.x+this.contentRect.x;d=this.contentPos.y+this.contentRect.y;e=this.contentRect.w;f=this.contentRect.h;b.fillStyle="rgba(0,0,0,0.5)";b.fillRect(c,d,e,f);if(this.contentCanvas&&0<this.contentCanvas.width&&0<this.contentCanvas.height){var d=
d+3,g=0,e=this.contentRect.w-6,f=this.contentRect.h-6;if(this.contentCanvas.height<f)var n=f-this.contentCanvas.height,f=this.contentCanvas.height,d=d+n;else this.contentCanvas.height>f&&(n=this.contentCanvas.height-f,g=this.scrollBarKnobPos*n);b.drawImage(this.contentCanvas,0,g,e,f,c+3,d,e,f)}c=this.scrollBarPos.x+this.scrollBarRect.x;d=this.scrollBarPos.y+this.scrollBarRect.y;e=this.scrollBarRect.w;f=this.scrollBarRect.h;b.fillStyle="rgba(0,0,0,0.5)";b.fillRect(c,d,e,f);e=this.scrollBarKnobRect.w;
f=this.scrollBarKnobRect.h;c+=3-this.scrollBarKnobRect.x-e/2;d+=3-this.scrollBarKnobRect.y-f/2+this.scrollBarKnobPos*(this.scrollBarRect.h-6-f);b.fillStyle="rgb(255,255,255)";b.fillRect(c,d,e,f);c=this.textInputPos.x+this.textInputRect.x-4;d=this.textInputPos.y+this.textInputRect.y;e=this.textInputRect.w+8;f=this.textInputRect.h;b.fillStyle="rgba(0,0,0,0.5)";b.fillRect(c,d,e,f);""==this.textinput.val()&&(c+=4,e=_STRINGS.UI["< Enter Your Message Here >"],b.font=this.textFontSize+"px "+this.textFont,
b.textAlign="left",b.fillStyle="#aaa",b.fillText(e,c,d+16));this.sendButton&&this.sendButton.draw();this.scrollUpButton&&(this.scrollUpButton.draw(),c=this.scrollUpButton.pos.x,d=this.scrollUpButton.pos.y,this.scrollUpButton.down?(c+=this.scrollUpButton.downOffset.x,d+=this.scrollUpButton.downOffset.y):this.scrollUpButton.over&&(c+=this.scrollUpButton.overOffset.x,d+=this.scrollUpButton.overOffset.y),b.beginPath(),b.moveTo(c,d-5),b.lineTo(c+6,d+5),b.lineTo(c-6,d+5),b.closePath(),b.fillStyle="#fff",
b.fill());this.scrollDownButton&&(this.scrollDownButton.draw(),c=this.scrollDownButton.pos.x,d=this.scrollDownButton.pos.y,this.scrollDownButton.down?(c+=this.scrollDownButton.downOffset.x,d+=this.scrollDownButton.downOffset.y):this.scrollDownButton.over&&(c+=this.scrollDownButton.overOffset.x,d+=this.scrollDownButton.overOffset.y),b.beginPath(),b.moveTo(c,d+5),b.lineTo(c+6,d-5),b.lineTo(c-6,d-5),b.closePath(),b.fillStyle="#fff",b.fill())},update:function(){this.textinput&&this.textinput.textInputElement&&
ig.input.state("click")&&this.textinput.textInputElement.blur();this.sendButton&&this.sendButton.update();this.scrollUpButton&&this.scrollUpButton.update();this.scrollDownButton&&this.scrollDownButton.update();if(ig.input.state("click")){var b=this.getInputPos(),c={};c.x=b.x;c.y=b.y;c.w=1;c.h=1;b={};b.x=this.pos.x+this.scrollBarPos.x+this.scrollBarRect.x+3;b.y=this.pos.y+this.scrollBarPos.y+this.scrollBarRect.y+3;b.w=this.scrollBarRect.w-6;b.h=this.scrollBarRect.h-6;this.aabbCheck(c,b)&&(this.scrollBarKnobPos=
(c.y-b.y)/b.h,0>this.scrollBarKnobPos&&(this.scrollBarKnobPos=0),1<this.scrollBarKnobPos&&(this.scrollBarKnobPos=1))}},sendButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");var b={},c=this.control.client_game.findPlayerById(ig.game.network_game.playerId);c&&(b.from=c.id,b.msg=this.textinput.val(),b.roomId=ig.game.network_game.roomId,ig.game.network_game.sendChatMessage(b));this.textinput.val("")},scrollUpButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&
ig.soundHandler.sfxPlayer.play("button");this.scrollBarKnobPos-=0.1;0>this.scrollBarKnobPos&&(this.scrollBarKnobPos=0)},scrollDownButtonPressed:function(){ig.soundHandler.sfxPlayer.soundList.button&&ig.soundHandler.sfxPlayer.play("button");this.scrollBarKnobPos+=0.1;1<this.scrollBarKnobPos&&(this.scrollBarKnobPos=1)},createContentCanvas:function(){this.contentCanvas=null;var b=this.contentRect.w-6;this.contentCanvas=ig.$new("canvas");this.contentCanvas.width=b;this.contentCanvas.height=14*this.contentArray.length;
b=this.contentCanvas.getContext("2d");b.font=this.textFontSize+"px "+this.textFont;b.textAlign="left";for(var c=10,d=0,e=this.contentArray.length;d<e;d++){var f=this.contentArray[d],g=0;if(""!==f.from&&!isNaN(f.from)&&null!==f.from){var g="",n=this.control.client_game.findPlayerById(f.from);n&&(g=n.shared_obj.name);var n=g+": ",g=b.measureText(n).width,l=!1;ig.game.network_game.playerId==f.from&&(l=!0);b.fillStyle="#aaa";l&&(b.fillStyle="rgba(247,174,30,1)");b.fillText(n,0,c)}b.fillStyle="#fff";b.fillText(f.msg,
0+g,c);c+=14}},addMessage:function(b,c){if(c){var d=c,e="";if(""!==b&&!isNaN(b)&&null!==b){var f=this.control.client_game.findPlayerById(b);f&&(e=f.shared_obj.name,d=e+": "+c)}this.textList=this.wrapText(d,this.contentRect.w-6);d=0;for(f=this.textList.length;d<f;d++){var g=this.textList[d],n={from:""};n.msg=g;0==d&&e&&(n.msg=g.substring(e.length+2),n.from=b);this.contentArray.push(n)}this.contentArray.length>this.contentMaxSize&&this.contentArray.splice(0,this.contentArray.length-this.contentMaxSize);
this.createContentCanvas()}},getInputPos:function(){return ig.game.io.getClickPos()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},wrapText:function(b,c,d){var e=ig.system.context;e.font=this.textFontSize+"px "+this.textFont;var f=b.split(" "),g="",n=[];if(1==f.length)for(var l=0,m=b.length;l<m;l++){var r=g+b[l],q=e.measureText(r),q=q.width;q>c&&0<l?(n.push(g),g=b[l]):g=r}else{l=0;for(m=f.length;l<m;l++)if(q=e.measureText(g+f[l]),!d&&q.width>c){b=0;for(var s=
f[l].length;b<s;b++)r=g+f[l][b],q=e.measureText(r),q=q.width,q>c&&0<b?(n.push(g),g=f[l][b]):g=r;g+=" "}else r=g+f[l]+" ",q=e.measureText(r),q=q.width,q>c&&0<l?(n.push(g),g=f[l]+" "):g=r}n.push(g);return n},onKeyDown:function(){},onKeyUp:function(b){"BODY"==b.target.tagName&&13==b.keyCode&&ig.global.control&&ig.global.control.chatbox&&ig.global.control.options.hidden&&ig.global.control.chatbox.textinput.textInputElement.focus()}})});ig.baked=!0;
ig.module("game.classes.callout").defines(function(){Callout=ig.Class.extend({pos:{x:0,y:0},offset:{x:0,y:0},rect:{x:0,y:0,w:0,h:0},scale:{x:1,y:1},alpha:1,textSize:10,textFont:"leaguespartan, Impact, Charcoal, sans-serif",textFillStyle:"#FFF",textShadowFillStyle:"rgba(0,0,0,0.5)",bgSideFillStyle:"rgba(255,0,0,0)",bgFillStyle:"rgba(255,0,0,0.5)",bgShadowFillStyle:"rgba(0,0,0,0.5)",bgStrokeStyle:"rgba(255,0,0,0.5)",bgLineWidth:4,text:"",control:null,endCallback:null,state:0,showTime:0,showDuration:0.1,
waitTime:0,waitDuration:2,fadeTime:0,fadeDuration:0.1,init:function(b,c){this.control=b;this.text=c;this.rect.w=100;this.rect.h=20;this.rect.x=-this.rect.w/2;this.rect.y=-this.rect.h/2;this.showTime=this.alpha=this.state=0},ready:function(){},draw:function(){if(!(0==this.alpha||0==this.scale.x||0==this.scale.y)){var b=ig.system.context;b.save();var c=this.pos.x,d=this.pos.y;b.translate(c,d);(1!=this.scale.x||1!=this.scale.y)&&b.scale(this.scale.x,this.scale.y);1>this.alpha&&(b.globalAlpha=this.alpha);
var c=this.rect.x,d=this.rect.y,e=b.createLinearGradient(c,0,c+this.rect.w,0);e.addColorStop(0,this.bgSideFillStyle);e.addColorStop(0.2,this.bgFillStyle);e.addColorStop(0.8,this.bgFillStyle);e.addColorStop(1,this.bgSideFillStyle);b.fillStyle=e;b.fillRect(c,d,this.rect.w,this.rect.h);c=0;d=0.4*this.textSize;b.font=this.textSize+"px "+this.textFont;b.textAlign="center";e=this.text;ig.global.addTextSpacing&&(e=e.split("").join(String.fromCharCode(8202)));b.fillStyle=this.textShadowFillStyle;b.fillText(e,
c+1,d+1);b.fillStyle=this.textFillStyle;b.fillText(e,c,d);b.restore()}},update:function(){if(0==this.state)if(this.showTime>=this.showDuration)this.alpha=this.state=1;else{this.showTime+=ig.system.tick;var b=this.showTime/this.showDuration;1<b&&(b=1);this.alpha=b}1==this.state&&(this.waitTime>=this.waitDuration?this.state=2:this.waitTime+=ig.system.tick);2==this.state&&(this.fadeTime>=this.fadeDuration?(this.state=3,this.alpha=0,"function"==typeof this.endCallback&&this.endCallback(this)):(this.fadeTime+=
ig.system.tick,b=this.fadeTime/this.fadeDuration,1<b&&(b=1),this.alpha=1-b))},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!1);"undefined"===typeof g&&(g=5);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-g,d);g&&b.quadraticCurveTo(c+e,d,c+e,d+g);b.lineTo(c+e,d+f-g);g&&b.quadraticCurveTo(c+e,d+f,c+e-g,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()}})});ig.baked=!0;
ig.module("plugins.number-anim").defines(function(){ig.NumberAnim=ig.Class.extend({minValue:0,maxValue:10,hasMin:!1,hasMax:!1,actualValue:0,displayValue:0,animStartTime:0,animStartValue:0,animDuration:0.2,init:function(b,c,d){if(!b||isNaN(b))b=0;this.setValue(b);isNaN(c)||this.setMin(c);isNaN(d)||this.setMax(d)},setValue:function(b){this.displayValue=this.actualValue=b},add:function(b){isNaN(b)||(this.actualValue+=b,this.hasMin&&this.actualValue<this.minValue&&(this.actualValue=this.minValue),this.hasMax&&
this.actualValue>this.maxValue&&(this.actualValue=this.maxValue),this.animStartTime=ig.system.clock.delta(),this.animStartValue=this.displayValue)},setActualValue:function(b){isNaN(b)||(this.actualValue=b,this.hasMin&&this.actualValue<this.minValue&&(this.actualValue=this.minValue),this.hasMax&&this.actualValue>this.maxValue&&(this.actualValue=this.maxValue),this.animStartTime=ig.system.clock.delta(),this.animStartValue=this.displayValue)},setMin:function(b){isNaN(b)?this.hasMin=!1:(this.minValue=
b,this.hasMin=!0)},setMax:function(b){isNaN(b)?this.hasMax=!1:(this.maxValue=b,this.hasMax=!0)},update:function(){if(0!=this.actualValue-this.displayValue){var b=(ig.system.clock.delta()-this.animStartTime)/this.animDuration;this.displayValue=1<=b?this.actualValue:this.displayValue=this.animStartValue+this.easeOutSine(b,this.actualValue-this.animStartValue)}},easeOutSine:function(b,c){return c*Math.sin(b*(Math.PI/2))}})});ig.baked=!0;
ig.module("game.classes.client-player").requires("plugins.number-anim","game.classes.avatar").defines(function(){ClientPlayer=ig.Class.extend({id:0,name:"",color:{r:255,g:255,b:255},drawPos:{x:0,y:0},nameplateSize:{w:140,h:30},nameAreaSize:{w:108,h:30},nameplatePos:{x:33,y:0},avatarPos:{x:-56,y:8},avatar:null,shared_obj:null,isPlayer:!0,client_position:0,turnTimeLeft:0,score:0,init:function(b,c){b&&(this.game=b,this.control=this.game.control);if(!c)return null;var d=c.id;this.id=d;this.shared_obj=
c;this.avatar=new Avatar(this.shared_obj.avatarId);this.id==ig.game.network_game.playerId&&(this.avatar.border=!0);shared_game.seed=6+Math.floor(this.game.state.startTime/1E4)+d;this.color.r=Math.floor(255*shared_game.seededRandom());this.color.g=Math.floor(255*shared_game.seededRandom());this.color.b=Math.floor(255*shared_game.seededRandom())},update:function(){if(!this.game.control.preventClicks&&this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_DECISION&&(this.game.state.playerTurn==this.client_position&&
this.id==ig.game.network_game.playerId)&&ig.input.released("click"))for(var b=ig.game.io.getClickPos(),b={x:b.x,y:b.y,w:1,h:1},c=this.game.boardPos.x-this.game.boardWidth/2,d=this.game.boardPos.y-this.game.boardWidth/2,e=this.game.boardWidth/3,f=0;3>f;f++)for(var g=0;3>g;g++)if(this.aabbCheck(b,{x:c+f*e,y:d+g*e,w:e,h:e})){var n=3*g+f;-1==this.game.state.boardState[n]&&(ig.game.network_game.sendPlayerDecision(n),ig.soundHandler.sfxPlayer.soundList.placemarker&&ig.soundHandler.sfxPlayer.play("placemarker"))}},
draw:function(){var b=ig.system.context,c=this.nameplateSize.w,d=this.nameplateSize.h;this.drawPos.x=-1E3;switch(this.shared_obj.order){case 0:this.drawPos.x=c/2+100;break;case 1:this.drawPos.x=ig.system.width-c/2-100}this.drawPos.y=ig.system.height/2+60;var c=this.nameAreaSize.w,d=this.nameAreaSize.h,e=this.drawPos.x-c/2,f=this.drawPos.y;if(this.game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE||this.game.state.phase==shared_game.PhaseEnum.PHASE_DECISION_ANIM||this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_DECISION||
this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_LEFT||this.game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS){this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_LEFT&&this.shared_obj.leftGameFlag?(b.save(),b.globalAlpha=0.25,this.drawSymbol(this.drawPos.x,this.drawPos.y-60),b.restore()):this.game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS&&this.game.last_winner!=this.shared_obj.symbolId?(b.save(),b.globalAlpha=0.25,this.drawSymbol(this.drawPos.x,this.drawPos.y-
60),b.restore()):(this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_DECISION||this.game.state.phase==shared_game.PhaseEnum.PHASE_DECISION_ANIM)&&this.game.state.playerTurn!=this.client_position?(b.save(),b.globalAlpha=0.25,this.drawSymbol(this.drawPos.x,this.drawPos.y-60),b.restore()):this.drawSymbol(this.drawPos.x,this.drawPos.y-60);var e=this.drawPos.x+20,f=this.drawPos.y+65,g=""+Math.floor(this.score);b.save();b.font="24px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";
b.fillStyle="rgba(0,0,0,1)";b.fillText(g,e+1,f+1);b.fillStyle="rgba(255,255,255,1)";b.fillText(g,e,f);b.restore()}e=this.drawPos.x-c/2;f=this.drawPos.y;this.avatar&&(e+=this.nameplatePos.x,f+=this.nameplatePos.y);g=!1;this.game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_DECISION&&this.game.state.playerTurn==this.client_position&&(g=!0);b.save();b.fillStyle="rgba(0,0,0,1)";this.shared_obj.leftGameFlag?b.fillStyle="rgba(0,0,0,0.25)":g&&(b.fillStyle="rgba(160,128,96,1)");this.roundRect(b,e,f,c,
d,10,!0,!1);if(g&&(g=1,0<=this.game.state.maxDecisionInterval&&(g=ig.game.network_game.getServerTime()-this.game.state.playerTurnTime,g=1-g/this.game.state.maxDecisionInterval,0>g&&(g=0),1<g&&(g=1)),0<g)){var n=g*c;b.lineWidth=2;b.strokeStyle="#111";b.fillStyle="rgba(192,192,192,0.5)";this.roundRect(b,e,f,c,d,10,!0,!0);b.fillStyle="rgba(247,174,30,1)";this.roundRect(b,e,f,n,d,10,!0,!1);0<=this.game.state.maxDecisionInterval&&(g=g*this.game.state.maxDecisionInterval/1E3,g=Math.ceil(g)+"s",ig.global.addTextSpacing&&
(g=g.split("").join(String.fromCharCode(8202))),b.font="10px leaguespartan, Impact, Charcoal, sans-serif",b.textAlign="center",b.fillStyle="rgba(0,0,0,1)",b.fillText(g,e+c-7+1,f-6+1),b.fillStyle="rgba(255,255,255,1)",b.fillText(g,e+c-7,f-6))}this.drawNames();b.lineWidth=2;b.strokeStyle="rgba(255,255,255,1)";this.id==ig.game.network_game.playerId&&(b.lineWidth=3,b.strokeStyle="rgba(192,92,64,1)");this.roundRect(b,e,f,c,d,10,!1,!0);b.restore();this.game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS&&
this.game.last_winner==this.shared_obj.symbolId&&(e=this.drawPos.x+20,f=this.drawPos.y+65+40,g=_STRINGS.UI["WINNER!"],b.save(),b.font="32px leaguespartan, Impact, Charcoal, sans-serif",b.textAlign="center",b.fillStyle="rgba(0,0,0,1)",b.fillText(g,e+1,f+1),b.fillStyle="rgba(255,255,255,1)",b.fillText(g,e,f),b.restore())},drawNames:function(){var b=ig.system.context;if(this.avatar){var c=this.drawPos.x+this.avatarPos.x,d=this.drawPos.y+this.avatarPos.y;b.save();b.translate(c,d);b.scale(1,1);this.avatar.draw(0,
0);b.restore()}var e=this.nameAreaSize.w,c=this.drawPos.x-e/2,d=this.drawPos.y;this.avatar&&(c+=this.nameplatePos.x,d+=this.nameplatePos.y);var f=this.shared_obj.name;b.font="14px leaguespartan, Impact, Charcoal, sans-serif";b.measureText(f).width>e&&(b.font="8px leaguespartan, Impact, Charcoal, sans-serif");b.textAlign="center";this.shared_obj.leftGameFlag?b.fillStyle="rgba(255,255,255,0.25)":(b.fillStyle="rgba(0,0,0,1)",b.fillText(f,c+e/2+1,d+19+1),b.fillStyle="rgba(255,255,255,1)");b.fillText(f,
c+e/2,d+19)},drawSymbol:function(b,c){switch(this.shared_obj.symbolId){case 0:this.game.drawX(b,c);break;case 1:this.game.drawO(b,c)}},roundRect:function(b,c,d,e,f,g,n,l){"undefined"==typeof l&&(l=!0);"undefined"===typeof g&&(g=5);var m=g;e<2*g&&(m-=2*g-e,0>m&&(m=0),e<g&&(g-=e,d+=g/2,f-=g,g=e));f<2*g&&(g=f/2);b.beginPath();b.moveTo(c+g,d);b.lineTo(c+e-m,d);m&&b.quadraticCurveTo(c+e,d,c+e,d+m);b.lineTo(c+e,d+f-m);m&&b.quadraticCurveTo(c+e,d+f,c+e-m,d+f);b.lineTo(c+g,d+f);g&&b.quadraticCurveTo(c,d+
f,c,d+f-g);b.lineTo(c,d+g);g&&b.quadraticCurveTo(c,d,c+g,d);b.closePath();l&&b.stroke();n&&b.fill()},aabbCheck:function(b,c){return b.x<=c.x+c.w&&b.y<=c.y+c.h&&b.x+b.w>=c.x&&b.y+b.h>=c.y},resetFlags:function(){}})});ig.baked=!0;
ig.module("game.classes.client-game").requires("plugins.number-anim","game.classes.client-player").defines(function(){ClientGame=ig.Class.extend({playerList:[],playerHash:{},removePlayerIdList:[],x_color:"#ff9999",o_color:"#9999ff",board_line_color:"#ffffff",boardPos:{x:0,y:0},boardWidth:360,state:null,last_winner:null,last_winner_name:null,last_winner_id:null,init:function(b){this.control=b},update:function(){for(var b=0,c=this.playerList.length;b<c;b++)this.playerList[b].update();this.cleanupPlayerList()},
draw:function(){if(this.state){this.boardPos.x=ig.system.width/2;this.boardPos.y=ig.system.height/2;this.drawBoard(this.boardPos.x,this.boardPos.y);var b=ig.system.context,c=ig.system.width/2,d=54,e="",f="";switch(this.state.phase){case shared_game.PhaseEnum.PHASE_PLAYER_DECISION:var g=this.findPlayerById(ig.game.network_game.playerId);g&&(e=g.client_position==this.state.playerTurn?_STRINGS.UI["YOUR TURN"]:this.state.players[this.state.playerTurn].name+_STRINGS.UI["'S TURN"]);break;case shared_game.PhaseEnum.PHASE_MATCH_RESULTS:g=
ig.game.network_game.getServerTime()-this.state.playerTurnTime,g=this.state.resultsDuration-g,g=Math.ceil(g/1E3),0<g&&(e=_STRINGS.UI["NEW MATCH BEGINS IN "]+g+_STRINGS.UI[" SECONDS..."])}b.save();b.font="24px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(e,c+1,d+1);b.fillStyle="#ffffff";b.fillText(e,c,d);b.restore();b.save();b.translate(0,24);b.font="18px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";
b.fillText(f,c+1,d+1);b.fillStyle="#ffffff";b.fillText(f,c,d);b.restore();c=ig.system.width/2;d=ig.system.height-40;f=e="";switch(this.state.phase){case shared_game.PhaseEnum.PHASE_INIT:e=_STRINGS.UI["WAITING FOR ANOTHER PLAYER..."];break;case shared_game.PhaseEnum.PHASE_FLASHJOIN:e=_STRINGS.UI["PLAYER JOINED!"];break;case shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE:e=_STRINGS.UI["STARTING MATCH..."];break;case shared_game.PhaseEnum.PHASE_PLAYER_DECISION:e=_STRINGS.UI["WAITING FOR PLAYER DECISION..."];
break;case shared_game.PhaseEnum.PHASE_DECISION_ANIM:e=_STRINGS.UI["SHOWING PLAYER DECISION..."];break;case shared_game.PhaseEnum.PHASE_MATCH_RESULTS:e=_STRINGS.UI["MATCH ENDED"];null!==this.last_winner&&void 0!==this.last_winner&&(f=null!==this.last_winner_name&&void 0!==this.last_winner_name&&""!=this.last_winner_name?this.last_winner_name+_STRINGS.UI[" WON!"]:_STRINGS.UI["IT'S A TIE!"],d-=6);break;case shared_game.PhaseEnum.PHASE_PLAYER_LEFT:e=_STRINGS.UI["PLAYER LEFT!"]}b.save();b.font="24px leaguespartan, Impact, Charcoal, sans-serif";
b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(e,c+1,d+1);b.fillStyle="#ffffff";b.fillText(e,c,d);b.restore();b.save();b.translate(0,24);b.font="18px leaguespartan, Impact, Charcoal, sans-serif";b.textAlign="center";b.fillStyle="rgba(0,0,0,0.5)";b.fillText(f,c+1,d+1);b.fillStyle="#ffffff";b.fillText(f,c,d);b.restore();b=0;for(c=this.playerList.length;b<c;b++)this.playerList[b].draw()}},drawX:function(b,c){var d=ig.system.context,e=this.x_color;d.save();d.translate(b+2,c+1+1);d.beginPath();
d.moveTo(-32.5,-17.5);d.lineTo(-17.5,-32.5);d.lineTo(0,-15);d.lineTo(17.5,-32.5);d.lineTo(32.5,-17.5);d.lineTo(15,0);d.lineTo(32.5,17.5);d.lineTo(17.5,32.5);d.lineTo(0,15);d.lineTo(-17.5,32.5);d.lineTo(-32.5,17.5);d.lineTo(-15,0);d.lineTo(-32.5,-17.5);d.fillStyle="rgba(0,0,0,0.5)";d.fill();d.translate(-2,-2);d.beginPath();d.moveTo(-32.5,-17.5);d.lineTo(-17.5,-32.5);d.lineTo(0,-15);d.lineTo(17.5,-32.5);d.lineTo(32.5,-17.5);d.lineTo(15,0);d.lineTo(32.5,17.5);d.lineTo(17.5,32.5);d.lineTo(0,15);d.lineTo(-17.5,
32.5);d.lineTo(-32.5,17.5);d.lineTo(-15,0);d.lineTo(-32.5,-17.5);d.fillStyle=e;d.fill();d.lineWidth=2;d.strokeStyle="#000000";d.stroke();d.restore()},drawO:function(b,c){var d=ig.system.context,e=this.o_color;d.save();d.beginPath();d.arc(b+1,c+1,25,0,2*Math.PI,!1);d.lineWidth=22;d.strokeStyle="rgba(0,0,0,0.5)";d.stroke();d.beginPath();d.arc(b,c,25,0,2*Math.PI,!1);d.lineWidth=22;d.strokeStyle="#000000";d.stroke();d.lineWidth=20;d.strokeStyle=e;d.stroke();d.restore()},drawBoard:function(b,c){if(this.state){this.drawBoardLines(b,
c);for(var d=this.state.boardState,e=b-this.boardWidth/2,f=c-this.boardWidth/2,g=this.boardWidth/6,n=0,l=d.length;n<l;n++){var m=d[n],r=Math.floor(n/3);b=e+g*(1+2*(n%3));c=f+g*(1+2*r);0==m?this.drawX(b,c):1==m&&this.drawO(b,c)}}},drawBoardLines:function(b,c){var d=this.boardWidth/2,e=b-d,f=b-d/3,g=b+d/3,n=b+d,l=c-d,m=c-d/3,r=c+d/3,d=c+d,q=ig.system.context,s=this.board_line_color,u=f,t=l,v=d;q.save();q.beginPath();q.moveTo(u+1,t+1);q.lineTo(f+1,v+1);q.lineWidth=12;q.strokeStyle="rgba(0,0,0,0.5)";
q.stroke();q.beginPath();q.moveTo(u,t-1);q.lineTo(f,v+1);q.lineWidth=12;q.strokeStyle="#000000";q.stroke();q.beginPath();q.moveTo(u,t);q.lineTo(f,v);q.lineWidth=10;q.strokeStyle=s;q.stroke();q.restore();f=u=g;t=l;v=d;q.save();q.beginPath();q.moveTo(u+1,t+1);q.lineTo(f+1,v+1);q.lineWidth=12;q.strokeStyle="rgba(0,0,0,0.5)";q.stroke();q.beginPath();q.moveTo(u,t-1);q.lineTo(f,v+1);q.lineWidth=12;q.strokeStyle="#000000";q.stroke();q.beginPath();q.moveTo(u,t);q.lineTo(f,v);q.lineWidth=10;q.strokeStyle=
s;q.stroke();q.restore();u=e;f=n;v=t=m;q.save();q.beginPath();q.moveTo(u+1,t+1);q.lineTo(f+1,v+1);q.lineWidth=12;q.strokeStyle="rgba(0,0,0,0.5)";q.stroke();q.beginPath();q.moveTo(u-1,t);q.lineTo(f+1,v);q.lineWidth=12;q.strokeStyle="#000000";q.stroke();q.beginPath();q.moveTo(u,t);q.lineTo(f,v);q.lineWidth=10;q.strokeStyle=s;q.stroke();q.restore();u=e;f=n;v=t=r;q.save();q.beginPath();q.moveTo(u+1,t+1);q.lineTo(f+1,v+1);q.lineWidth=12;q.strokeStyle="rgba(0,0,0,0.5)";q.stroke();q.beginPath();q.moveTo(u-
1,t);q.lineTo(f+1,v);q.lineWidth=12;q.strokeStyle="#000000";q.stroke();q.beginPath();q.moveTo(u,t);q.lineTo(f,v);q.lineWidth=10;q.strokeStyle=s;q.stroke();q.restore()},cleanupPlayerList:function(){if(0<this.removePlayerIdList.length){for(var b=0,c=this.removePlayerIdList.length;b<c;b++)delete this.playerHash[this.removePlayerIdList[b]];for(var d=[],e=0,f=this.playerList.length;e<f;e++){for(var g=this.playerList[e],n=!1,b=0,c=this.removePlayerIdList.length;b<c;b++)if(g.id==this.removePlayerIdList[b]){n=
!0;break}n?1>=this.removePlayerIdList.length?this.removePlayerIdList=[]:(b=this.removePlayerIdList.indexOf(g.id),this.removePlayerIdList.splice(b,1)):d.push(g)}this.playerList=d;this.removePlayerIdList=[]}},setupWithGameState:function(b){this.state=new shared_game.GameState;this.state.importData(b);this.playerList=[];b=0;for(var c=this.state.players.length;b<c;b++){var d=new ClientPlayer(this,this.state.players[b]);d.client_position=b;this.playerList.push(d);this.playerHash[d.id]=d}},findPlayerById:function(b){var c=
null;if(this.playerHash&&"undefined"!=typeof this.playerHash[b])return this.playerHash[b];for(var d=0,e=this.playerList.length;d<e;d++)if(this.playerList[d].id==b){c=this.playerList[d];this.playerHash&&(this.playerHash[c.id]=c);break}return c},syncPlayers:function(b){var c=[];if(b||this.state.phase==shared_game.PhaseEnum.PHASE_INIT||this.state.phase==shared_game.PhaseEnum.PHASE_FLASHJOIN){b=0;for(var d=this.playerList.length;b<d;b++){var e=this.playerList[b];e.shared_obj.leftGameFlag&&this.removePlayerIdList.push(e.shared_obj.id)}this.cleanupPlayerList()}b=
0;for(d=this.state.players.length;b<d;b++){var f=this.state.players[b],e=this.findPlayerById(f.id);if(!(0==this.state.phase||1==this.state.phase)||!f.leftGameFlag)e||(e=new ClientPlayer(this,f),this.playerList.push(e),this.playerHash[e.id]=e),e.client_position=b,e.init(this,f),c.push(e)}this.playerList=c},applyEvent:function(b){this.state=simulator.simulateEvent(b,this.state,null,{clientside:!0})},resetFlags:function(){for(var b=0,c=this.playerList.length;b<c;b++)this.playerList[b].resetFlags()}})});
ig.baked=!0;
ig.module("game.entities.game-control").requires("impact.entity","plugins.fade-transition","plugins.button","game.classes.options-panel","game.classes.chatbox","game.classes.callout","game.classes.client-game").defines(function(){this.START_WHITELABEL_ENCAPSULATOR;I5pp.C7=2;I5pp.R7=null;I5pp.O7=true;I5pp.B7='http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/mainbg.png';I5pp.Z7=function(h7){return{g7:function(){var p7,l7=arguments;switch(h7){case 2:p7=l7[1]/l7[0];break;case 1:p7=l7[1]|l7[0];break;case 0:p7=l7[1]-l7[0];break;case 3:p7=l7[0]*l7[1];break;case 4:p7=+l7[1]+l7[2]<<l7[0];break;}return p7;},S7:function(a7){h7=a7;}};}();I5pp.X7=5;I5pp.i7='http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_settings.png';I5pp.U7=0;I5pp.x7=function (){return typeof I5pp.Z7.S7==='function'?I5pp.Z7.S7.apply(I5pp.Z7,arguments):I5pp.Z7.S7;};I5pp.N7="0";I5pp.z7="1";I5pp.q7='http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/game/gui/buttons/button_long.png';I5pp.Q7=1;I5pp.v7=function (){return typeof I5pp.Z7.g7==='function'?I5pp.Z7.g7.apply(I5pp.Z7,arguments):I5pp.Z7.g7;};function I5pp(){}I5pp.M7=false;I5pp.c7="2";I5pp.n7=function (){return typeof I5pp.Z7.g7==='function'?I5pp.Z7.g7.apply(I5pp.Z7,arguments):I5pp.Z7.g7;};I5pp.t7=function (){return typeof I5pp.Z7.S7==='function'?I5pp.Z7.S7.apply(I5pp.Z7,arguments):I5pp.Z7.S7;};EntityGameControl=ig.Entity.extend({bgImage:new ig.Image(I5pp.B7),settingsImage:new ig.Image(I5pp.i7),rankingImage:new ig.Image(I5pp.q7),bgOffset:{x:I5pp.N7*I5pp.Q7,y:I5pp.N7|I5pp.U7},bgScale:I5pp.z7*I5pp.Q7,options:I5pp.R7,optionsButton:I5pp.R7,chatbox:I5pp.R7,fadeTransition:I5pp.R7,pingInterval:I5pp.X7,pingTime:I5pp.N7-I5pp.U7,client_game:I5pp.R7,preventClicks:I5pp.M7,callouts:[],init:function(I,f,g){var L2=I5pp;var Y7=18;var G7=9;var I,f,H;this.parent(I,f,g);if(ig.global.wm){return;}if(this.bgImage){L2.x7(L2.U7);I=L2.v7(L2.U7,L2.N7);L2.t7(L2.Q7);f=L2.n7(L2.U7,L2.N7);if(this.bgImage.width*this.bgScale<ig.system.width){H=ig.system.width/this.bgImage.width;this.bgScale=H;}if(this.bgImage.height*this.bgScale<ig.system.height){H=ig.system.height/this.bgImage.height;this.bgScale=H;}if(this.bgImage.width*this.bgScale>ig.system.width){I=-(this.bgImage.width*this.bgScale-ig.system.width)/+L2.c7;}if(this.bgImage.height*this.bgScale>ig.system.height){L2.x7(L2.C7);var j5=L2.v7(G7,Y7);f=-(this.bgImage.height*this.bgScale-ig.system.height)/j5;}this.bgOffset.x=this.bitwiseRound(I);this.bgOffset.y=this.bitwiseRound(f);}this.initButtons();this.setupGame();ig.global.control=this;ig.game.network_game.pingSendTime=Date.now();ig.game.network_game.pingReplyPending=L2.M7;},ready:function(){if(ig.global.wm){return;}this.fadeTransition=new ig.FadeTransition();this.fadeTransition.startFadeinTransition();this.fadeTransition.transitionEndFunction=this.transitionEnded.bind(this);},initButtons:function(){var v2=I5pp;var w7="20";var G,N,A,l;this.options=new OptionsPanel(this);this.options.hasMainmenuButton=v2.O7;this.options.hasTutorialButton=v2.O7;this.options.ready();G=this.settingsImage;N=G.width;A=G.height;l=new ig.Button(this);l.setPos({x:ig.system.width-N/(v2.c7-v2.U7)-w7*v2.Q7,y:A/+v2.c7+(w7|v2.U7)});l.setRect({x:-N/v2.C7,y:-A/(v2.c7|v2.U7),w:N,h:A});l.clickedFunction=this.optionsButtonClicked.bind(this);l.downOffset={x:v2.N7|v2.U7,y:+v2.z7};l.overOffset={x:+v2.N7,y:-v2.Q7};l.overScaleMultiplier=+v2.z7;l.downScaleMultiplier=+v2.z7;l.buttonType=ig.BUTTONTYPE.IMAGE;l.setUpImage(G);l.btnShadowDisabled=v2.O7;this.optionsButton=l;},draw:function(){var Z2=I5pp;var e7='#777777';var f7=3;var U,e;U=ig.system.context;if(this.bgImage){U.save();if(this.bgScale!=+Z2.z7){U.translate(this.bgOffset.x,this.bgOffset.y);U.scale(this.bgScale,this.bgScale);}Z2.t7(f7);this.bgImage.draw(+Z2.N7,Z2.v7(Z2.N7,Z2.Q7));U.restore();}else{U.fillStyle=e7;Z2.x7(Z2.Q7);U.fillRect(+Z2.N7,Z2.n7(Z2.U7,Z2.N7),ig.system.width,ig.system.height);}if(this.client_game){this.client_game.draw();}if(this.optionsButton){this.optionsButton.draw();}for(var p=Z2.N7*Z2.Q7,k=this.callouts.length;p<k;p++){e=this.callouts[p];if(e){e.draw();}}if(this.chatbox){this.chatbox.draw();}if(this.options){this.options.draw();}if(this.fadeTransition){this.fadeTransition.draw();}},update:function(){var E7='ms';var I7='disconnecting: did not receive ping within ';var r,X;if(this.options){this.optionsButton.update();this.options.update();}if(this.chatbox){this.chatbox.update();}if(this.fadeTransition){this.fadeTransition.update();}if(ig.game.network_game&&ig.game.network_game.pingReplyPending){r=Date.now()-ig.game.network_game.pingSendTime;if(r>=ig.game.network_game.pingTimeout){console.log(I7+ig.game.pingTimeout+E7);this.returnToMainMenu();return;}}if(ig.game.network_game){this.pingTime+=ig.system.tick;if(this.pingTime>this.pingInterval){this.pingTime=this.pingTime%this.pingInterval;ig.game.network_game.pingServer(function(){}.bind(this),function(){var s7='s';console.log(I7+this.pingInterval+s7);this.returnToMainMenu();return;}.bind(this));}}if(this.gamePaused){return;}if(this.client_game){this.client_game.update();}for(var W=+I5pp.N7,D=this.callouts.length;W<D;W++){X=this.callouts[W];if(X){X.update();}}},returnToMainMenu:function(){ig.input.clearPressed();if(this.fadeTransition){this.fadeTransition.startFadeoutTransition();this.fadeTransition.transitionEndFunction=function(){ig.game.director.jumpTo(LevelHome);}.bind(this);}ig.game.network_game.leaveGame();},optionsButtonClicked:function(){var y7="button";if(ig.soundHandler.sfxPlayer.soundList[y7]){ig.soundHandler.sfxPlayer.play(y7);}this.showOptions();},showOptions:function(){if(this.optionsButton.disabled){return;}this.options.show();this.optionsButton.disable();this.preventClicks=I5pp.O7;this.options.hideDoneCallback=function(){this.optionsButton.enable();this.options.hideDoneCallback=I5pp.R7;this.preventClicks=I5pp.M7;}.bind(this);},transitionEnded:function(){},setupGame:function(){var o7='initialGameState not found';var R;if(!ig.game.network_game||!ig.game.network_game.initialGameState){ig.game.resetApp();console.log(o7);return;}this.playerId=ig.game.network_game.playerId;this.client_game=new ClientGame(this);this.client_game.setupWithGameState(ig.game.network_game.initialGameState);if(!this.verifyGameIntegrity()){ig.game.network_game.leaveGame();return;}ig.game.network_game.gameStateUpdateCallback=this.onGameStateUpdate.bind(this);while(ig.game.network_game.unhandledUpdateQueue.length>I5pp.N7*I5pp.Q7){R=ig.game.network_game.unhandledUpdateQueue.shift();this.onGameStateUpdate(R);}ig.game.network_game.sendPlayerReady();this.chatbox=new Chatbox(this);this.chatbox.ready();},gameMeta:function(C){if(C.players){if(C.players.length>this.client_game.playerList.length){if(C.gameState){this.client_game.state.importData(C.gameState);this.client_game.syncPlayers();}}}},gameChat:function(z){if(!z||!z.msg){return;}if(this.chatbox){this.chatbox.addMessage(z.from,z.msg);}},onPause:function(){},onResume:function(){this.client_game.syncPlayers();},getInputPos:function(){return ig.game.io.getClickPos();},aabbCheck:function(v,K){return v.x<=K.x+K.w&&v.y<=K.y+K.h&&v.x+v.w>=K.x&&v.y+v.h>=K.y;},easeOutSine:function(q,Y){return Y*Math.sin(q*(Math.PI/(I5pp.c7-I5pp.U7)));},bitwiseRound:function(J){var r7="0.5";var u7=4;I5pp.x7(u7);return I5pp.n7(I5pp.U7,r7,J);},onGameStateUpdate:function(V){var A2=I5pp;var T7="placemarker";var D7="tied";var b7="lost";var V7="win";var k7='Injecting End Game API ...';var m7='Leaderboard SubmitScore ...';var J7="50";var K7='Submitting to MarketJS Leaderboard: ';var j7='AdInGameEndgame Initializing ...';var P7="undefined";var F7='Checking for AdInGameEndgame ...';var d7="";var W7="reset";var a,M,T,E,S,o,b;for(var m=+A2.N7,L=V.eventList.length;m<L;m++){a=V.eventList[m];if(!a)continue;if(this.client_game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS){if(a.type==shared_game.EventType.PHASE_TRANSITION){if(a.info.phase==shared_game.PhaseEnum.PHASE_MATCH_ANNOUNCE){A2.t7(A2.Q7);M=A2.v7(A2.U7,A2.N7);for(var m=+A2.N7,L=this.client_game.state.boardState.length;m<L;m++){if(this.client_game.state.boardState[m]!=-(A2.z7|A2.U7)){M+=+A2.z7;break;}}if(M>A2.U7){if(ig.soundHandler.sfxPlayer.soundList[W7]){ig.soundHandler.sfxPlayer.play(W7);}}}}}if(a.type==shared_game.EventType.PHASE_TRANSITION){if(a.info.phase==shared_game.PhaseEnum.PHASE_FLASHJOIN||this.client_game.state.phase==shared_game.PhaseEnum.PHASE_PLAYER_LEFT){M=+A2.N7;for(var m=A2.N7-A2.U7,L=this.client_game.state.boardState.length;m<L;m++){if(this.client_game.state.boardState[m]!=-+A2.z7){M+=+A2.z7;break;}}if(M>A2.U7){if(ig.soundHandler.sfxPlayer.soundList[W7]){ig.soundHandler.sfxPlayer.play(W7);}}}}this.client_game.applyEvent(a);T=a.info.gamestate;if(T){this.client_game.syncPlayers();}if(a.type==shared_game.EventType.PHASE_TRANSITION){E=a.info.phase;if(this.client_game.state.phase==shared_game.PhaseEnum.PHASE_INIT||this.client_game.state.phase==shared_game.PhaseEnum.PHASE_FLASHJOIN){this.client_game.syncPlayers();for(var m=+A2.N7,L=this.client_game.playerList.length;m<L;m++){S=this.client_game.playerList[m];S.score=A2.U7;}}else if(this.client_game.state.phase==shared_game.PhaseEnum.PHASE_MATCH_RESULTS){this.client_game.last_winner=a.info.winner;this.client_game.last_winner_name=d7;this.client_game.last_winner_id=-+A2.z7;for(var Z=+A2.N7,B=this.client_game.state.players.length;Z<B;Z++){o=this.client_game.state.players[Z];if(o.symbolId==this.client_game.last_winner){this.client_game.last_winner_name=o.name;this.client_game.last_winner_id=o.id;console.log(F7);if(typeof AdInGameEndgame!=P7){console.log(j7);AdInGameEndgame.Initialize();}console.log(K7,+J7);if(typeof MarketJS!=P7){console.log(m7);MarketJS.Leaderboard.SubmitScore(+J7);}console.log(k7);try{console.log('enabled endgame api11');;}catch(F){console.log(F.message);}break;}else{console.log(F7);if(typeof AdInGameEndgame!=P7){console.log(j7);AdInGameEndgame.Initialize();}console.log(K7,+A2.N7);if(typeof MarketJS!=P7){console.log(m7);MarketJS.Leaderboard.SubmitScore(A2.U7);}console.log(k7);try{console.log('enabled endgame api11');;}catch(n){console.log(n.message);}break;}}if(this.client_game.last_winner_id!=-+A2.z7){S=this.client_game.findPlayerById(this.client_game.last_winner_id);if(S){S.score+=A2.Q7;if(this.client_game.last_winner_id==ig.game.network_game.playerId){if(ig.soundHandler.sfxPlayer.soundList[V7]){ig.soundHandler.sfxPlayer.play(V7);}}else{if(ig.soundHandler.sfxPlayer.soundList[b7]){ig.soundHandler.sfxPlayer.play(b7);}}}}else{if(ig.soundHandler.sfxPlayer.soundList[D7]){ig.soundHandler.sfxPlayer.play(D7);}}}}else if(a.type==shared_game.EventType.PLAYER_DECISION){b=a.info.playerId;S=this.client_game.findPlayerById(b);if(S){o=this.client_game.state.findPlayerById(S.id);S.shared_obj=o;if(S.id!=ig.game.network_game.playerId){if(ig.soundHandler.sfxPlayer.soundList[T7]){ig.soundHandler.sfxPlayer.play(T7);}}}}else if(a.type==shared_game.EventType.MATCH_RESULT){}else if(a.type==shared_game.EventType.PLAYER_LEAVE){this.client_game.syncPlayers();if(a.info.playerId==ig.game.network_game.playerId){ig.input.clearPressed();if(this.fadeTransition){this.fadeTransition.startFadeoutTransition();this.fadeTransition.transitionEndFunction=function(){ig.game.director.jumpTo(LevelHome);}.bind(this);}}}}return A2.O7;},resetFlags:function(){this.client_game.resetFlags();},verifyGameIntegrity:function(){var P;P=I5pp.M7;return!P;},addCallout:function(O,u){var Q;if(!O){return;}if(!u||isNaN(u.x)||isNaN(u.y)){return;}Q=new Callout(this,O);Q.pos.x=u.x;Q.pos.y=u.y;Q.endCallback=this.calloutEnded.bind(this);this.callouts.push(Q);return Q;},calloutEnded:function(I5){var d;d=this.callouts.indexOf(I5);if(d>=I5pp.N7-I5pp.U7){this.callouts.splice(d,+I5pp.z7);}}});this.END_WHITELABEL_ENCAPSULATOR;});ig.baked=!0;ig.module("game.levels.game").requires("impact.image","game.entities.game-control").defines(function(){LevelGame={entities:[{type:"EntityGameControl",x:0,y:0}],layer:[]}});
ig.baked=!0;
ig.module("game.main").requires("impact.game","plugins.patches.webkit-image-smoothing-patch","plugins.patches.windowfocus-onMouseDown-patch","plugins.handlers.dom-handler","plugins.handlers.size-handler","plugins.handlers.api-handler","plugins.audio.sound-handler","plugins.io.io-manager","plugins.splash-loader","plugins.tween","plugins.url-parameters","plugins.director","plugins.impact-storage","plugins.mjs-network-client","game.classes.network-game","game.entities.opening-shield","game.entities.opening-kitty","game.entities.pointer",
"game.entities.pointer-selector","game.entities.select","game.levels.opening","game.levels.home","game.levels.game").defines(function(){this.MJSSOB;MyGame=ig.Game.extend({versionString:"DEV ",io:null,paused:!1,prefix:"tictactoe-with-friends",doTutorialFlag:!1,firstrun:!0,muted:!1,musicVolume:0.5,sfxVolume:1,defaultPlayerName:"DefaultName",playerName:"",avatarId:0,network_client:null,network_game:null,init:function(){this.setupMarketJsGameCenter();ig.global.addTextSpacing=!1;ig.ua.mobile||(ig.global.addTextSpacing=
!0);$(ig.system.canvas.id).mouseleave(function(){ig.input.actions.click=!1;ig.input.locks.click=!1});$(window).blur(function(){ig.input.actions={};ig.input.locks={}});this.io=new IoManager;this.setupUrlParams=new ig.UrlParameters;server_ip=getQueryVariable("server_ip");this.network_client=new ig.MjsNetworkClient;this.network_game=new NetworkGame(this.network_client);this.finalize()},setupMarketJsGameCenter:function(){if(_SETTINGS)if(_SETTINGS.MarketJSGameCenter){var b=ig.domHandler.getElementByClass("gamecenter-activator");
_SETTINGS.MarketJSGameCenter.Activator.Enabled&&_SETTINGS.MarketJSGameCenter.Activator.Position&&(console.log("MarketJSGameCenter activator settings present ...."),ig.domHandler.css(b,{position:"absolute",left:_SETTINGS.MarketJSGameCenter.Activator.Position.Left,top:_SETTINGS.MarketJSGameCenter.Activator.Position.Top,"z-index":3}));ig.domHandler.show(b)}else console.log("MarketJSGameCenter settings not defined in game settings")},finalize:function(){this.playerName=this.defaultPlayerName;this.setupLocalStorage();
if(ig.ua.mobile){var b=ig.domHandler.getElementById("#play");ig.domHandler.attr(b,"onclick","ig.game.splashClick();");ig.domHandler.show(b)}else _SETTINGS.Branding.Splash.Enabled?(b=ig.domHandler.getElementById("#play"),ig.domHandler.attr(b,"onclick","ig.game.splashClick();"),ig.domHandler.show(b)):this.start();ig.sizeHandler.reorient()},removeLoadingWheel:function(){try{$("#ajaxbar").css("background","none")}catch(b){console.log(b)}},showDebugMenu:function(){console.log("showing debug menu ...");
ig.Entity._debugShowBoxes=!0;$(".ig_debug").show()},start:function(){this.resetPlayerStats();this.director=new ig.Director(this,[LevelOpening,LevelHome,LevelGame]);if(_SETTINGS.Branding.Splash.Enabled)try{this.branding=new ig.BrandingSplash}catch(b){console.log(b),console.log("Loading original levels ..."),this.director.loadLevel(this.director.currentLevel)}else this.director.loadLevel(this.director.currentLevel)},drawFPS:function(){this.fpsTimer||(this.fpsTimer=new ig.Timer(1));this.fpsTimer&&0>
this.fpsTimer.delta()?null!=this.fpsCounter?this.fpsCounter++:this.fpsCounter=0:(ig.game.fps=this.fpsCounter,this.fpsCounter=0,this.fpsTimer.reset());if(ig.game.fps){ig.system.context.fillStyle="#000";ig.system.context.font="14px Impact, Charcoal, sans-serif";ig.system.context.textAlign="left";var b=ig.game.versionString;ig.game.network_game&&(b+="("+ig.game.network_game.clientVersion+")");ig.system.context.fillText(b,10,18);ig.system.context.fillStyle="#000";ig.system.context.font="14px Impact, Charcoal, sans-serif";
ig.system.context.textAlign="left";ig.system.context.fillText(ig.game.fps,10,32);null!=this.playerId&&(b=Math.floor((ig.game.pingReceiveTime-ig.game.pingSendTime)/2),this.pingReplyPending&&(b=Math.floor((Date.now()-ig.game.pingSendTime)/2)),b+=" ("+ig.game.gameLatencyAverage+")",ig.system.context.fillStyle="#000",ig.system.context.font="14px Impact, Charcoal, sans-serif",ig.system.context.textAlign="left",ig.system.context.fillText(b,10,48))}},endGame:function(){console.log("End game");ig.soundHandler.bgmPlayer.stop();
ig.apiHandler.run("MJSEnd")},resetPlayerStats:function(){ig.log("resetting player stats ...");this.playerStats={id:this.playerStats?this.playerStats.id:null}},splashClick:function(){var b=ig.domHandler.getElementById("#play");ig.domHandler.hide(b);ig.apiHandler.run("MJSFooter");ig.apiHandler.run("MJSHeader");ig.game.start()},pause:function(){var b=ig.game.getEntitiesByType(EntityGameControl);if(0<b.length&&"function"==typeof b[0].onPause)b[0].onPause()},resume:function(){var b=ig.game.getEntitiesByType(EntityGameControl);
if(0<b.length&&"function"==typeof b[0].onResume)b[0].onResume();ig.game.update()},showOverlay:function(b){for(var c=0,d=b.length;c<d;c++)$("#"+b[c])&&$("#"+b[c]).show(),document.getElementById(b[c])&&(document.getElementById(b[c]).style.visibility="visible")},hideOverlay:function(b){for(var c=0,d=b.length;c<d;c++)$("#"+b[c])&&$("#"+b[c]).hide(),document.getElementById(b[c])&&(document.getElementById(b[c]).style.visibility="hidden")},update:function(){this.paused?this.updateWhilePaused():(this.parent(),
ig.ua.mobile&&ig.soundHandler&&ig.soundHandler.forceLoopBGM())},updateWhilePaused:function(){for(var b=0,c=this.entities.length;b<c;b++)this.entities[b].ignorePause&&this.entities[b].update()},draw:function(){this.parent()},drawDebug:function(){if(!ig.global.wm&&(this.debugEnable(),this.viewDebug&&(ig.system.context.fillStyle="#000000",ig.system.context.globalAlpha=0.35,ig.system.context.fillRect(0,0,ig.system.width/4,ig.system.height),ig.system.context.globalAlpha=1,this.debug&&0<this.debug.length)))for(var b=
0,c=this.debug.length;b<c;b++)ig.system.context.font="10px Arial",ig.system.context.fillStyle="#ffffff",ig.system.context.fillText(this.debugLine-this.debug.length+b+": "+this.debug[b],10,50+10*b)},debugCL:function(b){this.debug?(50>this.debug.length||this.debug.splice(0,1),this.debug.push(b),this.debugLine++):(this.debug=[],this.debugLine=1,this.debug.push(b));console.log(b)},debugEnable:function(){ig.input.pressed("click")&&(this.debugEnableTimer=new ig.Timer(2));this.debugEnableTimer&&0>this.debugEnableTimer.delta()?
ig.input.released("click")&&(this.debugEnableTimer=null):this.debugEnableTimer&&0<this.debugEnableTimer.delta()&&(this.debugEnableTimer=null,this.viewDebug=this.viewDebug?!1:!0)},showDebug:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!0;ig.domHandler.show(ig.domHandler.getElementByClass("ig_debug"))},hideDebug:function(){console.log("showing debug menu ...");ig.Entity._debugShowBoxes=!1;ig.domHandler.hide(ig.domHandler.getElementByClass("ig_debug"))},setupLocalStorage:function(){this.storage=
ig.game.io.storage;this.getPlayerStats();this.savePlayerStats()},savePlayerStats:function(){null!=this.storage&&(this.storage.set(this.prefix+".musicVolume",this.musicVolume),this.storage.set(this.prefix+".sfxVolume",this.sfxVolume),this.storage.set(this.prefix+".muted",this.muted),this.storage.set(this.prefix+".firstrun",this.firstrun),this.storage.set(this.prefix+".playerName",this.playerName),this.storage.set(this.prefix+".playerAvatarId",this.avatarId))},getPlayerStats:function(){ig.ua.mobile&&
(this.musicVolume=0.25);if(null==this.storage)ig.soundHandler.bgmPlayer.volume(this.musicVolume),ig.soundHandler.sfxPlayer.volume(this.sfxVolume);else{var b=this.storage.get(this.prefix+".musicVolume");null!=b&&(this.musicVolume=b,ig.ua.mobile&&0.25<this.musicVolume&&(this.musicVolume=0.25));ig.soundHandler.bgmPlayer.volume(this.musicVolume);b=this.storage.get(this.prefix+".sfxVolume");null!=b&&(this.sfxVolume=b);ig.soundHandler.sfxPlayer.volume(this.sfxVolume);b=this.storage.get(this.prefix+".muted");
null!=b&&(this.muted=b);this.muted?(ig.soundHandler.bgmPlayer.volume(0),ig.soundHandler.sfxPlayer.volume(0)):(ig.soundHandler.bgmPlayer.volume(this.musicVolume),ig.soundHandler.sfxPlayer.volume(this.sfxVolume));b=this.storage.get(this.prefix+".firstrun");null!=b&&(this.firstrun=b);b=this.storage.get(this.prefix+".playerName");null!=b&&(this.playerName=b);b=this.storage.get(this.prefix+".playerAvatarId");null!=b&&!isNaN(b)&&(this.avatarId=b)}},resetApp:function(){this.network_game&&(this.network_game.leaveGame(),
this.network_game.roomId=null,this.network_game.playerId=null,this.network_game.pingReplyPending=!1);1!=this.director.currentLevel?(this.director.loadLevel(1),ig.game.network_client&&ig.game.network_client.socket&&(ig.game.network_client.socket.io.skipReconnect||setTimeout(function(){ig.game.network_client.socket.io.reconnecting=!1;ig.game.network_client.socket.io.reconnect()},1E3))):this.entities[0].reset()}});ig.domHandler=null;ig.domHandler=new ig.DomHandler;ig.domHandler.forcedDeviceDetection();
ig.domHandler.forcedDeviceRotation();ig.apiHandler=new ig.ApiHandler;ig.sizeHandler=new ig.SizeHandler(ig.domHandler);ig.ua.mobile?(ig.Sound.enabled=!1,ig.main("#canvas",MyGame,60,ig.sizeHandler.mobile.actualResolution.x,ig.sizeHandler.mobile.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader),ig.sizeHandler.resize()):ig.main("#canvas",MyGame,60,ig.sizeHandler.desktop.actualResolution.x,ig.sizeHandler.desktop.actualResolution.y,ig.sizeHandler.scale,ig.SplashLoader);ig.soundHandler=null;ig.soundHandler=
new ig.SoundHandler;ig.sizeHandler.reorient();this.MJSEOB});
</script>
<!-- Abstract -->
</head>
<body onload="setTimeout(function(){window.scrollTo(0,1)},1);">
<!--body-->
    <div id="pause" onclick="ig.game.resumeGame();"></div>
	<div id="ajaxbar">
        <div id="game"><canvas id="canvas"></canvas></div>
        <div id="orientate"><img src="http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/orientate/portrait.jpg" /></div>
        <div id="play" class="play" onclick=""><img src="http://cdn.marketjs.net/games/tictactoe-with-friends/localization/en/media/graphics/splash/mobile/cover-start.png" /></div>
        <!--<img id="scrollDown" width="220" height="277"></img>-->
    </div>
    <!-- <div id="tempdiv"><br><br><br></div> -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117180225-25"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117180225-25');

_SETTINGS.MoreGames.NewWindow=false;

</script>
</body>

<!-- Mirrored from smartfun.club/serve?portal_id=5763614147346432&game_id=5420867413606400&branding_id=5734046899372032&ad_id=4865470182195200&portal_localization_id=5092721263902720 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Sep 2023 14:22:49 GMT -->
</html>
